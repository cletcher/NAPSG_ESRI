// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/dijit/ObliqueViewer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../tasks/QueryTask ../tasks/query ./_EventedWidget dijit/_Widget ./_ObliqueRotationWidget dojo/_base/array ../ImageSpatialReference ../tasks/ImageServiceProjectTask ../tasks/ProjectParameters ../layers/MosaicRule ../geometry/Extent ../geometry/Polygon ../lang ../config ./RasterList dojo/store/Observable dojo/store/Memory dojo/date/locale dojo/json dojo/number esri/geometry/geometryEngine dojo/Deferred".split(" "),
function(d,e,m,h,a,c,k,l,t,g,p,b,v,w,q,n,r,u,z,B,y,F,C,D,G,x){d=d([k,l],{declaredClass:"esri.dijit.ObliqueViewer",azimuthField:"SensorAzimuth",elevationThreshold:70,elevationField:"SensorElevation",snap:!0,_refreshOK:!0,isNadir:!1,showThumbnail:!0,noQueryOnExtentChange:!1,azimuthTolerance:10,rasterListRefresh:!0,extents:[],center:null,searchRadius:0,searchUnit:"meters",maxExtentIdx:5,currentExtentIdx:null,esriDataType:{decimal:{esriFieldTypeDouble:1,esriFieldTypeSingle:1},integer:{esriFieldTypeInteger:1,
esriFieldTypeSmallInteger:1},date:{esriFieldTypeDate:1},string:{esriFieldTypeString:1},notRequired:{esriFieldTypeGeometry:1,esriFieldTypeBlob:1}},_dateFormats:{shortDate:{datePattern:"M/d/y",selector:"date"},shortDateLE:{datePattern:"d/M/y",selector:"date"},longMonthDayYear:{datePattern:"MMMM d, y",selector:"date"},dayShortMonthYear:{datePattern:"d MMM y",selector:"date"},longDate:{datePattern:"EEEE, MMMM d, y",selector:"date"},shortDateShortTime:{datePattern:"M/d/y",timePattern:"h:mm a",selector:"date and time"},
shortDateLEShortTime:{datePattern:"d/M/y",timePattern:"h:mm a",selector:"date and time"},shortDateShortTime24:{datePattern:"M/d/y",timePattern:"H:mm",selector:"date and time"},shortDateLEShortTime24:{datePattern:"d/M/y",timePattern:"H:mm",selector:"date and time"},shortDateLongTime:{datePattern:"M/d/y",timePattern:"h:mm:ss a",selector:"date and time"},shortDateLELongTime:{datePattern:"d/M/y",timePattern:"h:mm:ss a",selector:"date and time"},shortDateLongTime24:{datePattern:"M/d/y",timePattern:"H:mm:ss",
selector:"date and time"},shortDateLELongTime24:{datePattern:"d/M/y",timePattern:"H:mm:ss",selector:"date and time"},longMonthYear:{datePattern:"MMMM y",selector:"date"},shortMonthYear:{datePattern:"MMM y",selector:"date"},year:{datePattern:"y",selector:"date"}},setNextExtent:function(){if(!(this.currentExtentIdx>=this.maxExtentIdx||this.currentExtentIdx>=this.extents.length-1)){var f=this;this.currentExtentIdx++;var a=new w,b;a.method=w.METHOD_LOCKRASTER;a.lockRasterIds=[this.extents[this.currentExtentIdx].spatialReference.icsid];
f.imageServiceLayer.setMosaicRule(a,!0);f._refreshOK=!1;f.map.spatialReference=this.extents[this.currentExtentIdx].spatialReference;b=u.defaults.map.zoomDuration;u.defaults.map.zoomDuration=0;f.map.setExtent(this.extents[this.currentExtentIdx]).then(function(){f._refreshOK=!0;u.defaults.map.zoomDuration=b})}},setPreviousExtent:function(){if(!(0>=this.currentExtentIdx)){var f=this;this.currentExtentIdx--;var a=new w,b;a.method=w.METHOD_LOCKRASTER;a.lockRasterIds=[this.extents[this.currentExtentIdx].spatialReference.icsid];
f.imageServiceLayer.setMosaicRule(a,!0);f._refreshOK=!1;f.map.spatialReference=this.extents[this.currentExtentIdx].spatialReference;b=u.defaults.map.zoomDuration;u.defaults.map.zoomDuration=0;f.map.setExtent(this.extents[this.currentExtentIdx]).then(function(){f._refreshOK=!0;u.defaults.map.zoomDuration=b})}},isPreviousAvailable:function(){},isNextAvailable:function(){},_isICS:function(f){return!(!f.ics&&!f.icsid)},resizeRotationGauge:function(f){this._rotationWidget&&this._rotationWidget.resize(f)},
_initializeTasks:function(){this.obliqueRecordsQueryTask=new a(this.imageServiceUrl);this.projectTask=new b},_verifyRasterInfoFields:function(){return this.rasterInfoFields&&this.rasterInfoFields.length},_setupRasterList:function(){var f=this,a=[{name:this.imageServiceLayer.objectIdField,alias:"Object ID",display:!0},{name:this.azimuthField,alias:"Azimuth",display:!0},{name:this.elevationField,alias:this.elevationField,display:!0}];this.rasterInfoFields=this._verifyRasterInfoFields()?this.rasterInfoFields:
a;this.rasterList=new z({data:new B(new y),showThumbnail:this.showThumbnail,imageServiceUrl:this.imageServiceLayer.url,fields:this.rasterInfoFields},this.rasterListDiv);this.rasterList.on("raster-select",function(a){f.selectedRasterId=a[f.imageServiceLayer.objectIdField];f.emit("raster-select",{selectedRasterId:f.selectedRasterId});f.setImage(f.selectedRasterId,f.map.extent);g.forEach(f.filteredRecords,function(a){delete a.attributes.selected;a.attributes[f.imageServiceLayer.objectIdField]===f.selectedRasterId&&
(a.attributes.selected=!0)});f._rotationWidget&&f._rotationWidget.setAzimuth(a[f.azimuthField])});this.rasterList.startup()},_setupRotationWidget:function(){var f=this;this._rotationWidget=new t({snap:this.snap,azimuthAngle:this.azimuthAngle},this.rotationDiv);this._rotationWidget.startup();this.own(this._rotationWidget.on("azimuth-change",function(a){var b=a.azimuth;f.currentExtentIdx=0;f.extents=[];f.emit("azimuth-change",a);b?(f.azimuthAngle=b,f._checkExtentOrientation(),f._filterByAzimuth(),f._refreshRotationWidget({features:f.records}),
f._refreshListDijit(f.filteredRecords),f._refreshImage(f.map.extent),f._oldAzimuth=b,f.isNadir=!1):f._switchToNadir()}))},_refreshRotationWidget:function(f){this._rotationWidget&&this._rotationWidget.refresh(f)},_checkExtentOrientation:function(){var f=Math.abs((this._oldAzimuth-this.azimuthAngle)/90%2);this._azimuthExtentChanged=.25>f||1.75<f?!1:!0},_refreshListDijit:function(f){f=this._prepareListData(f);this.rasterList&&this.rasterListRefresh&&this.rasterList.setData(f);this.emit("records-refresh",
{records:this.records,filteredRecords:this.filteredRecords})},_prepareListData:function(f){var a=[],b,c=this.imageServiceLayer.objectIdField,k=this.imageServiceLayer.credential;g.forEach(f,function(f){b=this._fomatAttributes(e.clone(f.attributes));b.thumbnailUrl=this.imageServiceUrl+"/"+b[c]+"/thumbnail";k&&k.token&&(b.thumbnailUrl+="?token\x3d"+k.token);a.push(b)},this);return new B(new y({data:a,idProperty:this.imageServiceLayer.objectIdField}))},_fomatAttributes:function(f){this.rasterInfoFields.forEach(function(a){f[a.name]=
this._getFormattedValue(a,f[a.name])},this);return f},_getFormattedValue:function(f,a){if(f.format&&r.isDefined(a)){var b=C.parse(f.format);f=f.type;if(f in this.esriDataType.date)return F.format(new Date(a),this._dateFormats[b.dateFormat]);if(f in this.esriDataType.integer||f in this.esriDataType.decimal)return a=D.format(a,{places:b.places}),b.digitSeparator||this._i18n.group&&(a=a.replace(new RegExp("\\"+this._i18n.group,"g"),"")),a}else return a},clearSelection:function(){this.rasterList&&this.rasterList.clearSelection();
g.forEach(this.records,function(f){delete f.attributes.selected});this._refreshListDijit(this.records)},_switchToNadir:function(){var f=!!this.map.extent.spatialReference.icsid,a=this.defaultNadirMosaicRule||this.imageServiceLayer.mosaicRule||new w;this._oldAzimuth=this.azimuthAngle=null;this._azimuthExtentChanged=!1;a.method=a.method||w.METHOD_NONE;a.where=this.elevationField+"\x3e"+this.elevationThreshold;this.defaultNadirMosaicRule=a;this.imageServiceLayer.setMosaicRule(a,f);this.clearSelection();
if(f){var b=this,c;this.projectGeometry(this.map.extent,this.nadirSpatialReference).then(function(f){b._verifyExtent(f[0])&&(b._refreshOK=!1,b.map.spatialReference=f[0].spatialReference,b.spatialReferenceChanged(),c=u.defaults.map.zoomDuration,u.defaults.map.zoomDuration=0,b.map.setExtent((new q(f[0])).setSpatialReference(f[0].spatialReference)).then(function(){b._refreshOK=!0;b.isNadir=!0;u.defaults.map.zoomDuration=c;b.selectedRasterId=null;b.selectedRaster=null;b.filteredRecords=null}))})}},projectGeometry:function(f,
a){var b=new v;a=a||this.map.spatialReference;b.geometries=[f];b.outSR=a;return this.projectTask.execute(b)},_verifyExtent:function(f){return!isNaN(f.xmin)&&!isNaN(f.xmax)&&!isNaN(f.ymin)&&!isNaN(f.ymax)},_verifyPoint:function(f){return!isNaN(f.x)&&!isNaN(f.y)},_refreshRecords:function(f){function a(a){b._verifyExtent(a[0].getExtent())?(b.nadirExtent=a[0].getExtent(),b.search(b._trimExtent(b.nadirExtent,.15)).then(function(c){if(!c||!c.features)return b.emit("no-records",{message:"records not provided.",
extent:b.nadirExtent}),b._refreshRotationWidget({features:[]}),b._refreshListDijit(b.filteredRecords),console.log("Oblique viewer: no records returned");b.records=c.features;b._refreshRotationWidget({features:b.records});b.isNadir?b._refreshListDijit(b.records):(b._filterByAzimuth(),b._refreshListDijit(b.filteredRecords),f&&b.filteredRecords&&b.filteredRecords.length&&b._refreshImage(b.map.extent));b.emit("extent-change",{geometry:b.filteredRecords?b._getIntersectGeometry(a[0]):a[0]})})):(console.error("Oblique viewer: Project Operation returned invalid extent"),
b.search(b._trimExtent(b.map.extent,.15)).then(function(a){if(!a||!a.features)return b.emit("no-records",{message:"records not provided.",extent:b.map.extent}),b._refreshRotationWidget({features:[]}),b._refreshListDijit(b.filteredRecords),console.log("Oblique viewer: no records returned");b.records=a.features;b._refreshRotationWidget({features:b.records});b.isNadir?b._refreshListDijit(b.records):(b._filterByAzimuth(),b._refreshListDijit(b.filteredRecords),f&&b.filteredRecords&&b.filteredRecords.length&&
b._refreshImage((new n(b.filteredRecords[0].geometry)).getExtent()))}))}var b=this;this.nadirSpatialReference.equals(this.map.extent.spatialReference)?a([this.map.extent]):this.projectGeometry(this._convertExtentToPolygon(this.map.extent),this.nadirSpatialReference).then(a)},_convertExtentToPolygon:function(f){var b=new n(f.spatialReference);b.addRing([[f.xmax,f.ymin],[f.xmax,f.ymax],[f.xmin,f.ymax],[f.xmin,f.ymin],[f.xmax,f.ymin]]);return b},postCreate:function(){this.inherited(arguments);this.map&&
this.imageServiceLayer||console.error("ObliqueViewer: Map or Image service layer not provided.");this.imageServiceUrl=this.imageServiceLayer.url;this.nadirSpatialReference=this.map.extent.spatialReference;this._initializeTasks();(this.isNadir=!r.isDefined(this.azimuthAngle))&&this._switchToNadir();this.rotationDiv&&this._setupRotationWidget();if(this.rasterListDiv)if(this.imageServiceLayer.loaded)this._setupRasterList();else this.imageServiceLayer.on("load",e.hitch(this,this._setupRasterList));this.sorter||
(this.sorter=this._sortSpatially);this.own(this.map.on("extent-change",e.hitch(this,function(b){this._refreshOK&&!this.noQueryOnExtentChange&&(this._isICS(this.map.extent.spatialReference)||(this.nadirExtent=this.map.extent,this._switchToNadir(),this.emit("extent-change",{geometry:this.filteredRecords?this._getIntersectGeometry(this._convertExtentToPolygon(this.nadirExtent)):this._convertExtentToPolygon(this.nadirExtent)})),this._refreshRecords(!0),this._azimuthExtentChanged=!1)})));r.isDefined(this.azimuthAngle)&&
!this.noQueryOnExtentChange&&this._refreshRecords()},_refreshImage:function(b){this.filteredRecords&&this.filteredRecords.length&&this.selectedRasterId!==this.filteredRecords[0].attributes[this.imageServiceLayer.objectIdField]?this._setSelectedRaster(b):this._refreshSavedExtents()},_refreshSavedExtents:function(){this._isICS(this.map.extent.spatialReference)&&(this.extents&&this.extents.length?(this.extents.length>this.maxExtentIdx&&(this.extents.shift(),this.currentExtentIdx--),this.currentExtentIdx<
this.extents.length-1?this.currentExtentIdx=this.extents.length-1:this.currentExtentIdx++):(this.currentExtentIdx=0,this.extents=[]),this.extents.push(this.map.extent))},_createExtent:function(b,a,c){var f=c.getWidth()/2*1.00001;c=c.getHeight()/2;return new q(b.x-f,b.y-c,b.x+f,b.y+c,a)},spatialReferenceChanged:function(){this.imageServiceLayer.handleSpatialReferenceChange()},setImage:function(b,a){function f(a){if(H)if(c._verifyPoint(a[0]))l=c._createExtent(a[0],c.imageSpatialReference,H);else return console.log("Project operation returned invalid result.");
else if(H||c._verifyExtent(a[0]))l=a[0];else return console.log("Project operation returned invalid extent.");g=new w;g.method=w.METHOD_LOCKRASTER;g.lockRasterIds=[b];c.imageServiceLayer.setMosaicRule(g,!0);c._refreshOK=!1;c.map.spatialReference=l.spatialReference;c.spatialReferenceChanged();k=u.defaults.map.zoomDuration;D=u.defaults.map.panDuration=0;u.defaults.map.zoomDuration=0;u.defaults.map.panDuration=0;c.map.setExtent((new q(l)).setSpatialReference(l.spatialReference)).then(function(){c._refreshOK=
!0;u.defaults.map.zoomDuration=k;u.defaults.map.panDuration=D;c._refreshSavedExtents();c.projectGeometry(c._convertExtentToPolygon(l),c.nadirSpatialReference).then(function(b){c.emit("extent-change",{geometry:c.filteredRecords?c._getIntersectGeometry(b[0]):b[0]})})});c.center&&c.projectGeometry(c.center,c.imageSpatialReference).then(function(b){c.emit("add-point",{point:b[0]})})}if(!b)return console.error("Object ID of raster to be displayed not provided");var c=this,g,k,D,H=a&&(a.spatialReference.icsid||
a.spatialReference.ics)?a:null,l;this.imageSpatialReference=new p({icsid:b,url:this.imageServiceUrl});a&&a.spatialReference&&!a.spatialReference.ics&&!a.spatialReference.icsid?(c.nadirExtent=a.getExtent(),c.projectGeometry(c.nadirExtent,c.imageSpatialReference).then(f)):this.projectGeometry(this._convertExtentToPolygon(a),this.nadirSpatialReference).then(function(b){c.nadirExtent=b[0].getExtent().setSpatialReference(c.nadirSpatialReference);c.projectGeometry(a.getCenter(),c.imageSpatialReference).then(f)})},
locate:function(b){if(!b)return console.error("Geometry not specified.");var a=this,f,c;(c=b.type)&&"extent"===c?f=b:(c=c&&"point"===c?G.buffer(b,100,"meters"):G.buffer(b.getExtent().getCenter(),100,"meters"),f=c.getExtent());this.center=f.getCenter();this.search(b).then(function(b){a.setData(b.features,f)})},search:function(b){if(!b)return console.error("Oblique viewer: no geometry provided for search.");var a,f=new x,g=this;a=new c;a.geometry=b;a.outFields=this._getQueryFields()||[this.imageServiceLayer.objectIdField,
this.azimuthField];a.returnGeometry=!0;a.where=this.elevationField+"\x3c"+this.elevationThreshold;a.outSpatialReference=b.spatialReference;this.obliqueRecordsQueryTask.execute(a).then(function(a){f.resolve({features:g.sorter(g._processRecords(a.features),b)})});return f.promise},_sortSpatially:function(b,a){if(b&&b.length&&this.map.loaded){var f=0,c=0,k=b[0],l,D,H,r,f=0,c=this.nadirExtent||this.map.extent;a&&"extent"===a.type&&a.spatialReference.equals(b[0].geometry.spatialReference)&&(c=a);a=c.getCenter();
this.selectedRaster&&this._extentContained(this.selectedRaster,c)&&(g.some(b,function(a,f){if(a.attributes[this.imageServiceLayer.objectIdField]===this.selectedRasterId)return H=b[f],b[f]=k,b[0]=H,!0},this),f=1);for(;f<b.length;f++){l=Math.sqrt((b[f].center.x-a.x)*(b[f].center.x-a.x)+(b[f].center.y-a.y)*(b[f].center.y-a.y));r=f;for(c=f+1;c<b.length;c++)D=Math.sqrt((b[c].center.x-a.x)*(b[c].center.x-a.x)+(b[c].center.y-a.y)*(b[c].center.y-a.y)),l>D&&(k=b[c],l=D,r=c);f!==r&&(H=b[f],b[f]=k,b[r]=H)}}return b},
_filterByAzimuth:function(){this.filteredRecords=[];g.forEach(this.records,function(b){Math.min(Math.abs(b.attributes[this.azimuthField]-this.azimuthAngle),Math.abs(b.attributes[this.azimuthField]-this.azimuthAngle-360))<=this.azimuthTolerance&&this.filteredRecords.push(b)},this);this.filteredRecords&&this.filteredRecords.length&&!this.isNadir&&(this.filteredRecords[0].attributes.selected=!0)},_processRecords:function(b){var a;g.forEach(b,function(b){a=(new n(b.geometry)).setSpatialReference(this.nadirSpatialReference).getCentroid();
b.center=a},this);0===b.length?b=this.selectedRasterId=this.filteredRecords=null:this.emit("records-found",{message:"records are found."});return b},_computeAzimuthFilter:function(){var b=(this.azimuthAngle+350)%360,a=(this.azimuthAngle+10)%360;return b<a?this.azimuthField+" BETWEEN "+b+" AND "+a:"("+this.azimuthField+" BETWEEN 0 AND "+a+" OR "+this.azimuthField+" BETWEEN "+b+" AND 360)"},_getIds:function(b){var a=[],c=this;g.forEach(b,function(b){a.push(b.attributes[c.imageServiceLayer.objectIdField])});
return a},_setRasterListRefreshAttr:function(b){this._set("rasterListRefresh",b);b&&this._refreshListDijit(this.isNadir?this.records:this.filteredRecords)},_extentContained:function(b,a){if(!b||!a)return!1;b=(new n(b.geometry)).getExtent();return this._trimExtent(b,.2).contains(a)},setData:function(b,a){if(!b)return this.emit("no-records",{message:"records not provided.",extent:a}),this._refreshRotationWidget({features:[]}),this._refreshListDijit(this.filteredRecords),console.error("Oblique viewer: records not provided.");
a=a||this.map.extent;this._set("records",b);this._refreshRotationWidget({features:b});this._filterByAzimuth();if(this.filteredRecords&&this.filteredRecords.length)if(this._refreshListDijit(this.filteredRecords),this.imageServiceLayer.loaded)this._setSelectedRaster(a);else this.imageServiceLayer.on("load",e.hitch(this,function(){this._setSelectedRaster(a)}));else this.selectedRasterId=this.selectedRaster=null,this.emit("raster-select",{selectedRasterId:null})},_setSelectedRaster:function(b){this.selectedRaster=
this.filteredRecords[0];this.selectedRasterId=this.selectedRaster.attributes[this.imageServiceLayer.objectIdField];this.setImage(this.selectedRaster.attributes[this.imageServiceLayer.objectIdField],b);this.emit("raster-select",{selectedRasterId:this.selectedRasterId})},setExtent:function(b){var a=new x,c=this;this.projectGeometry(b,this.map.spatialReference).then(function(b){c._verifyExtent(b[0])&&c.map.setExtent(b[0]).then(function(){a.resolve()})});return a.promise},zoomToSelectedImage:function(){if(!r.isDefined(this.selectedRasterId))return console.error("Oblique viewer: no selected raster.");
if(this.isNadir)return console.log("Viewer in nadir mode, no selected raster.");this._getImageGeometry(this.selectedRasterId).then(e.hitch(this,function(b){this.map.setExtent(b.getExtent())}))},_getImageGeometry:function(b){var a=new c,f,g,k=new x;a.objectIds=[b];a.returnGeometry=!0;this.obliqueRecordsQueryTask.execute(a).then(e.hitch(this,function(b){b.features&&b.features.length&&(g=b.features[0])&&g.geometry&&(f=new n(g.geometry),this.projectGeometry(f,this.map.spatialReference).then(e.hitch(this,
function(b){b&&b.length&&(f=(new n(b[0])).setSpatialReference(this.map.spatialReference),k.resolve(f))})))}));return k.promise},_getQueryFields:function(){var b=[];g.forEach(this.rasterInfoFields,function(a){a.name&&b.push(a.name)});0>g.indexOf(b,this.azimuthField)&&b.push(this.azimuthField);0>g.indexOf(b,this.imageServiceLayer.objectIdField)&&b.push(this.imageServiceLayer.objectIdField);return b},_trimExtent:function(b,a){var c,f;a=a||.15;c=b.ymax-b.ymin;f=c*(1-a);a=c*(1-a);c=b.getCenter();return new q({xmin:c.x-
a/2,ymin:c.y-f/2,xmax:c.x+a/2,ymax:c.y+f/2,spatialReference:b.spatialReference})},_getIntersectGeometry:function(b){var a=this,c;if(!r.isDefined(this.selectedRasterId))return b;if(g.some(this.filteredRecords,function(b){if(b.attributes[a.imageServiceLayer.objectIdField]==a.selectedRasterId)return c=b.geometry,!0}))return G.intersect(b,c)}});m("extend-esri")&&e.setObject("dijit.ObliqueViewer",d,h);return d})},"esri/dijit/_ObliqueRotationWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ./_EventedWidget dijit/_Widget dijit/_TemplatedMixin dojo/text!./templates/_ObliqueRotationWidget.html dojo/_base/html dojo/on dojox/dgauges/CircularGauge ./ObliqueViewer/OVCircularScale dojox/dgauges/CircularRangeIndicator ./ObliqueViewer/OVCircularValueIndicator dojox/dgauges/LinearScaler dojo/dom-geometry dojo/dom-construct dojo/i18n!../nls/jsapi dojo/dom-style dojo/query dojo/dom-attr".split(" "),
function(d,e,m,h,a,c,k,l,t,g,p,b,v,w,q,n,r,u,z,B,y,F,C){d=d([k,l,t],{baseClass:"esriObliqueRotationWidget",declaredClass:"esri.dijit._ObliqueRotationWidget",templateString:g,azimuthAngle:0,azimuthChangeThreshold:10,azimuthField:"SensorAzimuth",isNadir:!1,_rangeIndicatorWidth:8,constructor:function(b,a){e.mixin(this,b);this._i18n=B;this.isNadir=!c.isDefined(this.azimuthAngle)},postCreate:function(){this.inherited(arguments);this._coords=this.domNode.getBoundingClientRect();this._computeCircleRadius();
this._getCenter();this.refresh()},startup:function(){this.inherited(arguments);this._setupGauge();this._addTooltips()},_getFontWeight:function(b){return 120<=b?"bold":"normal"},_getFontSize:function(b){return 120<=b?10:7},labelGap:5,resize:function(b){b=b||Math.min(this.domNode.getBoundingClientRect().height,this.domNode.getBoundingClientRect().width);this._getFontSize(b);var a=this._getFontWeight(b);this._gauge.resize(b,b);this._gauge.set("font",{family:"Helvetica",style:"normal",size:"10pt",color:"black",
weight:a});this._scale.set("labelGap",this.labelGap);this._addTooltips()},_setupGauge:function(){var a=this,c=Math.min(this._coords.height,this._coords.width);this._gauge=new v({value:0,font:{family:"Helvetica",style:"normal",size:this._getFontSize(c)+"pt",color:"black",weight:this._getFontWeight(c)},style:"margin: -2px;"},this.gaugeNode);this._addGaugeBackground();this._addGaugeScale();this._addGaugeIndicators();this._gauge.startup();this.own(b(this._gauge.domNode,"mouseup",function(b){a._getCenter();
var c=b.pageX-a._centerLocnInPage[0];b=b.pageY-a._centerLocnInPage[1];10>=Math.abs(c)&&10>=Math.abs(b)?(a._scale.azimuthAngle=null,a._switchToNadir()):(a.azimuthAngle=a._convertAngleToAzimuthNotation(a._calculateAngleFromXY(c,b)),a._switchToOblique())}));this.own(this._gauge.on("endEditing",e.hitch(this,function(b){a.isNadir||(this.snap&&this._snap(),a.azimuthAngle=this._convertAngleToAzimuthNotation(b.indicator.value),a.emit("azimuth-change",{azimuth:a.azimuthAngle}))})));this.on("azimuth-change",
function(){a.rotateGauge();a._azimuthIndicator.azimuthAngle=a.azimuthAngle;a.textNodes=a.gaugeNode.querySelectorAll("text")})},rotateGauge:function(){this.gaugeNode&&(this.isNadir?(this.rotateAngle=0,this._scale.azimuthAngle=null,y.set(this.gaugeNode,"transform","none")):(this.rotateAngle=this.rotateAngle||0,this.rotateAngle=Math.abs(this.rotateAngle+this.azimuthAngle)>Math.abs(this.rotateAngle-(360-this.azimuthAngle))?360-this.azimuthAngle:0-this.azimuthAngle,y.set(this.gaugeNode,"transform","rotate("+
this.rotateAngle+"deg)"),this._scale.azimuthAngle=this.azimuthAngle))},_addGaugeBackground:function(){var b="M "+this._center.join(",")+"m "+(0-this._radius)+",0 a "+this._radius+","+this._radius+" 0 1,0 "+2*this._radius+",0 a "+this._radius+","+this._radius+" 0 1,0 "+(0-2*this._radius)+",0";this._gauge.addElement("background",function(a){a.createPath({path:b}).setFill("rgba(255,255,255,0.8)").setStroke("rgba(89, 106, 114, 1)")});this._addNadirDataIndicator()},_addNadirDataIndicator:function(){var b=
"M "+this._center.join(",")+"m -7,0 a 7,7 0 1,0 14,0 a 7,7 0 1,0 -14,0";this._gauge.addElement("nadirDataIndicator",function(a){a.createPath({path:b}).setFill("#00BDFF").setStroke("rgba(0,0,0, 0)")})},_addGaugeScale:function(){this._scale=new w({originX:this._center[0],originY:this._center[1],radius:this._radius,startAngle:0,endAngle:359.999,orientation:"clockwise",scaler:new r({minimum:0,maximum:360,majorTickInterval:90,minorTickInterval:45}),tickShapeFunc:function(b,a,c){if(!c.isMinor)return b.createLine({x1:0,
y1:0,x2:c.isMinor?15:8,y2:0}).setStroke({color:"black",width:1})},labelGap:this.labelGap,tickLabelFunc:function(b){var a=["E","S","W","N"];return b.isMinor?" ":0===b.value%90?a[b.value/90]:b.value}});this._gauge.addElement("scale",this._scale)},_addGaugeIndicators:function(){var b=new q({value:359.9999,radius:this._radius,startThickness:8,endThickness:8,fill:"rgba(0,0,0,0.6)"});this._scale.addIndicator("indicatorBg",b);this.isNadir?(this._nadirIndicator=this._createNadirIndicator(),this._scale.addIndicator("nadir_indicator",
this._nadirIndicator)):(this._azimuthIndicator=this._createObliqueIndicator(),this._scale.addIndicator("azimuth_indicator",this._azimuthIndicator))},_convertAngleToAzimuthNotation:function(b){if(c.isDefined(b))return(b+90)%360},_convertAngleToGaugeNotation:function(b){if(c.isDefined(b))return(b+270)%360},_computeCircleRadius:function(){var b;b=Math.min(this._coords.width/2,this._coords.height/2);return this._radius=b=Math.floor(b-2)},showAvailableData:function(b){var a=this,c=this.azimuthAngle;this._snap();
Math.min(Math.abs(this.azimuthAngle-c),Math.abs(Math.abs(this.azimuthAngle-c)-360))>=this.azimuthChangeThreshold&&!this.isNadir&&this.emit("azimuth-change",{azimuth:this.azimuthAngle,noDataSwitch:!0});if(b=b||this.features){m.forEach(this._availableDataIndicators,function(b){a._scale.removeIndicator(b)});this._availableDataIndicators=[];this.features=b;for(var c=0,f,c=0;c<b.length;c++)f=new q({start:this._convertAngleToGaugeNotation(b[c].attributes[this.azimuthField]-5),value:this._convertAngleToGaugeNotation(b[c].attributes[this.azimuthField]+
5),radius:this._radius,startThickness:7,endThickness:7,fill:"#00BDFF",stroke:"#00BDFF"}),this._scale.addIndicator("indicator_"+c,f),this._availableDataIndicators.push("indicator_"+c)}},refresh:function(b){e.mixin(this,b);this.showAvailableData()},_getCenter:function(){var b=[],a,c=[];this._coords=this.gaugeNode.getBoundingClientRect();b.push(Math.ceil(this._coords.width/2));b.push(Math.ceil(this._coords.height/2));a=u.position(this.gaugeNode);c.push(a.x+b[0]);c.push(a.y+b[1]);this._centerLocnInPage=
c;return this._center=b},_snap:function(){if(this._azimuthIndicator&&this.features&&this.features.length){var b=this._convertAngleToAzimuthNotation(this._azimuthIndicator.value),a,c,f=1E3;m.forEach(this.features,function(g){c=Math.min(Math.abs(g.attributes[this.azimuthField]-b),Math.abs(Math.abs(g.attributes[this.azimuthField]-b)-360));c<=f&&(a=g.attributes[this.azimuthField],f=c)},this);this.azimuthAngle=a;this._azimuthIndicator.set("value",this._convertAngleToGaugeNotation(this.azimuthAngle))}},
_switchToNadir:function(){this.isNadir||(this._scale.azimuthAngle=null,this._nadirIndicator=this._createNadirIndicator(),this._scale.removeIndicator("azimuth_indicator"),this._scale.addIndicator("nadir_indicator",this._nadirIndicator),this.isNadir=!0,this.emit("azimuth-change",{azimuth:null}))},_switchToOblique:function(){this.isNadir&&(this._azimuthIndicator=this._createObliqueIndicator(),this._scale.removeIndicator("nadir_indicator"),this._scale.addIndicator("azimuth_indicator",this._azimuthIndicator),
this._snap(),this.isNadir=!1,this.emit("azimuth-change",{azimuth:this.azimuthAngle}))},_createNadirIndicator:function(){return new n({interactionArea:"gauge",title:"Nadir",interactionMode:"none",indicatorShapeFunc:function(b){return b.createPolyline([-7,0,7,0,0,0,0,7,0,-7]).setStroke({color:"#000000",width:1})},value:0})},_createObliqueIndicator:function(){var b=this;return new n({interactionArea:"gauge",title:"Change Azimuth",indicatorShapeFunc:function(a){return a.createPolyline([0,-1,b._radius-
1,-10,b._radius-1,10,0,1,0,-1]).setFill("rgba(0, 189, 255, 0.5)").setStroke("rgba(0, 189, 255, 0.5)")},value:this._convertAngleToGaugeNotation(this.azimuthAngle),azimuthAngle:this._convertAngleToGaugeNotation(this.azimuthAngle)})},_calculateAngleFromXY:function(b,a){b=Math.atan2(a,b);return b/Math.PI*180+(0<b?0:360)},_addTooltips:function(){var b=this,a,g=this.domNode.getBoundingClientRect(),g=Math.min(g.width/2,g.height/2);m.forEach(this._tooltipNodes,function(b){this.gaugeNode.removeChild(b.node)},
this);this._tooltipNodes=[{top:0,left:g-5,direction:"north",angle:0},{top:g-5,left:2*(g-5),direction:"east",angle:90},{top:2*(g-5),left:g,direction:"south",angle:180},{top:g-5,left:0,direction:"west",angle:270},{top:g-5,left:g-5,direction:"nadir",angle:null}];m.forEach(this._tooltipNodes,function(f){a=z.create("div");a.style.top=f.top+"px";a.style.left=f.left+"px";a.style.position="absolute";a.style.height="10px";a.style.width="10px";a.style.cursor="pointer";a.style.zIndex=999;a.id=this.domNode.id+
"_tooltip_"+f.direction;z.place(a,this.gaugeNode);a.title=this._i18n.widgets.obliqueViewer[f.direction+"Tooltip"];a.onclick=function(){c.isDefined(f.angle)&&(b.azimuthAngle=f.angle,b._azimuthIndicator.set("value",b._convertAngleToGaugeNotation(f.angle)),b.snap&&b._snap(),b.emit("azimuth-change",{azimuth:b.azimuthAngle}))};f.node=a},this)},setAzimuth:function(b){c.isDefined(b)&&(this.azimuthAngle=b,this.isNadir?this._switchToOblique():this._azimuthIndicator.set("value",this._convertAngleToGaugeNotation(this.azimuthAngle)))}});
h("extend-esri")&&e.setObject("dijit._ObliqueRotationWidget",d,a);return d})},"dojox/dgauges/CircularGauge":function(){define(["dojo/_base/declare","dojo/dom-geometry","dojox/gfx","./GaugeBase"],function(d,e,m,h){return d("dojox.dgauges.CircularGauge",h,{_transformProperties:null,refreshRendering:function(){if(!(0>=this._widgetBox.w||0>=this._widgetBox.h)){for(var a in this._elementsIndex)this._elementsRenderers[a]=this._elementsIndex[a].refreshRendering();var c=this._computeBoundingBox(this._gfxGroup),
k=(c.x+c.width)/(c.y+c.height),l=this._widgetBox.w,d=this._widgetBox.h,g=a=0,e=0,b=0;k>this._widgetBox.w/this._widgetBox.h?(b=l,e=b/k,g=(d-e)/2):(e=d,b=e*k,a=(l-b)/2);c=Math.max(b/(c.x+c.width),e/(c.y+c.height));this._transformProperties={scale:c,tx:a,ty:g};this._gfxGroup.setTransform([m.matrix.scale(c),m.matrix.translate(a/c,g/c)])}},_gaugeToPage:function(a,c){if(this._transformProperties){var k=e.position(this.domNode,!0);return{x:k.x+a*this._transformProperties.scale+this._transformProperties.tx,
y:k.y+c*this._transformProperties.scale+this._transformProperties.ty}}return null}})})},"dojox/dgauges/GaugeBase":function(){define("dojo/_base/lang dojo/_base/declare dojo/dom-geometry dijit/registry dijit/_WidgetBase dojo/_base/html dojo/_base/event dojox/gfx dojox/widget/_Invalidating ./ScaleBase dojox/gfx/matrix".split(" "),function(d,e,m,h,a,c,k,l,t,g,p){return e("dojox.dgauges.GaugeBase",[a,t],{_elements:null,_scales:null,_elementsIndex:null,_elementsRenderers:null,_gfxGroup:null,_mouseShield:null,
_widgetBox:null,_node:null,value:0,_mainIndicator:null,_getValueAttr:function(){if(this._mainIndicator)return this._mainIndicator.get("value");this._setMainIndicator();return this._mainIndicator?this._mainIndicator.get("value"):this.value},_setValueAttr:function(b){this._set("value",b);this._mainIndicator?this._mainIndicator.set("value",b):(this._setMainIndicator(),this._mainIndicator&&this._mainIndicator.set("value",b))},_setMainIndicator:function(){for(var b,a=0;a<this._scales.length;a++)if(b=this._scales[a].getIndicator("indicator"))this._mainIndicator=
b},_resetMainIndicator:function(){this._mainIndicator=null},font:null,constructor:function(b,a){this.font={family:"Helvetica",style:"normal",variant:"small-caps",weight:"bold",size:"10pt",color:"black"};this._elements=[];this._scales=[];this._elementsIndex={};this._elementsRenderers={};this._node=h.byId(a);b=c.getMarginBox(a);this.surface=l.createSurface(this._node,b.w||1,b.h||1);this._widgetBox=b;this._baseGroup=this.surface.createGroup();this._mouseShield=this._baseGroup.createGroup();this._gfxGroup=
this._baseGroup.createGroup()},_setCursor:function(b){this._node&&(this._node.style.cursor=b)},_computeBoundingBox:function(b){return b?b.getBoundingBox():{x:0,y:0,width:0,height:0}},destroy:function(){this.surface.destroy();this.inherited(arguments)},resize:function(b,a){switch(arguments.length){case 1:m.setMarginBox(this._node,b);break;case 2:m.setMarginBox(this._node,{w:b,h:a})}var c=m.getMarginBox(this._node);this._widgetBox=c;var g=this.surface.getDimensions();return g.width!=c.w||g.height!=
c.h?(this.surface.setDimensions(c.w,c.h),this._mouseShield.clear(),this._mouseShield.createRect({x:0,y:0,width:c.w,height:c.h}).setFill([0,0,0,0]),this.invalidateRendering()):this},addElement:function(b,a){this._elementsIndex[b]&&this._elementsIndex[b]!=a&&this.removeElement(b);if(d.isFunction(a)){var c={};d.mixin(c,new t);c._name=b;c._gfxGroup=this._gfxGroup.createGroup();c.width=0;c.height=0;c._isGFX=!0;c.refreshRendering=function(){c._gfxGroup.clear();return a(c._gfxGroup,c.width,c.height)};this._elements.push(c);
this._elementsIndex[b]=c}else a._name=b,a._gfxGroup=this._gfxGroup.createGroup(),a._gauge=this,this._elements.push(a),this._elementsIndex[b]=a,a instanceof g&&this._scales.push(a);return this.invalidateRendering()},removeElement:function(b){var a=this._elementsIndex[b];if(a){a._gfxGroup.removeShape();var c=this._elements.indexOf(a);this._elements.splice(c,1);a instanceof g&&(c=this._scales.indexOf(a),this._scales.splice(c,1),this._resetMainIndicator());delete this._elementsIndex[b];delete this._elementsRenderers[b]}this.invalidateRendering();
return a},getElement:function(b){return this._elementsIndex[b]},getElementRenderer:function(b){return this._elementsRenderers[b]},onStartEditing:function(b){},onEndEditing:function(b){}})})},"dojox/widget/_Invalidating":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Stateful"],function(d,e,m){return d("dojox.widget._Invalidating",m,{invalidatingProperties:null,invalidRendering:!1,postscript:function(d){this.inherited(arguments);if(this.invalidatingProperties)for(var a=this.invalidatingProperties,
c=0;c<a.length;c++)this.watch(a[c],e.hitch(this,this.invalidateRendering)),d&&a[c]in d&&this.invalidateRendering()},addInvalidatingProperties:function(d){this.invalidatingProperties=this.invalidatingProperties?this.invalidatingProperties.concat(d):d},invalidateRendering:function(){this.invalidRendering||(this.invalidRendering=!0,setTimeout(e.hitch(this,this.validateRendering),0))},validateRendering:function(){this.invalidRendering&&(this.refreshRendering(),this.invalidRendering=!1)},refreshRendering:function(){}})})},
"dojox/dgauges/ScaleBase":function(){define("dojo/_base/lang dojo/_base/declare dojox/gfx dojo/_base/array dojox/widget/_Invalidating dojo/_base/sniff".split(" "),function(d,e,m,h,a,c){return e("dojox.dgauges.ScaleBase",a,{scaler:null,font:null,labelPosition:null,labelGap:1,tickStroke:null,_gauge:null,_gfxGroup:null,_bgGroup:null,_fgGroup:null,_indicators:null,_indicatorsIndex:null,_indicatorsRenderers:null,constructor:function(){this._indicators=[];this._indicatorsIndex={};this._indicatorsRenderers=
{};this._gfxGroup=this._gauge=null;this.tickStroke={color:"black",width:8>=c("ie")?1:.5};this.addInvalidatingProperties("scaler font labelGap labelPosition tickShapeFunc tickLabelFunc tickStroke".split(" "));this.watch("scaler",d.hitch(this,this._watchScaler))},postscript:function(a){this.inherited(arguments);a&&a.scaler&&this._watchScaler("scaler",null,a.scaler)},_watchers:null,_watchScaler:function(a,c,e){h.forEach(this._watchers,d.hitch(this,function(a){a.unwatch()}));a=e.watchedProperties;this._watchers=
[];h.forEach(a,d.hitch(this,function(a){this._watchers.push(e.watch(a,d.hitch(this,this.invalidateRendering)))}))},_getFont:function(){var a=this.font;a||(a=this._gauge.font);a||(a=m.defaultFont);return a},positionForValue:function(a){return 0},valueForPosition:function(a){},tickLabelFunc:function(a){return a.isMinor?null:String(a.value)},tickShapeFunc:function(a,c,d){return a.createLine({x1:0,y1:0,x2:d.isMinor?6:10,y2:0}).setStroke(this.tickStroke)},getIndicatorRenderer:function(a){return this._indicatorsRenderers[a]},
removeIndicator:function(a){var c=this._indicatorsIndex[a];if(c){c._gfxGroup.removeShape();var k=this._indicators.indexOf(c);this._indicators.splice(k,1);c._disconnectListeners();delete this._indicatorsIndex[a];delete this._indicatorsRenderers[a]}this._gauge&&this._gauge._resetMainIndicator();this.invalidateRendering();return c},getIndicator:function(a){return this._indicatorsIndex[a]},addIndicator:function(a,c,d){this._indicatorsIndex[a]&&this._indicatorsIndex[a]!=c&&this.removeIndicator(a);this._indicators.push(c);
this._indicatorsIndex[a]=c;this._ticksGroup||this._createSubGroups();c._gfxGroup=(d?this._bgGroup:this._fgGroup).createGroup();c.scale=this;return this.invalidateRendering()},_createSubGroups:function(){this._gfxGroup&&!this._ticksGroup&&(this._bgGroup=this._gfxGroup.createGroup(),this._ticksGroup=this._gfxGroup.createGroup(),this._fgGroup=this._gfxGroup.createGroup())},refreshRendering:function(){this._ticksGroup||this._createSubGroups()}})})},"esri/dijit/ObliqueViewer/OVCircularScale":function(){define(["dojo/_base/declare",
"dojox/dgauges/CircularScale","dojox/gfx"],function(d,e,m){var h=Math.PI/180;return d([e],{_layoutLabel:function(a,c,k,l,d,g,e){var b=this._getFont();c=m._base._getTextBox(c,{font:m.makeFontString(m.makeParameters(m.defaultFont,b))}).w;b=m.normalizedLength(b.size);this.azimuthAngle=this.azimuthAngle||0;var t=this.azimuthAngle*h,p=k+Math.cos(g)*d-c/2,q=l-Math.sin(g)*d-b/2,n,r=[];n=p;var u;u=-Math.tan(g)*n+l+Math.tan(g)*k;u>=q&&u<=q+b&&r.push({x:n,y:u});n=p+c;u=-Math.tan(g)*n+l+Math.tan(g)*k;u>=q&&
u<=q+b&&r.push({x:n,y:u});n=q;u=-1/Math.tan(g)*n+k+1/Math.tan(g)*l;u>=p&&u<=p+c&&r.push({x:u,y:n});n=q+b;u=-1/Math.tan(g)*n+k+1/Math.tan(g)*l;u>=p&&u<=p+c&&r.push({x:u,y:n});if("inside"==e)for(e=0;e<r.length;e++){if(n=r[e],n=this._distance(n.x,n.y,k,l)-d,0<=n){p=k+Math.cos(g)*(d-n)-c/2;q=l-Math.sin(g)*(d-n)-b/2;break}}else for(e=0;e<r.length;e++)if(n=r[e],n=this._distance(n.x,n.y,k,l)-d,0>=n){p=k+Math.cos(g)*(d-n)-c/2;q=l-Math.sin(g)*(d-n)-b/2;break}315<this.azimuthAngle&&360>=this.azimuthAngle||
0<=this.azimuthAngle&&45>=this.azimuthAngle?c/=2:45<this.azimuthAngle&&135>=this.azimuthAngle?(c=0,b/=2):135<this.azimuthAngle&&225>=this.azimuthAngle?(c/=2,b=0):b/=2;a&&a.setTransform([{dx:p+c,dy:q+b,xx:Math.cos(t),xy:-Math.sin(t),yx:Math.sin(t),yy:Math.cos(t)}])}})})},"dojox/dgauges/CircularScale":function(){define(["dojo/_base/declare","dojox/gfx","./ScaleBase","./_circularUtils"],function(d,e,m,h){return d("dojox.dgauges.CircularScale",m,{originX:50,originY:50,radius:50,startAngle:0,endAngle:180,
orientation:"clockwise",constructor:function(){this.labelPosition="inside";this.addInvalidatingProperties("originX originY radius startAngle endAngle orientation".split(" "))},_getOrientationNum:function(){return"cclockwise"==this.orientation?-1:1},positionForValue:function(a){var c=h.computeTotalAngle(this.startAngle,this.endAngle,this.orientation);a=this.scaler.positionForValue(a);return h.modAngle(this.startAngle+this._getOrientationNum()*c*a,360)},_positionForTickItem:function(a){var c=h.computeTotalAngle(this.startAngle,
this.endAngle,this.orientation);return h.modAngle(this.startAngle+this._getOrientationNum()*c*a.position,360)},valueForPosition:function(a){if(this.positionInRange(a))var c=h.modAngle(this._getOrientationNum()*(a-this.startAngle),360),d=h.computeTotalAngle(this.startAngle,this.endAngle,this.orientation),c=c/d;else c=h.modAngle(this.startAngle-a,360),d=360-c,a=h.modAngle(this.endAngle-a,360),c=Math.min(c,d)<Math.min(a,360-a)?0:1;return this.scaler.valueForPosition(c)},positionInRange:function(a){if(this.startAngle==
this.endAngle)return!0;a=h.modAngle(a,360);return 1==this._getOrientationNum()?this.startAngle<this.endAngle?a>=this.startAngle&&a<=this.endAngle:!(a>this.endAngle&&a<this.startAngle):this.startAngle<this.endAngle?!(a>this.startAngle&&a<this.endAngle):a>=this.endAngle&&a<=this.startAngle},_distance:function(a,c,d,l){return Math.sqrt((d-a)*(d-a)+(l-c)*(l-c))},_layoutLabel:function(a,c,d,l,h,g,p){var b=this._getFont();c=e._base._getTextBox(c,{font:e.makeFontString(e.makeParameters(e.defaultFont,b))}).w;
var b=e.normalizedLength(b.size),k=d+Math.cos(g)*h-c/2,t=l-Math.sin(g)*h-b/2,q,n=[];q=k;var r;r=-Math.tan(g)*q+l+Math.tan(g)*d;r>=t&&r<=t+b&&n.push({x:q,y:r});q=k+c;r=-Math.tan(g)*q+l+Math.tan(g)*d;r>=t&&r<=t+b&&n.push({x:q,y:r});q=t;r=-1/Math.tan(g)*q+d+1/Math.tan(g)*l;r>=k&&r<=k+c&&n.push({x:r,y:q});q=t+b;r=-1/Math.tan(g)*q+d+1/Math.tan(g)*l;r>=k&&r<=k+c&&n.push({x:r,y:q});if("inside"==p)for(p=0;p<n.length;p++){if(q=n[p],q=this._distance(q.x,q.y,d,l)-h,0<=q){k=d+Math.cos(g)*(h-q)-c/2;t=l-Math.sin(g)*
(h-q)-b/2;break}}else for(p=0;p<n.length;p++)if(q=n[p],q=this._distance(q.x,q.y,d,l)-h,0>=q){k=d+Math.cos(g)*(h-q)-c/2;t=l-Math.sin(g)*(h-q)-b/2;break}a&&a.setTransform([{dx:k+c/2,dy:t+b}])},refreshRendering:function(){this.inherited(arguments);if(this._gfxGroup&&this.scaler){this.startAngle=h.modAngle(this.startAngle,360);this.endAngle=h.modAngle(this.endAngle,360);this._ticksGroup.clear();for(var a,c,d=this.scaler.computeTicks(),l,t=0;t<d.length;t++){c=d[t];a=this.tickShapeFunc(this._ticksGroup,
this,c);l=this._gauge._computeBoundingBox(a);var g;g=c.position?this._positionForTickItem(c):this.positionForValue(c.value);a&&a.setTransform([{dx:this.originX,dy:this.originY},e.matrix.rotateg(g),{dx:this.radius-l.width-2*l.x,dy:0}]);if(c=this.tickLabelFunc(c)){a=this._ticksGroup.createText({x:0,y:0,text:c,align:"middle"}).setFont(this._getFont()).setFill(this._getFont().color?this._getFont().color:"black");var p=this.radius,p="inside"==this.labelPosition?p-(l.width+this.labelGap):p+this.labelGap;
this._layoutLabel(a,c,this.originX,this.originY,p,h.toRadians(360-g),this.labelPosition)}}for(var b in this._indicatorsIndex)this._indicatorsRenderers[b]=this._indicatorsIndex[b].invalidateRendering()}}})})},"dojox/dgauges/_circularUtils":function(){define(function(){return{computeTotalAngle:function(d,e,m){return d==e?360:this.computeAngle(d,e,m,360)},modAngle:function(d,e){void 0==e&&(e=6.28318530718);if(d>=e){do d-=e;while(d>=e)}else for(;0>d;)d+=e;return d},computeAngle:function(d,e,m,h){void 0==
h&&(h=6.28318530718);return e==d?h:this.modAngle("clockwise"==m?e<d?h-(d-e):e-d:e<d?d-e:h-(e-d),h)},toRadians:function(d){return d*Math.PI/180},toDegrees:function(d){return 180*d/Math.PI}}})},"dojox/dgauges/CircularRangeIndicator":function(){define(["dojo/_base/declare","./ScaleIndicatorBase","./_circularUtils","dojo/_base/event"],function(d,e,m,h){return d("dojox.dgauges.CircularRangeIndicator",e,{start:0,radius:NaN,startThickness:6,endThickness:6,fill:null,stroke:null,constructor:function(){this.indicatorShapeFunc=
null;this.fill=[255,120,0];this.stroke={color:"black",width:.2};this.interactionMode="none";this.addInvalidatingProperties("start radius startThickness endThickness fill stroke".split(" "))},_interpolateColor:function(a,c,d){return((1-d)*(a>>16&255)+d*(c>>16&255)&255)<<16|((1-d)*(a>>8&255)+d*(c>>8&255)&255)<<8|(1-d)*(a&255)+d*(c&255)&255},_colorsInterpolation:function(a,c,d){for(var l=[],e=0,g=0;g<a.length-1;g++)e=(c[g+1]-c[g])*d,e=Math.round(e),l=l.concat(_colorInterpolation(a[g],a[g+1],e));return l},
_alphasInterpolation:function(a,c,d){for(var l=[],e=0,g=0;g<a.length-1;g++)e=(c[g+1]-c[g])*d,e=Math.round(e),l=l.concat(_alphaInterpolation(a[g],a[g+1],e));return l},_alphaInterpolation:function(a,c,d){c=(c-a)/(d-1);for(var e=[],k=0;k<d;k++)e.push(a+k*c);return e},_colorInterpolation:function(a,c,d){for(var e=[],k=0;k<d;k++)e.push(_interpolateColor(a,c,k/(d-1)));return e},_getEntriesFor:function(a,c){for(var d=[],e,h=0;h<a.length;h++)e=a[h],e=null==e[c]||isNaN(e[c])?h/(a.length-1):e[c],d.push(e);
return d},_drawColorTrack:function(a,c,d,e,h,g,p,b,v,w,q,n){var r=.05;p=6.28318530718-m.computeAngle(g,p,h);isNaN(n)||(n=m.computeAngle(g,n,h),v*=n/p,p=n);n=Math.max(2,Math.floor(p/r));var r=p/n,l=0;p=-b;var l=(b-v)/n,k;"clockwise"==h&&(r=-r);var t=[];h=c+Math.cos(g)*(e+p);b=d-Math.sin(g)*(e+p);t.push(h,b);for(v=0;v<n;v++)k=g+v*r,h=c+Math.cos(k+r)*(e+p+v*l),b=d-Math.sin(k+r)*(e+p+v*l),t.push(h,b);isNaN(k)&&(k=g);h=c+Math.cos(k+r)*(e+0+0*(n-1));b=d-Math.sin(k+r)*(e+0+0*(n-1));t.push(h,b);for(v=n-1;0<=
v;v--)k=g+v*r,h=c+Math.cos(k+r)*(e+0+0*v),b=d-Math.sin(k+r)*(e+0+0*v),t.push(h,b);h=c+Math.cos(g)*(e+0);b=d-Math.sin(g)*(e+0);t.push(h,b);h=c+Math.cos(g)*(e+p);b=d-Math.sin(g)*(e+p);t.push(h,b);a.createPolyline(t).setFill(w).setStroke(q)},refreshRendering:function(){this.inherited(arguments);var a=this._gfxGroup;a.clear();var c=this.scale.originX,d=this.scale.originY,e=isNaN(this.radius)?this.scale.radius:this.radius,h=this.scale.orientation,g=m.toRadians(360-this.scale.positionForValue(this.start)),
p=isNaN(this._transitionValue)?this.value:this._transitionValue,p=m.toRadians(360-this.scale.positionForValue(p));this._drawColorTrack(a,c,d,e,h,g,p,this.startThickness,this.endThickness,this.fill,this.stroke,NaN)},_onMouseDown:function(a){this.inherited(arguments);var c=this.scale._gauge._gaugeToPage(this.scale.originX,this.scale.originY);this.set("value",this.scale.valueForPosition(180*Math.atan2(a.pageY-c.y,a.pageX-c.x)/Math.PI));h.stop(a)},_onMouseMove:function(a){this.inherited(arguments);var c=
this.scale._gauge._gaugeToPage(this.scale.originX,this.scale.originY);this.set("value",this.scale.valueForPosition(180*Math.atan2(a.pageY-c.y,a.pageX-c.x)/Math.PI))}})})},"dojox/dgauges/ScaleIndicatorBase":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/window dojo/on dojo/touch dojo/_base/fx dojox/gfx dojox/widget/_Invalidating ./IndicatorBase".split(" "),function(d,e,m,h,a,c,k,l,t){return e("dojox.dgauges.ScaleIndicatorBase",t,{scale:null,value:0,interactionArea:"gauge",interactionMode:"mouse",
animationDuration:0,animationEaser:null,_indicatorShapeFuncFlag:!0,_interactionAreaFlag:!0,_downListeners:null,_cursorListeners:null,_moveAndUpListeners:null,_transitionValue:NaN,_preventAnimation:!1,_animation:null,constructor:function(){this.watch("value",d.hitch(this,function(){this.valueChanged(this)}));this.watch("value",d.hitch(this,this._startAnimation));this.watch("interactionArea",d.hitch(this,function(){this._interactionAreaFlag=!0}));this.watch("interactionMode",d.hitch(this,function(){this._interactionAreaFlag=
!0}));this.watch("indicatorShapeFunc",d.hitch(this,function(){this._indicatorShapeFuncFlag=!0}));this.addInvalidatingProperties(["scale","value","indicatorShapeFunc","interactionArea","interactionMode"]);this._downListeners=[];this._moveAndUpListeners=[];this._cursorListeners=[]},_startAnimation:function(a,e,b){0!==this.animationDuration&&(this._animation&&(this._preventAnimation||e==b)?this._animation.stop():(this._animation=new c.Animation({curve:[e,b],duration:this.animationDuration,easing:this.animationEaser?
this.animationEaser:c._defaultEasing,onAnimate:d.hitch(this,this._updateAnimation),onEnd:d.hitch(this,this._endAnimation),onStop:d.hitch(this,this._endAnimation)}),this._animation.play()))},_updateAnimation:function(a){this._transitionValue=a;this.invalidateRendering()},_endAnimation:function(){this._transitionValue=NaN;this.invalidateRendering()},refreshRendering:function(){null!==this._gfxGroup&&null!==this.scale&&(this._indicatorShapeFuncFlag&&d.isFunction(this.indicatorShapeFunc)&&(this._gfxGroup.clear(),
this.indicatorShapeFunc(this._gfxGroup,this),this._indicatorShapeFuncFlag=!1),this._interactionAreaFlag&&(this._interactionAreaFlag=this._connectDownListeners()))},valueChanged:function(a){h.emit(this,"valueChanged",{target:this,bubbles:!0,cancelable:!0})},_disconnectDownListeners:function(){for(var a=0;a<this._downListeners.length;a++)this._downListeners[a].remove();this._downListeners=[]},_disconnectMoveAndUpListeners:function(){for(var a=0;a<this._moveAndUpListeners.length;a++)this._moveAndUpListeners[a].remove();
this._moveAndUpListeners=[]},_disconnectListeners:function(){this._disconnectDownListeners();this._disconnectMoveAndUpListeners();this._disconnectCursorListeners()},_connectCursorListeners:function(c){var e=c.on(a.over,d.hitch(this,function(){this.scale._gauge._setCursor("pointer")}));this._cursorListeners.push(e);e=c.on(a.out,d.hitch(this,function(b){this.scale._gauge._setCursor("")}));this._cursorListeners.push(e)},_disconnectCursorListeners:function(){for(var a=0;a<this._cursorListeners.length;a++)this._cursorListeners[a].remove();
this._cursorListeners=[]},_connectDownListeners:function(){this._disconnectDownListeners();this._disconnectCursorListeners();var c=null;if("mouse"==this.interactionMode||"touch"==this.interactionMode)if("indicator"==this.interactionArea)c=this._gfxGroup.on(a.press,d.hitch(this,this._onMouseDown)),this._downListeners.push(c),this._connectCursorListeners(this._gfxGroup);else if("gauge"==this.interactionArea){if(!this.scale||!this.scale._gauge||!this.scale._gauge._gfxGroup)return!0;c=this.scale._gauge._gfxGroup.on(a.press,
d.hitch(this,this._onMouseDown));this._downListeners.push(c);c=this._gfxGroup.on(a.press,d.hitch(this,this._onMouseDown));this._downListeners.push(c);this._connectCursorListeners(this.scale._gauge._gfxGroup)}else if("area"==this.interactionArea){if(!this.scale||!this.scale._gauge||!this.scale._gauge._baseGroup)return!0;c=this.scale._gauge._baseGroup.on(a.press,d.hitch(this,this._onMouseDown));this._downListeners.push(c);c=this._gfxGroup.on(a.press,d.hitch(this,this._onMouseDown));this._downListeners.push(c);
this._connectCursorListeners(this.scale._gauge._baseGroup)}return!1},_connectMoveAndUpListeners:function(){var c=null,c=h(m.doc,a.move,d.hitch(this,this._onMouseMove));this._moveAndUpListeners.push(c);c=h(m.doc,a.release,d.hitch(this,this._onMouseUp));this._moveAndUpListeners.push(c)},_onMouseDown:function(a){this._connectMoveAndUpListeners();this._startEditing()},_onMouseMove:function(a){this._preventAnimation=!0;this._animation&&this._animation.stop()},_onMouseUp:function(a){this._disconnectMoveAndUpListeners();
this._preventAnimation=!1;this._endEditing()},_startEditing:function(){if(this.scale&&this.scale._gauge)this.scale._gauge.onStartEditing({indicator:this})},_endEditing:function(){if(this.scale&&this.scale._gauge)this.scale._gauge.onEndEditing({indicator:this})}})})},"dojox/dgauges/IndicatorBase":function(){define(["dojo/_base/declare","dojox/widget/_Invalidating"],function(d,e){return d("dojox.dgauges.IndicatorBase",e,{value:null})})},"esri/dijit/ObliqueViewer/OVCircularValueIndicator":function(){define(["dojo/_base/declare",
"dojox/gfx","dojox/dgauges/ScaleIndicatorBase","dojo/_base/event"],function(d,e,m,h){return d("esri.dijit.ObliqueViewer.OVCircularValueIndicator",m,{indicatorShapeFunc:function(a,c){return a.createLine({x1:0,y1:0,x2:40,y2:0}).setStroke({color:"black",width:1})},refreshRendering:function(){this.inherited(arguments);var a=isNaN(this._transitionValue)?this.value:this._transitionValue,a=this.scale.positionForValue(a);this._gfxGroup.setTransform([{dx:this.scale.originX,dy:this.scale.originY},e.matrix.rotateg(a)])},
_onMouseDown:function(a){this.inherited(arguments);var c=this.scale._gauge._gaugeToPage(this.scale.originX,this.scale.originY);this.set("value",this.scale.valueForPosition(180*Math.atan2(a.pageY-c.y,a.pageX-c.x)/Math.PI+this.azimuthAngle));h.stop(a)},_onMouseMove:function(a){this.inherited(arguments);var c=this.scale._gauge._gaugeToPage(this.scale.originX,this.scale.originY);this.set("value",this.scale.valueForPosition(180*Math.atan2(a.pageY-c.y,a.pageX-c.x)/Math.PI+this.azimuthAngle))}})})},"dojox/dgauges/LinearScaler":function(){define(["dojo/_base/lang",
"dojo/_base/declare","dojo/Stateful"],function(d,e,m){return e("dojox.dgauges.LinearScaler",m,{minimum:0,maximum:100,snapInterval:1,majorTickInterval:NaN,minorTickInterval:NaN,minorTicksEnabled:!0,majorTicks:null,minorTicks:null,_computedMajorTickInterval:NaN,_computedMinorTickInterval:NaN,constructor:function(){this.watchedProperties="minimum maximum majorTickInterval minorTickInterval snapInterval minorTicksEnabled".split(" ")},_buildMinorTickItems:function(){var d=this.majorTicks,a=[];if(this.maximum>
this.minimum)for(var c=Math.floor((this.maximum-this.minimum)/this.getComputedMajorTickInterval())+1,e=Math.floor(this.getComputedMajorTickInterval()/this.getComputedMinorTickInterval()),l,m=0;m<c-1;m++)for(var g=1;g<e;g++)l={scaler:this,isMinor:!0},l.value=d[m].value+g*this.getComputedMinorTickInterval(),l.position=(Number(l.value)-this.minimum)/(this.maximum-this.minimum),a.push(l);return a},_buildMajorTickItems:function(){var d=[];if(this.maximum>this.minimum)for(var a=Math.floor((this.maximum-
this.minimum)/this.getComputedMajorTickInterval())+1,c,e=0;e<a;e++)c={scaler:this,isMinor:!1},c.value=this.minimum+e*this.getComputedMajorTickInterval(),c.position=(Number(c.value)-this.minimum)/(this.maximum-this.minimum),d.push(c);return d},getComputedMajorTickInterval:function(){if(!isNaN(this.majorTickInterval))return this.majorTickInterval;isNaN(this._computedMajorTickInterval)&&(this._computedMajorTickInterval=(this.maximum-this.minimum)/10);return this._computedMajorTickInterval},getComputedMinorTickInterval:function(){if(!isNaN(this.minorTickInterval))return this.minorTickInterval;
isNaN(this._computedMinorTickInterval)&&(this._computedMinorTickInterval=this.getComputedMajorTickInterval()/5);return this._computedMinorTickInterval},computeTicks:function(){this.majorTicks=this._buildMajorTickItems();this.minorTicks=this.minorTicksEnabled?this._buildMinorTickItems():[];return this.majorTicks.concat(this.minorTicks)},positionForValue:function(d){var a;if(null==d||isNaN(d)||d<=this.minimum)a=0;d>=this.maximum&&(a=1);isNaN(a)&&(a=(d-this.minimum)/(this.maximum-this.minimum));return a},
valueForPosition:function(d){d=this.minimum+Math.abs(this.minimum-this.maximum)*d;!isNaN(this.snapInterval)&&0<this.snapInterval&&(d=Math.round((d-this.minimum)/this.snapInterval)*this.snapInterval+this.minimum);return d}})})},"esri/tasks/ImageServiceProjectTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/_base/Deferred dojo/_base/array ../kernel ../request ../deferredUtils ./Task ../urlUtils ../geometry/jsonUtils".split(" "),function(d,e,m,h,a,c,k,l,t,g,p){d=d(t,{constructor:function(b){this._handler=
e.hitch(this,this._handler)},execute:function(b,a,c){var d=new h(l._dfdCanceller),g=this._url||this._getImageServiceUrl(b);if(g){var r=this._encode(e.mixin({},g.query,{f:"json"},b.toJson())),u=this._handler,m=this._errorHandler,t=p.getJsonType(b.geometries[0]),v=b.outSR;d._pendingDfd=k({url:g.path+"/project",content:r,callbackParamName:"callback",load:function(b){u(b,t,v,a,c,d)},error:function(b){m(b,c,d)}})}else d.reject("Input arguments do not contain image service URL.");return d},_handler:function(b,
a,c,d,e,g){try{var r=this._decodeGeometries(b,a,c);this._successHandler([r],"onComplete",d,g)}catch(z){this._errorHandler(z,e,g)}},_encodeGeometries:function(b){var a=[],c,d=b.length;for(c=0;c<d;c++)a.push(b[c].toJson());return{geometryType:p.getJsonType(b[0]),geometries:a}},_decodeGeometries:function(b,c,d){var g=p.getGeometryType(c),l=[],r={spatialReference:d},h=e.mixin;a.forEach(b.geometries,function(b,a){l[a]=new g(h(b,r))});return l},onComplete:function(){},_getImageServiceUrl:function(b){var a;
if(b&&b.geometries&&b.geometries.length&&b.outSR)if(b.geometries[0].spatialReference||b.geometries[0].spatialReference.url||b.outSR.url)if(b.geometries[0].spatialReference.url&&b.outSR.url&&b.geometries[0].spatialReference.url!==b.outSR.url)this.onError(Error("Input and output spatial reference must be from one image service"));else a=b.geometries[0].spatialReference&&b.geometries[0].spatialReference.url?b.geometries[0].spatialReference.url:b.outSR.url;else this.onError(Error("Spatial reference doesn't contain Image Service URL"));
a&&(a=g.urlToObject(a));return a}});m("extend-esri")&&e.setObject("tasks.ImageServiceProjectTask",d,c);return d})},"esri/dijit/RasterList":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/CheckBox dojo/_base/array dgrid/OnDemandGrid dgrid/extensions/DijitRegistry dgrid/Selection dojo/_base/lang dojo/dom-class dojo/dom-construct ../lang".split(" "),function(d,e,m,h,a,c,k,l,t,g,p,b,v){var w=d([k,l,t],{selectionMode:"single",selection:!0,
maxRowsPerPage:2,minRowsPerPage:2,farOffRemoval:500});return d([e,m,h],{templateString:'\x3cdiv class\x3d"esriRasterListDiv"\x3e \x3cdiv data-dojo-attach-point \x3d "listDiv" style\x3d"height: 100%; width: 100%;" class\x3d"obliqueRasterList"\x3e\x3c/div\x3e\x3c/div\x3e',showThumbnail:!1,setData:function(a){this.rasterList.set("store",a)},clearSelection:function(){this.rasterList.clearSelection()},refresh:function(a){this.rasterList.refresh({keepScrollPosition:a})},startup:function(){this.inherited(arguments);
var d=this;this.rasterList=new w({store:this.store,minRowsPerPage:5,maxRowsPerPage:6,bufferRows:3,selectionMode:this.selectionMode?this.selectionMode:"single",renderRow:function(e){e=e.attributes||e;var g,l=b.create("div");d.showThumbnail?p.add(l,"esriRasterListThumbnailRow"):p.add(l,"esriRasterListNoThumbnailRow");var h=b.create("div");p.add(h,"esriRasterListInfoTag");c.forEach(d.fields,function(a){v.isDefined(e[a.name])&&a.display&&(g=e[a.name].toFixed&&0<e[a.name].toString().indexOf(".")?e[a.name].toFixed(2):
e[a.name],h.innerHTML+="\x3cstrong\x3e"+a.alias+": \x3c/strong\x3e"+g+"\x3cbr/\x3e")});var k=b.create("table"),n=b.create("tr");p.add(k,"esriRasterListRowTable");if(d.showThumbnail){var m=b.create("img",{className:"esriRasterListThumbnail",src:e.thumbnailUrl}),C=b.create("td");p.add(C,"esriRasterListThumbnailCol");b.place(m,C);b.place(C,n)}m=b.create("td");b.place(h,m);b.place(m,n);d.showCheckbox&&(m=b.create("td"),p.add(m,"esriRasterListCheckboxCol"),C=new a({checked:e.selected}),b.place(C.domNode,
m),b.place(m,n));b.place(n,k);b.place(k,l);e.selected&&d.rasterList.select(d.rasterList.row(e));return l}},this.listDiv);this.rasterList.startup();this.own(this.rasterList.on(".dgrid-row:click",function(a){a=d.rasterList.row(a).data;d.emit("raster-select",a)}),this.rasterList.on(".dgrid-row:mouseover",function(a){a=d.rasterList.row(a).data;d.emit("raster-mouseover",a)}),this.rasterList.on(".dgrid-row:mouseout",function(a){d.emit("raster-mouseout")}),this.rasterList.on("dgrid-select",function(a){d.emit("raster-row-select",
{rasters:a.rows})}))}})})},"dgrid/extensions/DijitRegistry":function(){define(["dojo/_base/declare","dojo/dom-geometry","dijit/registry"],function(d,e,m){return d("dgrid.extensions.DijitRegistry",null,{minSize:0,maxSize:Infinity,layoutPriority:0,showTitle:!0,buildRendering:function(){m.add(this);this.inherited(arguments);this.domNode.setAttribute("widgetId",this.id)},startup:function(){if(!this._started){this.inherited(arguments);var d=m.getEnclosingWidget(this.domNode.parentNode);d&&d.isLayoutContainer&&
this._resizeHandle.remove()}},destroyRecursive:function(){this.destroy()},destroy:function(){this.inherited(arguments);m.remove(this.id)},getChildren:function(){return[]},isLeftToRight:function(){return!this.isRTL},resize:function(d){d&&e.setMarginBox(this.domNode,d);this.inherited(arguments)},_set:function(d,a){this[d]=a},watch:function(){},getParent:function(){return m.getEnclosingWidget(this.domNode.parentNode)}})})},"esri/dijit/ImageServiceMeasure":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n!../nls/jsapi dojo/text!./templates/ImageServiceMeasure.html dojo/has dojo/on ../kernel dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ../toolbars/ImageServiceMeasureTool dijit/form/DropDownButton dijit/DropDownMenu dijit/MenuItem dijit/MenuSeparator dijit/PopupMenuItem dijit/RadioMenuItem dijit/CheckedMenuItem ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../graphic ../InfoTemplate ../geometry/Point dojo/_base/Color dojo/dom-class dojo/_base/array ../tasks/ImageServiceMeasureParameters ../units dojo/dom-construct dijit/form/ToggleButton dojo/html dojo/number".split(" "),
function(d,e,m,h,a,c,k,l,t,g,p,b,v,w,q,n,r,u,z,B,y,F,C,D,G,x,f,E,A,I,L,K,J){h=d([l,t,g],{declaredClass:"esri.dijit.ImageServiceMeasure",templateString:h,widgetsInTemplate:!0,layer:null,map:null,layout:"dropDown",displayOperations:null,markerSymbol:null,lineSymbol:null,fillSymbol:null,displayMeasureResultInPopup:null,angularUnit:null,linearUnit:null,areaUnit:null,_supportedMeasureOperations:[],_supportedUnits:{},_currentGraphic:null,_defaultUnits:{angularUnit:"DECIMAL_DEGREES",linearUnit:"METERS",
areaUnit:"SQUARE_METERS"},_desiredDropDownOrder:"OPERATION_POINT OPERATION_DISTANCE_ANGLE OPERATION_AREA_PERIMETER OPERATION_CENTROID OPERATION_BASE_TOP OPERATION_TOP_TOP_SHADOW OPERATION_BASE_TOP_SHADOW".split(" "),_map3DOperations:{OPERATION_POINT:"OPERATION_POINT_3D",OPERATION_DISTANCE_ANGLE:"OPERATION_DISTANCE_ANGLE_3D",OPERATION_AREA_PERIMETER:"OPERATION_AREA_PERIMETER_3D",OPERATION_CENTROID:"OPERATION_CENTROID_3D",OPERATION_BASE_TOP:"OPERATION_BASE_TOP",OPERATION_TOP_TOP_SHADOW:"OPERATION_TOP_TOP_SHADOW",
OPERATION_BASE_TOP_SHADOW:"OPERATION_BASE_TOP_SHADOW"},_menu:null,_dropDownButton:null,_currentOperation:null,_activeMeasureOpMenuItem:null,_has3DOperations:!1,_enabled3DCheckbox:!1,_dropDownMenuItemMap:{},_toggleButtonMenuItemMap:{},_decimalDegreesConstantValue:"esriDUDecimalDegrees",_decimalDegreesConstantKeyword:"DECIMAL_DEGREES",constructor:function(a){d.safeMixin(this,a);this._setDefaultSymbols();this._i18n=m},startup:function(){this.inherited(arguments)},postCreate:function(){this.map&&this.layer&&
(this.measureToolbar=new p({map:this.map,layer:this.layer}),this.measureToolbar.on("draw-end",e.hitch(this,this._addGraphic)),this.measureToolbar.on("draw-start",e.hitch(this,this._onDrawStart)),this.measureToolbar.on("measure-end",e.hitch(this,this._addInfoWindow)),this.measureToolbar.on("unit-change",e.hitch(this,this._onUnitChange)),c(this.layer,"spatial-reference-change",e.hitch(this,this._removeDraws)),this._supportedMeasureOperations=this._getSupportedMeasureOperations(),this._has3DOperations=
this._check3DSupported(),this._reorderMeasureOperations(),this._supportedUnits=this._getSupportedUnits(),this._setDefaultUnits());this._checkValidLayoutValue();0<this._supportedMeasureOperations.length?"dropDown"===this.layout?this._populateMeasureDropdown():"toolbar"===this.layout&&this._populateMeasureButtons():K.set(this.esriImageServiceMeasure,this._i18n.widgets.imageServiceMeasure.mensurationCapabilitiesAbsentText)},_checkValidLayoutValue:function(){"dropdown"===this.layout.toLowerCase()?this.layout=
"dropDown":"toolbar"===this.layout.toLowerCase()?this.layout="toolbar":(this.layout="dropDown",console.log("Invalid value for layout"))},_getUnitKeyword:function(a){var b=null,c;if(a===this._decimalDegreesConstantValue)b=this._decimalDegreesConstantKeyword;else for(c in A)A.hasOwnProperty(c)&&A[c]===a&&(b=c);return b||null},_setUnitKeyword:function(a,b){var c;this[a]?(c=this._getUnitKeyword(this[a]))?a=c:(a=this._defaultUnits[a],console.log("Incorrect "+b+" supplied. "+b+" set to default.")):a=this._defaultUnits[a];
return a},_setDefaultUnits:function(){this.linearUnit=this._setUnitKeyword("linearUnit","Linear Unit");this.areaUnit=this._setUnitKeyword("areaUnit","Area Unit");this.angularUnit=this._setUnitKeyword("angularUnit","Angular Unit");this.measureToolbar.setLinearUnit(A[this.linearUnit]);this.measureToolbar.setAreaUnit(A[this.areaUnit]);this.measureToolbar.setAngularUnit(A[this.angularUnit])},_getSupportedMeasureOperations:function(){var a=[],b=this.displayOperations||this.measureToolbar.getSupportedMeasureOperations(),
c=this.measureToolbar.getSupportedMeasureOperations(),d;f.forEach(b,function(b){for(d in E)E.hasOwnProperty(d)&&E[d]===b&&(-1<f.indexOf(c,b)?a.push(d):console.log(b+" is not supported by the service."))},this);return a},_getSupportedUnits:function(){var a={},b=[],c=[],d=this.measureToolbar.getSupportedUnits(),e;for(e in d)d.hasOwnProperty(e)&&(c=d[e],b=[],f.forEach(c,function(a){b.push(this._getUnitString(a))},this),a[e]=b);return a},_check3DSupported:function(){return this._isSupportedMeasureOperation("OPERATION_POINT_3D")||
this._isSupportedMeasureOperation("OPERATION_DISTANCE_ANGLE_3D")||this._isSupportedMeasureOperation("OPERATION_AREA_PERIMETER_3D")||this._isSupportedMeasureOperation("OPERATION_CENTROID_3D")},_isSupportedMeasureOperation:function(a){return-1<this._supportedMeasureOperations.indexOf(a)},_reorderMeasureOperations:function(){var a=[];f.forEach(this._desiredDropDownOrder,function(b){-1<this._supportedMeasureOperations.indexOf(b)&&a.push(b)},this);this._supportedMeasureOperations=a},_setDefaultSymbols:function(){this.markerSymbol||
(this.markerSymbol=new z,this.markerSymbol.setPath("M16,4.938c-7.732,0-14,4.701-14,10.5c0,1.981,0.741,3.833,2.016,5.414L2,25.272l5.613-1.44c2.339,1.316,5.237,2.106,8.387,2.106c7.732,0,14-4.701,14-10.5S23.732,4.938,16,4.938zM16.868,21.375h-1.969v-1.889h1.969V21.375zM16.772,18.094h-1.777l-0.176-8.083h2.113L16.772,18.094z"),this.markerSymbol.setColor(new G("#00FFFF")));this.lineSymbol||(this.lineSymbol=new B(B.STYLE_SOLID,new G([255,0,0]),1.5));this.fillSymbol||(this.fillSymbol=new y(y.STYLE_SOLID,new B(B.STYLE_DASHDOT,
new G([255,0,0]),2),new G([255,255,0,.25])))},_populateMeasureDropdown:function(){var a,c;this._menu=new v;f.forEach(this._supportedMeasureOperations,function(b){a=new w({label:this._i18n.widgets.imageServiceMeasure.operationLabel[b],iconClass:E[b]});a.on("click",e.hitch(this,this._onDropDownMenuItemClick,b,a));this._menu.addChild(a);this._dropDownMenuItemMap[b]=a},this);c=new q;this._menu.addChild(c);this._has3DOperations&&(c=new u({label:this._i18n.widgets.imageServiceMeasure.measure3DLabel,checked:!1}),
c.on("change",e.hitch(this,this._on3DCheckBoxChange)),this._menu.addChild(c),c=new q,this._menu.addChild(c));this._addUnitsMenu();this._dropDownButton=new b({dropDown:this._menu,"class":"esriImageServiceMeasureDropdownContainer"},this.measureDropDownContainer);this._dropDownButton.startup();this._currentOperation=this._defaultOperation=this._supportedMeasureOperations[0];this._toggleButton=new b({label:this._i18n.widgets.imageServiceMeasure.operationLabel[this._defaultOperation],iconClass:E[this._defaultOperation],
"class":"esriImageServiceMeasureToggleButton",dropDown:new v({"class":"esriHiddenDropDownMenu"})},this.toggleButtonDiv);this._toggleButton._buttonNode.title=this._i18n.widgets.imageServiceMeasure.operationLabel[this._defaultOperation];this._toggleButton.startup();this._toggleButton.on("click",e.hitch(this,this._toggle))},_populateMeasureButtons:function(){var a,c,d;x.add(this.esriImageServiceMeasure,"esriImageServiceMeasureToolbarLayout");x.add(this.measureButtonContainer,"esriImageServiceMeasureButtonContainer");
this._menu=new v;f.forEach(this._supportedMeasureOperations,function(b){d=I.create("div",{innerHTML:this._i18n.widgets.imageServiceMeasure.operationLabel[b]},this.measureButtonContainer);a=new L({showLabel:!1,checked:!1,label:this._i18n.widgets.imageServiceMeasure.operationLabel[b],iconClass:E[b],baseClass:"esriMeasureButton"},d);a.on("click",e.hitch(this,this._onButtonMenuItemClick,b));this._toggleButtonMenuItemMap[b]=a},this);this._has3DOperations&&(c=new u({label:this._i18n.widgets.imageServiceMeasure.measure3DLabel,
checked:!1}),c.on("change",e.hitch(this,this._on3DCheckBoxToolbarLayoutChange)),this._menu.addChild(c),c=new q,this._menu.addChild(c));this._addUnitsMenu();c=I.create("span",{innerHTML:"|"},this.measureButtonContainer);d=I.create("div",null,this.measureButtonContainer);this._dropDownButton=new b({dropDown:this._menu,label:this._i18n.widgets.imageServiceMeasure.settings,showLabel:!1,iconClass:"esriMensurationSettingsIcon","class":"esriMeasureSettingsButton"},d);this._dropDownButton.startup();"false"!==
this.displayMeasureResultInPopup&&!1!==this.displayMeasureResultInPopup&&this.displayMeasureResultInPopup||(this.measureResultContainer=I.create("div",{"class":"measureResultContainer"},this.esriImageServiceMeasure),this.esriMeasurementResultLabel=I.create("div",{innerHTML:this._i18n.widgets.imageServiceMeasure.infoWindowTitle,"class":"esriMeasurementResultLabel"},this.measureResultContainer),this.measureResultStringDiv=I.create("div",{"class":"esriMeasurementResultString"},this.measureResultContainer))},
_angularUnitsReqd:function(){if(f.some(this._supportedMeasureOperations,function(a){if("OPERATION_DISTANCE_ANGLE_3D"===a||"OPERATION_DISTANCE_ANGLE"===a)return!0}))return!0},_linearUnitsReqd:function(){if(f.some(this._supportedMeasureOperations,function(a){if(0>a.indexOf("OPERATION_POINT")&&0>a.indexOf("OPERATION_CENTROID"))return!0}))return!0},_areaUnitsReqd:function(){if(f.some(this._supportedMeasureOperations,function(a){if("OPERATION_AREA_PERIMETER_3D"===a||"OPERATION_AREA_PERIMETER"===a)return!0}))return!0},
_addUnitsMenu:function(){var a,b,c;this._angularUnitsReqd()&&(this.angularUnitMenu=new v,f.forEach(this._supportedUnits.angularUnits,function(a){c=this._isCurrentAngularUnit(a);b=new r({group:"angularUnit",checked:c,label:this._i18n.widgets.imageServiceMeasure.unitLabel[a],"class":c?"esriSelectedOption":""});c&&(this._currentAngularUnitMenuItem=b);b.on("click",e.hitch(this,this._onAngularUnitClick,a,b));this.angularUnitMenu.addChild(b)},this),a=new n({label:this._i18n.widgets.imageServiceMeasure.angularUnits,
popup:this.angularUnitMenu}),this._menu.addChild(a));this._linearUnitsReqd()&&(this.linearUnitMenu=new v,f.forEach(this._supportedUnits.linearUnits,function(a){c=this._isCurrentLinearUnit(a);b=new r({group:"linearUnit",checked:c,label:this._i18n.widgets.imageServiceMeasure.unitLabel[a],"class":c?"esriSelectedOption":""});c&&(this._currentLinearUnitMenuItem=b);b.on("click",e.hitch(this,this._onLinearUnitClick,a,b));this.linearUnitMenu.addChild(b)},this),a=new n({label:this._i18n.widgets.imageServiceMeasure.linearUnits,
popup:this.linearUnitMenu}),this._menu.addChild(a));this._areaUnitsReqd()&&(this.areaUnitMenu=new v,f.forEach(this._supportedUnits.areaUnits,function(a){c=this._isCurrentAreaUnit(a);b=new r({group:"areaUnit",checked:c,label:this._i18n.widgets.imageServiceMeasure.unitLabel[a],"class":c?"esriSelectedOption":""});c&&(this._currentAreaUnitMenuItem=b);b.on("click",e.hitch(this,this._onAreaUnitClick,a,b));this.areaUnitMenu.addChild(b)},this),a=new n({label:this._i18n.widgets.imageServiceMeasure.areaUnits,
popup:this.areaUnitMenu}),this._menu.addChild(a))},_on3DCheckBoxChange:function(a){var b=this._currentOperation.replace("_3D","");this._enabled3DCheckbox=a;this._dropDownButton.openDropDown();this._activeMeasureOpMenuItem&&(this._activeMeasureOpMenuItem=null,this._onDropDownMenuItemClick(b,this._dropDownMenuItemMap[b]))},_on3DCheckBoxToolbarLayoutChange:function(a){this._enabled3DCheckbox=a;this._dropDownButton.openDropDown();this._enabled3DCheckbox||(this._currentOperation=this._currentOperation.replace("_3D",
""));this._currentOperation&&this._onButtonMenuItemClick(this._currentOperation)},_onDropDownMenuItemClick:function(a,b){var c=b.domNode;this._enabled3DCheckbox&&(a=this._map3DOperations[a]);this._disableMapNavigation();this._removeDraws();this._activeMeasureOpMenuItem?(x.remove(this._activeMeasureOpMenuItem.domNode,"esriSelectedOption"),x.add(c,"esriSelectedOption"),this._activeMeasureOpMenuItem=b,this._currentOperation=a,this._toggleButton.set({label:this._i18n.widgets.imageServiceMeasure.operationLabel[a],
iconClass:E[a.replace("_3D","")]})):(this._activeMeasureOpMenuItem=b,x.add(c,"esriSelectedOption"),this._currentOperation=a,this._toggleButton.set({label:this._i18n.widgets.imageServiceMeasure.operationLabel[a],iconClass:E[a.replace("_3D","")]}),x.add(this._toggleButton._buttonNode,"esriCheckedMeasureButton"));this._toggleButton._buttonNode.title=this._i18n.widgets.imageServiceMeasure.operationLabel[a];this.measureToolbar.activate(E[a]);this.measureToolbar.showDrawTooltip()},_uncheckOtherButtons:function(a){for(var b in this._toggleButtonMenuItemMap)this._toggleButtonMenuItemMap.hasOwnProperty(b)&&
b!==a&&(0<=f.indexOf(this._supportedMeasureOperations,b)?this._toggleButtonMenuItemMap[b].set("checked",!1):delete this._toggleButtonMenuItemMap[b])},_onButtonMenuItemClick:function(a){this._removeDraws();this._enabled3DCheckbox&&(a=this._map3DOperations[a]);this._uncheckOtherButtons(a.replace("_3D",""));this._currentOperation=a;this._toggleButtonMenuItemMap[a.replace("_3D","")].checked?(this._disableMapNavigation(),this.measureToolbar.activate(E[a]),this.measureToolbar.showDrawTooltip()):(this.measureToolbar.deactivate(),
this._enableMapNavigation());this.measureResultStringDiv&&K.set(this.measureResultStringDiv,"")},_isCurrentAngularUnit:function(a){return a===this.angularUnit?!0:!1},_isCurrentLinearUnit:function(a){return a===this.linearUnit?!0:!1},_isCurrentAreaUnit:function(a){return a===this.areaUnit?!0:!1},_onLinearUnitClick:function(a,b){x.remove(this._currentLinearUnitMenuItem.domNode,"esriSelectedOption");x.add(b.domNode,"esriSelectedOption");this._currentLinearUnitMenuItem=b;this.linearUnit=a;this.measureToolbar.setLinearUnit(A[a]);
this._dropDownButton.openDropDown()},_onAngularUnitClick:function(a,b){x.remove(this._currentAngularUnitMenuItem.domNode,"esriSelectedOption");x.add(b.domNode,"esriSelectedOption");this._currentAngularUnitMenuItem=b;this.angularUnit=a;this.measureToolbar.setAngularUnit(A[a]);this._dropDownButton.openDropDown()},_onAreaUnitClick:function(a,b){x.remove(this._currentAreaUnitMenuItem.domNode,"esriSelectedOption");x.add(b.domNode,"esriSelectedOption");this._currentAreaUnitMenuItem=b;this.areaUnit=a;this.measureToolbar.setAreaUnit(A[a]);
this._dropDownButton.openDropDown()},_onDrawStart:function(){this._removeDraws()},_addGraphic:function(a){var b=a.geometry;this.measureToolbar.hideDrawTooltip();a="point"===b.type?this.markerSymbol:"line"===b.type||"polyline"===b.type?this.lineSymbol:this.fillSymbol;this._removeDraws();this._currentGraphic=a=new F(b,a);this.map.graphics.add(a)},_addInfoWindow:function(a){a=this._measureResultString(a.measureResult,a.error);"dropDown"===this.layout||"toolbar"===this.layout&&("true"===this.displayMeasureResultInPopup||
!0===this.displayMeasureResultInPopup)?this._displayInfoWindowMeasureResult(a):"toolbar"===this.layout&&this._displayToolbarMeasureResult(a)},_measureResultString:function(a,b){b="";var c,d,e,f,g;if(a)for(g in a)a.hasOwnProperty(g)&&a[g]&&"name"!==g&&"sensorName"!==g&&(f="point"===g&&0<=this._currentOperation.toLowerCase().indexOf("centroid")?this._i18n.widgets.imageServiceMeasure.measureDialog.Centroid:this._i18n.widgets.imageServiceMeasure.measureDialog[g.charAt(0).toUpperCase()+g.slice(1)],"point"!=
g?(c=this._i18n.widgets.imageServiceMeasure.unitLabel[this._getUnitString(a[g].unit)],e=Math.abs(a[g].uncertainty).toFixed(2),d=this._getDisplayValue(a[g]),b+="\x3cstrong\x3e"+f+"\x3c/strong\x3e: "+J.format(d)+" (\x26plusmn"+J.format(e)+") "+c+"\x3cbr/\x3e"):(c=a[g].value.x.toFixed(2),d=a[g].value.y.toFixed(2),b+="\x3cstrong\x3e"+f+"\x3c/strong\x3e\x3cbr/\x3e"+this._i18n.widgets.imageServiceMeasure.measureDialog.X+" : "+J.format(c)+"\x3cbr/\x3e"+this._i18n.widgets.imageServiceMeasure.measureDialog.Y+
" : "+J.format(d)+"\x3cbr/\x3e",0<=this._currentOperation.toLowerCase().indexOf("3d")&&void 0!==a[g].value.z&&(f=a[g].value.z.toFixed(2),b+=this._i18n.widgets.imageServiceMeasure.measureDialog.Z+" : "+J.format(f)+"\x3cbr/\x3e")));else b=this._i18n.widgets.imageServiceMeasure.measurementErrorGeneric;return b},_getDisplayValue:function(a){return this.layer.currentVersion&&10.3<=this.layer.currentVersion?0>a.uncertainty?a.value.toFixed(2):Number(a.displayValue).toString():a.value.toFixed(2)},_getUnitString:function(a){var b,
c;for(b in A)A.hasOwnProperty(b)&&(A[b]===a?c=b:a===this._decimalDegreesConstantValue&&(c=this._decimalDegreesConstantKeyword));return c},_displayInfoWindowMeasureResult:function(a){if(this._currentGraphic){var b=this._currentGraphic.geometry,c,d=[this._currentGraphic];this._currentGraphic&&("point"===b.type?this._currentInfowindow=b:"polyline"===b.type?(c=(b.paths[0][0][0]+b.paths[0][1][0])/2,b=(b.paths[0][0][1]+b.paths[0][1][1])/2,this._currentInfowindow=new D(c,b,this.map.spatialReference)):"polygon"===
b.type&&(this._currentInfowindow=b.getCentroid()),d[0].setInfoTemplate(new C({title:this._i18n.widgets.imageServiceMeasure.infoWindowTitle,content:a})),this.map.infoWindow.setFeatures(d),this.map.infoWindow.show(this._currentInfowindow))}},_displayToolbarMeasureResult:function(a){K.set(this.measureResultStringDiv,a)},_removeAssociatedGeometry:function(){this._currentGraphic&&(this.map.graphics.remove(this._currentGraphic),this._currentGraphic=null)},_removeDraws:function(){this._removeAssociatedGeometry();
this._currentInfowindow&&(this.map.infoWindow.hide(this._currentInfowindow),this._currentInfowindow=null)},_onUnitChange:function(a){this._addInfoWindow(a)},_toggle:function(){this._activeMeasureOpMenuItem?(this._removeDraws(),x.remove(this._activeMeasureOpMenuItem.domNode,"esriSelectedOption"),this._activeMeasureOpMenuItem=null,this.measureToolbar.deactivate(),x.remove(this._toggleButton._buttonNode,"esriCheckedMeasureButton"),this._enableMapNavigation()):(this._menuItem=this._dropDownMenuItemMap[this._currentOperation.replace("_3D",
"")],this._onDropDownMenuItemClick(this._currentOperation.replace("_3D",""),this._menuItem))},deactivate:function(){this._removeDraws();this._activeMeasureOpMenuItem&&(x.remove(this._activeMeasureOpMenuItem.domNode,"esriSelectedOption"),this._activeMeasureOpMenuItem=null);this._toggleButton&&x.remove(this._toggleButton._buttonNode,"esriCheckedMeasureButton");this.measureResultStringDiv&&K.set(this.measureResultStringDiv,"");"toolbar"===this.layout&&this._currentOperation&&this._toggleButtonMenuItemMap[this._currentOperation.replace("_3D",
"")].set("checked",!1);this.measureToolbar&&this.measureToolbar.deactivate();this._enableMapNavigation()},_disableMapNavigation:function(){this.map.disableMapNavigation();this.map.setInfoWindowOnClick(!1)},_enableMapNavigation:function(){this.map.enableMapNavigation();this.map.setInfoWindowOnClick(!0)},destroy:function(){this.inherited(arguments)}});a("extend-esri")&&e.setObject("dijit.ImageServiceMeasure",h,k);return h})},"esri/toolbars/ImageServiceMeasureTool":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has ../kernel ./_toolbar ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ./draw ../tasks/ImageServiceMeasureParameters ../tasks/ImageServiceMeasureTask ../geometry/Point dojo/_base/array ../units".split(" "),
function(d,e,m,h,a,c,k,l,t,g,p,b,v,w,q){var n=d("CustomDraw",[g],{returnCurrentPoint:function(){return this._points},hideTooltip:function(){this._options.showTooltips=!1},showTooltip:function(){this._options.showTooltips=!0}});c=d(c,{declaredClass:"esri.toolbars.imageServiceMeasure",_eventMap:{"draw-end":["geometry"],"draw-start":[],"measure-end":["measureResult","error","geometry"],"unit-change":["measureResult","error","geometry"]},_mensurationCapabilitiesMap:{Basic:["OPERATION_POINT","OPERATION_DISTANCE_ANGLE",
"OPERATION_AREA_PERIMETER","OPERATION_CENTROID"],"3D":["OPERATION_POINT_3D","OPERATION_DISTANCE_ANGLE_3D","OPERATION_AREA_PERIMETER_3D","OPERATION_CENTROID_3D"],"Base-Top Height":["OPERATION_BASE_TOP"],"Top-Top Shadow Height":["OPERATION_TOP_TOP_SHADOW"],"Base-Top Shadow Height":["OPERATION_BASE_TOP_SHADOW"]},_supportedMeasureOperations:[],_operationsMap:{OPERATION_POINT:{geometryType:"POINT"},OPERATION_DISTANCE_ANGLE:{geometryType:"LINE"},OPERATION_AREA_PERIMETER:{geometryType:"POLYGON"},OPERATION_BASE_TOP:{geometryType:"LINE"},
OPERATION_BASE_TOP_SHADOW:{geometryType:"LINE"},OPERATION_TOP_TOP_SHADOW:{geometryType:"LINE"},OPERATION_CENTROID:{geometryType:"POLYGON"},OPERATION_POINT_3D:{geometryType:"POINT"},OPERATION_DISTANCE_ANGLE_3D:{geometryType:"LINE"},OPERATION_AREA_PERIMETER_3D:{geometryType:"POLYGON"},OPERATION_CENTROID_3D:{geometryType:"POLYGON"}},_supportedUnits:{linearUnits:"INCHES FEET YARDS MILES NAUTICAL_MILES MILLIMETERS CENTIMETERS DECIMETERS METERS KILOMETERS".split(" "),angularUnits:["RADIANS","DECIMAL_DEGREES"],
areaUnits:"SQUARE_INCHES SQUARE_FEET SQUARE_YARDS ACRES SQUARE_MILES SQUARE_MILLIMETERS SQUARE_CENTIMETERS SQUARE_DECIMETERS SQUARE_METERS ARES HECTARES SQUARE_KILOMETERS".split(" ")},markerSymbol:null,lineSymbol:null,fillSymbol:null,_drawToolbar:null,_currentGeometry:null,_currentOperation:null,linearUnit:null,angularUnit:null,areaUnit:null,_decimalDegreesConstantValue:"esriDUDecimalDegrees",_decimalDegreesConstantKeyword:"DECIMAL_DEGREES",constructor:function(a){d.safeMixin(this,a);this._checkMensurationSupport();
this._setDefaultSymbols()},_checkMensurationSupport:function(){this.layer.mensurationCapabilities?this._setSupportedMeasureOperations():console.log("Mensuration Capabilities not supported.")},_setDefaultSymbols:function(){this.markerSymbol||(this.markerSymbol=new k,this.markerSymbol.setPath("M16,4.938c-7.732,0-14,4.701-14,10.5c0,1.981,0.741,3.833,2.016,5.414L2,25.272l5.613-1.44c2.339,1.316,5.237,2.106,8.387,2.106c7.732,0,14-4.701,14-10.5S23.732,4.938,16,4.938zM16.868,21.375h-1.969v-1.889h1.969V21.375zM16.772,18.094h-1.777l-0.176-8.083h2.113L16.772,18.094z"),
this.markerSymbol.setColor(new m("#00FFFF")));this.lineSymbol||(this.lineSymbol=new l(l.STYLE_SOLID,new m([255,0,0]),1.5));this.fillSymbol||(this.fillSymbol=new t(t.STYLE_SOLID,new l(l.STYLE_DASHDOT,new m([255,0,0]),2),new m([255,255,0,.25])))},_setSupportedMeasureOperations:function(){var a;this._supportedMeasureOperations=[];this.mensurationCapabilities=this.layer.mensurationCapabilities.split(",");w.forEach(this.mensurationCapabilities,function(b){a=this._mensurationCapabilitiesMap[b];w.forEach(a,
function(a){this._supportedMeasureOperations.push(a)},this)},this)},getSupportedMeasureOperations:function(){var a=[];w.forEach(this._supportedMeasureOperations,function(b){a.push(p[b])},this);return a},getSupportedUnits:function(){var a={},b=[],c=[],d;for(d in this._supportedUnits)this._supportedUnits.hasOwnProperty(d)&&(b=this._supportedUnits[d],c=[],w.forEach(b,function(a){a===this._decimalDegreesConstantKeyword?c.push(this._decimalDegreesConstantValue):c.push(q[a])},this),a[d]=c);return a},setLinearUnit:function(a){for(var b in q)q.hasOwnProperty(b)&&
q[b]===a&&(this.linearUnit=b);this._currentGeometry&&this._getUnitChangeResults(this._currentGeometry)},setAngularUnit:function(a){for(var b in q)q.hasOwnProperty(b)&&(q[b]===a?this.angularUnit=b:a===this._decimalDegreesConstantValue&&(this.angularUnit=this._decimalDegreesConstantKeyword));this._currentGeometry&&this._getUnitChangeResults(this._currentGeometry)},setAreaUnit:function(a){for(var b in q)q.hasOwnProperty(b)&&q[b]===a&&(this.areaUnit=b);this._currentGeometry&&this._getUnitChangeResults(this._currentGeometry)},
setMarkerSymbol:function(a){this.markerSymbol=a},setLineSymbol:function(a){this.lineSymbol=a},setFillSymbol:function(a){this.fillSymbol=a},activate:function(a){w.forEach(this._supportedMeasureOperations,function(b){p[b]===a&&(this._currentOperation=b)},this);this.map.setMapCursor("crosshair");this._mapClickHandle=this.map.on("click",e.hitch(this,this._onMapClick));this._mapMouseDownHandle=this.map.on("mouse-down",e.hitch(this,this._onMapMouseDown));this._drawToolbar||(this._drawToolbar=new n(this.map,
{fillSymbol:this.fillSymbol,markerSymbol:this.markerSymbol,lineSymbol:this.lineSymbol}),this._drawToolbar.on("draw-end",e.hitch(this,this._setGeometry)));this._drawToolbar.activate(g[this._operationsMap[this._currentOperation].geometryType])},_onMapClick:function(){if(0===this._drawToolbar.returnCurrentPoint().length)this.onDrawStart()},_onMapMouseDown:function(){if(0===this._drawToolbar.returnCurrentPoint().length)this.onDrawStart()},deactivate:function(){this._drawToolbar&&this._drawToolbar.deactivate();
this.map.setMapCursor("default");this._currentOperation=this._currentGeometry=null;this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null);this._mapMouseDownHandle&&(this._mapMouseDownHandle.remove(),this._mapMouseDownHandle=null)},hideDrawTooltip:function(){this._drawToolbar.deactivate();this._drawToolbar.hideTooltip();this._drawToolbar.activate(g[this._operationsMap[this._currentOperation].geometryType])},showDrawTooltip:function(){this._drawToolbar.deactivate();this._drawToolbar.showTooltip();
this._drawToolbar.activate(g[this._operationsMap[this._currentOperation].geometryType])},_setGeometry:function(a){a=a.geometry;this.onDrawEnd(a);this._getMensurationResults(a);this._currentGeometry=a},_getImageServiceMeasureParameters:function(a){var b=new p;b.operation=p[this._currentOperation];b.mosaicRule=this.layer.mosaicRule;b.linearUnit=q[this.linearUnit];b.angularUnit=this.angularUnit===this._decimalDegreesConstantKeyword?this._decimalDegreesConstantValue:q[this.angularUnit];b.areaUnit=q[this.areaUnit];
"line"===a.type||"polyline"===a.type?(b.fromGeometry=new v(a.paths[0][0][0],a.paths[0][0][1],this.map.spatialReference),b.toGeometry=new v(a.paths[0][1][0],a.paths[0][1][1],this.map.spatialReference)):b.fromGeometry=a;return b},_getMensurationResults:function(a){a=this._getImageServiceMeasureParameters(a);(new b(this.layer.url)).execute(a,e.hitch(this,this._measureTaskSuccess),e.hitch(this,this._measureTaskError))},_measureTaskSuccess:function(a){this.onMeasureEnd(a,null,this._currentGeometry)},_measureTaskError:function(a){this.onMeasureEnd(null,
a,this._currentGeometry)},_getUnitChangeResults:function(a){a=this._getImageServiceMeasureParameters(a);(new b(this.layer.url)).execute(a,e.hitch(this,this._unitChangeSuccess),e.hitch(this,this._unitChangeError))},_unitChangeSuccess:function(a){this.onUnitChange(a,null,this._currentGeometry)},_unitChangeError:function(a){this.onUnitChange(null,a,this._currentGeometry)},onDrawStart:function(){},onDrawEnd:function(){},onMeasureEnd:function(){},onUnitChange:function(){}});h("extend-esri")&&e.setObject("toolbars.imageServiceMeasure",
c,a);return c})},"esri/tasks/ImageServiceMeasureParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(d,e,m,h,a,c){d=d(null,{declaredClass:"esri.tasks.ImageServiceMeasureParameters",fromGeometry:null,toGeometry:null,operation:null,pixelSize:null,mosaicRule:!1,linearUnit:null,angularUnit:null,areaUnit:null,toJson:function(a){var d=a&&a.fromGeometry||this.fromGeometry;a={fromGeometry:d,toGeometry:a&&a.toGeometry||
this.toGeometry,measureOperation:this.operation,mosaicRule:this.mosaicRule?m.toJson(this.mosaicRule.toJson()):null,linearUnit:this.linearUnit,angularUnit:this.angularUnit,areaUnit:this.areaUnit};d&&(a.geometryType=c.getJsonType(d));this.pixelSize&&(a.pixelSize=this.pixelSize?m.toJson(this.pixelSize.toJson()):null);return a}});e.mixin(d,{OPERATION_POINT:"esriMensurationPoint",OPERATION_DISTANCE_ANGLE:"esriMensurationDistanceAndAngle",OPERATION_AREA_PERIMETER:"esriMensurationAreaAndPerimeter",OPERATION_BASE_TOP:"esriMensurationHeightFromBaseAndTop",
OPERATION_BASE_TOP_SHADOW:"esriMensurationHeightFromBaseAndTopShadow",OPERATION_TOP_TOP_SHADOW:"esriMensurationHeightFromTopAndTopShadow",OPERATION_CENTROID:"esriMensurationCentroid",OPERATION_POINT_3D:"esriMensurationPoint3D",OPERATION_DISTANCE_ANGLE_3D:"esriMensurationDistanceAndAngle3D",OPERATION_AREA_PERIMETER_3D:"esriMensurationAreaAndPerimeter3D",OPERATION_CENTROID_3D:"esriMensurationCentroid3D"});h("extend-esri")&&e.setObject("tasks.ImageServiceMeasureParameters",d,a);return d})},"esri/tasks/ImageServiceMeasureTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task".split(" "),
function(d,e,m,h,a,c,k){d=d(k,{declaredClass:"esri.tasks.ImageServiceMeasureTask",constructor:function(a){this._url.path+="/measure";this._handler=e.hitch(this,this._handler)},__msigns:[{n:"execute",c:3,a:[{i:0,p:["fromGeometry","toGeometry"]}],e:2}],_handler:function(a,c,d,e,b){try{this._successHandler([a],"onComplete",d,b)}catch(v){this._errorHandler(v,e,b)}},execute:function(c,d,g,h){var b=h.assembly;c=this._encode(e.mixin({},this._url.query,{f:"json"},c.toJson(b&&b[0])));var l=this._handler,k=
this._errorHandler;return a({url:this._url.path,content:c,callbackParamName:"callback",load:function(a,b){l(a,b,d,g,h.dfd)},error:function(a){k(a,g,h.dfd)}})},onComplete:function(){}});c._createWrappers(d);m("extend-esri")&&e.setObject("tasks.ImageServiceMeasureTask",d,h);return d})},"dijit/PopupMenuItem":function(){define("dojo/_base/declare dojo/dom-style dojo/_base/lang dojo/query ./popup ./registry ./MenuItem ./hccss".split(" "),function(d,e,m,h,a,c,k){return d("dijit.PopupMenuItem",k,{baseClass:"dijitMenuItem dijitPopupMenuItem",
_fillContent:function(){if(this.srcNodeRef){var a=h("*",this.srcNodeRef);this.inherited(arguments,[a[0]]);this.dropDownContainer=this.srcNodeRef}},_openPopup:function(c,d){var e=this.popup;a.open(m.delegate(c,{popup:this.popup,around:this.domNode}));d&&e.focus&&e.focus()},_closePopup:function(){a.close(this.popup);this.popup.parentMenu=null},startup:function(){if(!this._started){this.inherited(arguments);if(!this.popup){var a=h("[widgetId]",this.dropDownContainer)[0];this.popup=c.byNode(a)}this.ownerDocumentBody.appendChild(this.popup.domNode);
this.popup.domNode.setAttribute("aria-labelledby",this.containerNode.id);this.popup.startup();this.popup.domNode.style.display="none";this.arrowWrapper&&e.set(this.arrowWrapper,"visibility","");this.focusNode.setAttribute("aria-haspopup","true")}},destroyDescendants:function(a){this.popup&&(this.popup._destroyed||this.popup.destroyRecursive(a),delete this.popup);this.inherited(arguments)}})})},"dijit/RadioMenuItem":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/query!css2 ./CheckedMenuItem ./registry".split(" "),
function(d,e,m,h,a,c){return e("dijit.RadioButtonMenuItem",a,{baseClass:"dijitMenuItem dijitRadioMenuItem",role:"menuitemradio",checkedChar:"*",group:"",_setGroupAttr:"domNode",_setCheckedAttr:function(a){this.inherited(arguments);this._created&&a&&this.group&&d.forEach(this._getRelatedWidgets(),function(a){a!=this&&a.checked&&a.set("checked",!1)},this)},_onClick:function(a){this.disabled||this.checked||(this.set("checked",!0),this.onChange(!0));this.onClick(a)},_getRelatedWidgets:function(){var a=
[];h("[group\x3d"+this.group+"][role\x3d"+this.role+"]").forEach(function(d){(d=c.getEnclosingWidget(d))&&a.push(d)});return a}})})},"widgets/ObliqueViewer/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:esri/dijit/templates/_ObliqueRotationWidget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"gaugeNode" class\x3d"esriObliqueRotationWidgetGauge"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:esri/dijit/templates/ImageServiceMeasure.html":'\x3cdiv data-dojo-attach-point\x3d"esriImageServiceMeasure" class\x3d"esriImageServiceMeasure"\x3e\r\n  \x3cdiv class\x3d"esriImageServiceMeasureToggleButton" data-dojo-attach-point\x3d"toggleButtonDiv"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriImageServiceMeasureDropdownContainer" data-dojo-attach-point\x3d"measureDropDownContainer"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"measureButtonContainer"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/ObliqueViewer/Widget.html":'\x3cdiv class\x3d"obliqueViewerWidget"\x3e\r\n  \x3cdiv class\x3d"obliqueViewerWidgetDiv"\x3e\r\n      \x3cdiv id\x3d"ovMap" class\x3d"ovMap"\x3e\r\n        \x3c!-- added or the overlay to show error message  --\x3e\r\n        \x3cdiv id\x3d"info" class\x3d"info" data-dojo-attach-point\x3d"infoDiv"\x3e\r\n          \x3cdiv id\x3d"infoText" data-dojo-attach-point\x3d"infoDivText" \x3e${nls.noImageNotification}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"obliqueRotationDivPassive" data-dojo-attach-point\x3d"rotationDivContainer"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"obliqueRotationDiv"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"toolbar" class\x3d"toolbar"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"locateButtonContainer"\x3e\r\n          \x3c/div\x3e   \r\n          \x3cdiv data-dojo-attach-point\x3d"clearButtonContainer"\x3e\r\n          \x3c/div\x3e \r\n          \x3cdiv data-dojo-attach-point\x3d"zoomButtonContainer"\x3e\r\n          \x3c/div\x3e   \r\n          \x3cdiv data-dojo-attach-point\x3d"syncButtonContainer"\x3e\r\n          \x3c/div\x3e    \r\n          \x3cdiv data-dojo-attach-point\x3d"listTitlePaneDiv" class\x3d"listDivTitlePane"\x3e     \r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d\'measureWidget\' title\x3d"{nls.measureWidgetLabel}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"azimuthChangeNotification" data-dojo-attach-point\x3d"notificationDiv"\x3e${nls.azimuthChangeNotification}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ObliqueViewer/css/style.css":'.obliqueViewerWidgetDiv {height: 100%; width:100%;}.obliqueViewerWidget, .obliqueViewerWidgetDiv{height: 100%; width: 100%;}.ovMap{height: 100%; width: 100%;}.info {position: absolute; height: 15%; width: 80%; left: 10%; top: 30%; display: none; background-color: rgba(0,0,0,0.5); z-index: 2; cursor: pointer;}#infoText {position: absolute; top: 10%; left: 2%; padding: 2%; font-size: 12px; color: white;}.obliqueViewerWidgetDiv .dijitReset.dijitInline.dijitArrowButtonInner{background-image: url(../images/arrow-drop-down.png) !important; background-position: center;}.esriMensurationHeightFromBaseAndTop{background-image: url(../images/measure_base_top.png) !important; background-position: center; background-size: 17px;}.esriMensurationHeightFromTopAndTopShadow {background-image: url(../images/measure_top_top_shadow.png) !important; background-position: center; background-size: 17px;}.esriMensurationHeightFromBaseAndTopShadow{background-image: url(../images/measure_base_top_shadow.png) !important; background-position: center; background-size: 17px;}.obliqueViewerWidgetDiv .dijitButtonNode,.obliqueViewerWidgetDiv .dijitDropDownButton.dijitButtonNode{background-color: rgba(0,0,0,0)!important; background-image: none!important;}.obliqueViewerWidgetDiv .obliqueRotationDivPassive {display: block; position: absolute; background-color: rgba(255, 255, 255, 0); bottom: 15px; right: 10px; border-radius: 10px; height:90px; width:90px; z-index: 10;}.obliqueViewerWidgetDiv .toolbar {position: absolute; display: block; top: 5px; left: 5px; height: 40px; overflow: visible; background-color: rgba(255,255,255, 0.8); filter: progid:DXImageTransform.Microsoft.gradient( startColorstr\x3d\'#ffffff\', endColorstr\x3d\'#dddddd\',GradientType\x3d0 ); -webkit-box-shadow: 3px 2px 3px 0px rgba(50, 50, 50, 0.69); -moz-box-shadow: 3px 2px 3px 0px rgba(50, 50, 50, 0.69); box-shadow: 3px 2px 3px 0px rgba(50, 50, 50, 0.69); z-index: 10;}.obliqueViewerWidgetDiv .listDivTitlePane {display: inline;}.obliqueViewerWidgetDiv .esriSimpleSliderTL {display: none;}.obliqueViewerWidgetDiv .zoomButtonContainer {display: inline; padding-left: 3px;}.obliqueViewerWidgetDiv .zoomIcon {height: 16px; width: 16px; background: url(../images/zoom.png); -webkit-background-size: 16px; -moz-background-size: 16px; background-size: 16px; background-position: center;}.obliqueViewerWidgetDiv .measureWidget {display: inline;}.obliqueViewerWidgetDiv .measureWidget .dijitButtonText{display: none;}.obliqueViewerWidgetDiv .rastersListIcon {background-image: url("../images/rasters_list.png"); width: 16px; height: 16px; -webkit-background-size: 16px; -moz-background-size: 16px; background-size: 16px; background-position: center; background-repeat: no-repeat;}.dgrid-row-odd {background: #E6EBFA;}.dgrid-scroller {margin-top: 0 !important; margin-bottom: 0 !important; height: 100% !important; overflow: auto!important;}.esriRasterListThumbnail {height:70px; width:70px;}.dgrid-header {z-index: 1;}.dgrid-header-scroll {display: none;}.dgrid-header-row th {height: 25px;}th.dgrid-cell {text-align: center;}.dgrid-content {margin-top: 27px; height: auto;}.dgrid-content .dgrid-cell {border-collapse: collapse !important;}td.dgrid-cell {padding-left: 5px;}.dgrid-row {font-size:10px;}.field-id {width: 30px;}.obliqueRasterList .dgrid-content {margin-top: 0!important;}.obliqueRasterList .dgrid-row {padding: 3px; border-bottom: 1px solid slategray;}.esriRasterListThumbnailRow.dgrid-row {height:80px;}.obliqueViewerWidgetDiv .dijitDialogUnderlay {background: #000000; opacity: 0.4;}.obliqueViewerWidgetDiv .dijitIcon{display: inline-block!important;}.obliqueViewerWidgetDiv .dijitButton .dijitButtonNode,.obliqueViewerWidgetDiv .dijitToggleButton .dijitButtonNode,.obliqueViewerWidgetDiv .dijitButtonHover .dijitButtonNode,.obliqueViewerWidgetDiv .dijitToggleButtonHover .dijitButtonNode{padding-left: 6px!important; padding-right: 6px!important; border-width: 1px!important; border-radius: 0px!important; margin-top: -7px; padding-top: 11px!important; height: 100%; border-color: rgba(0,0,0,0)!important; border-width: 1px!important; box-shadow: none!important; min-width: 0!important;}.obliqueViewerWidgetDiv .dijitDropDownButton .dijitButtonNode,.obliqueViewerWidgetDiv .dijitComboButton .dijitButtonNode,.obliqueViewerWidgetDiv .dijitDropDownButtonHover .dijitButtonNode,.obliqueViewerWidgetDiv .dijitComboButtonHover .dijitButtonNode{padding-left: 6px!important; padding-right: 6px!important; border-radius: 0px!important; z-index: 1; border-color: rgba(0,0,0,0)!important; border-width: 1px!important; margin-top: -2px; padding-top: 11px!important; height: 100%; box-shadow: none!important; min-width: 0!important;}.obliqueViewerWidgetDiv .dijitButtonHover .dijitButtonNode,.obliqueViewerWidgetDiv .dijitToggleButtonHover .dijitButtonNode,.obliqueViewerWidgetDiv .dijitDropDownButtonHover .dijitButtonNode,.obliqueViewerWidgetDiv .dijitComboButtonHover .dijitButtonNode{background-color: rgba(255,255,255,0.9)!important; background-image: none!important;}.obliqueViewerWidgetDiv .dijit.dijitReset.dijitInline.dijitDropDownButton{height: 100%;}.obliqueViewerWidgetDiv .dijitToggleButtonChecked .dijitButtonNode,.obliqueViewerWidgetDiv .esriCheckedMeasureButton{border-width: 1px; background-color: rgba(255,255,255,0.9)!important; box-shadow: none!important; border-color: rgba(0,0,0,0)!important; border-radius: 0px!important; min-width: 0;}.obliqueViewerWidgetDiv .locateIcon {background-image: url("../images/locate.png"); width: 16px; height: 16px; -webkit-background-size: 16px; -moz-background-size: 16px; background-position: center; background-repeat: no-repeat; filter: grayscale(50%);}.obliqueViewerWidgetDiv .syncIcon {background-image: url("../images/sync.png"); width: 16px; height: 16px; -webkit-background-size: 16px; -moz-background-size: 16px; background-size: 16px; background-position: center; background-repeat: no-repeat; filter: grayscale(50%);}.obliqueViewerWidgetDiv .clearIcon {background-image: url("../images/clear.png"); width: 16px; height: 16px; -webkit-background-size: 16px; -moz-background-size: 16px; background-size: 16px; background-position: center; background-repeat: no-repeat;}.obliqueViewerWidgetDiv .clearButtonContainer {display: inline;}.obliqueViewerWidgetDiv .locateButtonContainer {display: inline;}.obliqueViewerWidgetDiv .syncButtonContainer {display: inline;}.obliqueViewerWidgetDiv .esriImageServiceMeasureToggleButton{margin-right: 4px!important; padding-left: 2px!important;}.obliqueViewerWidgetDiv .dijitMenuItem td{background-color: transparent!important; border-color: transparent!important; border-width: 1px 0 1px 0!important; padding: 2px!important; color: #000000!important;}.obliqueViewerWidgetDiv.dijitMenuTable{background-color: rgba(255,255,255,0.8)!important; border: none!important; color: #000000!important;}.obliqueViewerWidgetDiv .dijitMenuItemHover,.obliqueViewerWidgetDiv .dijitMenuItemChecked,.obliqueViewerWidgetDiv .dijitMenuItemFocused,.obliqueViewerWidgetDiv .dijitMenuItemSelected{background-color: rgba(255,255,255,0.8)!important; background-image: none!important; border-color: rgba(255,255,255,0.8)!important; border-width: 1px 0 1px 0!important; padding: 2px!important; color: #000000!important;}.obliqueViewerWidgetDiv.dijitTooltipDialog{padding:0!important;}.obliqueViewerWidgetDiv .dijitTooltipConnector{display: none;}.obliqueViewerWidgetDiv .dijitTooltipContainer{padding: 0px!important; background-color: transparent!important; background-image: none!important; border: none!important; box-shadow: none!important;}#rasterListDiv{background-color: rgba(255,255,255,0.8)!important; border: none;}.obliqueRasterList .dgrid-row{border-bottom: 1px solid slategray; background: transparent!important;}.obliqueViewerWidgetDiv .dgrid-selected{background: #C7E4FF!important;}.azimuthChangeNotification{background: rgba(255,255,255,0.8); transition: opacity 1s; -webkit-transition: opacity 1s ease-out; display: none; position: absolute; bottom: 20px; left: 20px; width: 50%; color: #000000; padding: 5px;}.noImageNotification{background: rgba(255,255,255,0.8); display: none; position: absolute; bottom: 20px; left: 20px; width: 50%; color: #000000; padding: 5px;}.jimu-rtl .obliqueViewerWidgetDiv .toolbar {right: 5px; left: auto;}.jimu-rtl .obliqueViewerWidgetDiv .obliqueRotationDivPassive {left: 5px; right: auto;}',
"*now":function(d){d(['dojo/i18n!*preload*widgets/ObliqueViewer/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidget esri/map esri/dijit/ObliqueViewer dojo/_base/lang dojo/dom dijit/form/Button esri/dijit/ImageServiceMeasure dijit/form/DropDownButton dijit/TooltipDialog dijit/form/ToggleButton esri/layers/ArcGISImageServiceLayer esri/symbols/PictureMarkerSymbol esri/symbols/SimpleFillSymbol esri/symbols/SimpleLineSymbol esri/symbols/CartographicLineSymbol esri/Color esri/graphic esri/geometry/geometryEngine esri/geometry/Point dojo/dom-style dojo/dom-class esri/IdentityManager".split(" "),function(d,
e,m,h,a,c,k,l,t,g,p,b,v,w,q,n,r,u,z,B,y,F){return d([e],{baseClass:"jimu-widget-ObliqueViewer",name:"ObliqueViewer",imageServiceMeasureWidget:null,imageLayer:"",ovMap:null,startAzimuthAngle:0,startup:function(){this.inherited(arguments);var c=this._getLayerUrl(this.config.ObliqueViewer.layerTitle);this.imageLayer=new b(c);this.setImageLayerProperties();this.ovMap=new m("ovMap");this.own(this.imageLayer.on("load",a.hitch(this,this._addObliqueViewerWidget)));this.ovMap.addLayer(this.imageLayer);this.nativePointSymbol=
new v({angle:0,xoffset:2,yoffset:4,type:"esriPMS",url:"./widgets/ObliqueViewer/images/BlueShinyPin.png",contentType:"image/png",width:24,height:24});this.noImageExtentSymbol=(new w).setOutline((new n(n.STYLE_LONGDASH)).setColor(new r("green")).setWidth(2)).setColor(new r([0,0,0,0]));this.obliqueExtentSymbol=(new w).setOutline((new q).setColor(new r("red")).setWidth(2)).setColor(new r([0,0,0,0]))},setImageLayerProperties:function(){this.renderingRule&&this.imageLayer.setRenderingRule(this.renderingRule,
!0);this.mosaicRule&&this.imageLayer.setMosaicRule(this.mosaicRule,!0);this.imageFormat&&this.imageLayer.setImageFormat(this.imageFormat,!0);this.compressionQuality&&this.imageLayer.setCompressionQuality(this.compressionQuality,!0);this.imageLayer.refresh()},onOpen:function(){if(this.oblique){var a=z.buffer(this.map.extent.getCenter(),100,"meters").getExtent();this.oblique.locate(a)}else this._setInitialExtent()},_setInitialExtent:function(){var a=this.map.extent,a=new B((a.xmax+a.xmin)/2,(a.ymax+
a.ymin)/2,a.spatialReference),a=z.buffer(a,100,"meters").getExtent();this.oblique?this.oblique.setExtent(a):this.ovMap.setExtent(a)},_addObliqueViewerWidget:function(){this._addLocateButton();this._addClearButton();this._addZoomButton();this._addSyncButton();this._addTitlePane();this.oblique=new h({map:this.ovMap,imageServiceLayer:this.imageLayer,azimuthField:this.config.ObliqueViewer.azimuthField,elevationField:this.config.ObliqueViewer.elevationField,showThumbnail:this.config.ObliqueViewer.showThumbnail,
searchRadius:this.config.ObliqueViewer.searchRadius,searchUnit:this.config.ObliqueViewer.searchUnit,rasterInfoFields:this.config.ObliqueViewer.rasterInfoFields,rotationDiv:this.obliqueRotationDiv,azimuthAngle:this.startAzimuthAngle,rasterListDiv:c.byId("rasterListDiv"),rasterListRefresh:this.dropDown.dropDown.open});var b=["esriMensurationHeightFromBaseAndTop","esriMensurationHeightFromTopAndTopShadow","esriMensurationHeightFromBaseAndTopShadow"];this.config.ObliqueViewer.showDistanceTools&&b.push("esriMensurationDistanceAndAngle",
"esriMensurationAreaAndPerimeter");this.measureWidget=new l({layer:this.imageLayer,map:this.ovMap,"class":"measureWidget",title:this.nls.measureWidgetLabel,displayOperations:b},this.measureWidget);this.measureWidget.startup();this.own(this.measureWidget.measureToolbar.on("measure-end",a.hitch(this,this.publishMeasureResult)),this.measureWidget.measureToolbar.on("unit-change",a.hitch(this,this.publishMeasureResult)),this.zoomButton.on("click",a.hitch(this,function(){this.oblique.zoomToSelectedImage()})),
this.locateButton.on("change",a.hitch(this,this._locateClick)),this.clearButton.on("click",a.hitch(this,this._clearAll)),this.oblique.on("raster-select",a.hitch(this,this._closeDropDown)),this.oblique.on("azimuth-change",a.hitch(this,this._handleZoomButton)),this.oblique.on("azimuth-change",a.hitch(this,this._showAzimuthChangeNotification)),this.oblique.on("extent-change",a.hitch(this,this._updateExtentOnNadirMap)),this.oblique.on("no-records",a.hitch(this,this._showNoImageNotification)),this.oblique.on("records-found",
a.hitch(this,this._hideNoImageNotification)),this.oblique.on("add-point",a.hitch(this,this._showPoint)));this._addClassesToMenus();this.syncButton&&this.own(this.syncButton.on("click",a.hitch(this,this._updateNadirExtent,!0)))},_showAzimuthChangeNotification:function(b){b.noDataSwitch?(y.set(this.notificationDiv,"display","block"),y.set(this.notificationDiv,"opacity",1),setTimeout(a.hitch(this,function(){this._hideAzimuthChangeNotification()}),3E3)):this._hideAzimuthChangeNotification()},_hideAzimuthChangeNotification:function(){y.set(this.notificationDiv,
"opacity","0")},_addClassesToMenus:function(){this.measureWidget&&(this.measureWidget._menu&&F.add(this.measureWidget._menu.domNode,"obliqueViewerWidgetDiv"),this.measureWidget.linearUnitMenu&&F.add(this.measureWidget.linearUnitMenu.domNode,"obliqueViewerWidgetDiv"))},publishMeasureResult:function(a){this.publishData({measureResult:a.measureResult})},_updateExtentOnNadirMap:function(a){var b=null!==a.geometry?z.simplify(a.geometry):a.geometry;this.noImageExtentGraphic&&this.noImageExtentGraphic.hide();
this.obliqueExtentGraphic?(this.obliqueExtentGraphic.setGeometry(b),this.obliqueExtentGraphic.show()):this.obliqueExtentGraphic=this.map.graphics.add(new u(b,this.obliqueExtentSymbol));this.locatePoint&&b?(this.ovMap.graphics.show(),z.within(this.locatePoint,b)||this.ovMap.graphics.clear()):this.ovMap.graphics.clear();!this.map.extent.contains(b)&&this.config.ObliqueViewer.autoSync&&a.geometry&&this._updateNadirExtent(!1,a.geometry.getExtent())},_updateNadirExtent:function(a,b){a?this.map.setExtent(this.map.extent.centerAt(this.oblique.nadirExtent.getCenter())):
b&&this.map.setExtent(this._getAdjustedExtent(this.map.extent,b))},_getAdjustedExtent:function(b,c){if(b&&c){var d=0,e=0;b=a.clone(b);c.xmax>b.xmax?d=c.xmax-b.xmax:c.xmin<b.xmin&&(d=c.xmin-b.xmin);c.ymax>b.ymax?e=c.ymax-b.ymax:c.ymin<b.ymin&&(e=c.ymin-b.ymin);return b.offset(d,e)}},_handleZoomButton:function(a){a=a.azimuth;null===a||"undefined"===typeof a?this.zoomButton.set("disabled",!0):this.zoomButton.set("disabled",!1)},_closeDropDown:function(){this.dropDown.closeDropDown()},_showNoImageNotification:function(){this.ovMap.graphics.clear();
y.set(this.infoDiv,"display","block");this.imageLayer.hide();this.obliqueExtentGraphic&&this.obliqueExtentGraphic.hide()},_hideNoImageNotification:function(){y.set(this.infoDiv,"display","none");this.imageLayer.show()},_locateClick:function(b){var c;b?(this.map.setMapCursor("crosshair"),this.map.disableMapNavigation(),this.map.setInfoWindowOnClick(!1),this.own(c=this.map.on("click",a.hitch(this,function(a){c.remove();this.map.enableMapNavigation();this.map.setInfoWindowOnClick(!0);this.locateButton.set("checked",
!1);this.map.setMapCursor("default");this._clearAll();this._addPoint(a.mapPoint)})))):(this.map.setMapCursor("default"),this.map.enableMapNavigation(),this.map.setInfoWindowOnClick(!0),c&&c.remove())},_clearAll:function(){this.map.graphics.clear();this.ovMap.graphics.clear();delete this.obliqueExtentGraphic;delete this.noImageExtentGraphic},_addPoint:function(a){var b;b=0<this.config.ObliqueViewer.searchRadius?z.buffer(a,this.config.ObliqueViewer.searchRadius,this.config.ObliqueViewer.searchUnit):
a;this.locatePoint=a;this.oblique.locate(b);this.map.graphics.add(new u(a,this.nativePointSymbol))},_showPoint:function(a){this.ovMap.graphics.clear();this.ovMap.graphics.add(new u(a.point,this.nativePointSymbol))},_addTitlePane:function(){var b=new g({content:'\x3cdiv id\x3d"rasterListDiv"\x3e\x3c/div\x3e'});this.dropDown=new t({label:this.nls.rasterListLabel,showLabel:!1,iconClass:"rastersListIcon",dropDown:b},this.listTitlePaneDiv);this.own(b.on("open",a.hitch(this,this._enableRasterList)),b.on("close",
a.hitch(this,this._disableRasterList)));this.dropDown.startup();F.add(b.domNode,"obliqueViewerWidgetDiv")},_disableRasterList:function(){this.oblique.set("rasterListRefresh",!1)},_enableRasterList:function(){this.oblique.set("rasterListRefresh",!0)},_addZoomButton:function(){this.zoomButton=new k({showLabel:!1,iconClass:"zoomIcon",label:this.nls.zoomButtonLabel,disabled:!1,"class":"zoomButtonContainer"},this.zoomButtonContainer)},_addLocateButton:function(){this.locateButton=new p({showLabel:!1,iconClass:"locateIcon",
label:this.nls.locateButtonLabel,"class":"locateButtonContainer"},this.locateButtonContainer)},_addClearButton:function(){this.clearButton=new k({showLabel:!1,iconClass:"clearIcon",label:this.nls.clearButtonLabel,"class":"clearButtonContainer"},this.clearButtonContainer)},_addSyncButton:function(){this.config.ObliqueViewer.autoSync?y.set(this.syncButtonContainer,"display","none"):this.syncButton=new k({showLabel:!1,iconClass:"syncIcon",label:this.nls.syncButtonLabel,"class":"syncButtonContainer"},
this.syncButtonContainer)},onClose:function(){this._clearAll()},_getLayerUrl:function(a){var b=this.map.itemInfo.itemData.operationalLayers,c,d;for(c in b)if(b.hasOwnProperty(c)&&b[c].title===a){d=b[c];var e=d.layerObject;d=d.url;this.renderingRule=e.renderingRule;this.mosaicRule=e.mosaicRule;this.imageFormat=e.format;this.compressionQuality=e.compressionQuality}return d}})});