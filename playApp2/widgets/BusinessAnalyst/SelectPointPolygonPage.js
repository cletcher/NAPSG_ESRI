// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/BusinessAnalyst/SelectPointPolygonPage.html":'\x3cdiv\x3e\r\n    \x3cbr\x3e\r\n    \x3cdiv\x3e${nls.widgetDescription}\x3c/div\x3e\r\n    \x3cbr\x3e\r\n    \x3cdiv\x3e${nls.selectPointOrPolygon}\x3c/div\x3e\r\n    \x3cbr\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"searchContainer" class\x3d"esriBusinessAnalystSearchContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"activatePinButton" title\x3d"${nls.addPoint}" class\x3d"esriBusinessAnalystPinButton" data-blur-on-click\x3d"true" \x3e\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dojo/dom-class dojo/on dojo/when dijit/_TemplatedMixin dijit/_WidgetBase esri/dijit/Search esri/dijit/geoenrichment/_WizardPage esri/geometry/webMercatorUtils esri/graphic esri/symbols/PictureMarkerSymbol dojo/text!./SelectPointPolygonPage.html ./utils/GeocodeUtil".split(" "),function(h,c,f,k,l,m,n,p,g,q,r,t,u){return h([m,l,p],{templateString:t,postCreate:function(){this.inherited(arguments);var a=this;this.search=(new n({map:this.map})).placeAt(this.searchContainer);this.search.activeSource.outFields.push("country");
this.own(f(this.search,"select-result",function(){a._loadSearchResult()}));this.own(f(this.activatePinButton,"click",function(){a._onActivatePinButtonClick()}))},startup:function(){this._started||c.add(this.layoutGrid.domNode,"business-analyst-search-suggestions-overflow")},_loadSearchResult:function(){this.wizard.selectedPoint.geometry=this.search.selectedResult.feature.geometry;this.wizard.selectedPoint.locationName=this.search.selectedResult.name;var a=g.xyToLngLat(this.search.selectedResult.feature.geometry.x,
this.search.selectedResult.feature.geometry.y);this.wizard.selectedPoint.long=a[0].toFixed(5);this.wizard.selectedPoint.lat=a[1].toFixed(5);this.wizard.setSelectedCountry(this.search.selectedResult.feature.attributes.country);this.onNext()},_onActivatePinButtonClick:function(){this._executeHandler?this._deactivate():this._setActive()},_setActive:function(){this._executeHandler||(c.add(this.activatePinButton,"esriBusinessAnalystPinPressedButton"),this.map.setMapCursor("default"),this.map.disablePan(),
this._executeHandler=f(this.map,"click",this._addPoint.bind(this)))},_deactivate:function(){this._executeHandler&&(c.remove(this.activatePinButton,"esriBusinessAnalystPinPressedButton"),this.map.enablePan(),this._executeHandler.remove(),this._executeHandler=null)},_addPoint:function(a){if(this._executeHandler){this._deactivate();var e=g.xyToLngLat(a.mapPoint.x,a.mapPoint.y),b=this;k(u.reverseGeocode({x:e[0],y:e[1]}),function(d){var c=new r("https://js.arcgis.com/3.28/esri/dijit/Search/images/search-pointer.png",
36,36);b.wizard.selectedPoint.pointGraphic=new q(a.mapPoint,c);b.map.graphics.add(b.wizard.selectedPoint.pointGraphic);b.map.centerAndZoom(a.mapPoint,12);b.wizard.selectedPoint.geometry=a.mapPoint;b.wizard.selectedPoint.locationName=d&&d.address&&d.address.LongLabel?d.address.LongLabel:"";b.wizard.setSelectedCountry(d.address.CountryCode);b.wizard.selectedPoint.long=e[0].toFixed(5);b.wizard.selectedPoint.lat=e[1].toFixed(5);b.onNext()})}}})});