// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/BusinessAnalyst/BAWizard":function(){define("dojo/_base/array dojo/_base/declare dojo/on dojo/when esri/dijit/geoenrichment/_Wizard esri/geometry/webMercatorUtils ./CreateBuffersPage ./NoPermissionsPage ./RunReportsPage ./SelectPointPolygonPage ./utils/GEUtil ./utils/GeocodeUtil".split(" "),function(k,h,e,g,c,b,a,f,d,n,m,l){return h([c],{selectedPoint:{tradeAreas:[]},selectedPolygon:{},selectedCountryID:"",availableCountries:[],name:"BusinessAnalystWizard",baseClass:"jimu-widget-business-analyst-wizard",
postCreate:function(){this.inherited(arguments);var b=this;g(m.hasGEPrivilege(),function(c){c?(b.pages.SELECT_POINT_POLYGON=new n({map:b.map,nls:b.nls,wizard:b,config:b.config,onNext:function(){b._loadCreateBuffersPage()}}),b.pages.CREATE_BUFFERS=new a({map:b.map,nls:b.nls,wizard:b,config:b.config,onBack:function(){b._loadSelectPointPolygonPage()},onNext:function(){b._loadRunReportsPage()}}),b.pages.CREATE_BUFFERS.startup(),b.pages.RUN_REPORTS=new d({map:b.map,nls:b.nls,wizard:b,config:b.config,onBack:function(){b.selectedPoint.geometry?
b._loadCreateBuffersPage():b._loadSelectPointPolygonPage()}}),b.loadPage("SELECT_POINT_POLYGON"),b.own(e(b.map.infoWindow,"Show",function(){b._featureSelected()})),b.own(e(b.map.infoWindow,"Hide",function(){b._featureUnselected()})),b.own(e(b.map.infoWindow,"set-features",function(){b._featureSelected()})),b.own(e(b.map.infoWindow,"selection-change",function(){b._featureSelected()})),b.selectedCountryID=b.config.defaultCountryID,g(m.getAvailableCountries(),function(a){b.availableCountries=a.countries;
b.setSelectedCountry(b.selectedCountryID)}),b.map.infoWindow&&b.map.infoWindow.features&&0<b.map.infoWindow.features.length&&b._featureSelected()):(b.pages.NO_PERMISSIONS=new f({nls:b.nls}),b.pages.NO_PERMISSIONS.startup(),b.loadPage("NO_PERMISSIONS"))})},startup:function(){},clearSelectedPointBuffers:function(){var a=this;k.forEach(this.selectedPoint.tradeAreas,function(b){b&&b.graphic&&a.map.graphics.remove(b.graphic)});this.selectedPoint.tradeAreas=[]},clearSelectedPoint:function(){this.clearSelectedPointBuffers();
this.map.graphics.remove(this.selectedPoint.pointGraphic);this.selectedPoint={tradeAreas:[]}},clearSelectedPolygon:function(){this.selectedPolygon={}},setSelectedCountry:function(a){var b=this;3==a.length?k.forEach(this.availableCountries,function(d){d.abbr3==a&&(b.selectedCountryID=d.id)}):2==a.length&&(this.selectedCountryID=a);this.pages.RUN_REPORTS.loadReportsInfographicsForCountry(this.selectedCountryID)},_loadSelectPointPolygonPage:function(){this.clearSelectedPoint();this.loadPage("SELECT_POINT_POLYGON")},
_loadCreateBuffersPage:function(){this.loadPage("CREATE_BUFFERS");this.pages.CREATE_BUFFERS.refresh()},_loadRunReportsPage:function(){this.loadPage("RUN_REPORTS");this.pages.RUN_REPORTS.refresh()},refreshPage:function(){this.currentPage&&this.currentPage.refresh&&this.currentPage.refresh()},_featureSelected:function(){this.clearSelectedPoint();this.clearSelectedPolygon();var a=this,d=-1<this.map.infoWindow.selectedIndex&&this.map.infoWindow.features&&this.map.infoWindow.features[this.map.infoWindow.selectedIndex];
d&&("point"==d.geometry.type?(this.selectedPoint.geometry=d.geometry,this.selectedPoint.locationName=this._getFeatureName(d),d=b.xyToLngLat(d.geometry.x,d.geometry.y),this.selectedPoint.long=d[0].toFixed(5),this.selectedPoint.lat=d[1].toFixed(5),g(l.reverseGeocode({x:d[0],y:d[1]}),function(b){a.setSelectedCountry(b.address.CountryCode);a._loadCreateBuffersPage()})):"polygon"==d.geometry.type?(this.selectedPolygon.geometry=d.geometry,this.selectedPolygon.locationName=this._getFeatureName(d),this.selectedPolygon.feature=
d,d=d.geometry.getCentroid(),d=b.xyToLngLat(d.x,d.y),g(l.reverseGeocode({x:d[0],y:d[1]}),function(b){a.setSelectedCountry(b.address.CountryCode);a._loadRunReportsPage()})):a._loadSelectPointPolygonPage())},_featureUnselected:function(){this.clearSelectedPoint();this.clearSelectedPolygon();this.pages.SELECT_POINT_POLYGON.search.clear();this._loadSelectPointPolygonPage()},_getFeatureName:function(a){return a.getTitle()?a.getTitle():a._layer.displayField&&a.attributes[a._layer.displayField]?a.attributes[a._layer.displayField]:
""}})})},"esri/dijit/geoenrichment/_Wizard":function(){define(["esri/declare","dojo/_base/lang","dojo/dom-construct","dijit/_WidgetBase","./utils/animation/AnimationHelper"],function(k,h,e,g,c){return k("esri.dijit.geoenrichment._Wizard",g,{currentPage:null,currentPageId:null,_anim:null,pages:null,stacking:"stretch",constructor:function(){this.pages={};this._anim=new c},buildRendering:function(){this.domNode=e.create("div",{"class":"_Wizard_Root"})},loadPage:function(b){var a=this.pages[b],f=this.currentPage;
a!==f&&(this._anim.finish(),f&&this._animPage("Anim_FadeOut").then(h.hitch(this.domNode,"removeChild",f.domNode)),this.currentPage=a,this.currentPageId=b,e.place(this.currentPage.domNode,this.domNode,"first"),f&&this._animPage("Anim_FadeIn"),a._started||(a.set("stacking",this.stacking),a.startup()),a.resize())},_animPage:function(b){return this._anim.start([{node:this.currentPage.domNode,classes:[b,"Wizard_FadeAnim"]}])},resize:function(){this.currentPage&&this.currentPage.resize()},destroy:function(){for(var b in this.pages)this.hasOwnProperty(b)&&
this.pages[b].destroyRecursive();this.pages={};this.inherited(arguments)}})})},"esri/declare":function(){define(["dojo/_base/declare","dojo/_base/lang","./extend"],function(k,h,e){return function(g,c,b){var a=h.isString(g);a?b.declaredClass=g:(b=c,c=g);c=k(c,b);a&&e(g,c);return c}})},"esri/extend":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(k,h,e){return function(g,c){h("extend-esri")&&(g=g.substring(g.indexOf(".")+1),k.setObject(g,c,e))}})},"esri/dijit/geoenrichment/utils/animation/AnimationHelper":function(){define("esri/declare dojo/_base/array dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/sniff dojo/on esri/dijit/geoenrichment/Deferred".split(" "),
function(k,h,e,g,c,b,a,f,d){var n,m;m=!(29>a("chrome")||23>a("ff")||6>a("safari")||10>a("ie"));n=function(a,b){for(var d=function(a){var d=a.type;n=d;for(var f in c)f!==d&&(c[f].remove(),delete c[f]);b.apply(this,arguments)},c={},l=["animationend","webkitAnimationEnd"],m=0;m<l.length;m++)c[l[m]]=f(a,l[m],d);return{remove:function(){for(var a in c)c.hasOwnProperty(a)&&c[a].remove()}}};var l=k(null,{_oldNode:null,_targets:null,_deferred:null,start:function(a,b){this._oldNode=b;this._deferred=new d;
if(!m)return this.finish(),this._deferred.promise;this._targets=a;f.once(a[0].node,n,e.hitch(this,this.finish));for(b=0;b<a.length;b++){var c=a[b];g.add(c.node,c.classes);g.add(c.node,"Anim_Common")}return this._deferred.promise},finish:function(){if(this._targets){for(var a=0;a<this._targets.length;a++){var b=this._targets[a];b.node&&(g.remove(b.node,b.classes),g.remove(b.node,"Anim_Common"))}this._targets=null}this._oldNode&&(this.onNodePreDestroy(this._oldNode),c.destroy(this._oldNode),this._oldNode=
null);this._deferred.resolve()},onNodePreDestroy:function(a){}});return k(null,{progress:null,_items:null,_flySurfaceNode:null,_ltr:b.isBodyLtr(),constructor:function(a){this._flySurfaceNode=a;this._items=[]},start:function(a,b){var f=this,c=new l;c.onNodePreDestroy=function(a){f.onNodePreDestroy(a)};this._items.push(c);this.progress||(this.progress=new d);return c.start(a,b).then(e.hitch(this,this._onItemFinished,c))},_onItemFinished:function(a){a=h.indexOf(this._items,a);0<=a&&(this._items.splice(a,
1),0===this._items.length&&this.progress&&(this.progress.resolve(),this.progress=null))},finish:function(){for(var a=this._items;0<a.length;)a.pop().finish()},fly:function(a,b,d,f){f=f||a.cloneNode(!0);d||(d=["top",this._ltr?"left":"right"]);if(!m)return f;a=a.getBoundingClientRect();var c=this._flySurfaceNode.getBoundingClientRect();g.add(f,"Anim_FlyingObj");for(var n,l,e=0;e<d.length;e++){var p=d[e],q=a[p]-c[p];if("right"===p||"bottom"===p)q=-q;if("left"===p&&!this._ltr||"right"===p&&this._ltr)n=
p,l=q;f.style[p]=q+"px"}this._flySurfaceNode.appendChild(f);n&&(l+=a.width-f.getBoundingClientRect().width,f.style[n]=l+"px");this.start([{node:f,classes:[b]}],f);return f},onNodePreDestroy:function(a){}})})},"esri/dijit/geoenrichment/Deferred":function(){define(["dojo/Deferred"],function(k){return k})},"widgets/BusinessAnalyst/CreateBuffersPage":function(){define("dojo/_base/declare dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin esri/dijit/geoenrichment/_WizardPage esri/geometry/Polygon esri/symbols/SimpleFillSymbol esri/symbols/SimpleLineSymbol esri/Color esri/graphic ./utils/GEUtil ./utils/TravelModeUtil ./utils/ValidationUtil dojo/text!./CreateBuffersPage.html jimu/dijit/TabContainer3 dijit/form/TextBox".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v){return k([e,h,c,g],{templateString:q,postCreate:function(){this.inherited(arguments);this.tab=new v({tabs:[{title:this.nls.rings,content:this.ringsContentPane},{title:this.nls.driveTime,content:this.driveTimeContentPane},{title:this.nls.walkTime,content:this.walkTimeContentPane}],selected:this.nls.rings});this.tab.placeAt(this.ringDtWtTabContainer);this.tab.startup();this._setConfigDefaults()},startup:function(){this.inherited(arguments)},refresh:function(){this._showHideTabs()},
_setConfigDefaults:function(){this._setRadii(this.config.ringDefaults,this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3);this.ringsBufferUnits.set("value",this.config.ringUnitDefault);this._setRadii(this.config.driveTimeDefaults,this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3);this.driveTimeBufferUnits.set("value",this.config.driveTimeUnitDefault);this._setRadii(this.config.walkTimeDefaults,this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3);
this.walkTimeBufferUnits.set("value",this.config.walkTimeUnitDefault)},_showHideTabs:function(){this.config.ringDisabled&&this.tab.removeTab(this.nls.rings);this.config.driveTimeDisabled&&this.tab.removeTab(this.nls.driveTime);this.config.walkTimeDisabled&&this.tab.removeTab(this.nls.walkTime);this.tab.getSelectedTitle()==this.nls.rings&&this.config.ringDisabled&&this.tab.selectTab(this.nls.driveTime);this.tab.getSelectedTitle()==this.nls.driveTime&&this.config.driveTimeDisabled&&this.tab.selectTab(this.nls.walkTime);
this.tab.getSelectedTitle()==this.nls.walkTime&&this.config.walkTimeDisabled&&this.tab.selectTab(this.nls.driveTime)},applyBuffer:function(){if(this._validateInput()){this.shelter.show();var c=this,e=[[16,59,143,1],[0,204,51,1],[204,51,0,1]],p=0,g={},q="",h="",v="";this.tab.getSelectedTitle()==this.nls.rings?(g.areaType="RingBuffer",g.bufferUnits=this.ringsBufferUnits.get("value"),v=this.ringsBufferUnits._getDisplayedValueAttr(),g.bufferRadii=this._getRadii(this.ringsBufferRadii1,this.ringsBufferRadii2,
this.ringsBufferRadii3),q=this.nls.ring):this.tab.getSelectedTitle()==this.nls.driveTime?(g.areaType="NetworkServiceArea",g.bufferUnits=this.driveTimeBufferUnits.get("value"),v=this.driveTimeBufferUnits._getDisplayedValueAttr(),g.bufferRadii=this._getRadii(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3),q=this.nls.driveTime,h="Driving "+("Minutes"==g.bufferUnits?"Time":"Distance")):(g.areaType="NetworkServiceArea",g.bufferUnits=this.walkTimeBufferUnits.get("value"),
v=this.walkTimeBufferUnits._getDisplayedValueAttr(),g.bufferRadii=this._getRadii(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3),q=this.nls.walkTime,h="Walking "+("Minutes"==g.bufferUnits?"Time":"Distance"));var k=[];l.getTravelMode(h).then(function(l){l&&(g.travelMode=l);m.createRingOrDriveTimes({geometry:c.wizard.selectedPoint.geometry,studyAreasOptions:g,sourceCountry:c.wizard.selectedCountryID}).then(function(l){c.wizard.clearSelectedPointBuffers();c.wizard.selectedPoint.areadesc2=
q+c.nls.colon+" "+g.bufferRadii.join(", ")+" "+c.nls["headerDescription_"+v]+" "+c.nls.radii;l=l.results[0].value.FeatureSet[0].features.reverse();var m=g.bufferRadii.reverse(),h;for(h in l){var r=new b({rings:[l[h].geometry.rings[0]],spatialReference:{wkid:102100}});if(c.tab.getSelectedTitle()==c.nls.rings)var t=new a(f.STYLE_SOLID,new f(f.STYLE_SOLID,new d(e[p]),2),new d([255,0,15,0]));else t=new d(e[p]),t.a=.5,t=new a(f.STYLE_SOLID,new f(f.STYLE_SOLID,new d(e[p]),2),t);r=new n(r,t);t={};t.graphic=
r;t.name=c.wizard.selectedPoint.locationName+" - "+m[p]+" "+v;t.shortName=m[p]+" "+v;t.AREA_DESC=m[p]+" "+v;t.AREA_DESC2=q+c.nls.colon+" "+m[p]+" "+c.nls["headerDescription_"+v]+" "+c.nls.radius_lowercase;c.wizard.selectedPoint.tradeAreas.push(t);c.map.graphics.add(r);k.push(r);p++}c.wizard.selectedPoint.tradeAreas=c.wizard.selectedPoint.tradeAreas.reverse();c.map.setExtent(c.wizard.selectedPoint.tradeAreas[c.wizard.selectedPoint.tradeAreas.length-1].graphic._extent);c.shelter.hide();c.onNext()},
function(a){alert("Error: "+a);c.shelter.hide()})})}},backOnClick:function(){this.onBack()},_getRadii:function(a,b,d){a=a.get("value");b=b.get("value");d=d.get("value");var f=[];""!=a&&f.push(a);""!=b&&f.push(b);""!=d&&f.push(d);return f},_setRadii:function(a,b,d,f){0<a.length?b.set("value",a[0]):b.set("value","");1<a.length?d.set("value",a[1]):d.set("value","");2<a.length?f.set("value",a[2]):f.set("value","")},_validateInput:function(){var a=!0,a=this.tab.getSelectedTitle()==this.nls.rings?p.validateInvalidValues(this.ringsBufferRadii1,
this.ringsBufferRadii2,this.ringsBufferRadii3,this.ringValidationErrorMessage,this.nls.thisEntryIsNotValid):this.tab.getSelectedTitle()==this.nls.driveTime?p.validateInvalidValues(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,this.driveTimeValidationErrorMessage,this.nls.thisEntryIsNotValid):p.validateInvalidValues(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,this.walkTimeValidationErrorMessage,this.nls.thisEntryIsNotValid);return a?
(a=this.tab.getSelectedTitle()==this.nls.rings?p.validateMinMaxValues(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3,p.MIN_RINGS_VALUE,p.MAX_RINGS_VALUE,this.ringValidationErrorMessage,this.nls.invalidValueRing):this.tab.getSelectedTitle()==this.nls.driveTime?p.validateMinMaxValues(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,p.MIN_DTWT_VALUE,p.MAX_DTWT_VALUE,this.driveTimeValidationErrorMessage,this.nls.invalidValueDTWT):p.validateMinMaxValues(this.walkTimeBufferRadii1,
this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,p.MIN_DTWT_VALUE,p.MAX_DTWT_VALUE,this.walkTimeValidationErrorMessage,this.nls.invalidValueDTWT))?!0:!1:!1}})})},"esri/dijit/geoenrichment/_WizardPage":function(){define("esri/declare dojo/_base/lang dojo/string dojox/mvc/Templated ./Grid ./ProgressHandler dojo/text!./templates/_WizardPage.html".split(" "),function(k,h,e,g,c,b,a){return k("esri.dijit.geoenrichment._WizardPage",g,{buttonsNode:null,_progressHandler:null,buildRendering:function(){var b=
this.templateString;b&&"\ufeff"==b[0]&&(b=b.substr(1));this.templateString=e.substitute(a,{content:b});this.inherited(arguments);this.layoutGrid.rows=[c.AUTO,c.AUTO,c.AUTO]},resize:function(){this.layoutGrid.resize()},_setStackingAttr:function(a){switch(a){case "stretch":this.layoutGrid.rows[1]=c.STRETCH;break;case "stack":this.layoutGrid.rows[1]=c.STACK}},showProgress:function(a,d){this._progressHandler||(this._progressHandler=new b(this.progressDiv,{queryNode:this.domNode}),this.own(this._progressHandler));
a=this._progressHandler.showProgress(a,"string"==typeof d?d:"");d=d?"function"==typeof d?d:this[d]:null;"function"==typeof d&&a.then(h.hitch(this,d));return a},cancelProgress:function(a){this._progressHandler&&this._progressHandler.cancelProgress("string"==typeof a?a:"")}})})},"dojox/mvc/Templated":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ./at".split(" "),function(k,h,e,g,c){return k("dojox.mvc.Templated",[e,g,c],{bindings:null,
startup:function(){var b=h.isFunction(this.bindings)&&this.bindings.call(this)||this.bindings,a;for(a in b){var f=this[a],d=b[a];if(f)for(var c in d)f.set(c,d[c]);else console.warn("Widget with the following attach point was not found: "+a)}this.inherited(arguments)}})})},"dojox/mvc/at":function(){define(["dojo/_base/kernel","dojo/_base/lang","./sync","./_atBindingExtension"],function(k,h,e){k.experimental("dojox.mvc");k=function(g,c){return{atsignature:"dojox.mvc.at",target:g,targetProp:c,bindDirection:e.both,
direction:function(b){this.bindDirection=b;return this},transform:function(b){this.converter=b;return this},equals:function(b){this.equalsCallback=b;return this}}};k.from=e.from;k.to=e.to;k.both=e.both;return h.setObject("dojox.mvc.at",k)})},"dojox/mvc/sync":function(){define(["dojo/_base/lang","dojo/_base/config","dojo/_base/array","dojo/has"],function(k,h,e,g){function c(a,b,c,l,p,q,h,r,u,t){if(!(c(u,r)||"*"==p&&0>e.indexOf(l.get("properties")||[h],h)||"*"==p&&h in(t||{}))){c="*"==p?h:p;if(g("mvc-bindings-log-api"))var d=
f(l,c,q,h);try{u=a?a(u,b):u}catch(w){g("mvc-bindings-log-api")&&console.log("Copy from"+d.join(" to ")+" was not done as an error is thrown in the converter.");return}g("mvc-bindings-log-api")&&console.log(d.reverse().join(" is being copied from: ")+" (Value: "+u+" from "+r+")");k.isFunction(l.set)?l.set(c,u):l[c]=u}}var b=k.getObject("dojox.mvc",!0);g.add("mvc-bindings-log-api",(h.mvc||{}).debugBindings);var a,f=g("mvc-bindings-log-api")?function(a,b,f,c){return[[f.canConvertToLoggable||!f.declaredClass?
f:f.declaredClass,c].join(":"),[a.canConvertToLoggable||!a.declaredClass?a:a.declaredClass,b].join(":")]}:"";h={from:1,to:2,both:3};a=function(d,n,m,l,p){var q=(p||{}).converter,h,r,u;q&&(h={source:d,target:m},r=q.format&&k.hitch(h,q.format),u=q.parse&&k.hitch(h,q.parse));var t=[],z=[],w=k.mixin({},d.constraints,m.constraints),q=(p||{}).bindDirection||b.both,C=(p||{}).equals||a.equals;if(g("mvc-bindings-log-api"))var A=f(d,n,m,l);if("*"==l){if("*"!=n)throw Error("Unmatched wildcard is specified between source and target.");
p=m.get("properties");if(!p){p=[];for(var B in m)m.hasOwnProperty(B)&&"_watchCallbacks"!=B&&p.push(B)}z=m.get("excludes")}else p=[n];q&b.from&&(k.isFunction(d.set)&&k.isFunction(d.watch)?t.push(d.watch.apply(d,("*"!=n?[n]:[]).concat([function(a,b,f){c(r,w,C,m,l,d,a,b,f,z)}]))):g("mvc-bindings-log-api")&&console.log(A.reverse().join(" is not a stateful property. Its change is not reflected to ")+"."),e.forEach(p,function(a){if("*"!=l||!(a in(z||{}))){var b=k.isFunction(d.get)?d.get(a):d[a];c(r,w,C,
m,"*"==l?a:l,d,a,void 0,b)}}));q&b.to&&(q&b.from||e.forEach(p,function(a){if("*"!=l||!(a in(z||{}))){var b=k.isFunction(m.get)?m.get(l):m[l];c(u,w,C,d,a,m,"*"==l?a:l,void 0,b)}}),k.isFunction(m.set)&&k.isFunction(m.watch)?t.push(m.watch.apply(m,("*"!=l?[l]:[]).concat([function(a,b,f){c(u,w,C,d,n,m,a,b,f,z)}]))):g("mvc-bindings-log-api")&&console.log(A.join(" is not a stateful property. Its change is not reflected to ")+"."));g("mvc-bindings-log-api")&&console.log(A.join(" is bound to: "));B={};B.unwatch=
B.remove=function(){for(var a=null;a=t.pop();)a.unwatch();g("mvc-bindings-log-api")&&console.log(A.join(" is unbound from: "))};return B};k.mixin(b,h);return k.setObject("dojox.mvc.sync",k.mixin(a,{equals:function(a,b){return a===b||"number"==typeof a&&isNaN(a)&&"number"==typeof b&&isNaN(b)||k.isFunction((a||{}).getTime)&&k.isFunction((b||{}).getTime)&&a.getTime()==b.getTime()||(k.isFunction((a||{}).equals)?a.equals(b):k.isFunction((b||{}).equals)?b.equals(a):!1)}},h))})},"dojox/mvc/_atBindingExtension":function(){define(["dojo/_base/config",
"dojo/has","dijit/_WidgetBase","./atBindingExtension"],function(k,h,e,g){h.add("mvc-extension-per-widget",(k.mvc||{}).extensionPerWidget);h("mvc-extension-per-widget")||g(e.prototype)})},"dojox/mvc/atBindingExtension":function(){define("dojo/aspect dojo/_base/array dojo/_base/lang dijit/_WidgetBase ./_atBindingMixin dijit/registry".split(" "),function(k,h,e,g,c){return function(b){h.forEach(arguments,function(a){a.dataBindAttr?console.warn("Detected a widget or a widget class that has already been applied data binding extension. Skipping..."):
(e._mixin(a,c.mixin),k.before(a,"postscript",function(a,b){this._dbpostscript(a,b)}),k.before(a,"startup",function(){this._started||this._startAtWatchHandles()}),k.before(a,"destroy",function(){this._stopAtWatchHandles()}),k.around(a,"set",function(a){return function(b,f){return b==c.prototype.dataBindAttr?this._setBind(f):"dojox.mvc.at"==(f||{}).atsignature?this._setAtWatchHandle(b,f):a.apply(this,e._toArray(arguments))}}))});return arguments}})},"dojox/mvc/_atBindingMixin":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/has dojo/Stateful ./resolve ./sync".split(" "),
function(k,h,e,g,c,b,a){function f(a){var b;try{b=require("dijit/registry")}catch(r){return}for(a=a.domNode&&a.domNode.parentNode;a;){if(a=b.getEnclosingWidget(a)){var d=a._relTargetProp||"target";if((h.isFunction(a.get)?a.get(d):a[d])||d in a.constructor.prototype)return a}a=a&&a.domNode.parentNode}}function d(d,c,l,e,k){function p(){q.Two&&q.Two.unwatch();delete q.Two;var f=v&&(h.isFunction(v.get)?v.get(r):v[r]),p=b(d,f),f=b(l,f);g("mvc-bindings-log-api")&&(!p||/^rel:/.test(d)&&!v)&&m(d,c);g("mvc-bindings-log-api")&&
(!f||/^rel:/.test(l)&&!v)&&m(l,e);p&&f&&(!/^rel:/.test(d)&&!/^rel:/.test(l)||v)&&(p.set&&p.watch||"*"!=c?null==c?(h.isFunction(f.set)?f.set(e,p):f[e]=p,g("mvc-bindings-log-api")&&console.log("dojox/mvc/_atBindingMixin set "+p+" to: "+n(f,e))):q.Two=a(p,c,f,e,k):g("mvc-bindings-log-api")&&m(d,c))}var q={},v=f(l),r=v&&v._relTargetProp||"target";p();if(v&&/^rel:/.test(d)||/^rel:/.test(l)&&h.isFunction(v.set)&&h.isFunction(v.watch))q.rel=v.watch(r,function(a,b,d){b!==d&&(g("mvc-bindings-log-api")&&console.log("Change in relative data binding target: "+
v),p())});var A={};A.unwatch=A.remove=function(){for(var a in q)q[a]&&q[a].unwatch(),delete q[a]};return A}var n=g("mvc-bindings-log-api")?function(a,b){return[a._setIdAttr||!a.declaredClass?a:a.declaredClass,b].join(":")}:"",m=g("mvc-bindings-log-api")?function(a,b){console.warn(b+" could not be resolved"+("string"==typeof a?" with "+a:"")+".")}:"",l={dataBindAttr:"data-mvc-bindings",_dbpostscript:function(a,b){b=this._refs=(a||{}).refs||{};for(var d in a)if("dojox.mvc.at"==(a[d]||{}).atsignature){var f=
a[d];delete a[d];b[d]=f}var f=new c,n=this;f.toString=function(){return"[Mixin value of widget "+n.declaredClass+", "+(n.id||"NO ID")+"]"};f.canConvertToLoggable=!0;this._startAtWatchHandles(f);for(d in b)void 0!==f[d]&&((a=a||{})[d]=f[d]);this._stopAtWatchHandles()},_startAtWatchHandles:function(a){this.canConvertToLoggable=!0;var b=this._refs;if(b){var f=this._atWatchHandles=this._atWatchHandles||{};this._excludes=null;for(var c in b)b[c]&&"*"!=c&&(f[c]=d(b[c].target,b[c].targetProp,a||this,c,{bindDirection:b[c].bindDirection,
converter:b[c].converter,equals:b[c].equalsCallback}));"dojox.mvc.at"==(b["*"]||{}).atsignature&&(f["*"]=d(b["*"].target,b["*"].targetProp,a||this,"*",{bindDirection:b["*"].bindDirection,converter:b["*"].converter,equals:b["*"].equalsCallback}))}},_stopAtWatchHandles:function(){for(var a in this._atWatchHandles)this._atWatchHandles[a].unwatch(),delete this._atWatchHandles[a]},_setAtWatchHandle:function(a,b){if("ref"==a)throw Error(this+": 1.7 ref syntax used in conjunction with 1.8 dojox/mvc/at syntax, which is not supported.");
var f=this._atWatchHandles=this._atWatchHandles||{};f[a]&&(f[a].unwatch(),delete f[a]);this._excludes=this[a]=null;this._started?f[a]=d(b.target,b.targetProp,this,a,{bindDirection:b.bindDirection,converter:b.converter,equals:b.equalsCallback}):this._refs[a]=b},_setBind:function(a){a=eval("({"+a+"})");for(var b in a){var d=a[b];"dojox.mvc.at"!=(d||{}).atsignature?console.warn(b+" in "+dataBindAttr+" is not a data binding handle."):this._setAtWatchHandle(b,d)}},_getExcludesAttr:function(){if(this._excludes)return this._excludes;
var a=[],b;for(b in this._atWatchHandles)"*"!=b&&a.push(b);return a},_getPropertiesAttr:function(){if(this.constructor._attribs)return this.constructor._attribs;var a=["onClick"].concat(this.constructor._setterAttrs);k.forEach(["id","excludes","properties","ref","binding"],function(b){b=k.indexOf(a,b);0<=b&&a.splice(b,1)});return this.constructor._attribs=a}};l[l.dataBindAttr]="";e=e("dojox/mvc/_atBindingMixin",null,l);e.mixin=l;return e})},"dojox/mvc/resolve":function(){define(["dojo/_base/lang",
"dijit/registry","dojo/Stateful"],function(k,h){return k.setObject("dojox.mvc.resolve",function(e,g){if("string"==typeof e){var c=e.match(/^(expr|rel|widget):(.*)$/)||[];try{e="rel"==c[1]?k.getObject(c[2]||"",!1,g):"widget"==c[1]?h.byId(c[2]):k.getObject(c[2]||e,!1,g)}catch(b){}}return e})})},"esri/dijit/geoenrichment/Grid":function(){define(["../../declare","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dijit/layout/_LayoutWidget"],function(k,h,e,g,c){var b=k("esri.dijit.geoenrichment.Grid",
[c],{_placeholder:null,layout:function(){var a=this.getChildren(),f=[],d,c,m;for(d=0;d<this.rows.length;d++)f.push(0);h.add(this.domNode,"Grid_Measure");var l=[];for(d=0;d<a.length;d++){c=a[d];m=c.row;c=c.domNode;c.style.position="absolute";h.add(c,"GridCell_Measure");var p=c.scrollHeight;h.remove(c,"GridCell_Measure");c=p;l.push(c);c>f[m]&&(f[m]=c)}m=g.getContentBox(this.domNode).h;h.remove(this.domNode,"Grid_Measure");d=this.rows;for(c=l=0;c<f.length;c++)switch(d[c]){case b.AUTO:m-=f[c];break;case b.STRETCH:case b.STACK:l++}if(1<
l)throw Error("Multiple rows with flexible heights are not supported");l=[0];for(c=0;c<f.length;c++){var q;switch(d[c]){case b.AUTO:q=f[c];break;case b.STRETCH:q=m;break;case b.STACK:q=Math.min(m,f[c])}l.push(l[c]+q)}for(d=0;d<a.length;d++)c=a[d],m=c.row,f=l[m+1]-l[m],q=c.domNode.style,q.top=l[m]+"px",q.height=f+"px";this._placeholder||(this._placeholder=e.create("div",null,this.domNode));this._placeholder.style.height=l[l.length-1]+"px"}});b.AUTO="auto";b.STRETCH="stretch";b.STACK="stack";return b})},
"esri/dijit/geoenrichment/ProgressHandler":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/when","dojo/dom-class","dojo/query"],function(k,h,e,g){return k(null,{progressNode:null,progressPromises:null,busyClass:null,errorClass:null,_allStates:null,constructor:function(c,b){b=b||{};this.busyClass=b.busyClass||"Wizard_Loading";this.errorClass=b.errorClass||"Wizard_Error";this._allStates=[this.busyClass,this.errorClass];var a=b.progressClass||"Wizard_Progress";c?(this.progressNode=
c,e.add(this.progressNode,a)):b.queryNode&&(this.progressNode=g("."+a,b.queryNode)[0]);this.progressPromises={}},showProgress:function(c,b){function a(){if(f.progressPromises[b]===c)return delete f.progressPromises[b],!0}b=b||"";c=h(c);if(c.isFulfilled())return this.progressPromises[b]&&(delete this.progressPromises[b],this._setState("done")),c;this.progressPromises[b]=c;var f=this;this._setState("busy");c.then(function(){a()&&f._setState("done")},function(b){a()&&("CancelError"==b.name?f._setState("done"):
f._setState("error",b.toString()))});return c},cancelProgress:function(c){c=c||"";this.progressPromises[c]&&this.progressPromises[c].cancel()},_setState:function(c,b){!this.progressNode||"done"==c&&Object.keys(this.progressPromises).length||(this.progressNode.innerHTML=b||"",e.remove(this.progressNode,this._allStates),"done"!=c&&e.add(this.progressNode,this[c+"Class"]))},destroy:function(){for(var c=Object.keys(this.progressPromises),b=0;b<c.length;b++)this.cancelProgress(c[b])}})})},"esri/dijit/geoenrichment/when":function(){define(["dojo/when"],
function(k){return k})},"widgets/BusinessAnalyst/utils/GEUtil":function(){define(["dojo/_base/array","esri/request","esri/dijit/geoenrichment/utils/FileUtil","jimu/portalUtils"],function(k,h,e,g){return{getAvailableCountries:function(){return g.getPortal(portalUrl).loadSelfInfo().then(function(c){return h({url:(c&&c.helperServices&&c.helperServices.geoenrichment&&c.helperServices.geoenrichment.url?c.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+
"/Geoenrichment/Countries",content:{appID:"webappbuilder",f:"json",langCode:"en-us"},handleAs:"json"})})},createRingOrDriveTimes:function(c){return g.getPortal(portalUrl).loadSelfInfo().then(function(b){return h({url:(b&&b.helperServices&&b.helperServices.geoenrichment&&b.helperServices.geoenrichment.url?b.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Enrich",content:{appID:"webappbuilder",f:"json",langCode:"en-us",
useData:JSON.stringify({sourceCountry:c.sourceCountry}),studyAreasOptions:JSON.stringify(c.studyAreasOptions),dataCollections:JSON.stringify(["GlobalIntersect"]),returnGeometry:!0,outSR:JSON.stringify({wkid:102100}),studyAreas:JSON.stringify([{geometry:c.geometry}]),token:esri.id.credentials[0].token},handleAs:"json"})})},createReport:function(c){var b={appID:"webappbuilder",langCode:"en-us",report:"string"===typeof c.report?c.report:JSON.stringify(c.report),format:"pdf",f:"bin",token:esri.id.credentials[0].token,
useData:JSON.stringify({sourceCountry:c.sourceCountry}),studyAreas:JSON.stringify(c.studyAreas),reportFields:JSON.stringify({locationname:c.locationName,latitude:c.lat,longitude:c.long,subtitle:"Prepared by Esri",areadesc2:c.areadesc2})};return g.getPortal(portalUrl).loadSelfInfo().then(function(a){return h({url:(a&&a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+
"/Geoenrichment/createReport",content:b,handleAs:"blob"}).then(function(a){return e.saveAs(a,c.reportDownloadName)}).otherwise(function(a){alert("Error: "+a)})})},hasGEPrivilege:function(){return g.getPortal(portalUrl).loadSelfInfo().then(function(c){var b=!1,a=!1;k.forEach(c&&c.user&&c.user.privileges,function(f){"premium:user:geoenrichment"==f?b=!0:"premium:user:networkanalysis"==f&&(a=!0)});return b&&a})}}})},"esri/dijit/geoenrichment/utils/FileUtil":function(){define(["esri/dijit/geoenrichment/Deferred",
"./DataUtil","./ImageUtil"],function(k,h,e){function g(){return new k.reject(Error("Saving not supported."))}var c=g,b=/[\\/:*?"<>|]/g,a={savingSupported:function(){return void 0!==window.Blob},saveTextFile:function(b,d,f){return a.savingSupported()?a.saveAs(new Blob([b],{type:f||"text/plain"}),d||"text.txt"):g()},saveImageFile:function(b,d){if(a.savingSupported()){var f;"string"===typeof b?(f=e.base64DataFromDataURL(b),f=h.binaryStringToByteArray(atob(f)).buffer):b instanceof ArrayBuffer&&(f=b);
return a.saveAs(f?h.arrayBuffersToBlob([f],"image/png"):b,d)}g()},saveAs:function(b,d){return c(b,a.validateName(d||"download"))},validateName:function(a){return String(a).trim().replace(b,"")}};if(!a.savingSupported())return a;if(window.navigator&&window.navigator.msSaveOrOpenBlob)return c=function(a,b){var d=new k;window.navigator.msSaveOrOpenBlob(a,b)?d.resolve():d.reject(Error("Failed to save or open downloaded file."));return d.promise},a;var f=window.URL||window.webkitURL;if("download"in window.document.createElement("a")){var d=
function(a){var b;void 0!==window.MouseEvent?b=new MouseEvent("click",{bubbles:!0,cancelable:!1}):(b=document.createEvent("MouseEvent"),b.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null));a.dispatchEvent(b)},c=function(a,b){var c=new k,n=f.createObjectURL(a);a=window.document.createElement("a");a.href=n;a.download=b;d(a);setTimeout(function(){f.revokeObjectURL(n);c.resolve()},1E3);return c.promise};return a}c=function(a,b){var d=new k;a=new File([a],b,{type:a.type});var c=f.createObjectURL(a);
window.open(c,"_blank");setTimeout(function(){f.revokeObjectURL(c);d.resolve()},1E3);return d.promise};return a})},"esri/dijit/geoenrichment/utils/DataUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(k,h){function e(a){return"string"==typeof a?{source:a,getLength:function(){return this.source.length},getByte:function(a){return this.source.charCodeAt(a)&255}}:window.ArrayBuffer&&a instanceof ArrayBuffer?{source:new Uint8Array(a),getLength:function(){return this.source.byteLength},
getByte:function(a){return this.source[a]}}:a}function g(a){for(var b=a.length,d=new Uint8Array(a.length),c=0;c<b;c++)d[c]=a.charCodeAt(c);return d}function c(a,b){a=new Uint8Array(a);b=Math.min(b,a.byteLength);for(var d="",f=0;f<b;f++)d+=String.fromCharCode(a[f]);return d}var b={arrayBufferFromBlob:function(a){var b=new k,d=new FileReader;d.onloadend=function(){d.error?b.reject(d.error):b.resolve(d.result)};d.readAsArrayBuffer(a);return b.promise},arrayBuffersToBlob:function(a,b){return new Blob(a,
{type:b||"application/octet-stream"})},binaryStringFromByteSource:function(a){if("string"==typeof a)return a;a=e(a);for(var b=a.getLength(),d=b%4,b=b-d,c="",m=0,l,g,q,h;m<b;)l=a.getByte(m++),g=a.getByte(m++),q=a.getByte(m++),h=a.getByte(m++),c+=String.fromCharCode(l,g,q,h);1==d?c+=String.fromCharCode(a.getByte(m)):2==d?c+=String.fromCharCode(a.getByte(m),a.getByte(m+1)):3==d&&(c+=String.fromCharCode(a.getByte(m),a.getByte(m+1),a.getByte(m+2)));return c},base64FromByteSource:function(a){a=e(a);for(var b=
a.getLength(),d=b%3,b=b-d,c,m,l,g,q="",h=0;h<b;h+=3)g=a.getByte(h)<<16|a.getByte(h+1)<<8|a.getByte(h+2),c=g>>18&63,m=g>>12&63,l=g>>6&63,g&=63,q+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[c]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[l]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g];1==d?(g=a.getByte(h),q+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g>>
2&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g<<4&63]+"\x3d\x3d"):2==d&&(g=a.getByte(h)<<8|a.getByte(h+1),q+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g>>10&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g>>4&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g<<2&63]+"\x3d");return q}};b.binaryStringToByteArray=g;b.base64ToByteArray=function(a){return g(atob(a))};b.getFirstBytes=function(a,b){var d;if("string"==
typeof a)d=a.substr(0,b);else if(window.ArrayBuffer&&a instanceof ArrayBuffer)d=c(a,b);else if(window.Blob&&a instanceof Blob){d=new k;var f=new FileReader;f.onloadend=function(){f.error?d.resolve(""):d.resolve(c(f.result,b))};f.readAsArrayBuffer(a.slice(0,b))}return h(d||"")};b.isBase64=function(a){return a&&0==a.length%4&&/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+\/]+$/.test(a.replace(/={0,2}$/,""))};b.getContentType=function(a){var b=a.lastIndexOf(".")+1;if(!b)return null;
switch(a.substr(b).toLowerCase()){case "png":return"image/png";case "jpg":case "jpeg":return"image/jpeg";case "gif":return"image/gif";case "json":return"application/json";case "txt":return"text/plain";case "xml":return"text/xml";default:return null}};return b})},"esri/dijit/geoenrichment/utils/ImageUtil":function(){define(["esri/dijit/geoenrichment/Deferred","dojo/dom-construct","esri/dijit/geoenrichment/when"],function(k,h,e){var g={base64DataToDataURL:function(c,b){if(/^data:image/.test(c))return c;
b||(b=atob(c.substr(0,16)),b=g.getImageContentType(b));return"data:"+(b||"image/png")+";base64,"+c},getImageContentType:function(c){if("\u00ff\u00d8\u00ff"==c.substr(0,3)&&"JFIF"==c.substr(6,4))return"image/jpeg";if("\u0089PNG\r\n\u001a\n"==c.substr(0,8))return"image/png";if("GIF89a"==c.substr(0,6)||"GIF87a"==c.substr(0,6))return"image/gif"},base64DataFromDataURL:function(c){0==c.indexOf("data:")&&(c=c.substr(c.indexOf(",")+1));return c},getBase64DataIndex:function(c){c=0==c.indexOf("data:")?c.indexOf(";base64,"):
-1;return 0<c?c+8:0},getContentType:function(c){var b=g.getBase64DataIndex(c);return b?c.substring(5,b-8):null},checkBase64FileSize:function(c,b){return g.getBase64FileSize(c)<=b},getBase64FileSize:function(c){return.75*c.length},imageToDataURL:function(c,b){b=b||{};var a=document.createElement("canvas"),f=a.getContext("2d");a.width=b.width||c.width;a.height=b.height||c.height;var d=b.opacity;null!=d&&!isNaN(d)&&0<=d&&1>d&&(f.globalAlpha=+d,b.format="image/png");(d=b.pos)?f.drawImage(c,d.x||0,d.y||
0):f.drawImage(c,0,0,a.width,a.height);return a.toDataURL(b.format)},imageFromUrl:function(c){var b=new k,a=new Image;0!==c.indexOf("data:")&&a.setAttribute("crossOrigin","anonymous");a.onload=function(){a.width&&a.height?b.resolve(a):b.reject(Error("Error of reading an image from URL."));h.destroy(a)};a.onerror=function(f){b.reject(f);h.destroy(a)};a.src=require.toUrl(c);return b.promise},scaleImage:function(c,b){if("string"===typeof c)var a=g.base64DataToDataURL(c),f=g.getContentType(a),a=g.imageFromUrl(a);
return e(a||c).then(function(a){var d=1,c=a.width,l=a.height;if(b.factor)d=b.factor;else if(b.maxDim)d=b.maxDim/Math.max(c,l);else if(b.imageDim){var e=b.imageDim.w,q=b.imageDim.h;b.imageDim.preserveRatio?(d=Math.min(e/c,q/l),b.imageDim.reduceOnly&&1<d&&(d=1)):b.imageDim.reduceOnly?(c=Math.min(c,e),l=Math.min(l,q)):(c=e,l=q)}return g.imageToDataURL(a,{width:c*d,height:l*d,format:b.format||f,opacity:b.opacity})})}};return g})},"widgets/BusinessAnalyst/utils/TravelModeUtil":function(){define(["esri/request",
"jimu/portalUtils","dojo/_base/array","dojo/Deferred","dojo/when"],function(k,h,e,g,c){var b=null;return{getTravelMode:function(a){return c(this._getTravelModes(),function(b){var d="";e.forEach(b.results,function(b){"supportedTravelModes"==b.paramName&&e.forEach(b.value.features,function(b){b.attributes&&b.attributes.Name==a&&(d=b.attributes.TravelMode)})});return d})},_getTravelModes:function(){b||(b=new g,h.getPortal(portalUrl).loadSelfInfo().then(function(a){k({url:a.helperServices.routingUtilities.url+
"/GetTravelModes/execute",content:{appID:"webappbuilder",f:"json",langCode:"en-us"},handleAs:"json"}).then(function(a){b.resolve(a)})}));return b}}})},"widgets/BusinessAnalyst/utils/ValidationUtil":function(){define(["dojo/dom-class"],function(k){return{MIN_RINGS_VALUE:0,MAX_RINGS_VALUE:1E3,MIN_DTWT_VALUE:0,MAX_DTWT_VALUE:300,validateInvalidValues:function(h,e,g,c,b){var a=h.get("value"),f=e.get("value"),d=g.get("value"),n=!0;0<a.length&&null===this._tryParseFloat(a)?(n=!1,k.remove(c,"hidden"),c.innerHTML=
b,k.add(h.domNode,"invalidValue")):k.remove(h.domNode,"invalidValue");0<f.length&&null===this._tryParseFloat(f)?(n=!1,k.remove(c,"hidden"),c.innerHTML=b,k.add(e.domNode,"invalidValue")):k.remove(e.domNode,"invalidValue");0<d.length&&null===this._tryParseFloat(d)?(n=!1,k.remove(c,"hidden"),c.innerHTML=b,k.add(g.domNode,"invalidValue")):k.remove(g.domNode,"invalidValue");n&&k.add(c,"hidden");return n},validateMinMaxValues:function(h,e,g,c,b,a,f){var d=h.get("value"),n=e.get("value"),m=g.get("value"),
l=!0;0<d.length?(d=parseFloat(d),d<c||d>b?(l=!1,k.remove(a,"hidden"),a.innerHTML=f,k.add(h.domNode,"invalidValue")):k.remove(h.domNode,"invalidValue")):k.remove(h.domNode,"invalidValue");0<n.length?(d=parseFloat(n),d<c||d>b?(l=!1,k.remove(a,"hidden"),a.innerHTML=f,k.add(e.domNode,"invalidValue")):k.remove(e.domNode,"invalidValue")):k.remove(e.domNode,"invalidValue");0<m.length?(d=parseFloat(m),d<c||d>b?(l=!1,k.remove(a,"hidden"),a.innerHTML=f,k.add(g.domNode,"invalidValue")):k.remove(g.domNode,"invalidValue")):
k.remove(g.domNode,"invalidValue");l&&k.add(a,"hidden");return l},_tryParseFloat:function(h){var e=null;null!==h&&0<h.length&&(isNaN(h)||(e=parseFloat(h)));return e}}})},"widgets/BusinessAnalyst/NoPermissionsPage":function(){define(["dojo/_base/declare","dijit/_TemplatedMixin","dijit/_WidgetBase","esri/dijit/geoenrichment/_WizardPage","dojo/text!./NoPermissionsPage.html"],function(k,h,e,g,c){return k([e,h,g],{templateString:c,postCreate:function(){this.inherited(arguments);this.permissionsDiv.innerHTML=
this.nls.noPermissions},startup:function(){this.inherited(arguments)}})})},"widgets/BusinessAnalyst/RunReportsPage":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/dom-style dojo/query dojo/when dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin esri/dijit/geoenrichment/SelectableTree esri/dijit/geoenrichment/ReportPlayer/ReportPlayer esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes esri/dijit/geoenrichment/ReportPlayer/PlayerThemes esri/dijit/geoenrichment/ReportPlayer/DataProviderGE esri/dijit/geoenrichment/ReportPlayer/PlayerCommands esri/dijit/geoenrichment/_WizardPage esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/ReportTemplateTypes ./utils/GEUtil ./utils/ReportUtil ./esriAnalystX/widgets/Selects/FilteringSelectTree dojo/text!./RunReportsPage.html jimu/dijit/TabContainer3 jimu/utils".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v,r,u,t,z,w,C,A,B,y){return h([d,f,u,n],{templateString:A,infographicsTabHidden:!1,reportsTabHidden:!1,_infograpicReports:null,_configForLightTheme:[{name:"DashboardTheme",style:"light"}],postCreate:function(){this.inherited(arguments);this.tab=new B({tabs:[{title:this.nls.infographics,content:this.infographicsContentPane},{title:this.nls.reports,content:this.reportsContentPane}],selected:this.nls.infographics});this.tab.placeAt(this.runReportTabContainer);this.tab.startup()},
startup:function(){this.inherited(arguments)},loadReportsInfographicsForCountry:function(b){var d=this;a(w.getAvailableClassicReports(b,this.config),function(a){d.filteredReportDropDown?d.filteredReportDropDown.set("tree",new m(a)):(d.filteredReportDropDown=new C({name:"filteredReportSelect",tree:new m(a),defaultExpand:{esriReports:!0},placeHolder:d.nls.selectReport,onChange:function(a){d._enableDisableButton(d.runReportBtn,a)}},d.reportFilteringSelectDropDownContainer),d.filteredReportDropDown.startup());
d.reportsTabHidden=d.config.reportsDisabled||!d._areReportsAvailable(a)});a(w.getAvailableInfographicReports(b,this.config),function(a){d.infographicDropDown?d.infographicDropDown.set("tree",new m(a)):(d.infographicDropDown=new C({name:"filteredInfographicReportSelect",tree:new m(a),defaultExpand:{esriReports:!0},placeHolder:d.nls.selectTemplate,onChange:function(a){d._enableDisableButton(d.runInfographicBtn,a)}},d.infographicDropDownContainer),d.infographicDropDown.startup());d.infographicsTabHidden=
d.config.infographicsDisabled||!d._areReportsAvailable(a);d._infograpicReports=a})},_areReportsAvailable:function(a){if(0==a.length)return!1;var b=!1;k.forEach(a,function(a){0<a.children.length&&(b=!0)});return b},refresh:function(){this._hideOrShowTabs()},_hideOrShowTabs:function(){this.infographicsTabHidden&&(this.tab.removeTab(this.nls.infographics),this.tab.selectTab(this.nls.reports));this.reportsTabHidden&&(this.tab.removeTab(this.nls.reports),this.tab.selectTab(this.nls.infographics))},runInfographic:function(){if(!e.contains(this.runInfographicBtn,
"jimu-state-disabled")){var a=this,b=this.infographicDropDown.get("value");this.reportPlayer&&this.reportPlayer.destroy();this.playerDiv&&g.destroy(this.playerDiv);this.playerDiv=g.create("div",null,document.body);var d=new v;d.registerCommand(r.PDF);d.registerCommand(r.IMAGE);d.registerCommand(r.PRINT);d.registerCommand(r.DYNAMIC_HTML);var f=y.isMobileUa();this.reportPlayer=(new l({isSlidesView:f?!0:!1,theme:this._useLightTheme()?q.LIGHT:q.DARK,dataProvider:d,resizeMode:p.FIT_WINDOW,showCloseButton:!0,
config:{esriDijitCssUrl:"https://js.arcgis.com/3.29/dijit/themes/claro/claro.css",esriCssUrl:"https://js.arcgis.com/3.29/esri/css/esri.css",playerSourceRootUrl:"https://js.arcgis.com/3.29/"},onClose:function(){a.reportPlayer.destroy();g.destroy(a.playerDiv)}})).placeAt(this.playerDiv);var c=!0,d=new C({name:"filteredInfographicReportSelect",tree:new m(this._infograpicReports),defaultExpand:{esriReports:!0},placeHolder:a.nls.selectTemplate,value:b,onChange:function(b){c?c=!1:(a.infographicDropDown.set("value",
b),n(b))}});this._useLightTheme()||e.add(this.reportPlayer.playerToolbar.domNode,"jimu-main-background");d.startup();d.set("value",b);this.reportPlayer.playerToolbar.addInfographicsSelect(d);var n=function(b){var d=[];if(a.wizard.selectedPoint.long)k.forEach(a.wizard.selectedPoint.tradeAreas,function(a){var b={};b.name=a.name;b.shortName=a.shortName;b.feature=a.graphic;d.push(b)});else if(a.wizard.selectedPolygon.geometry){var d=[],f={};f.name=a.wizard.selectedPolygon.locationName;f.shortName=a.wizard.selectedPolygon.locationName;
f.feature=a.wizard.selectedPolygon.feature;d.push(f)}a.reportPlayer.playReport({portalUrl:portalUrl,countryID:a.wizard.selectedCountryID,reportID:b,analysisAreas:d})};n(b)}},_useLightTheme:function(){var a=!1,b=self.getAppConfig();k.forEach(this._configForLightTheme,function(d){b&&b.theme&&b.theme.name==d.name&&b.theme.styles&&0<b.theme.styles.length&&k.forEach(b.theme.styles,function(b){b==d.style&&(a=!0)})});b&&b.theme&&b.theme.customStyles&&b.theme.customStyles.mainBackgroundColor&&"#FFFFFF"==
b.theme.customStyles.mainBackgroundColor.toUpperCase()&&(a=!0);return a},runReport:function(){if(!e.contains(this.runReportBtn,"jimu-state-disabled")){e.add(this.runReportBtn,"jimu-state-disabled");this.shelter.show();var a=this;this.wizard.selectedPoint.long?this.runReportForPoint().then(function(){a.shelter.hide();e.remove(a.runReportBtn,"jimu-state-disabled")}).otherwise(function(){a.shelter.hide();e.remove(a.runReportBtn,"jimu-state-disabled")}):this.wizard.selectedPolygon.geometry&&this.runReportForPolygon().then(function(){a.shelter.hide();
e.remove(a.runReportBtn,"jimu-state-disabled")}).otherwise(function(){a.shelter.hide();e.remove(a.runReportBtn,"jimu-state-disabled")})}},_enableDisableButton:function(a,b){"string"==typeof b&&"None"!=b?e.remove(a,"jimu-state-disabled"):e.add(a,"jimu-state-disabled")},runReportForPoint:function(){var a=this,b={studyAreas:[]},d={featureSet:{fields:[{name:"OBJECTID",alias:"Object ID",type:"esriFieldTypeOID"},{name:"STORE_ID",alias:"STORE_ID",type:"esriFieldTypeString",length:1,nullable:!0},{name:"STORE_LONG",
alias:"STORE_LONG",type:"esriFieldTypeDouble"},{name:"STORE_LAT",alias:"STORE_LAT",type:"esriFieldTypeDouble"},{name:"AREA_DESC",alias:"AREA_DESC",type:"esriFieldTypeString",length:7,nullable:!0},{name:"AREA_DESC2",alias:"AREA_DESC2",type:"esriFieldTypeString",length:19,nullable:!0}],spatialReference:this.map.spatialReference.toJson(),geometryType:"esriGeometryPolygon",features:[]}};k.forEach(this.wizard.selectedPoint.tradeAreas,function(b){var f={};f.geometry=b.graphic.geometry;f.attributes=b.graphic.attributes;
f.attributes||(f.attributes={});f.attributes.OBJECTID=1;f.attributes.STORE_ID="1";f.attributes.STORE_LONG=a.wizard.selectedPoint.long;f.attributes.STORE_LAT=a.wizard.selectedPoint.lat;f.attributes.AREA_DESC=b.AREA_DESC;f.attributes.AREA_DESC2=b.AREA_DESC2;d.featureSet.features.push(f)});b.studyAreas.push(d);this.filteredReportDropDown.getSelectedItem().reportType!=t.STANDARD&&(b.areadesc2=this.wizard.selectedPoint.areadesc2);b.locationName=this.wizard.selectedPoint.locationName;b.lat=this.wizard.selectedPoint.lat;
b.long=this.wizard.selectedPoint.long;b.sourceCountry=this.wizard.selectedCountryID;b.report=this.filteredReportDropDown.getSelectedItem().item?this.filteredReportDropDown.getSelectedItem().item:this.filteredReportDropDown.getSelectedItem().value;b.reportDownloadName=this.filteredReportDropDown.getSelectedItem().label;return z.createReport(b)},runReportForPolygon:function(){var a={studyAreas:[]};a.studyAreas.push({geometry:this.wizard.selectedPolygon.geometry});a.locationName=this.wizard.selectedPolygon.locationName;
a.sourceCountry=this.wizard.selectedCountryID;a.report=this.filteredReportDropDown.getSelectedItem().item?this.filteredReportDropDown.getSelectedItem().item:this.filteredReportDropDown.getSelectedItem().value;a.reportDownloadName=this.filteredReportDropDown.getSelectedItem().label;return z.createReport(a)},backOnClick:function(){this.onBack()}})})},"esri/dijit/geoenrichment/SelectableTree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/store/util/QueryResults dojo/store/util/SimpleQueryEngine".split(" "),
function(k,h,e,g,c,b){return k(g,{idProperty:"id",bindingProperty:null,autoIdentify:!0,queryEngine:b,root:null,data:null,_hash:null,_autoId:null,constructor:function(a,b){h.mixin(this,b);this.root={children:a||[]};h.mixin(this._provideBinding(this.root),{deepness:-1,selectCount:0,leafCount:0});this._hash={};this.idProperty&&this.autoIdentify&&(this._autoId=1);this._initializeNode(this.root,0);this.data=this.root.children},_provideBinding:function(a){var b=this._getBinding(a);b||(a[this.bindingProperty]=
b={});return b},_getBinding:function(a){return this.bindingProperty?a[this.bindingProperty]:a},_initializeNode:function(a,b){var d=this._provideBinding(a);d.selected=!!d.selected;a.children?(d.selectCount=0,d.leafCount=0,e.forEach(a.children,function(f){this._registerNode(f);var c=this._provideBinding(f);c.parent=a;c.deepness=b;this._initializeNode(f,b+1);d.selectCount+=c.selectCount;d.leafCount+=c.leafCount},this),d.selectCount)?d.selectCount==d.leafCount&&(d.selected=!0):d.selected=!1:("number"!=
typeof d.leafCount&&(d.leafCount=1),d.selectCount=d.selected?d.leafCount:0)},isOwned:function(a,b){return b||a!==this.root?this.get(this.getIdentity(a))===a:!0},_registerNode:function(a){this._autoId&&void 0===a[this.idProperty]&&(a[this.idProperty]=this._autoId++);this.idProperty&&(this._hash[a[this.idProperty]]=a)},_unregisterNode:function(a){this.isOwned(a,!0)&&delete this._hash[a[this.idProperty]]},clear:function(){this.root.children.length&&(e.forEach(this.root.children,function(a){this._unbindNode(a)},
this),this.data=this.root.children=[])},destroy:function(){this.clear()},_unbindNode:function(a){a.children&&e.forEach(a.children,function(a){delete this._getBinding(a).parent;this._unbindNode(a)},this);this._unregisterNode(a);var b=this._getBinding(a);b.parent&&(this._incrementCounts(b.parent,-b.selectCount,-b.leafCount),delete b.parent);b!==a&&delete a[this.bindingProperty]},removeNodes:function(a,b){e.forEach(a&&a.slice(),function(a){if(this.isOwned(a,!0)){var b=this._getBinding(a).parent,d=e.indexOf(b.children,
a);0<=d&&b.children.splice(d,1);this._unbindNode(a)}},this);b||this.emit("updated")},addNodes:function(a,b,d){if(!b)b=this.root;else if(!this.isOwned(b)||!b.children)return!1;var f=this._getBinding(b).deepness+1,c=0,l=0;e.forEach(a,function(a){if(!this.isOwned(a)){b.children.push(a);this._registerNode(a);var d=this._provideBinding(a);d.parent=b;d.deepness=f;this._initializeNode(a,f+1);c+=d.selectCount;l+=d.leafCount}},this);this._incrementCounts(b,c,l);d||this.emit("updated");return!0},select:function(a,
b){return this.changeSelect(a,!0,b)},deselect:function(a){this.changeSelect(a,!1)},changeSelect:function(a,b,d){d=d||this.root.leafCount;var f=a&&this._getBinding(a);if(f){b=!!b;var c=(b?f.leafCount:0)-f.selectCount,l=this.root.selectCount+c<=d;if(!a.children)return l&&(f.selected=b,c&&this._incrementCounts(a,c)),l;l&&(f.selected=b);e.forEach(a.children,function(a){this.changeSelect(a,b,d)},this);return l}},_incrementCounts:function(a,b,d){a=this._getBinding(a);a.selectCount+=b;d&&(a.leafCount+=d);
a.selectCount?a.selectCount==a.leafCount&&(a.selected=!0):a.selected=!1;a.parent&&this._incrementCounts(a.parent,b,d)},getSelectionState:function(a){if(!this.isOwned(a))return!1;a=this._getBinding(a);return a.selectCount&&a.selectCount!=a.leafCount?"mixed":a.selected=!!a.selectCount},getSelectedNodes:function(a){return this.getDescendingNodes(this.root,!0,a)},getDescendingNodes:function(a,b,d){if(!this.isOwned(a))return[];var f=[];this._collectNodes(a.children,f,b,d);return f},_collectNodes:function(a,
b,d,c){e.forEach(a,function(a){var f=this._getBinding(a),n=null===d||void 0===d?f.leafCount:d?f.selectCount:f.leafCount-f.selectCount;n&&(!a.children||!c&&n==f.leafCount?b.push(a):this._collectNodes(a.children,b,d,c))},this)},inspectChildren:function(a,b,d,c){c&&(b=h.hitch(c,b));a=a||this.root;(a=a.children)&&d&&(a=a.slice(),a.sort(d));return e.every(a,function(a){var f=b(a);return null===f?!1:!1!==f&&a.children?this.inspectChildren(a,b,d):!0},this)},updateExpandedNodes:function(a,b){for(var d in this._hash)this.updateExpand(this._hash[d],
!!a[d]);this._updateOddEven(null,b)},updateExpand:function(a,b,d,c){if(a){var f=!1;a.children&&(a=this._getBinding(a),a.expanded!==b&&(f=!0,a.expanded=b));b={};f&&d&&this._updateOddEven(b,c);return b}},_updateOddEven:function(a,b){var d=1;this.inspectChildren(null,function(b){!1!==b.visible&&(d=1-d);var f=this._getBinding(b);a&&f.isOdd!==d&&(a[this.getIdentity(b)]=d);f.isOdd=d;return!(!b.children||!f.expanded)},b,this)},isOdd:function(a){return(a=this._getBinding(a))&&a.isOdd},get:function(a){return this._hash[a]},
getIdentity:function(a){return this.idProperty?a[this.idProperty]:null},query:function(a,b){return c(this.queryEngine(a,b)(this.data))},getChildren:function(a,b){a=this.isOwned(a,!0)?a.children:null;return c(this.queryEngine({},b)(a||[]))},mayHaveChildren:function(a){return!!a.children}})})},"esri/dijit/geoenrichment/ReportPlayer/ReportPlayer":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when dojo/on dojo/keys dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin ./config ./playerSupports/_CommandSupport ./playerSupports/_LogoSupport ./playerSupports/_MapSupport ./playerSupports/_PageNavigationSupport ./playerSupports/_PrintSupport ./playerSupports/_ReportContainersSwitcher ./playerSupports/_SmartLayoutSupport ./playerSupports/_ZoomSupport ./playerSupports/_WaitingSupport ./supportClasses/PlayerConfigurator ./supportClasses/PlayerToFullScreenAnimator ./PlayerToolbar ./ReportPlayerViewModel ./PlayerResizeModes ./PlayerThemes ./ReportPlayerState ./DataProviderGE esri/dijit/geoenrichment/utils/DelayUtil esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/InvokeUtil esri/dijit/geoenrichment/utils/async/AsyncQueue dojo/text!./templates/ReportPlayer.html dojo/i18n!esri/nls/jsapi ./_devConfig".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v,r,u,t,z,w,C,A,B,y,D,F,E,G,H,I,J,N,K,P,L,M){L=L.geoenrichment.dijit.ReportPlayer.ReportPlayer;return k([d,n,l,p,q,r,u,t,z,v,w],{templateString:P,nls:L,dataProvider:null,exportCommands:null,config:null,theme:void 0,viewMode:void 0,enableDataDrilling:void 0,showDataDrillingInsidePanel:void 0,showToolbarInPopup:void 0,showAreaTitle:void 0,scaleSlidesToFitWindow:void 0,showCloseButton:!1,showToFullScreenAnimation:!1,allowAutoOrientation:!0,mobileLandscapeViewMode:void 0,
resizeMode:void 0,isPlayerOnServer:!1,printConfig:{subtitle:L.preparedByEsri,printDialogClass:"esri/dijit/geoenrichment/ReportPlayer/printing/PageOptionsDialog/PageOptionsDialog"},showProgressBar:!0,defaultZoomBehavior:void 0,isDataDrillingPlayer:!1,_viewModel:null,_reportData:null,_analysisAreaIndex:0,playerToolbar:null,postCreate:function(){this.config=h.mixin(m,this.config);this._viewModel=new (this._getViewModelClass());this._setUpDataProvider();C.configurePlayer(this);this._initToolbar();this._initContainerSwither();
this._initSmartLayout();this._initCommands();this._initPageNavigationControls();this._initZoomControls();this._applyTheme();this._showError(!1);this._initProgressController();I.isMobileDevice()&&(f.add(this.domNode,"esriGEReportPlayerMobile"),this._setUpMobileOrientationHandling())},_setUpDataProvider:function(){this.dataProvider=this.dataProvider||new G;this.exportCommands&&this.exportCommands.forEach(function(a){this.dataProvider.registerCommand(a)},this)},_orientationDfd:null,_setUpMobileOrientationHandling:function(){var a=
this;this.allowAutoOrientation&&this.own(b(window,"orientationchange",function(){a._orientationDfd&&a._orientationDfd.resolve("cancel");var b=a._orientationDfd=new g;a._showWaiting(b.promise);b.promise.then(function(b){"cancel"!==b&&(C.configurePlayer(a),a._refreshZoomControls(),a.refresh())});c(a.getRenderPromise(),function(){H.delay(500).then(b.resolve,b.resolve)})}))},_getViewModelClass:function(){return y},_initToolbar:function(){var d=this;this.playerToolbar=(new B({popupButtonDiv:this.playerAfterToolbarDiv,
showToolbarInPopup:this.showToolbarInPopup,showAreaTitle:this.showAreaTitle,stretchToolbarNode:!this.showToolbarInPopup&&(this.resizeMode===D.FIT_WINDOW?document.body:this.domNode),showCloseButton:this.showCloseButton,isMobileDevice:I.isMobileDevice(),isScrollShown:function(){var a=d.getCurrentReportContainer();return a&&a.isScrollShown&&a.isScrollShown()},onClose:function(){d._onClose()}})).placeAt(this.playerToolbarDiv);this.own(this.playerToolbar);this.playerToolbar.onShowAnalysisAreaAt=function(a){d.showAnalysisAreaAt(a)};
this.showCloseButton&&this.own(b(window,"keyup",function(b){d.getWaitingPromise()||E.isViewingDataDrillingZoom||b.keyCode===a.ESCAPE&&d._onClose()}));J.hide(this.playerToolbarDiv)},_applyTheme:function(){f.remove(this.domNode,"playerThemeDark playerThemeLight");f.add(this.domNode,this.theme===F.DARK?"playerThemeDark":"playerThemeLight");this.playerToolbar.setTheme(this.theme)},playReport:function(a,b){return this._callAfterRendering("_doPlayReport",[a,b])},_doPlayReport:function(a,b){this.playerToolbar.closePopup();
var d=this;this._showError(!1);this._progressController&&this._progressController.reset();this.showToFullScreenAnimation&&this.resizeMode===D.FIT_WINDOW&&A.animateTo(this);this.dataProvider._onCreateReportStarted=function(){d._viewModel.preInitialize()};this._viewModel.reset();return this._showWaiting(c(this.dataProvider.getReportData(a,{progressCallback:function(a){d._progressController&&d._progressController.setLoadDataProgress(a)}}),function(a){return d.setReportData(a,b)},function(a){d._showError(a)}))},
_isDataBeingSetFlag:!1,setReportData:function(a,b){return this._callAfterRendering("_doSetReportData",[a,b])},_doSetReportData:function(a,b){var d=this;b=b||{};this._reportData=a;J.show(this.playerToolbarDiv);if(a){this._isDataBeingSetFlag=!0;E.isAnimationSuspended=!0;this.onSetReportDataStart();var c=new g;this._viewModel.animationAllowed=!b.disableAnimation;this._configureViewModel(a);H.delay(0).then(function(){if(1===a.analysisAreas.length||a.isMultiFeature)d._destroyAllContainers(),d._resetMapBuilder(),
d._applyReportData({analysisAreaIndex:0,rerenderContent:!0}).then(c.resolve,c.reject);else{var f=function(){0>l?c.resolve():d._applyReportData({analysisAreaIndex:l--,rerenderContent:!1}).then(function(){setTimeout(f,100)},c.reject)};!1!==b._resetLoadedContents&&(d._destroyAllContainers(),d._resetMapBuilder());var l=a.analysisAreas.length-1;f()}});this._progressController&&this._progressController.setNumAreas(a.analysisAreas.length);this._progressController&&this._progressController.setLoadDataProgress(1);
var l=c.promise.then(function(){return d._progressController&&d._progressController.finalize()}).otherwise(function(a){d._showError(a)});this._showWaiting(l);return l.always(function(){var a=d.getCurrentReportContainer();if(a&&a.domNode)return f.add(a.domNode,"esriGEReportPlayer_fadeIn1000"),H.delay(1E3).then(function(){a.domNode&&f.remove(a.domNode,"esriGEReportPlayer_fadeIn1000")}),H.delay(300).then(function(){d._isDataBeingSetFlag=!1;E.isAnimationSuspended=!1;d.onSetReportDataEnd();d._emitPendingResizedEvent();
a.notifyShown();d._progressController&&d._progressController.reset();if(b.waitUntilAllContentIsReady)return d.getRenderPromise()})})}this._showError(!0)},refresh:function(a){return this._reportData&&c(this.setReportData(this._reportData,{waitUntilAllContentIsReady:!(!a||!a.waitUntilAllContentIsReady)}),function(){this.showPageAt(0);return this.resize()}.bind(this))},showAnalysisAreaAt:function(a){return this._callAfterRendering("_doShowAnalysisAreaAt",[a])},_doShowAnalysisAreaAt:function(a){return this._applyReportData({analysisAreaIndex:a,
rerenderContent:!1})},_applyReportData:function(a){var b=this;a=a||{};var d=this._reportData&&this._reportData.isMultiFeature?0:a.analysisAreaIndex||0,f=!1!==a.rerenderContent;this._analysisAreaIndex=d;this._showError(!this._reportData);if(this._reportData)return c(this._viewModel.initialize(this._reportData.isClassic,this.viewMode),function(){b.playerToolbar.updateAreaSelect(b._reportData.analysisAreas,b._reportData.combinedAreasInfo,b.getCurrentAnalysisAreaIndex(),b._reportData.isMultiFeature);
return c(b._setReportContainer(f),function(a){return a&&b._doApplyTemplateJson({analysisAreaIndex:d})})})},_doApplyTemplateJson:function(a){var b=this,d=this.getCurrentReportContainer(),f=d.fromJson(h.clone(this._reportData.templateJson),{waitUntilAllContentIsReady:!0,progressCallback:function(d){b._progressController&&b._progressController.setProgressForAreaAt(d,a.analysisAreaIndex)}}),l=d.getPagePromise?d.getPagePromise():f,d=d.getContentPromise?d.getContentPromise():f;this._registerContainerLoadPromise(d||
l);return c(l,function(){b._setCurrentContainerLoaded();b.showPageAt(b._currentPageIndex);return b.resize()})},getReportData:function(){return this._reportData},getReportTitle:function(){return this._reportData&&this._reportData.reportTitle||""},getCurrentAnalysisAreaIndex:function(){return this._analysisAreaIndex},getCurrentAnalysisArea:function(){return this._reportData&&this._reportData.analysisAreas[this._analysisAreaIndex]},getAnalysisAreas:function(){return this._reportData&&this._reportData.analysisAreas},
reportDataToJson:function(a){return this._showWaiting(this.dataProvider.reportDataToJson(this.getReportData(),a))},reportDataFromJson:function(a,b){var d=this;this._showError(!1);return this._showWaiting(c(this.dataProvider.reportDataFromJson(a),function(a){return d.setReportData(a,b)}))},_configureViewModel:function(a){var b=this;this._viewModel.setTheme(this._reportData.templateJson.theme);this._viewModel.enableDataDrilling=this.enableDataDrilling;this._viewModel.showDataDrillingInsidePanel=this.showDataDrillingInsidePanel;
this._viewModel.setDynamicReportInfo({fieldData:this._reportData.fieldData,analysisAreas:this._reportData.analysisAreas,combinedAreasInfo:this._reportData.combinedAreasInfo,infographicOptions:this._reportData.infographicOptions,attachmentsStore:this._reportData.attachmentsStore,createMapFunc:h.hitch(this,this._createMap),reportType:this._reportData.reportType,isClassic:this._reportData.isClassic,isMultiFeature:this._reportData.isMultiFeature,isFixedDataMode:!this._reportData.config.geoenrichmentUrl,
geClient:this._reportData.geClient,templateVariableProvider:this._reportData.templateVariableProvider,countryID:this._reportData.config.countryID,hierarchy:this._reportData.config.hierarchy});this._viewModel.getDynamicImageFunc=h.hitch(this,this._getReportLogo);this._viewModel.enrichFieldData=function(a){return b.dataProvider.enrichFieldData(a,h.mixin({analysisAreas:b._reportData.analysisAreas,fieldData:b._reportData.fieldData},b._reportData.config))}},getNumberOfPages:function(){return this.getCurrentReportContainer()&&
this.getCurrentReportContainer().getNumberOfPages()},notifyShown:function(){this._isDataBeingSetFlag||this.getCurrentReportContainer()&&this.getCurrentReportContainer().notifyShown()},_isErrorShown:!1,_showError:function(a){M.emulateErrors.playerError&&(a=!0);J[a?"hide":"show"](this.printableDivContainer);J[a?"show":"hide"](this.errorViewDiv);f[a?"add":"remove"](this.domNode,"esriGEReportPlayerError");this._isErrorShown=!!a;a&&J.hide(this.sidePageNavigator);this.playerToolbar.setErrorShown(!!a);a&&
(this._progressController&&this._progressController.reset(),console.log(a),this.onError(a))},isErrorShown:function(){return this._isErrorShown},setPrintMode:function(a){f[a?"add":"remove"](this.domNode,"esriGEReportPlayerInPrinting")},resize:function(a,b){return c(this._resize({width:a,height:b}),function(){this._updatePageNavigator();this._updateZoomControls();this.playerToolbar.update()}.bind(this))},_pendingResizeEvent:null,_emitResizedEvent:function(a){this._pendingResizeEvent={isPaginating:!!a};
this._isDataBeingSetFlag||this._emitPendingResizedEvent()},_emitPendingResizedEvent:function(){this._pendingResizeEvent&&(this.onResized(this._pendingResizeEvent.isPaginating),this._pendingResizeEvent=null)},_onClose:function(){var a;this.showToFullScreenAnimation&&this.resizeMode===D.FIT_WINDOW&&(a=A.animateFrom(this));c(a,function(){this.onClose()}.bind(this))},getVisualState:function(){return{type:"reportPlayer",viewMode:this.viewMode,reportContainers:this.getAllReportContainers().map(function(a){return a.getVisualState&&
a.getVisualState()})}},setVisualState:function(a){return this._callAfterRendering("_doSetVisualState",[a])},_doSetVisualState:function(a){var b=a&&this.getAllReportContainers().map(function(b,d){return b.setVisualState&&b.setVisualState(a.reportContainers[d])});return e(b)},_renderQueue:null,getRenderPromise:function(){return this._renderQueue&&this._renderQueue.getPromise()},_registerContainerLoadPromise:function(a){this._renderQueue=this._renderQueue||new K;this._renderQueue.add(a);this.playerToolbar.setContentLoadPromise(this.getRenderPromise())},
_safeFuncCaller:null,_callAfterRendering:function(a,b){var d=this;this._safeFuncCaller=this._safeFuncCaller||{};this._safeFuncCaller[a]=function(){return d[a].apply(d,b)};return c(this.getRenderPromise(),function(){return N.invoke(d._safeFuncCaller,a)})},onSetReportDataStart:function(){},onSetReportDataEnd:function(){},onResized:function(a){},onClose:function(){},onError:function(a){}})})},"esri/dijit/geoenrichment/promise/all":function(){define(["dojo/promise/all"],function(k){return k})},"esri/dijit/geoenrichment/ReportPlayer/config":function(){define(["esri/kernel"],
function(k){function h(e){e=e.split(".");return Number((Number(e[0])+Number(e[1])/100).toFixed(2))}k=Math.max(h("3.29"),h(k.version)).toFixed(2);return{jsapiVersion:k,esriDijitCssUrl:"https://js.arcgis.com/"+k+"/dijit/themes/claro/claro.css",esriCssUrl:"https://js.arcgis.com/"+k+"/esri/css/esri.css",playerSourceRootUrl:"https://js.arcgis.com/"+k+"/",runReportTask:{ignoreErrors:!0,secondAttempt:!0},charts:{showErrorIfHasUnavailableData:!1},tables:{leaveEmptyCellsUponError:!0,showUnavailableData:!0},
createImageCommand:{skipSavingFile:!1},createPDFCommand:{skipSavingFile:!1},createPlayerCommand:{prettifyDataJson:!0},exportToExcel:{skipSavingFile:!1},modules:{exportCommands:!0,complexCellTooltips:!0},generalization:{factor:-1,maxVerticesInAllFeatures:1E5,numVerticesPerFeature:5E4}}})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_CommandSupport":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/PlayerCommands esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/utils/DeviceUtil".split(" "),
function(k,h,e,g,c,b,a){return k(null,{_initCommands:function(){a.isMobileDevice()||!b.modules.exportCommands?this.playerToolbar.notifyCommandButtonsAdded():g(this.dataProvider.getCommands&&this.dataProvider.getCommands(),function(a){this._createCommandButtons(a);this.playerToolbar.notifyCommandButtonsAdded()}.bind(this))},_lastNonPrintCommandId:null,_executeExportCallback:null,_executePrintCallback:null,_createCommandButtons:function(a){function b(a){var b=new e,d=new e;f.onCommandSettingsShown(b.promise);
f._saveVisualState();g(f._getPrintableContainer({commandId:a,showDialog:!0}),function(a){if(a){var b=a.getSelectedCommandId();b&&b!==c.PRINT&&(f._lastNonPrintCommandId=b);g(f._executeCommand(b,{printableContainer:a}),d.resolve,d.reject)}else g(f._applySavedVisualState(),function(){f.onCommandCanceled();d.resolve()})}).always(b.resolve);return d.promise}var f=this;if(a&&a.length){var m,l=a.filter(function(a){return a.id===c.PRINT?(m=a,!1):!0});l.length&&(this._executeExportCallback=function(){return b(f._lastNonPrintCommandId||
l[0].id)},this._createCommandButton(l[0],this._executeExportCallback));m&&(this._executePrintCallback=function(){return b(m.id)},this._createCommandButton(m,this._executePrintCallback))}},executeExport:function(){return this._executeExportCallback&&this._executeExportCallback()},executePrint:function(){return this._executePrintCallback&&this._executePrintCallback()},_createCommandButton:function(a,b){return this.playerToolbar.createCommandButton(a,b)},getCommandExportDialogSettings:function(){return this._getPrintDialogSettings()},
executeCommand:function(a,b){this._saveVisualState();var d=this;return g(this._getPrintableContainer({commandId:a,showDialog:!1,exportSettings:b&&b.exportSettings}),function(f){return d._executeCommand(a,h.mixin({printableContainer:f},b))})},_executeCommand:function(a,b){var d=this;a!==c.PDF&&a!==c.DYNAMIC_HTML||!this._viewModel.dynamicReportInfo.fieldData.runReportTaskID||(b.creditsTaskID=this._viewModel.dynamicReportInfo.fieldData.runReportTaskID);var f=new e;setTimeout(function(){g(d.dataProvider.executeCommand&&
d.dataProvider.executeCommand(a,d,b,function(a){d.onCommandProgress(a)}),f.resolve,f.reject)});var l=f.promise.then(function(a){return g(d._applySavedVisualState(),function(){return a})});this.onCommandStart(l,a);this._showWaiting(l);l.always(function(){d.onCommandEnd(l)});return l},_visualStateMemo:null,_saveVisualState:function(){this._visualStateMemo=this.getVisualState()},_applySavedVisualState:function(){var a=this;return this.setVisualState(this._visualStateMemo).then(function(){a._visualStateMemo=
null})},onCommandSettingsShown:function(a){},onCommandCanceled:function(){},onCommandStart:function(a,b){},onCommandProgress:function(a){},onCommandEnd:function(a){}})})},"esri/dijit/geoenrichment/ReportPlayer/PlayerCommands":function(){define([],function(){var k={HTML:"createHTML",PDF:"createPDF",PRINT:"print",DYNAMIC_HTML:"createDynamicHTML",IMAGE:"createImage",EXCEL:"exportToExcel",isSupported:function(h){for(var e in k)if(k[e]===h)return!0;return!1}};return k})},"esri/dijit/geoenrichment/utils/DeviceUtil":function(){define(["dojo/sniff"],
function(k){var h={},e=function(){var c=window,b=document,a=c.navigator.platform,f=c.navigator.userAgent,d={ios:!1,android:!1,androidChrome:!1,desktop:!1,windowsPhone:!1,iphone:!1,iphoneX:!1,ipod:!1,ipad:!1,edge:!1,ie:!1,firefox:!1,macos:!1,windows:!1,cordova:!(!c.cordova&&!c.phonegap),phonegap:!(!c.cordova&&!c.phonegap)},n=c.screen.width,e=c.screen.height,l=f.match(/(Windows Phone);?[\s\/]+([\d.]+)?/),g=f.match(/(Android);?[\s\/]+([\d.]+)?/),h=f.match(/(iPad).*OS\s([\d_]+)/),k=f.match(/(iPod)(.*OS\s([\d_]+))?/),
r=!h&&f.match(/(iPhone\sOS|iOS)\s([\d_]+)/),n=r&&(375===n&&812===e||414===n&&896===e),e=0<=f.indexOf("MSIE ")||0<=f.indexOf("Trident/"),u=0<=f.indexOf("Edge/"),t=0<=f.indexOf("Gecko/")&&0<=f.indexOf("Firefox/"),z="MacIntel"===a,a="Win32"===a;d.ie=e;d.edge=u;d.firefox=t;l&&(d.os="windows",d.osVersion=l[2],d.windowsPhone=!0);g&&!a&&(d.os="android",d.osVersion=g[2],d.android=!0,d.androidChrome=0<=f.toLowerCase().indexOf("chrome"));if(h||r||k)d.os="ios",d.ios=!0;r&&!k&&(d.osVersion=r[2].replace(/_/g,
"."),d.iphone=!0,d.iphoneX=n);h&&(d.osVersion=h[2].replace(/_/g,"."),d.ipad=!0);k&&(d.osVersion=k[3]?k[3].replace(/_/g,"."):null,d.iphone=!0);d.ios&&d.osVersion&&0<=f.indexOf("Version/")&&"10"===d.osVersion.split(".")[0]&&(d.osVersion=f.toLowerCase().split("version/")[1].split(" ")[0]);d.webView=!(!(r||h||k)||!f.match(/.*AppleWebKit(?!.*Safari)/i)&&!c.navigator.standalone)||c.matchMedia&&c.matchMedia("(display-mode: standalone)").matches;d.standalone=d.webView;d.desktop=!(d.os||d.android||d.webView);
d.desktop&&(d.macos=z,d.windows=a);d.os&&"ios"===d.os&&(f=d.osVersion.split("."),b=b.querySelector('meta[name\x3d"viewport"]'),d.minimalUi=!d.webView&&(k||r)&&(7===1*f[0]?1<=1*f[1]:7<1*f[0])&&b&&0<=b.getAttribute("content").indexOf("minimal-ui"));d.needsStatusbarOverlay=function(){return(d.webView||d.android&&d.cordova)&&c.innerWidth*c.innerHeight===c.screen.width*c.screen.height?!d.iphoneX||90!==c.orientation&&-90!==c.orientation?!0:!1:!1};d.statusbar=d.needsStatusbarOverlay();d.pixelRatio=c.devicePixelRatio||
1;return d}(),g=!e.desktop&&!e.ipad;h.device=e;h.isMobileDevice=function(){return g};h.isPCWithTouchScreen=function(){return!g&&k("touch")};h.isLandscape=function(){return 90===Math.abs(window.orientation)};h.press=g?"touchstart":"mousedown";h.release=g?"touchend":"mouseup";h.click=g?"touchend":"click";h.clickOrRelease=g?"touchend":"click, mouseup";h.move=g?"touchmove":"mousemove";return h})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_LogoSupport":function(){define(["dojo/_base/declare",
"esri/dijit/geoenrichment/when","../core/annotations/supportClasses/DynamicBehaviors","../core/supportClasses/images/DefaultLogoLoader"],function(k,h,e,g){return k(null,{_getReportLogo:function(c,b,a){function f(){return h(d._reportData.attachmentsStore&&d._reportData.attachmentsStore.getAttachments(),function(f){return h(f&&f[0]&&f[0].getThumbnail(),function(f){return f||d._getDefaultLogo(b,a)})})}var d=this;switch(c){case e.ATTACHMENTS:return f();default:return this._getDefaultLogo(b,a)}},_getDefaultLogo:function(c,
b){return this._reportData.customLogo||b||g.getDefaultLogo(this._viewModel.getDocumentDefaultStyles())}})})},"esri/dijit/geoenrichment/ReportPlayer/core/annotations/supportClasses/DynamicBehaviors":function(){define([],function(){var k={ATTACHMENTS:"attachments",PREFERENCES:"preferences",DEFAULT:"default",isSupported:function(h){for(var e in k)if(k[e]===h)return!0;return!1},toSupportedValue:function(h){return k.isSupported(h)?h:k.DEFAULT}};return k})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/images/DefaultLogoLoader":function(){define(["require",
"esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/utils/ColorUtil"],function(k,h,e){return{_identifyDefaultLogoBackground:function(g){return!g||e.isTransparent(g.backgroundColor)?"transparent":e.isLightColor(g.backgroundColor)?"light":"dark"},_loadLogo:function(e){var c=new h;k(["./"+e],function(b){c.resolve(b)});return c.promise},getDefaultLogo:function(e){switch(this._identifyDefaultLogoBackground(e)){case "light":return this._loadLogo("DefaultLogoGraphicReportDark");case "dark":return this._loadLogo("DefaultLogoGraphicReportLight");
default:return this._loadLogo("DefaultLogoGraphicReportGeneric")}}}})},"esri/dijit/geoenrichment/utils/ColorUtil":function(){define(["dojo/_base/Color","dojox/color/_base","dojox/color/Palette"],function(k,h,e){function g(b,a,f){return Math.round((b&255)*(1-f)+(a&255)*f)}var c={toCSSColor:function(b,a,f){"string"!==typeof b||/^0x/i.test(b)||(b=k.fromString(b));if(b instanceof k)return a||1==b.a?b.toHex():b.toCss(!0);if(null==b||isNaN(b))return f?c.toCSSColor(f,a):"#000000";b="00000"+Number(b).toString(16);
return"#"+b.substr(b.length-6)},toColor:function(b,a){return"object"==typeof b?(new k).setColor(b):k.fromString(c.toCSSColor(b,!1,a))},getCSSColorWithAlpha:function(b,a){return c.toCSSColor(c.getColorWithAlpha(b,a))},getColorWithAlpha:function(b,a){b=(new k).setColor(b);b.a=a;return b},transform:function(b,a){var f=new e;f.colors=[new k(b)];return f.transform({use:void 0!==a.dl?"hsl":"hsv",dh:a.dh||0,ds:a.ds||0,dv:a.dv||0,dl:a.dl||0}).colors[0]},generateAnalogousColorScheme:function(b,a,f){return e.generators.analogous({base:b,
high:a,low:f}).colors},applyColorHue:function(b,a){b=new h.Color(b);a=new h.Color(a);b=b.toHsl();var f=a.toHsl();b=h.fromHsl({h:b.h,s:0===b.s?0:0===f.s?b.s:f.s,l:f.l});b.a=a.a;return b},getColorParams:function(b){b=new h.Color(b);var a=b.toHsv();a.l=b.toHsl().l;return a},generateGradient:function(b,a){b=b.map(c.toRGBColor);var f=[];if(0==b.length-1||1==a){b=b[0];for(var d=0;d<a;d++)f.push(b);return f}for(var n=1/(a-1),d=0;d<a;d++)f.push(c.getGradientRGBColor(b,d*n));return f},getGradientRGBColor:function(b,
a,f){var d=b.length-1,n=1>d||0>=a?0:1<=a?d:-1;if(0<=n)return b[n];a*=d;n=Math.floor(a);n==d&&n--;return c.mixRGBColors(b[n],b[n+1],a-n,f)},mixRGBColors:function(b,a,f,d){1<f?f=1:0>f&&(f=0);var c=g(b,a,f),e=g(b>>8,a>>8,f),l=g(b>>16,a>>16,f);return((d?g(b>>24,a>>24,f):0)<<24)+(l<<16)+(e<<8)+c},toRGBColor:function(b,a){b=c.toCSSColor(b,!0,a);return parseInt("0x"+b.substr(1))},getContrastColor:function(b,a,f,d){return c.isLightColor(b,d)?c.toColor(a,"#000000"):c.toColor(f,"#FFFFFF")},getHighlightColor:function(b,
a){a=a||{};b=new h.Color(b);x=b.toHsl();if("darker"===a.method)x.l=50>x.l?x.l+30:x.l-20,0<x.s&&(x.s+=30);else{var f=a.saturation||100,d=a.luminosity1||75;a=a.luminosity2||50;0===x.s?x.l=50>x.l?x.l+30:x.l-20:(x.s=f,x.l=x.l<a?d:x.l>d?a:x.l-a>d-x.l?a:d)}a=h.fromHsl(x);a.a=b.a;return a},getLightness:function(b){b=c.toRGBColor(b);return(299*(b>>16&255)+587*(b>>8&255)+114*(b&255))/1E3},isLightColor:function(b,a){return c.getLightness(b)>=(void 0===a?128:a)},colorsEqual:function(b,a){b instanceof k||(b=
c.toColor(b));a instanceof k||(a=c.toColor(a));return b.a==a.a&&b.r==a.r&&b.g==a.g&&b.b==a.b},isTransparent:function(b){b=c.toCSSColor(b);return"rgba(0,0,0,0)"===b.toLowerCase().replace(/\s/g,"")},generateRandomColor:function(b){function a(){return f+Math.round((d-f)*Math.random())}b=b||{};var f=b.min||0,d=b.max||255,c=b.randomizeAlpha?a():1;return b.grayScheme?(b=a(),new k([b,b,b,c])):new k([a(),a(),a(),c])}};return c})},"dojox/color/Palette":function(){define(["dojo/_base/lang","dojo/_base/array",
"./_base"],function(k,h,e){function g(a,b,f){var d=new e.Palette;d.colors=[];h.forEach(a.colors,function(a){d.colors.push(new e.Color({r:Math.min(255,Math.max(0,"dr"==b?a.r+f:a.r)),g:Math.min(255,Math.max(0,"dg"==b?a.g+f:a.g)),b:Math.min(255,Math.max(0,"db"==b?a.b+f:a.b)),a:Math.min(1,Math.max(0,"da"==b?a.a+f:a.a))}))});return d}function c(a,b,f){var d=new e.Palette;d.colors=[];h.forEach(a.colors,function(a){a=a.toCmy();d.colors.push(e.fromCmy(Math.min(100,Math.max(0,"dc"==b?a.c+f:a.c)),Math.min(100,
Math.max(0,"dm"==b?a.m+f:a.m)),Math.min(100,Math.max(0,"dy"==b?a.y+f:a.y))))});return d}function b(a,b,f){var d=new e.Palette;d.colors=[];h.forEach(a.colors,function(a){a=a.toCmyk();d.colors.push(e.fromCmyk(Math.min(100,Math.max(0,"dc"==b?a.c+f:a.c)),Math.min(100,Math.max(0,"dm"==b?a.m+f:a.m)),Math.min(100,Math.max(0,"dy"==b?a.y+f:a.y)),Math.min(100,Math.max(0,"dk"==b?a.b+f:a.b))))});return d}function a(a,b,f){var d=new e.Palette;d.colors=[];h.forEach(a.colors,function(a){a=a.toHsl();d.colors.push(e.fromHsl(("dh"==
b?a.h+f:a.h)%360,Math.min(100,Math.max(0,"ds"==b?a.s+f:a.s)),Math.min(100,Math.max(0,"dl"==b?a.l+f:a.l))))});return d}function f(a,b,f){var d=new e.Palette;d.colors=[];h.forEach(a.colors,function(a){a=a.toHsv();d.colors.push(e.fromHsv(("dh"==b?a.h+f:a.h)%360,Math.min(100,Math.max(0,"ds"==b?a.s+f:a.s)),Math.min(100,Math.max(0,"dv"==b?a.v+f:a.v))))});return d}e.Palette=function(a){this.colors=[];a instanceof e.Palette?this.colors=a.colors.slice(0):a instanceof e.Color?this.colors=[null,null,a,null,
null]:k.isArray(a)?this.colors=h.map(a.slice(0),function(a){return k.isString(a)?new e.Color(a):a}):k.isString(a)&&(this.colors=[null,null,new e.Color(a),null,null])};k.extend(e.Palette,{transform:function(d){var n=g;if(d.use){var e=d.use.toLowerCase();0==e.indexOf("hs")?n="l"==e.charAt(2)?a:f:0==e.indexOf("cmy")&&(n="k"==e.charAt(3)?b:c)}else if("dc"in d||"dm"in d||"dy"in d)n="dk"in d?b:c;else if("dh"in d||"ds"in d)n="dv"in d?f:a;var e=this,l;for(l in d)"use"!=l&&(e=n(e,l,d[l]));return e},clone:function(){return new e.Palette(this)}});
k.mixin(e.Palette,{generators:{analogous:function(a){var b=a.high||60,d=a.low||18;a=(k.isString(a.base)?new e.Color(a.base):a.base).toHsv();var f=Math.max(10,95>=a.s?a.s+5:100-(a.s-95)),c=92<=a.v?a.v-9:Math.max(a.v+9,20),g=90>=a.v?Math.max(a.v+5,20):95+Math.ceil((a.v-90)/2),v=[f,1<a.s?a.s-1:21-a.s,a.s,f,f],r=[c,g,a.v,c,g];return new e.Palette(h.map([(a.h+d+360)%360,(a.h+Math.round(d/2)+360)%360,a.h,(a.h-Math.round(b/2)+360)%360,(a.h-b+360)%360],function(a,b){return e.fromHsv(a,v[b],r[b])}))},monochromatic:function(a){a=
k.isString(a.base)?new e.Color(a.base):a.base;var b=a.toHsv(),d=9<b.s-30?b.s-30:b.s+30,f=b.s,c=20<b.v-20?b.v-20:b.v+60,g=20<b.v-50?b.v-50:b.v+30;return new e.Palette([e.fromHsv(b.h,d,100-.8*(100-b.v)),e.fromHsv(b.h,f,g),a,e.fromHsv(b.h,d,g),e.fromHsv(b.h,f,c)])},triadic:function(a){a=k.isString(a.base)?new e.Color(a.base):a.base;var b=a.toHsv(),d=(b.h-157+360)%360,f=90<b.s?b.s-10:b.s+10,c=95<b.s?b.s-5:b.s+5,g=20<b.v-20?b.v-20:b.v+20,h=20<b.v-30?b.v-30:b.v+30,r=70<b.v-30?b.v-30:b.v+30;return new e.Palette([e.fromHsv((b.h+
57+360)%360,20<b.s?b.s-10:b.s+10,b.v),e.fromHsv(b.h,f,h),a,e.fromHsv(d,f,g),e.fromHsv(d,c,r)])},complementary:function(a){a=k.isString(a.base)?new e.Color(a.base):a.base;var b=a.toHsv(),d=360>2*b.h+137?2*b.h+137:Math.floor(b.h/2)-137,f=100-.9*(100-b.s),c=Math.min(100,b.s+20),g=20<b.v?b.v-30:b.v+30;return new e.Palette([e.fromHsv(b.h,Math.max(b.s-10,0),Math.min(100,b.v+30)),e.fromHsv(b.h,f,g),a,e.fromHsv(d,c,g),e.fromHsv(d,b.s,b.v)])},splitComplementary:function(a){var b=k.isString(a.base)?new e.Color(a.base):
a.base,d=a.da||30;a=b.toHsv();var f=360>2*a.h+137?2*a.h+137:Math.floor(a.h/2)-137,c=(f-d+360)%360,d=(f+d)%360,f=100-.9*(100-a.s),g=Math.min(100,a.s+20),h=20<a.v?a.v-30:a.v+30;return new e.Palette([e.fromHsv(c,Math.max(a.s-10,0),Math.min(100,a.v+30)),e.fromHsv(c,f,h),b,e.fromHsv(d,g,h),e.fromHsv(d,a.s,a.v)])},compound:function(a){a=k.isString(a.base)?new e.Color(a.base):a.base;var b=a.toHsv(),d=360>2*b.h+18?2*b.h+18:Math.floor(b.h/2)-18,f=360>2*b.h+120?2*b.h+120:Math.floor(b.h/2)-120,c=360>2*b.h+99?
2*b.h+99:Math.floor(b.h/2)-99,g=80<b.s-10?b.s-10:b.s+10,h=10<b.s-25?b.s-25:b.s+25,r=80<b.v-20?b.v-20:b.v+20,u=Math.max(b.v,20);return new e.Palette([e.fromHsv(d,10<b.s-40?b.s-40:b.s+40,10<b.v-40?b.v-40:b.v+40),e.fromHsv(d,g,r),a,e.fromHsv(f,h,u),e.fromHsv(c,g,r)])},shades:function(a){a=k.isString(a.base)?new e.Color(a.base):a.base;var b=a.toHsv(),d=100==b.s&&0==b.v?0:b.s,f=20<=b.v-25?b.v-25:b.v+55,c=20<=b.v-75?b.v-75:b.v+5,g=Math.max(b.v-10,20);return new e.Palette([new e.fromHsv(b.h,d,20<b.v-50?
b.v-50:b.v+30),new e.fromHsv(b.h,d,f),a,new e.fromHsv(b.h,d,c),new e.fromHsv(b.h,d,g)])}},generate:function(a,b){if(k.isFunction(b))return b({base:a});if(e.Palette.generators[b])return e.Palette.generators[b]({base:a});throw Error("dojox.color.Palette.generate: the specified generator ('"+b+"') does not exist.");}});return e.Palette})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_MapSupport":function(){define(["require","dojo/_base/declare","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],
function(k,h,e,g){return h(null,{_initBuilderPromise:null,_mapBuilder:null,_initMapBuilder:function(){var c=this;if(this._initBuilderPromise)return this._initBuilderPromise;var b=new e;k(["../core/supportClasses/map/MapBuilder"],function(a){c._mapBuilder=new a({renderMapsFromCalculators:c.isPlayerOnServer,getPlayerZoomScale:function(a){var b=c.getCurrentReportContainer();return b&&b.getPanelZoomScale?b.getPanelZoomScale(a):b&&b.getZoomInfo&&b.getZoomInfo().scale}});b.resolve()});return this._initBuilderPromise=
b.promise},collectMaps:function(c){return this._mapBuilder?c&&c.allAreas?this._mapBuilder.collectAllAreasMaps():this._mapBuilder.collectAreaMaps(this.getCurrentAnalysisAreaIndex()):[]},_resetMapBuilder:function(){this._mapBuilder&&this._mapBuilder.reset()},_createMap:function(c,b){b=b||{};var a,f={},d=b.areaIndex||0;if(this._reportData.isMultiFeature){a=[];var e=this._reportData.reverseAnalysisAreasOnMap?this._reportData.analysisAreas.slice().reverse():this._reportData.analysisAreas;e.forEach(function(b,
d){var c=this._reportData.reverseAnalysisAreasOnMap?e.length-d-1:d;f[a.length]=c;a.push(b.feature);d=this._reportData.combinedAreasInfo.groups;d&&d.length&&d.some(function(a){return-1!==a.indexes.indexOf(c)})||(b.location&&(f[a.length]=c,a.push(b.location)),b.additionalFeatures&&b.additionalFeatures.forEach(function(b){f[a.length]=c;a.push(b)}))},this);this._reportData.combinedAreasInfo.groups&&this._reportData.combinedAreasInfo.groups.forEach(function(b){b.location&&(f[a.length]=b.indexes[0],a.push(b.location),
b.location.locationName=b.locationName);b.additionalFeatures&&b.additionalFeatures.forEach(function(d){f[a.length]=b.indexes[0];a.push(d)})})}else{var m=this._reportData.analysisAreas[d];a=[m.feature];m.location&&a.push(m.location);m.additionalFeatures&&(a=a.concat(m.additionalFeatures));a.forEach(function(a,b){f[b]=d},this)}return g(this._initMapBuilder(),function(){this._mapBuilder.setArcgisUrl(this._reportData.config.portalUrl);this._mapBuilder.setFallbackMapImageInfos(this._reportData.mapImageInfos);
return this._mapBuilder.createMap(c,{features:a,featureIndexToAreaIndexMap:f,analysisAreas:this._reportData.analysisAreas,areaIndex:d,defaultBasemapId:this._getDefaultBasemapId()||b.defaultBasemapId,webMapId:b.webMapId,additionalLayerInfos:b.additionalLayerInfos,calculatorFieldName:b.calculatorFieldName,locatorPointsControllers:b.locatorPointsControllers,stdPolygonsControllers:b.stdPolygonsControllers,thisAreasHighlightController:b.thisAreasHighlightController,legendController:b.legendController,
fieldData:this._viewModel.dynamicReportInfo.fieldData,geClient:this._viewModel.dynamicReportInfo.geClient,countryID:this._viewModel.dynamicReportInfo.countryID,hierarchy:this._viewModel.dynamicReportInfo.hierarchy,waitForLoad:b.waitForLoad,extent:b.extent,attachmentsStore:this._viewModel.dynamicReportInfo.attachmentsStore,onPanContainer:function(a,b){}})}.bind(this))},_getDefaultBasemapId:function(){return null}})})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_PageNavigationSupport":function(){define("dojo/_base/declare dojo/on dojo/dom-class dojo/dom-geometry dojo/dom-style ../PlayerResizeModes ../PlayerViewModes esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(k,h,e,g,c,b,a,f,d,n){n=n.geoenrichment.dijit.ReportPlayer.ReportPlayer;return k(null,{_currentPageIndex:null,_initPageNavigationControls:function(){var b=this;this.viewMode===a.FULL_PAGES&&(h(this.prevPageButton,"click",function(){b._showPrevPage()}),h(this.nextPageButton,"click",function(){b._showNextPage()}),f.hide(this.sidePageNavigator),this.playerToolbar.onShowPageAt=this.showPageAt.bind(this),d.setTooltipToNode(this.prevPageButton,n.previousPage),d.setTooltipToNode(this.nextPageButton,
n.nextPage))},showPageAt:function(b){this.viewMode===a.FULL_PAGES&&(b=Math.max(0,b),this._currentPageIndex=b=Math.min(this.getCurrentReportContainer().getNumberOfPages()-1,b),this.getCurrentReportContainer().showPageAt(b),this._updatePageNavigator())},_updatePageNavigator:function(){var d=this.getCurrentReportContainer()&&this.getCurrentReportContainer().getNumberOfPages&&this.viewMode===a.FULL_PAGES;this.playerToolbar.setPageControlsVisible(d);if(d){d=this.getCurrentReportContainer().getNumberOfPages();
f[1===d?"hide":"show"]([this.sidePageNavigator]);e[0===this._currentPageIndex?"add":"remove"](this.prevPageButton,"disabled");e[this._currentPageIndex===d-1?"add":"remove"](this.nextPageButton,"disabled");if(this.resizeMode===b.FIT_WINDOW){var l=g.position(this.getCurrentReportContainer().stackContainer);c.set(this.sidePageNavigator,"left",Math.min(l.x+l.w+20,document.body.clientWidth-70)+"px");c.set(this.sidePageNavigator,"top",Math.max(60,l.y+10)+"px")}this.playerToolbar.updatePageSelect(d,this._currentPageIndex)}else f.hide([this.sidePageNavigator])},
_showPrevPage:function(){0!==this._currentPageIndex&&(this._currentPageIndex--,this.showPageAt(this._currentPageIndex))},_showNextPage:function(){this._currentPageIndex!==this.getCurrentReportContainer().getNumberOfPages()-1&&(this._currentPageIndex++,this.showPageAt(this._currentPageIndex))}})})},"esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes":function(){define([],function(){return{AUTO:"auto",FIT_WINDOW:"fitWindow",MANUAL:"manual"}})},"esri/dijit/geoenrichment/ReportPlayer/PlayerViewModes":function(){define([],
function(){var k={FULL_PAGES:"fullPages",PANELS_IN_SLIDES:"panelsInSlides",PANELS_IN_STACK:"panelsInStack",PANELS_IN_ROW:"panelsInRow",isMobileSupported:function(h){return h===k.PANELS_IN_SLIDES||h===k.PANELS_IN_STACK||h===k.PANELS_IN_ROW},isStackLike:function(h){return h===k.PANELS_IN_STACK||h===k.PANELS_IN_ROW}};return k})},"esri/dijit/geoenrichment/utils/DomUtil":function(){define("dojo/_base/lang dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style esri/dijit/geoenrichment/Deferred dojo/domReady!".split(" "),
function(k,h,e,g,c,b,a){function f(){n||(n=g.create("div",{"class":"esriGEOffscreen"},document.body));return n}var d={isHidden:function(a){return a&&e.contains(a,"esriGEHidden")},hasVisibleChildren:function(a){if(!a||!a.children.length)return!1;for(var b=0;b<a.children.length;b++)if(!d.isHidden(a.children[b]))return!0;return!1},hide:function(a){return d.addTag(a,"esriGEHidden")},show:function(a){return d.removeTag(a,"esriGEHidden")},addTag:function(a,b){return d.applyCallback(a,function(a){a&&e.add(a,
b)})},removeTag:function(a,b){return d.applyCallback(a,function(a){a&&e.remove(a,b)})},applyCallback:function(a,b,d){d&&(b=k.hitch(d,b));Array.isArray(a)?a.forEach(b):b(a);return a},getChildIndex:function(a,b){if(!a||!a.children||!b)return-1;for(var d=0;d<a.children.length;d++)if(a.children[d]===b)return d;return-1},getChildren:function(a){if(!a||!a.children)return null;for(var b=[],d=0;d<a.children.length;d++)b.push(a.children[d]);return b},getChildNodes:function(a){if(!a||!a.childNodes)return null;
for(var b=[],d=0;d<a.childNodes.length;d++)b.push(a.childNodes[d]);return b},isChildOf:function(a,b,d){var f=!1,c=function(a){if(d&&!d(a))return!1;a.parentNode===b?f=!0:a.parentNode&&c(a.parentNode)};a&&c(a);return f},isNodeInLayout:function(a){return d.isChildOf(a,document.body,function(a){return!d.isHidden(a)&&"none"!=b.get(a,"display")&&!e.contains(a,"dijitHidden")})},isNodeVisible:function(a){return d.isChildOf(a,document.body,function(a){return!e.contains(a,"dijitHidden")&&"hidden"!=b.get(a,
"visibility")})},isNodeOnscreen:function(a){return d.isChildOf(a,document.body,function(a){return!e.contains(a,"esriGEOffscreen")})},enableContent:function(a,d,f){if(a){f=f||{};var l=a.children.length-1;if(!(0>l)){l=a.children[l];e.contains(l,"esriGEDisabledContent")||(l=null);if(d)l&&a.removeChild(l);else if(l=l||g.create("div",{"class":"esriGEDisabledContent"+(f.overlayClass?" "+f.overlayClass:"")},a),!1!==f.fitParent&&(a=c[f.marginBox?"getMarginBox":"getContentBox"](a).h))a=a.toString()+"px",b.set(l,
{height:a,marginTop:"-"+a});return l}}},enableContentAbsolute:function(a,f,c){if(a){c=c||{};var l=b.get(a,"position");"relative"!==l&&"absolute"!==l&&b.set(a,"position","relative");return d.enableContent(a,f,{overlayClass:"esriGEAbsoluteStretched "+(c.overlayClass||"")+(c.isTransparent?" esriGEDisabledContentTransparent ":""),fitParent:!1})}}},n;d.hideNodeInBackground=function(a,b){if(a){if(a._hideNodeInBackgroundUndoController)return a._hideNodeInBackgroundUndoController;var d=g.create("div",null,
a,"after"),c=g.create("div",{style:"position: absolute; left: 0px; top: 0px;"},f());g.place(a,c);b="DomUtil.hideNodeInBackground"+(b?"."+b:"");h.set(d,"_bg_memo_node",b);h.set(c,"_bg_temp_node",b);b={undo:function(){d&&(d.parentNode&&g.place(a,d,"replace"),g.destroy(d),g.destroy(c),n.children.length||(g.destroy(n),n=null),d=null,delete a._hideNodeInBackgroundUndoController)},remove:function(){this.undo()}};return a._hideNodeInBackgroundUndoController=b}};d.showNodeFromBackground=function(a){a&&a._hideNodeInBackgroundUndoController&&
a._hideNodeInBackgroundUndoController.undo()};d.noTransformPosition=function(a){function d(a){for(var d={x:0,y:0};a.offsetParent;)d.x+=a.offsetLeft,d.y+=a.offsetTop,a=a.offsetParent,d.x+=b.get(a,"borderLeftWidth"),d.y+=b.get(a,"borderTopWidth");return d}function f(a){return b.get(a,"width")+b.get(a,"paddingLeft")+b.get(a,"paddingRight")+b.get(a,"borderLeftWidth")+b.get(a,"borderRightWidth")}function c(a){return b.get(a,"height")+b.get(a,"paddingTop")+b.get(a,"paddingBottom")+b.get(a,"borderTopWidth")+
b.get(a,"borderBottomWidth")}if(a){var l;if(a instanceof SVGElement&&a.getBBox)return l=(l=a.ownerSVGElement&&a.ownerSVGElement.parentNode)&&d(l),a=a.getBBox(),{x:(a.x||0)+l.x,y:(a.y||0)+l.y,w:a.width||0,h:a.height||0};l=d(a);return{x:l.x,y:l.y,w:f(a),h:c(a)}}};d.uniteNodeBoxes=function(a,b){var f=1E6,c=1E6,l=-1E6,e=-1E6;a.forEach(function(a){a=d.noTransformPosition(a);f=Math.min(f,a.x);c=Math.min(c,a.y);l=Math.max(l,a.x+a.w);e=Math.max(e,a.y+a.h)});a={x:f,y:c,w:l-f,h:e-c};b&&(b=d.noTransformPosition(b),
a.x-=b.x,a.y-=b.y);return a};d.getNodesBox=function(a,b){var f=1E6,l=-1E6,e=1E6,n=-1E6;a.forEach(function(a){a=b&&b.ignoreTranformation?d.noTransformPosition(a):c.position(a);f=Math.min(f,a.x);e=Math.min(e,a.y);l=Math.max(l,a.x+a.w);n=Math.max(n,a.y+a.h)});return{x:f,y:e,w:l-f,h:n-e}};d.traverseChildren=function(a,b){function d(a){if(a&&a.children)for(var f=0;f<a.children.length;f++){var c=a.children[f];if(b(c))break;d(c)}}d(a)};d.scrollToListNode=function(a,b,d){var f=b.offsetTop+b.clientHeight,
c=f-(a.scrollTop+a.clientHeight);0<c&&(a.scrollTop+=c);d&&(f-=b.clientHeight-d.offsetTop,c=a.scrollTop-f,0<c&&(a.scrollTop-=c))};var m;d.getScrollbarSize=function(){if(!m){var a=g.create("div",null,document.body);a.style.width="100px";a.style.height="100px";a.style.overflow="scroll";a.style.position="absolute";a.style.top="9999px";m={w:a.offsetWidth-a.clientWidth,h:a.offsetHeight-a.clientHeight};g.destroy(a)}return m};d.hasScrollbars=function(a){var d=b.getComputedStyle(a);return{w:"scroll"===d.overflowX||
a.offsetWidth>a.clientWidth&&"auto"===d.overflowX,h:"scroll"===d.overflowY||a.offsetHeight>a.clientHeight&&"auto"===d.overflowY}};d.getMeasureContext=function(a){a=a||{};a.style=a.style?a.style+" ":"";a.style+="display: inline-block; position: absolute; left: 0; top: 0;";return{div:g.create("div",a,document.body),measureText:function(a){this.div.innerHTML=a;a=c.getMarginBox(this.div);delete a.l;delete a.t;return a},destroy:function(){g.destroy(this.div)}}};d.getTextBox=function(a,b){b=d.getMeasureContext(b);
a=b.measureText(a);b.destroy();return a};d.stealFocus=function(){var b=new a;try{var d=g.create("input",{type:"text",style:"position: absolute; left: 0px; top: 0px;"});g.place(d,document.body);d.select();g.destroy(d)}catch(q){}setTimeout(b.resolve,0);return b.promise};d.getWindowBox=function(){for(var a=[],b=0,f=document.body.children.length;b<f;b++){var c=document.body.children[b];d.isHidden(c)||(d.hide(c),a.push(c))}b={w:document.body.clientWidth,h:document.body.clientHeight};a.forEach(function(a){d.show(a)});
return b};d.getBorder=function(a){return{t:b.toPixelValue(a,b.get(a,"borderTopWidth")),r:b.toPixelValue(a,b.get(a,"borderRightWidth")),b:b.toPixelValue(a,b.get(a,"borderBottomWidth")),l:b.toPixelValue(a,b.get(a,"borderLeftWidth"))}};return d})},"esri/dijit/geoenrichment/utils/TooltipUtil":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/on dojo/mouse dojo/sniff dijit/Tooltip dijit/place ./DeviceUtil ./DnDUtil ./DomUtil ./MouseUtil dojo/domReady!".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v){function r(){}var u={},t=k(n._MasterTooltip,{_customClasses:null,addCustomClasses:function(a){a&&(e.add(this.domNode,a),this._customClasses=a)},show:function(a,b,d,f,c,e,l){if(!this.aroundNode||this.aroundNode!==b||this.containerNode.innerHTML!=a)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{"string"===typeof a?this.containerNode.innerHTML=a:(this.containerNode.innerHTML="",g.place(a.domNode,this.containerNode));c&&this.set("textDir",c);this.containerNode.align=
f?"right":"left";var q=m.around(this.domNode,b,d&&d.length?d:n.defaultPosition,!f,h.hitch(this,"orient")),p=q.aroundNodePos;"M"==q.corner.charAt(0)&&"M"==q.aroundCorner.charAt(0)?(this.connectorNode.style.top=p.y+(p.h-this.connectorNode.offsetHeight>>1)-q.y+"px",this.connectorNode.style.left=""):"M"==q.corner.charAt(1)&&"M"==q.aroundCorner.charAt(1)?this.connectorNode.style.left=p.x+(p.w-this.connectorNode.offsetWidth>>1)-q.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");
this.domNode.style.opacity="0";this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=e||r;this.onMouseLeave=l||r}},orient:function(a,b,f,e,l){this.connectorNode.style.top="";var n=e.h;e=e.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight",
"BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[b+"-"+f];this.addCustomClasses(this._customClasses);this.domNode.style.width="auto";var g=c.position(this.domNode);if(d("ie")||d("trident"))g.w+=2;c.setMarginBox(this.domNode,{w:Math.min(Math.max(e,1),g.w)});"B"==f.charAt(0)&&"B"==b.charAt(0)?(a=c.position(a),b=this.connectorNode.offsetHeight,a.h>n?(this.connectorNode.style.top=n-(l.h+b>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(l.h/2-b/2,
0),a.h-b)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,g.w-e)}}),z={show:function(a,b,d,f){d=d&&d.map(function(a){return{after:"after-centered",before:"before-centered"}[a]||a});var c=new t;c.addCustomClasses(f);c.show(a,b,d);return c}};u.setTooltipToNode=function(b,d,c){function e(){!n&&u.showTooltipForNode(b,d,c)}c=c||{};if(b&&(u.hideTooltipForNode(b),b.__setTooltipToNodeMouseEnterHandle&&b.__setTooltipToNodeMouseEnterHandle.remove(),
d)){var n=!1;l.isMobileDevice()?b.__setTooltipToNodeMouseEnterHandle=p.addNoDragClickHandler(b,e):b.__setTooltipToNodeMouseEnterHandle=a(b,f.enter,e);return{remove:function(){d=null;u.hideTooltipForNode(b)},suspend:function(){u.hideTooltipForNode(b);n=!0},resume:function(){n=!1}}}};u.showTooltipForNode=function(b,d,c){function n(){u.hideTooltipForNode(b);var a=Array.isArray(c.classes)?c.classes.join(" "):c.classes,a=(a||"")+" esriGETooltip";c.notRestricted&&(a+=" notRestricted");b._shownTooltip=m=
z.show(g,b,c.position||["after","before"],a)}if(b){u.hideTooltipForNode(b);var g="function"==typeof d?d():d;if(g){c.textAlign&&(g="\x3cdiv class\x3d'"+("start"===c.textAlign?"esriGEStart":"end"===c.textAlign?"esriGEEnd":"")+"'\x3e"+g+"\x3c/div\x3e");e.add(b,"esriGESimpleTextTooltip");var m;n();var h=u.hideTooltipForNode.bind(u,b);l.isMobileDevice()?b.__setTooltipToNodeMouseLeaveHandle=a(document.body,"touchstart",function(a){v.isMouseOver(b,{event:a})||h()}):b.__setTooltipToNodeMouseLeaveHandle=a.once(b,
f.leave,function(){!c.stayOnHover&&h()});c.ignoreNodeRemoval||(b.__setTooltipToNodeInLayoutHandle=setInterval(function(){!q.isNodeInLayout(b)&&h()},300));l.isMobileDevice()||(b.__setTooltipToNodeMouseOverHandle=setInterval(function(){c.stayOnHover&&v.isMouseOver(m.domNode)||v.isMouseOver(b)||h()},300),b.__setTooltipToNodeClickHandle=a(b,"click",function(a){c.hideOnClick?h():!b._shownTooltip&&n()}),c.stayOnHover&&(b.__setTooltipToNodeMouseLeaveMasterHandle=a(m.domNode,f.leave,h)));return b._shownTooltip}}};
u.hideTooltipForNode=function(a){a&&(delete a.title,e.remove(a,"esriGESimpleTextTooltip"),a._shownTooltip&&a._shownTooltip.destroy(),delete a._shownTooltip,a.__setTooltipToNodeMouseLeaveHandle&&a.__setTooltipToNodeMouseLeaveHandle.remove(),clearInterval(a.__setTooltipToNodeInLayoutHandle),clearInterval(a.__setTooltipToNodeMouseOverHandle),a.__setTooltipToNodeClickHandle&&a.__setTooltipToNodeClickHandle.remove(),a.__setTooltipToNodeMouseLeaveMasterHandle&&a.__setTooltipToNodeMouseLeaveMasterHandle.remove())};
var w,C;u.autoTooltip=function(b){a(b,".TrimWithEllipses:mouseover",function(){if(this!==w&&this.offsetWidth<this.scrollWidth){var b=function(){w=null;C&&(C.tooltip.destroy(),C.mouseOutH.remove(),C.mouseMoveH.remove(),C=null)};b();w=this;C={tooltip:z.show(w.textContent,w,["above","below"]),mouseOutH:a.once(w,"mouseout, mousedown, touchstart",b),mouseMoveH:a(document.body,"mousemove",function(){v.isMouseOver(w)||b()})}}})};u.showClosableTooltip=function(a){var b=u._createClosableTooltip(a.message,
a.tooltipClass,a.position);return u._placeClosableTooltip(b,a.node,a.timeout,a.position,a.onClosed)};u.removeClosableTooltip=function(a){a&&a._removeFunc&&a._removeFunc()};u._createClosableTooltip=function(a,b,d){function f(){var a=g.create("div",{"class":"esriGEClosableTooltipTip"},l);e.add(a,"right"===d?"esriGEClosableTooltipTipRight":"esriGEClosableTooltipTipLeft")}function c(){n=g.create("div",{"class":"esriGEClosableTooltipBody"},l);g.create("div",{innerHTML:a,"class":"esriGEClosableTooltipLabel"},
n);m=g.create("div",{"class":"esriGEClosableTooltipCloseButton"},n)}var l=g.create("div",{"class":"esriGEClosableTooltip esriGENonSelectable "+(b||"")},document.body),n,m;"right"!==d?(c(),f()):(f(),c());l.style.position="fixed";return{tooltip:l,body:n,closeButton:m}};u._placeClosableTooltip=function(d,f,e,l,n){function g(){var a=c.position(f),e=a.x+";"+a.y+";"+a.w+";"+a.h;e!==h&&(h=e,e=c.getMarginBox(d.tooltip),b.set(d.tooltip,{left:(m?a.x+a.w:a.x-e.w)+"px",top:a.y+a.h/2-e.h/2+"px"}))}var m="rtl"===
document.dir&&"right"!==l||"rtl"!==document.dir&&"right"===l,h;g();var p,k,v,r,t,z=function(){p&&clearTimeout(p);k&&clearInterval(k);v&&clearInterval(v);r&&r.remove();d.tooltip.parentNode&&d.tooltip.parentNode.removeChild(d.tooltip)};k=setInterval(function(){q.isNodeInLayout(f)||(t=!1,z());q.isNodeVisible(f)&&q.isNodeOnscreen(f)?(t=!0,q.show(d.tooltip)):(t=!1,q.hide(d.tooltip))},300);v=setInterval(function(){t&&g()},0);e&&(p=setTimeout(z,e));r=a(d.closeButton,"click",function(){z();n&&n()});d.tooltip._removeFunc=
z;return d.tooltip};return u})},"esri/dijit/geoenrichment/utils/DnDUtil":function(){define(["dojo/on","dojo/sniff","./DeviceUtil","./KeyboardUtil"],function(k,h,e,g){var c={MOBILE_TOLERANCE:10,LONG_PRESS_TIMEOUT:500,addNoDragClickHandler:function(b,a,f){f=f||{};return e.isMobileDevice()?c._addMobile(b,a,f):c._addPC(b,a,f)},_addPC:function(b,a,f){var d=f.tolerance||0,c,e,l=k(b,"mousedown",function(b){e&&e.remove();var f=b.clientX,l=b.clientY,n;c=k(document.body,"mousemove",function(a){if(!a.shiftKey&&
!g.isCtrl(a)){var b=a.clientY;if(0<Math.abs(a.clientX-f)||0<Math.abs(b-l))n=!0}});e=k.once(document.body,"mouseup",function(b){c.remove();var e=b.clientX,g=b.clientY;!n&&Math.abs(e-f)<=d&&Math.abs(g-l)<=d&&a(b)})});return{remove:function(){c&&c.remove();e&&e.remove();l&&l.remove()}}},_addMobile:function(b,a,f){function d(){l&&l.remove();h&&h.remove();q&&q.remove();clearTimeout(v)}var e=f.tolerance||c.MOBILE_TOLERANCE,g,l,h,q,v;g=k(b,"touchstart",function(n){function g(a){return Math.abs(n.clientX-
a.clientX)<e&&Math.abs(n.clientY-a.clientY)<e}d();var m;if(f.detectLongPress){var p;h=k(b,"touchmove",function(a){p=a});v=setTimeout(function(){g(p||n)&&(f.ignoreReleaseIfLongPressHappened&&(m=!0),f.longPressCallback(n))},f.longPressTimeout||c.LONG_PRESS_TIMEOUT)}l=k.once(b,"touchend",function(b){!m&&g(b)&&a(b);d()});q=k.once(b,"touchcancel",d)});return{remove:function(){g&&g.remove();d()}}},addGlobalDragHanlder:function(b){function a(){f&&f.remove();d&&d.remove();c&&c.remove();m&&m.remove();l&&b.destroyDnDBox&&
b.destroyDnDBox(l)}b.tolerance=0<b.tolerance?b.tolerance:5;var f,d,c,m,l;return k(b.node,b.downEventName||e.press,function(n){a();if(!b.onMouseDown||b.onMouseDown(n)){var q=n.clientX,p=n.clientY,r=q,u=p;f=k(document.body,e.move,function(n){n.shiftKey||g.isCtrl(n)||!(Math.abs(q-n.clientX)>=b.tolerance||Math.abs(p-n.clientY)>=b.tolerance)||(f.remove(),b.dragStarted&&!b.dragStarted(n,n.clientX-r,n.clientY-u))||(r=n.clientX,u=n.clientY,l=b.createDnDBox&&b.createDnDBox(),d=k(document.body,e.move,function(a){b.dragMoved&&
b.dragMoved(a,a.clientX-r,a.clientY-u);r=a.clientX;u=a.clientY}),c=k.once(document.body,h("ie")||h("trident")?"mouseup, touchend, click":"mouseup, touchend",function(){a();b.dragEnded&&b.dragEnded()}),m=k(document.body,"keyup",function(d){27==d.keyCode&&(a(),b.dragCanceled&&b.dragCanceled())}))});k.once(document.body,h("ie")||h("trident")?"mouseup, touchend, click":"mouseup, touchend",function(){f.remove()})}})}};return c})},"esri/dijit/geoenrichment/utils/KeyboardUtil":function(){define(["dojo/on",
"dojo/sniff","./DomUtil"],function(k,h,e){var g={listenToKeyboardCombinationOverNode:function(a){return k(document.body,"keydown",function(b){if(!a.isCtrl||g.isCtrl(b))if(!a.isShift||b.shiftKey)if(!a.isAlt||b.altKey)String.fromCharCode(b.keyCode).toLowerCase()!==a["char"]||a.node&&!e.isNodeInLayout(a.node)||a.callback(b)})},isCtrl:function(a){return a.ctrlKey||c.ctrlKey||c.cmdKey||h("mac")&&a.metaKey}},c={};if(h("mac")){var b=function(b,e){kC=b.keyCode;(a||f)&&(91===kC||93===kC)||d&&224===kC?c.cmdKey=
e:16===kC?c.shiftKey=e:17===kC?c.ctrlKey=e:18===kC&&(c.altKey=e)},a=h("webkit"),f=h("opera"),d=h("mozilla");k(document.body,"keydown",function(a){b(a,!0)});k(document.body,"keyup",function(a){b(a,!1)})}return g})},"esri/dijit/geoenrichment/utils/MouseUtil":function(){define("dojo/_base/lang dojo/on dojo/sniff dojo/touch dojo/dom-geometry ./DomUtil dojo/domReady!".split(" "),function(k,h,e,g,c,b){var a={_latestEvent:null,_setLatestEvent:function(b){a._latestEvent=b}};e("touch")?(h(document.body,g.press,
function(b){a._setLatestEvent(a.fixTouchEvent(b,!0))}),h(document.body,g.move,function(b){a._setLatestEvent(a.fixTouchEvent(b,!0))})):h(document.body,"mousemove",function(b){a._setLatestEvent(a.fixTouchEvent(b,!0))});var f;h(document.body,"mousedown",function(){f||(f=!0,h.once(document.body,"mouseup, click",function(){f=!1}))});a.getCursorPosition=function(){return a._latestEvent};a.isMouseOver=function(d,f){var e=f&&f.event||a._latestEvent;if(!(d&&d.parentNode&&d.getBoundingClientRect&&e))return!1;
if(f&&f.checkAllChildren){f=k.mixin({},f);delete f.checkAllChildren;var l=!1;b.traverseChildren(d,function(b){if(a.isMouseOver(b,f))return l=!0});return l}return a.isMouseOverBox(c.position(d),f)};a.isMouseOverBox=function(b,f){if(!b)return!1;var d=f&&f.event||a._latestEvent;f&&f.ignoreBorderTolerance&&(f=f.ignoreBorderTolerance,b=k.mixin({},b),b.x+=f,b.y+=f,b.w-=2*f,b.h-=2*f);return b.x<=d.clientX&&b.x+b.w>=d.clientX&&b.y<=d.clientY&&b.y+b.h>=d.clientY};a.fixTouchEvent=function(a,b){a=b?k.mixin({},
a):a;a.touches&&1===a.touches.length?(b=a.touches[0],a.clientX=b.clientX,a.clientY=b.clientY,a.pageX=b.pageX,a.pageY=b.pageY):a.changedTouches&&1===a.changedTouches.length&&(b=a.changedTouches[0],a.clientX=b.clientX,a.clientY=b.clientY,a.pageX=b.pageX,a.pageY=b.pageY);return a};a.isBeingDragged=function(){return f};a.addOverOutHandler=function(b){function d(){clearTimeout(c);f&&f.remove()}var f,c,e=h(b.node,"mouseover",function(e){function l(){a.isMouseOver(b.node)&&(b.onMouseOver(e),f=h(document.body,
"mousemove",function(f){a.isMouseOver(b.node)||(d(),b.onMouseOut(f))}))}d();b.delayTimeout?c=setTimeout(l,b.delayTimeout):l()});return{remove:function(){e.remove();d()}}};a.addOutHandler=function(b,f){return h(document.body,"mousemove",function(d){a.isMouseOver(b,{checkAllChildren:!0})||f(d)})};return a})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_PrintSupport":function(){define(["require","dojo/_base/declare","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(k,
h,e,g){function c(){var b=new e;k(["../printing/PrintableContainer"],function(a){b.resolve(a)});return b.promise}return h(null,{_getPrintableContainer:function(b){var a=this;return c().then(function(f){var d=new f(a,a._viewModel);b.onShowWaiting=function(b){a._showWaiting(b)};return g(d.initialize(b),function(a){return a?a:g(d.stop(),function(){return null})})})},_getPrintDialogSettings:function(){var b=this;return c().then(function(a){return(new a(b,b._viewModel)).getPrintDialogSettings()})}})})},
"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_ReportContainersSwitcher":function(){define("dojo/_base/declare esri/dijit/geoenrichment/when dojo/dom-attr dojo/dom-class dojo/dom-construct ../PlayerResizeModes ../PlayerViewModes esri/dijit/geoenrichment/utils/DomUtil".split(" "),function(k,h,e,g,c,b,a,f){var d={createContainer:function(d,f){function c(){var a={viewModel:g,parentWidget:f,currentFeatureIndex:d,isSourceContainer:!0,onPendingDataApplied:function(){f._emitResizedEvent()}};a.renderOptions=
f.resizeMode!==b.AUTO?{center:!0,minTop:10}:{center:!0,minTop:10,minRight:10,minBottom:10,minLeft:10};return g.layoutBuilder.createElement("classic"===n?"reportContainer":"reportContainerGrid",a,f.reportContainerDiv)}function e(){return g.layoutBuilder.createElement("reportContainerPagination",{viewModel:g,parentWidget:f,currentFeatureIndex:d,scaleSectionsToFit:f.scaleSlidesToFitWindow,onResized:function(a){f.playerToolbar.update();f._emitResizedEvent(a)},onPendingDataApplied:function(){f._emitResizedEvent()}},
f.reportContainerDiv)}function l(a){var c;c=f.resizeMode!==b.AUTO?{center:!0,minLeft:"row"===n?10:0}:{center:!0,minRight:10,minBottom:10,minLeft:10};c.minTop=f.showToolbarInPopup?"row"===n?50:43:10;return g.layoutBuilder.createElement("reportContainerStack",{viewModel:g,parentWidget:f,currentFeatureIndex:d,isVertical:a,renderOptions:c,onPendingDataApplied:function(){f._emitResizedEvent()}},f.reportContainerDiv)}var g=f._viewModel,n;switch(f.viewMode){case a.PANELS_IN_SLIDES:n="pagination";break;case a.PANELS_IN_STACK:n=
"stack";break;case a.PANELS_IN_ROW:n="row";break;default:n=f._reportData.isClassic?"classic":"graphic"}var m=f._containerDict.getContainer(d);if(!m){switch(n){case "pagination":m=e();break;case "stack":m=l(!0);break;case "row":m=l(!1);break;default:m=c()}m.isCurrentContainer=function(){return f.getCurrentReportContainer()===m};f.own(m)}f._containerDict.setContainer(m,d);return m}},n=k(null,{_containerInfos:null,constructor:function(){this._containerInfos=[]},getContainer:function(a){return this._getInfo(a,
"container")},getContainers:function(){return this._containerInfos.map(function(a){return a.container})},getContainerIndex:function(a){return this.getContainers().indexOf(a)},setContainer:function(a,b){e.set(a.domNode,"area-index",b);this._getInfo(b,null,a)},isLoaded:function(a){return this._getInfo(a,"loaded")},setLoaded:function(a){if(a=this._getInfo(a))a.loaded=!0},resetAllLoaded:function(){this._containerInfos.forEach(function(a){a.loaded=!1})},destroyAllContainers:function(){this._containerInfos.forEach(function(a){a.container.destroy()});
this._containerInfos.length=0},_getInfo:function(a,b,d){var f=this._containerInfos[a];!f&&d&&(f=this._containerInfos[a]={container:d,loaded:!1});return b?f&&f[b]:f}}),m=k(null,{_lastVisuals:null,reset:function(){this._lastVisuals=null},rememberCurrentContainerVisuals:function(a){this._lastVisuals=a?{scrollTop:a.getScrollableContainer&&a.getScrollableContainer().scrollTop||0,pageIndex:a.getCurrentPageIndex&&a.getCurrentPageIndex()||0,slideIndex:a.getCurrentSlideIndex&&a.getCurrentSlideIndex()||0,zoomInfo:a.getZoomInfo&&
a.getZoomInfo()}:null},applyCurrentContainerVisuals:function(a){this._lastVisuals&&(a.getScrollableContainer&&(a.getScrollableContainer().scrollTop=this._lastVisuals.scrollTop||0),a.showSlideAt&&a.showSlideAt(this._lastVisuals.slideIndex||0),a.showPageAt&&a.showPageAt(this._lastVisuals.pageIndex||0),a.setZoomInfo&&a.setZoomInfo(this._lastVisuals.zoomInfo))}});return k(null,{_containerDict:null,_visualsHelper:null,_initContainerSwither:function(){this._containerDict=new n;this._visualsHelper=new m},
getCurrentReportContainer:function(){return this._currentReportContainer},getAllReportContainers:function(){return this._containerDict.getContainers()},_destroyAllContainers:function(){this._containerDict.destroyAllContainers();this._currentReportContainer=null},_setReportContainer:function(a){var b=this;a?this._resetLoadedFlags():this._visualsHelper.rememberCurrentContainerVisuals(this._currentReportContainer);this._switchToCurrentReportContainer();return!a&&this._containerDict.isLoaded(this.getCurrentAnalysisAreaIndex())?
h(this._resize({isPaginating:!0}),function(){b._visualsHelper.applyCurrentContainerVisuals(b._currentReportContainer);return!1}):!0},_switchToCurrentReportContainer:function(){this._currentReportContainer&&this._hideContainer(this._currentReportContainer);this._currentReportContainer=d.createContainer(this.getCurrentAnalysisAreaIndex(),this);g.remove(this.domNode,"esriGEReportPlayerFullView esriGEReportPlayerPaginationView esriGEReportPlayerStackView esriGEReportPlayerRowView");switch(this.viewMode){case a.PANELS_IN_SLIDES:g.add(this.domNode,
"esriGEReportPlayerPaginationView");break;case a.PANELS_IN_STACK:g.add(this.domNode,"esriGEReportPlayerStackView");break;case a.PANELS_IN_ROW:g.add(this.domNode,"esriGEReportPlayerRowView");break;default:g.add(this.domNode,"esriGEReportPlayerFullView")}this._showContainer(this._currentReportContainer);this._connectZoomToCurrentContainer();this.notifyShown()},_hideContainer:function(a){a.__undoHideContainerHandle=f.hideNodeInBackground(a.domNode,"reportContainer_"+this._containerDict.getContainerIndex(a));
a.own(a.__undoHideContainerHandle)},_showContainer:function(a){a.__undoHideContainerHandle&&(a.__undoHideContainerHandle.undo(),delete a.__undoHideContainerHandle)},_showAllContainers:function(){var a=this;this.getAllReportContainers().forEach(function(b){a._showContainer(b);a.reportContainerDiv.removeChild(b.domNode);c.place(b.domNode,a.reportContainerDiv)});return{undo:function(){a.getAllReportContainers().forEach(function(b){a._hideContainer(b)});a._switchToCurrentReportContainer()}}},_resetLoadedFlags:function(){this._visualsHelper.reset();
this._containerDict.resetAllLoaded()},_setCurrentContainerLoaded:function(){this._visualsHelper.applyCurrentContainerVisuals(this._currentReportContainer);this._containerDict.setLoaded(this.getCurrentAnalysisAreaIndex())}})})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_SmartLayoutSupport":function(){define("dojo/_base/declare esri/dijit/geoenrichment/when dojo/dom-class dojo/on esri/dijit/geoenrichment/utils/DomUtil ../PlayerResizeModes".split(" "),function(k,h,e,g,c,b){return k(null,
{_width:0,_height:0,_measuredWinBox:null,_initSmartLayout:function(){var a=this;this.resizeMode===b.FIT_WINDOW&&this.own(g(window,"resize, orientationchange",function(){setTimeout(function(){a._measuredWinBox=null;a.resize()})}));this._resize()},_resize:function(a){a=a||{};e.remove(this.domNode,"esriGEReportPlayerFullScreen esriGEReportPlayerAutoResize esriGEReportPlayerManualResize");switch(this.resizeMode){case b.FIT_WINDOW:return this._resize_fitWindow(a);case b.AUTO:return this._resize_auto(a);
case b.MANUAL:return this._resize_manual(a)}},_resize_fitWindow:function(a){var b=this;this._measuredWinBox=this._measuredWinBox||c.getWindowBox();this._width=this._maxWidth=this._measuredWinBox.w;this._height=this._maxHeight=this._measuredWinBox.h;e.add(this.domNode,"esriGEReportPlayerFullScreen");this.domNode.style.width=this._width+"px";this.domNode.style.height=this._height+"px";if(this._currentReportContainer)return this._currentReportContainer.setMaxWidth&&this._currentReportContainer.setMaxWidth(this._maxWidth),
this._currentReportContainer.setMaxHeight&&this._currentReportContainer.setMaxHeight(this._maxHeight-this._getToolbarHeight()),h(this._currentReportContainer.resize(this._width,this._height-this._getToolbarHeight()),function(){b._emitResizedEvent(a.isPaginating)})},_resize_auto:function(a){var b=this;this._height=this._width=0;e.add(this.domNode,"esriGEReportPlayerAutoResize");this.domNode.style.width="auto";this.domNode.style.height="auto";if(this._currentReportContainer)return this._currentReportContainer.setMaxWidth&&
this._currentReportContainer.setMaxWidth(this._maxWidth),this._currentReportContainer.setMaxHeight&&this._currentReportContainer.setMaxHeight(this._maxHeight-this._getToolbarHeight()),h(this._currentReportContainer.resize(0,0),function(){b._emitResizedEvent(a.isPaginating)})},_resize_manual:function(a){var b=this;this._width=void 0!==a.width?a.width:this._width;this._height=void 0!==a.height?a.height:this._height;if(this._width&&this._height&&(this._maxWidth&&(this._width=Math.min(this._maxWidth,
this._width)),this._maxHeight&&(this._height=Math.min(this._maxHeight,this._height)),e.add(this.domNode,"esriGEReportPlayerManualResize"),this.domNode.style.width=this._width+"px",this.domNode.style.height=this._height+"px",this._currentReportContainer))return this._currentReportContainer.setMaxWidth&&this._currentReportContainer.setMaxWidth(this._maxWidth||this._width),this._currentReportContainer.setMaxHeight&&this._currentReportContainer.setMaxHeight((this._maxHeight||this._height)-this._getToolbarHeight()),
h(this._currentReportContainer.resize(this._width,this._height-this._getToolbarHeight()),function(){b._emitResizedEvent(a.isPaginating)})},_getToolbarHeight:function(){return this.showToolbarInPopup?0:50},_maxWidth:0,_maxHeight:0,setMaxWidth:function(a){this._maxWidth=a},setMaxHeight:function(a){this._maxHeight=a}})})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_ZoomSupport":function(){define(["dojo/_base/declare","dojo/aspect","../PlayerResizeModes","../PlayerViewModes","../PlayerZoomBehaviors"],
function(k,h,e,g,c){return k(null,{_initZoomControls:function(){var b=this;this.playerToolbar.onZoomToFitPage=function(){b.getCurrentReportContainer().zoomToFitPage({showAnimation:!0})};this.playerToolbar.onZoomToFitPageWidth=function(){b.getCurrentReportContainer().zoomToFitPageWidth({showAnimation:!0})};this.playerToolbar.onZoomToFitPageHeight=function(){b.getCurrentReportContainer().zoomToFitPageHeight({showAnimation:!0})};this.playerToolbar.onSetZoomPercent=function(a){b.getCurrentReportContainer().setZoomPercent(a,
{showAnimation:!0})};this._refreshZoomControls()},_refreshZoomControls:function(){this.playerToolbar.setZoomSupportsInfo(this._getZoomSupportsInfo())},setBestZoom:function(){this._callZoomMethod("setBestZoom")},zoomToFitPage:function(){this._callZoomMethod("zoomToFitPage")},zoomToFitPageWidth:function(){this._callZoomMethod("zoomToFitPageWidth")},zoomToFitPageHeight:function(){this._callZoomMethod("zoomToFitPageHeight")},resetZoom:function(){this._callZoomMethod("resetZoom")},_callZoomMethod:function(b){if(this._getZoomSupportsInfo().supported){var a=
this.getCurrentReportContainer();a&&a[b]&&a[b]()}},_getZoomSupportsInfo:function(){var b={supported:!1,canFitPage:!1,canFitPageWidth:!1,canFitPageHeight:!1};this.viewMode!==g.PANELS_IN_SLIDES&&(b.supported=!0,this.resizeMode!==e.AUTO&&(b.canFitPage=!g.isStackLike(this.viewMode),b.canFitPageWidth=this.viewMode!==g.PANELS_IN_ROW,b.canFitPageHeight=this.viewMode===g.PANELS_IN_ROW));return b},_updateZoomControls:function(){this._connectZoomToCurrentContainer();this._applyDefaultZoomBehavior()},_reportContainerZoomChangedHandle:null,
_connectZoomToCurrentContainer:function(){var b=this.getCurrentReportContainer();this._reportContainerZoomChangedHandle&&this._reportContainerZoomChangedHandle.remove();this._reportContainerZoomChangedHandle=b&&h.after(b,"onZoomChanged",function(){var a=this.getCurrentReportContainer();a&&a.getZoomInfo&&this.playerToolbar.setZoomInfo(this.getCurrentReportContainer().getZoomInfo());this._updatePageNavigator();this.playerToolbar.update()}.bind(this));b&&b.own(this._reportContainerZoomChangedHandle)},
_applyDefaultZoomBehavior:function(){var b=this._getZoomSupportsInfo();b.supported&&b.canFitPage&&this.defaultZoomBehavior===c.FIT_PAGE?this.zoomToFitPage():b.supported&&b.canFitPageWidth&&this.defaultZoomBehavior===c.FIT_PAGE_WIDTH?this.zoomToFitPageWidth():b.supported&&b.canFitPageHeight&&this.defaultZoomBehavior===c.FIT_PAGE_HEIGHT?this.zoomToFitPageHeight():this.resetZoom()}})})},"esri/dijit/geoenrichment/ReportPlayer/PlayerZoomBehaviors":function(){define([],function(){return{RESET:"reset",FIT_PAGE:"fitPage",
FIT_PAGE_WIDTH:"fitPageWidth",FIT_PAGE_HEIGHT:"fitPageHeight"}})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_WaitingSupport":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when dojo/dom-construct ../PlayerResizeModes esri/dijit/geoenrichment/utils/DelayUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/WaitingUtil esri/dijit/geoenrichment/utils/progress/SmoothProgress".split(" "),function(k,h,e,g,c,b,a,f,d){var n=k(null,{_dataProgress:0,
_areaProgresses:null,_numAreas:0,constructor:function(a){h.mixin(this,a);this.reset()},reset:function(){this._dataProgress=0;this._areaProgresses={};this._fireProgress()},setLoadDataProgress:function(a){this._dataProgress=a;this._fireProgress()},setNumAreas:function(a){this._numAreas=a},setProgressForAreaAt:function(a,b){this._areaProgresses[b]=a;this._fireProgress()},finalize:function(){this.onDone();return b.delay(300)},_setProgress:function(a){this._currentProgress=a;this.onChange(this._currentProgress)},
_fireProgress:function(){var a=.25*this._dataProgress,b=.75/this._numAreas,d;for(d in this._areaProgresses)a+=b*(this._areaProgresses[d]||0);a=Math.min(1,Math.max(0,a));this.onChange(a);this._printProgress()},_printProgress:function(){},onChange:function(a){},onDone:function(){}});return k(null,{_progressController:null,_initProgressController:function(){var a=this;this.showProgressBar&&(this._progressController=new n,(new d(this._progressController)).onChange=function(b){f.showProgressBar({value:b,
node:a.domNode,position:"top"})})},_waitingCount:0,_hideUndoHandle:null,_waitNode:null,getWaitingPromise:function(){return f.getProgressPromiseForNode(this._waitNode||this.domNode)},_showWaiting:function(b){var d=this;return this.resizeMode!==c.FIT_WINDOW?(0===this._waitingCount++&&(this._waitNode=g.create("div",{"class":"esriGEReportPlayerWaitingNode"},this.domNode.parentNode),this._waitNode.style.width=this.domNode.clientWidth?this.domNode.clientWidth+"px":"",this._waitNode.style.height=this.domNode.clientHeight?
this.domNode.clientHeight+"px":"",this._waitNode.style.position="relative",this._hideUndoHandle=a.hideNodeInBackground(this.domNode)),e(b).always(function(){0===--d._waitingCount&&(d._hideUndoHandle.undo(),d._hideUndoHandle=null,g.destroy(d._waitNode))}),f.showProgressPromise(this._waitNode,b,{progressClass:"esriGEReportPlayerProgress"})):this._showWaitingFullScreen(b)},_showWaitingFullScreen:function(a){return f.showProgressPromise(this.domNode,a,{progressClass:"esriGEReportPlayerProgress",onShowProgress:this._onShowWaiting.bind(this),
onRemoveProgress:this._onRemoveWaiting.bind(this)})},_onShowWaiting:function(){this.normalViewDiv.style.opacity="0.001";this.sidePageNavigator.style.opacity="0.001"},_onRemoveWaiting:function(){this.domNode&&(this.normalViewDiv.style.opacity="",this.sidePageNavigator.style.opacity="")}})})},"esri/dijit/geoenrichment/utils/DelayUtil":function(){define(["esri/dijit/geoenrichment/Deferred"],function(k){return{delay:function(h,e){var g=new k,c="function"===typeof h?h:null;setTimeout(g.resolve,("number"===
typeof h?h:e)||0);return g.promise.then(function(){return c&&c()})}}})},"esri/dijit/geoenrichment/utils/WaitingUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style"],function(k,h,e,g,c){var b={showProgress:function(a,b){a&&!a["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]&&(a["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]=e.create("div",{"class":"esriGEProgress esriGEProgressAbsolute "+
(b||"")},a))},removeProgress:function(a){a&&a["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]&&(e.destroy(a["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]),delete a["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"])},showProgressBar:function(a){var b=a.node;if(b){b._progressBar&&e.destroy(b._progressBar);delete b._progressBar;var d=Number(a.value);0>=d||isNaN(d)||(d=Math.min(d,1),b._progressBar=e.create("div",{"class":"esriGEWaitingMessageProgressBar esriGEWaitingMessageProgressBar_"+
(a.position||"bottom")},b),c.set(b._progressBar,"width",g.position(b).w*d+"px"))}},showProgressPromise:function(a,f,d){d=d||{};void 0===a.__progressIndex&&(a.__progressIndex=0);0===a.__progressIndex&&(a.__progressDfd=new k,b.showProgress(a,d.progressClass),d.onShowProgress&&d.onShowProgress());a.__progressIndex++;h(f).always(function(){a.__progressIndex=Math.max(0,--a.__progressIndex);0===a.__progressIndex&&(a.__progressDfd&&a.__progressDfd.resolve(),delete a.__progressDfd,b.removeProgress(a),d.onRemoveProgress&&
d.onRemoveProgress())});return f},getProgressPromiseForNode:function(a){return a&&a.__progressDfd&&a.__progressDfd.promise}};return b})},"esri/dijit/geoenrichment/utils/progress/SmoothProgress":function(){define(["dojo/_base/declare","dojo/aspect","../DelayUtil"],function(k,h,e){return k(null,{elasticTime:1E3,fireInterval:30,runAheadSpeed:2.5E-4,_intervalHandle:null,_progressH:null,_doneH:null,_realProgress:0,_smoothProgress:0,_currentSpeed:0,constructor:function(e){var c=this;this._progressH=h.after(e,
"onChange",function(b){c._updateProgress(b)},!0);this._doneH=h.after(e,"onDone",function(b){c.finalize()},!0)},_setIntervalHandle:function(e){e&&this._intervalHandle||(e?this._intervalHandle=setInterval(this._tryFireProgress.bind(this),this.fireInterval):(clearInterval(this._intervalHandle),this._intervalHandle=null))},_updateProgress:function(e){this._realProgress=e;0>=this._realProgress?(this._currentSpeed=this._smoothProgress=0,this._setIntervalHandle(!1),this.onChange(0)):(this._setIntervalHandle(!0),
this._currentSpeed=this._smoothProgress>=this._realProgress?this.runAheadSpeed:(this._realProgress-this._smoothProgress)*this.fireInterval/this.elasticTime)},_tryFireProgress:function(){0!==this._currentSpeed&&(this._smoothProgress+=this._currentSpeed,this._smoothProgress=Math.min(1,this._smoothProgress),this._smoothProgress>=this._realProgress&&(this._currentSpeed=this.runAheadSpeed),this.onChange(this._smoothProgress))},finalize:function(){this._smoothProgress=1;this.onChange(this._smoothProgress);
return e.delay(100)},onChange:function(e){},destroy:function(){this._progressH.remove();this._doneH.remove();this._setIntervalHandle(!1)}})})},"esri/dijit/geoenrichment/ReportPlayer/supportClasses/PlayerConfigurator":function(){define("../PlayerResizeModes ../PlayerZoomBehaviors ../PlayerThemes ../PlayerViewModes ../config esri/dijit/geoenrichment/utils/DeviceUtil".split(" "),function(k,h,e,g,c,b){var a={configurePlayer:function(f){b.isMobileDevice()?a._configureMobile(f):a._configurePC(f)},_configureMobile:function(a){a.allowAutoOrientation&&
(a.viewMode=b.isLandscape()?a.mobileLandscapeViewMode||g.PANELS_IN_SLIDES:g.PANELS_IN_STACK);a.theme=a.theme||e.DARK;a.viewMode=g.isMobileSupported(a.viewMode)?a.viewMode:g.PANELS_IN_STACK;a.resizeMode=a.resizeMode||k.FIT_WINDOW;a.enableDataDrilling=!1!==a.enableDataDrilling;a.showAreaTitle=!1;a.showToolbarInPopup=!0;a.defaultZoomBehavior=a.viewMode===g.PANELS_IN_STACK?h.FIT_PAGE_WIDTH:a.viewMode===g.PANELS_IN_ROW?h.FIT_PAGE_HEIGHT:void 0;a.showDataDrillingInsidePanel=!1;a.scaleSlidesToFitWindow=
a.viewMode===g.PANELS_IN_SLIDES;c.modules.exportCommands=!1;c.modules.complexCellTooltips=!1},_configurePC:function(b){b.theme=b.theme||e.DARK;b.viewMode=b.viewMode||g.FULL_PAGES;b.resizeMode=b.resizeMode||k.FIT_WINDOW;b.showToolbarInPopup=!!b.showToolbarInPopup;b.enableDataDrilling=!1!==b.enableDataDrilling;b.showDataDrillingInsidePanel=!!b.showDataDrillingInsidePanel;c.modules.complexCellTooltips=b.viewMode===g.FULL_PAGES;switch(b.viewMode){case g.FULL_PAGES:a._configurePC_fullPages(b);break;case g.PANELS_IN_SLIDES:a._configurePC_panelsInSlides(b);
break;case g.PANELS_IN_STACK:a._configurePC_panelsInStack(b);break;case g.PANELS_IN_ROW:a._configurePC_panelsInRow(b)}},_configurePC_fullPages:function(a){a.showAreaTitle=!1!==a.showAreaTitle;a.scaleSlidesToFitWindow=!1;switch(a.resizeMode){case k.FIT_WINDOW:a.defaultZoomBehavior=a.defaultZoomBehavior||h.FIT_PAGE;break;case k.AUTO:a.defaultZoomBehavior=h.RESET;break;case k.MANUAL:a.defaultZoomBehavior=a.defaultZoomBehavior||h.FIT_PAGE}},_configurePC_panelsInSlides:function(a){a.showAreaTitle=!!a.showAreaTitle;
a.defaultZoomBehavior=null;switch(a.resizeMode){case k.FIT_WINDOW:a.scaleSlidesToFitWindow=!1!==a.scaleSlidesToFitWindow;break;case k.AUTO:a.scaleSlidesToFitWindow=!1;break;case k.MANUAL:a.scaleSlidesToFitWindow=!1!==a.scaleSlidesToFitWindow}},_configurePC_panelsInStack:function(a){a.showAreaTitle=!!a.showAreaTitle;a.scaleSlidesToFitWindow=!1;switch(a.resizeMode){case k.FIT_WINDOW:a.defaultZoomBehavior=h.FIT_PAGE_WIDTH;break;case k.AUTO:a.defaultZoomBehavior=h.RESET;break;case k.MANUAL:a.defaultZoomBehavior=
h.FIT_PAGE_WIDTH}},_configurePC_panelsInRow:function(a){a.showAreaTitle=!!a.showAreaTitle;a.scaleSlidesToFitWindow=!1;switch(a.resizeMode){case k.FIT_WINDOW:a.defaultZoomBehavior=h.FIT_PAGE_HEIGHT;break;case k.AUTO:a.defaultZoomBehavior=h.RESET;break;case k.MANUAL:a.defaultZoomBehavior=h.FIT_PAGE_HEIGHT}}};return a})},"esri/dijit/geoenrichment/ReportPlayer/PlayerThemes":function(){define([],function(){return{LIGHT:"light",DARK:"dark"}})},"esri/dijit/geoenrichment/ReportPlayer/supportClasses/PlayerToFullScreenAnimator":function(){define(["esri/dijit/geoenrichment/utils/animation/AnimationUtil",
"esri/dijit/geoenrichment/utils/DelayUtil"],function(k,h){return{animateTo:function(e){if(!e._isAnimatedTo){e._isAnimatedTo=!0;var g=k.animateResize({duration:300,domNode:e.domNode,startScaleX:.3,startScaleY:.3,fromOffset:{x:"c",y:"c"},toBox:{x:0,y:0,w:document.body.clientWidth,h:document.body.clientHeight}});k.animateFadeIn({domNode:e.domNode,duration:300});return g.then(function(){return h.delay(100)})}},animateFrom:function(e){if(e._isAnimatedTo){e._isAnimatedTo=!1;var g=k.animateResize({duration:300,
domNode:e.domNode,endScaleX:.3,endScaleY:.3,toOffset:{x:"c",y:"c"},toBox:{x:(document.body.clientWidth-300)/2,y:(document.body.clientHeight-200)/2,w:300,h:200}});k.animateFadeOut({domNode:e.domNode,duration:300});return g.then(function(){return h.delay(100)})}}}})},"esri/dijit/geoenrichment/utils/animation/AnimationUtil":function(){define(["dojo/dom-construct","dojo/dom-style","dojo/sniff","./Animator","esri/dijit/geoenrichment/utils/DomUtil"],function(k,h,e,g,c){var b={animateResize:function(a){function b(b){a.domNode=
k.create("div",{"class":a.ghostClass},document.body);h.set(a.domNode,{width:b.w+"px",height:b.h+"px"})}function d(b,d,f){var c,e=a.fromOffset.x,g=a.fromOffset.y;if("number"!==typeof e)switch(c=d.w*f.x,e){case "l":e=0;break;case "r":e=(b.w||0)-c;break;default:e=((b.w||0)-c)/2}if("number"!==typeof g)switch(c=d.h*f.y,g){case "t":g=0;break;case "b":g=(b.h||0)-c;break;default:g=((b.h||0)-c)/2}return{x:b.x+e,y:b.y+g}}function n(b,d,f){var c,e=a.toOffset.x,g=a.toOffset.y;if("number"!==typeof e)switch(c=
b.w*f.x,e){case "l":e=0;break;case "r":e=(d.w||0)-c;break;default:e=((d.w||0)-c)/2}if("number"!==typeof g)switch(c=b.h*f.y,g){case "t":g=0;break;case "b":g=(d.h||0)-c;break;default:g=((d.h||0)-c)/2}return{x:d.x+e,y:d.y+g}}var m=a.fromBox||(a.domFrom||a.domNode)&&c.noTransformPosition(a.domFrom||a.domNode);a.animateGhost&&b(m);var l=a.toBox||c.noTransformPosition(a.domTo);if(m&&l){var p=function(b,d){var f={x:a.startScaleX,y:a.startScaleY},c=0;"fit"===f.x&&(b.w?c=f.x=b.w/d.w:f.x=0);"fit"===f.y&&(b.h?
c=Math.max(f.y=b.h/d.h,c):f.y=0);f.x=f.x||c||1;f.y=f.y||c||1;return f}(m,l),q=function(b,d){var f={x:a.endScaleX,y:a.endScaleY},c=0;"fit"===f.x&&(d.w?c=f.x=d.w/b.w:f.x=0);"fit"===f.y&&(d.h?c=Math.max(f.y=d.h/b.h,c):f.y=0);f.x=f.x||c||1;f.y=f.y||c||1;return f}(m,l);a.fromOffset&&(m=d(m,l,p));a.toOffset&&(l=n(m,l,q));var v=e("webkit")?"webkitTransformOrigin":"transformOrigin";a.domNode.style[v]="0% 0%";return g.animateProperty({obj:a.domNode,duration:a.duration||250,properties:{__x:{start:m.x,end:l.x},
__y:{start:m.y,end:l.y},__scaleX:{start:p.x||1,end:q.x},__scaleY:{start:p.y||1,end:q.y}},endFunction:function(){a.animateGhost&&k.destroy(a.domNode);a.onEnd&&a.onEnd()},progressFunction:function(b,d){var f=e("webkit")?"webkitTransform":"transform";"__x"==b?a.domNode.style.left=d+"px":"__y"==b?a.domNode.style.top=d+"px":"__scaleX"==b?a.domNode.style[f]="scaleX("+d+") scaleY("+(a.domNode.__scaleY||1)+")":"__scaleY"==b&&(a.domNode.style[f]="scaleX("+(a.domNode.__scaleX||1)+") scaleY("+d+")")}}).promise}a.onEnd&&
a.onEnd()},animateShrinkResize:function(a){a.endScaleX=a.endScaleX||.1;a.endScaleY=a.endScaleY||.05;return b.animateResize(a)},animateFadeIn:function(a){return g.animateProperty({obj:a.domNode.style,duration:a.duration||250,properties:{opacity:{start:0,end:1}},endFunction:function(){a.onEnd&&a.onEnd()}}).promise},animateFadeOut:function(a){return g.animateProperty({obj:a.domNode.style,duration:a.duration||250,properties:{opacity:{start:1,end:0}},endFunction:function(){a.onEnd&&a.onEnd()}}).promise},
animateSlide:function(a,b,d){var f=d.width;g.animateProperty({obj:a.style,duration:d.duration||250,properties:{left:{start:d.leftToRight?0:-f,end:d.leftToRight?-f:0,addPx:!0},right:{start:d.leftToRight?0:f,end:d.leftToRight?f:0,addPx:!0}},endFunction:function(){d.onEnd&&d.onEnd()}});return g.animateProperty({obj:b.style,duration:d.duration||250,properties:{left:{start:d.leftToRight?f:0,end:d.leftToRight?0:f,addPx:!0},right:{start:d.leftToRight?-f:0,end:d.leftToRight?0:-f,addPx:!0}}}).promise},animateExpand:function(a,
b,d){d=d||{};a.style.overflow="hidden";b&&c.show(a);var f=h.get(a,"height");return g.animateProperty({obj:a.style,duration:d.duration,properties:{height:{start:b?0:f,end:b?f:0,addPx:!0}},progressFunction:d.progressFunction,endFunction:function(){!b&&c.hide(a);h.set(a,"height","");h.set(a,"overflow","")}}).promise}};return b})},"esri/dijit/geoenrichment/utils/animation/Animator":function(){define(["esri/dijit/geoenrichment/Deferred","dojo/fx/easing","dojox/gfx/matrix"],function(k,h,e){function g(a){for(var b in a.params.properties){var f=
a.params.properties[b],c=f.easing?"function"===typeof f.easing?f.easing:h[f.easing]:null,c=c?c(a.progress):a.progress,e=f.start+c*(f.end-f.start);a.obj[b]=f.addPx?e+"px":e;a.progressFunction&&a.progressFunction(b,e,c)}}function c(b){1>b.progress&&!b.isStopped?b._executeAnimation=a.setTimeout(function(){var a=(new Date).getTime();b.progress=1-(b.endTime-a)/b.duration;b.progress=Math.min(1,b.progress);g(b);c(b)}):b.endFunction()}var b={},a={_funcs:null,setTimeout:function(a){var b=this;this._funcs?
this._funcs.push(a):(this._funcs=[a],setTimeout(function(){var a=b._funcs;b._funcs=null;a.forEach(function(a){a()})},33))}};b.animateProperty=function(a){var b={},f=new k;b.promise=f.promise;b.params=a;b.obj=a.obj||a.node||{};b.duration=void 0!==a.duration?a.duration:1E3;b.startTime=(new Date).getTime();b.endTime=b.startTime+b.duration;b.progress=0;b.endFunction=function(){a.endFunction&&a.endFunction();f.resolve()};b.progressFunction=a.progressFunction;b.stop=function(){clearTimeout(b._executeAnimation);
b.isStopped=!0};g(b);c(b);return b};b.animateTransform=function(a){var d=a.shape;d.setTransform(null);return b.animateProperty({duration:a.duration,properties:{p:{start:0,end:1,easing:a.easing}},progressFunction:function(b,f,c){var g,l,n,m;a.transform.forEach(function(a){var b=a.start[0]+(a.end[0]-a.start[0])*c,d=a.start[1]+(a.end[1]-a.start[1])*c;"translate"===a.name?(g=b,l=d):"scale"===a.name&&(n=b,m=d)});d.setTransform(new e.Matrix2D({dx:g,dy:l,xx:n,yy:m}))},endFunction:function(){d.setTransform(null);
a.onEnd&&a.onEnd()}}).promise};return b})},"dojo/fx/easing":function(){define(["../_base/lang"],function(k){var h={linear:function(e){return e},quadIn:function(e){return Math.pow(e,2)},quadOut:function(e){return e*(e-2)*-1},quadInOut:function(e){e*=2;return 1>e?Math.pow(e,2)/2:-1*(--e*(e-2)-1)/2},cubicIn:function(e){return Math.pow(e,3)},cubicOut:function(e){return Math.pow(e-1,3)+1},cubicInOut:function(e){e*=2;return 1>e?Math.pow(e,3)/2:(Math.pow(e-2,3)+2)/2},quartIn:function(e){return Math.pow(e,
4)},quartOut:function(e){return-1*(Math.pow(e-1,4)-1)},quartInOut:function(e){e*=2;return 1>e?Math.pow(e,4)/2:-.5*(Math.pow(e-2,4)-2)},quintIn:function(e){return Math.pow(e,5)},quintOut:function(e){return Math.pow(e-1,5)+1},quintInOut:function(e){e*=2;return 1>e?Math.pow(e,5)/2:(Math.pow(e-2,5)+2)/2},sineIn:function(e){return-1*Math.cos(Math.PI/2*e)+1},sineOut:function(e){return Math.sin(Math.PI/2*e)},sineInOut:function(e){return-1*(Math.cos(Math.PI*e)-1)/2},expoIn:function(e){return 0==e?0:Math.pow(2,
10*(e-1))},expoOut:function(e){return 1==e?1:-1*Math.pow(2,-10*e)+1},expoInOut:function(e){if(0==e)return 0;if(1==e)return 1;e*=2;if(1>e)return Math.pow(2,10*(e-1))/2;--e;return(-1*Math.pow(2,-10*e)+2)/2},circIn:function(e){return-1*(Math.sqrt(1-Math.pow(e,2))-1)},circOut:function(e){return Math.sqrt(1-Math.pow(e-1,2))},circInOut:function(e){e*=2;return 1>e?-.5*(Math.sqrt(1-Math.pow(e,2))-1):.5*(Math.sqrt(1-Math.pow(e-2,2))+1)},backIn:function(e){return Math.pow(e,2)*(2.70158*e-1.70158)},backOut:function(e){--e;
return Math.pow(e,2)*(2.70158*e+1.70158)+1},backInOut:function(e){e*=2;if(1>e)return Math.pow(e,2)*(3.5949095*e-2.5949095)/2;e-=2;return(Math.pow(e,2)*(3.5949095*e+2.5949095)+2)/2},elasticIn:function(e){if(0==e||1==e)return e;--e;return-1*Math.pow(2,10*e)*Math.sin(2*(e-.075)*Math.PI/.3)},elasticOut:function(e){return 0==e||1==e?e:Math.pow(2,-10*e)*Math.sin(2*(e-.075)*Math.PI/.3)+1},elasticInOut:function(e){if(0==e)return 0;e*=2;if(2==e)return 1;var g=.3*1.5,c=g/4;if(1>e)return--e,-.5*Math.pow(2,10*
e)*Math.sin(2*(e-c)*Math.PI/g);--e;return.5*Math.pow(2,-10*e)*Math.sin(2*(e-c)*Math.PI/g)+1},bounceIn:function(e){return 1-h.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*Math.pow(e,2):e<2/2.75?7.5625*Math.pow(e-1.5/2.75,2)+.75:e<2.5/2.75?7.5625*Math.pow(e-2.25/2.75,2)+.9375:7.5625*Math.pow(e-2.625/2.75,2)+.984375},bounceInOut:function(e){return.5>e?h.bounceIn(2*e)/2:h.bounceOut(2*e-1)/2+.5}};k.setObject("dojo.fx.easing",h);return h})},"esri/dijit/geoenrichment/ReportPlayer/PlayerToolbar":function(){define("dojo/_base/declare dojo/on dojo/string esri/dijit/geoenrichment/when dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin ./PlayerSelect ./PlayerCommands ./PlayerThemes ./supportClasses/ToolbarArranger ./supportClasses/ZoomUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/InvokeUtil esri/dijit/geoenrichment/utils/MouseUtil esri/dijit/geoenrichment/utils/PopupUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/text!./templates/PlayerToolbarHolder.html dojo/i18n!esri/nls/jsapi".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v,r,u,t,z,w){w=w.geoenrichment.dijit.ReportPlayer.PlayerToolbar;var C=k([a,f],{templateString:z,nls:w,formatAreaTitleFunc:null,formatAreaTitleMultiFunc:null,showAreaTitle:!1,stretchToolbarNode:null,areasSelect:null,pageSelect:null,zoomSelect:null,_toolbarArranger:null,_infographicSelect:null,postCreate:function(){q.hide(this.commandButtonsContainer);this._toolbarArranger=new l({showAreaTitle:this.showAreaTitle,stretchToolbarNode:this.stretchToolbarNode,domNode:this.domNode,
infographicsSelectDiv:this.infographicsSelectDiv,areaTitleDiv:this.areaTitleDiv,areaTitleInnerDiv:this.areaTitleInnerDiv,rightSideControlsBlock:this.rightSideControlsBlock,areasSelectDiv:this.areasSelectDiv,zoomSelectDiv:this.zoomSelectDiv,pageSelectDiv:this.pageSelectDiv,commandButtonsContainer:this.commandButtonsContainer});this._initAreaSelect();this._initPageSelect();this._initZoomSelect();t.autoTooltip(this.domNode)},_initAreaSelect:function(){var a=this;this.areasSelect=(new d({onChange:function(b){a.onShowAnalysisAreaAt(b.value);
a.onClosePopup()}})).placeAt(this.areasSelectDiv);this.own(this.areasSelect)},updateAreaSelect:function(a,b,d,f){var c=a.length,e=a.map(function(a,b){return{label:1===c?a.name:a.shortName||a.name||"",value:b}});this.areasSelect.set("options",e);this.areasSelect.set("value",d);q[1<c&&!f?"show":"hide"](this.areasSelectDiv);this._toolbarArranger.syncRightSideVisibility();f?this.formatAreaTitleMultiFunc?this.formatAreaTitleMultiFunc(this.areaTitleInnerDiv,b):this._formatAreaTitleMulti(b):(a=a[d],this.formatAreaTitleFunc?
this.formatAreaTitleFunc(this.areaTitleInnerDiv,a):this._formatAreaTitle(a))},_formatAreaTitle:function(a){this.areaTitleInnerDiv.innerHTML=a.locationName||a.name},_formatAreaTitleMulti:function(a){this.areaTitleInnerDiv.innerHTML=a.locationName||a.name||a.shortName||""},_pageControlsVisible:!0,_initPageSelect:function(){var a=this;this.pageSelect=(new d({onChange:function(b){a.onShowPageAt(b.value);a.onClosePopup()}})).placeAt(this.pageSelectDiv);this.own(this.pageSelect)},setPageControlsVisible:function(a){this._pageControlsVisible=
a;q[a?"show":"hide"](this.pageSelectDiv)},updatePageSelect:function(a,b){for(var d=[],f=0;f<a;f++)d.push({label:e.substitute(w.pageIndex,{index:f+1}),value:f});this.pageSelect.set("options",d);this.pageSelect.set("value",b);q[this._pageControlsVisible&&1<a?"show":"hide"](this.pageSelectDiv)},_initZoomSelect:function(){var a=this;this.zoomSelect=(new d({onChange:function(b){if(b.value===p.FIT_PAGE)a.onZoomToFitPage();else if(b.value===p.FIT_PAGE_WIDTH)a.onZoomToFitPageWidth();else if(b.value===p.FIT_PAGE_HEIGHT)a.onZoomToFitPageHeight();
else a.onSetZoomPercent(b.value);a.onClosePopup()}})).placeAt(this.zoomSelectDiv);this.own(this.zoomSelect);this.zoomSelect.set("options",p.getOptions());this.zoomSelect.set("value",100)},setZoomSupportsInfo:function(a){q[a.supported?"show":"hide"](this.zoomSelectDiv);this._toolbarArranger.syncRightSideVisibility();this.zoomSelect.store.data.forEach(function(b){b.hidden=!1;if(b.value===p.FIT_PAGE&&!a.canFitPage)b.hidden=!0;else if(b.value===p.FIT_PAGE_WIDTH&&!a.canFitPageWidth)b.hidden=!0;else if(b.value===
p.FIT_PAGE_HEIGHT&&!a.canFitPageHeight)b.hidden=!0;else if(b.isCustomBig||b.isCustomSmall)b.hidden=!b.value})},setZoomInfo:function(a){a=a.isFitPageScale?p.FIT_PAGE:a.isFitPageWidthScale?p.FIT_PAGE_WIDTH:a.isFitPageHeightScale?p.FIT_PAGE_HEIGHT:p.getClosestZoomAndUpdateOptions(100*a.scale,this.zoomSelect.get("options"));a!==this.zoomSelect.get("value")&&this.zoomSelect.set("value",a)},createCommandButton:function(a,b){return this.createCustomCommandButton({callback:b,buttonClass:a.id===n.PRINT?"playerPrintButton":
"playerExportButton",tooltip:a.id===n.PRINT?w.printInfographic:w.exportInfographic,visibleOnError:!1})},createCustomCommandButton:function(a){q.show(this.commandButtonsContainer);var d=b.create("div",{"class":"playerToolbar_commandButtonContainer dijitInline"},this.commandButtonsContainer,a.addFirst?"first":"last");d.__visibleOnError=a.visibleOnError;d=b.create("div",{"class":"playerToolbar_commandButton"},d);a.buttonClass&&c.add(d,a.buttonClass);a.tooltip&&t.setTooltipToNode(d,a.tooltip);h(d,"click",
a.callback);return d},setTheme:function(a){c.remove(this.domNode,"playerThemeDark playerThemeLight");c.add(this.domNode,a===m.DARK?"playerThemeDark":"playerThemeLight");this.areasSelect.setTheme(a);this.pageSelect.setTheme(a);this.zoomSelect.setTheme(a)},setErrorShown:function(a){if(a){q.hide([this.areaTitleDiv,this.areasSelectDiv,this.pageSelectDiv,this.zoomSelectDiv]);for(a=0;a<this.commandButtonsContainer.children.length;a++){var b=this.commandButtonsContainer.children[a];q[b.__visibleOnError?
"show":"hide"](b)}this.arrangeControls()}},arrangeControls:function(){this._toolbarArranger.arrangeControls()},hasVisibleControls:function(){return this._toolbarArranger.hasVisibleControls()},addInfographicsSelect:function(a){this._infographicSelect=a;a.placeAt(this.infographicsSelectDiv)},isMouseOver:function(){return r.isMouseOver(this.domNode)||this.areasSelect&&this.areasSelect.isMouseOver()||this.pageSelect&&this.pageSelect.isMouseOver()||this.zoomSelect&&this.zoomSelect.isMouseOver()||this._infographicSelect&&
this._infographicSelect.isMouseOver&&this._infographicSelect.isMouseOver()},setContentLoadPromise:function(a){q.enableContentAbsolute(this.commandButtonsContainer,!1);q.enableContentAbsolute(this.infographicsSelectDiv,!1);g(a,function(){q.enableContentAbsolute(this.commandButtonsContainer,!0);q.enableContentAbsolute(this.infographicsSelectDiv,!0)}.bind(this))},onShowPageAt:function(a){},onShowAnalysisAreaAt:function(a){},onZoomToFitPage:function(){},onZoomToFitPageWidth:function(){},onZoomToFitPageHeight:function(){},
onSetZoomPercent:function(a){},onClosePopup:function(){}});return k([a,f],{templateString:"\x3cdiv class\x3d'esriGEPlayerToolbarOuter'\x3e\x3c/div\x3e",popupButtonDiv:null,formatAreaTitleFunc:null,formatAreaTitleMultiFunc:null,showToolbarInPopup:!1,showAreaTitle:!1,stretchToolbarNode:null,isMobileDevice:!1,showCloseButton:!1,toolbarHolder:null,postCreate:function(){var a=this;this.inherited(arguments);this.toolbarHolder=(new C({showAreaTitle:this.showAreaTitle,stretchToolbarNode:this.stretchToolbarNode,
onShowPageAt:function(b){a.onShowPageAt(b)},onShowAnalysisAreaAt:function(b){a.onShowAnalysisAreaAt(b)},onZoomToFitPage:function(){a.onZoomToFitPage()},onZoomToFitPageWidth:function(){a.onZoomToFitPageWidth()},onZoomToFitPageHeight:function(){a.onZoomToFitPageHeight()},onSetZoomPercent:function(b){a.onSetZoomPercent(b)},onClosePopup:function(){a.closePopup()}})).placeAt(this.domNode);this.own(this.toolbarHolder)},updateAreaSelect:function(a,b,d,f){this.toolbarHolder.formatAreaTitleFunc=this.formatAreaTitleFunc;
this.toolbarHolder.formatAreaTitleMultiFunc=this.formatAreaTitleMultiFunc;this.toolbarHolder.updateAreaSelect(a,b,d,f)},setPageControlsVisible:function(a){this.toolbarHolder.setPageControlsVisible(a)},updatePageSelect:function(a,b){this.toolbarHolder.updatePageSelect(a,b)},setZoomSupportsInfo:function(a){this.toolbarHolder.setZoomSupportsInfo(a)},setZoomInfo:function(a){this.toolbarHolder.setZoomInfo(a)},createCommandButton:function(a,b){return this.toolbarHolder.createCommandButton(a,b)},setTheme:function(a){this.toolbarHolder.setTheme(a)},
setErrorShown:function(a){this.toolbarHolder.setErrorShown(a)},_popupHandle:null,_popupButton:null,update:function(){v.invoke(this,"_doUpdateToolbar")},_doUpdateToolbar:function(){c[this.isScrollShown()?"add":"remove"](this.popupButtonDiv,"playerToolbar_parentHasScroll");c[this.isMobileDevice?"add":"remove"](this.popupButtonDiv,"isMobileDevice");c[this.isMobileDevice?"add":"remove"](this.toolbarHolder.domNode,"isMobileDevice");this._resetToolbarNode();var a=u.isOpen(this.toolbarHolder);this._popupHandle&&
this._popupHandle.remove();this._popupHandle=null;this.showToolbarInPopup?(this._popupButton=b.create("div",{"class":"dijitInline playerToolbar_outerButton playerToolbar_settingsButton"},this.popupButtonDiv,"first"),this._popupHandle=u.makePopup(this.toolbarHolder,this,this._popupButton,{orient:["before","below"],openPopup:a})):b.place(this.toolbarHolder.domNode,this.domNode);this.toolbarHolder.arrangeControls();q[this.toolbarHolder.hasVisibleControls()?"show":"hide"]([this._popupButton,this.domNode])},
_resetToolbarNode:function(){this.toolbarHolder.domNode.parentNode&&this.toolbarHolder.domNode.parentNode.removeChild(this.toolbarHolder.domNode);b.empty(this.domNode);this._popupButton&&b.destroy(this._popupButton);this._popupButton=null},closePopup:function(){this.showToolbarInPopup&&u.close(this.toolbarHolder)},isScrollShown:function(){return!1},placeInfographicsSelect:function(a){a.placeAt(this.toolbarHolder.infographicsSelectDiv)},createCustomCommandButton:function(a){return this.toolbarHolder.createCustomCommandButton(a)},
notifyCommandButtonsAdded:function(){if(this.showCloseButton)if(this.showToolbarInPopup){var a=b.create("div",{"class":"dijitInline playerToolbar_outerButton playerToolbar_closeButtonOuter"},this.popupButtonDiv);t.setTooltipToNode(a,w.close);h(a,"click",function(){this.onClose()}.bind(this))}else this.createCustomCommandButton({buttonClass:"playerToolbar_closeButton",tooltip:w.close,callback:function(){this.closePopup();this.onClose()}.bind(this),visibleOnError:!0})},addInfographicsSelect:function(a){this.toolbarHolder.addInfographicsSelect(a)},
isMouseOver:function(){return r.isMouseOver(this.domNode)||this.toolbarHolder.isMouseOver()},setContentLoadPromise:function(a){this.toolbarHolder.setContentLoadPromise(a)},onShowPageAt:function(a){},onShowAnalysisAreaAt:function(a){},onZoomToFitPage:function(){},onZoomToFitPageWidth:function(){},onZoomToFitPageHeight:function(){},onSetZoomPercent:function(a){},onClose:function(){}})})},"esri/dijit/geoenrichment/ReportPlayer/PlayerSelect":function(){define(["dojo/_base/declare","dojo/dom-class","esri/dijit/geoenrichment/OnDemandSelect",
"./PlayerThemes"],function(k,h,e,g){return k(e,{"class":"esriGEOnDemandSelectNoBackground",listClass:"esriGEOnDemandSelectVeryTallList esriGEOnDemandSelectSpacedOut",allowRepetitiveSelection:!1,setTheme:function(c){h[c===g.DARK?"add":"remove"](this.domNode,"esriGEOnDemandSelectWhite")}})})},"esri/dijit/geoenrichment/OnDemandSelect":function(){define("dojo/_base/declare dojo/on dojo/dom-construct dojo/dom-class dojo/dom-style dojo/dom-geometry dojo/store/Memory dijit/_WidgetBase dijit/_TemplatedMixin ./lists/FlowList ./lists/_FlowListHoverSupport ./utils/DeviceUtil ./utils/DomUtil ./utils/MouseUtil ./utils/PopupUtil dojo/text!./templates/OnDemandSelect.html".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v,r){var u=k([n,m]),t={_currentSelect:null,_keyHandler:null,_mouseMoveHandler:null,setFocusedSelect:function(a){this._currentSelect=a;this._updateHandlers()},_updateHandlers:function(){var a=this;this._keyHandler&&this._keyHandler.remove();this._keyHandler=null;this._mouseMoveHandler&&this._mouseMoveHandler.remove();this._mouseMoveHandler=null;this._currentItemIndex=-1;this._currentSearchLetter=null;this._setNodeFocused(null);this._currentSelect&&(this._keyHandler=
h(document.body,"keyup",function(b){b=String.fromCharCode(b.keyCode);1===b.length&&(b=b.toLowerCase(),a._tryHighlightNextItemForKey(b))}),this._mouseMoveHandler=h(this._currentSelect.popupList.domNode,"mousemove",function(){a._setNodeFocused(null)}))},_currentItemIndex:-1,_currentSearchLetter:null,_tryHighlightNextItemForKey:function(a){a===this._currentSearchLetter?this._currentItemIndex++:this._currentItemIndex=0;this._currentSearchLetter=a;var b=this,d=this._currentSelect.store.query(function(d){return(d=
d[b._currentSelect.labelProperty])&&d.toLowerCase().charAt(0)===a});if(d.length){this._currentItemIndex>d.length-1&&(this._currentItemIndex=0);var f=(d=d[this._currentItemIndex])&&this._currentSelect.popupList.getItemNode(d);d&&this._currentSelect.popupList.scrollToItem(d);this._setNodeFocused(f)}},_currentFocusedNode:null,_setNodeFocused:function(a){this._currentFocusedNode&&(g.remove(this._currentFocusedNode,"listItemFocused"),this._currentFocusedNode=null);a&&(g.add(a,"listItemFocused"),this._currentFocusedNode=
a)}};k=k([f,d],{templateString:r,value:null,popupList:null,listClass:null,placeHolderClass:"placeHolder",idProperty:"value",labelProperty:"label",options:null,store:null,itemRenderer:null,itemClass:null,placeHolder:null,requireSelection:!0,renderSelectionAsItem:!1,makePopupListWidthMatchOpenButtonWidth:!0,orient:null,noPopupOverflow:!1,stopOpenEventPropagation:!1,stopPopupInteractionEventPropagation:!0,onClickComponent:null,clearPopupOnClose:!0,detectItemHover:!1,hasSelectableItems:!0,allowRepetitiveSelection:!0,
labelTextToKeep:null,nodeToKeepAsSelected:null,openMouseEvent:null,toggleOnClick:!0,supportsKeyNavigation:!0,_closePopupOnChangeFunc:null,_lastPopupListScrollTop:0,postCreate:function(){var a=this;this.inherited(arguments);this._normalizeValue();this.labelTextToKeep?this.selectedLabel.innerHTML=this.labelTextToKeep:this.requireSelection||this._tryAssignPlaceholder();this.nodeToKeepAsSelected?this._updateSelection():p.hide(this.selectedItemHolder);this._createPopupList();this.own(this.popupList);this.listClass&&
g.add(this.popupList.domNode,this.listClass);this._popupCreationHandler=h(this.openButton,this.openMouseEvent||l.click,function(b){a.stopOpenEventPropagation&&("function"===typeof a.stopOpenEventPropagation?a.stopOpenEventPropagation(b):b.stopPropagation());a.openPopup()});this.popupList.startup();this._trySelectValue();h(this.popupList.domNode,l.clickOrRelease,function(b){a.stopPopupInteractionEventPropagation&&b.stopPropagation()});h(this.popupList.domNode,"scroll",function(b){a._lastPopupListScrollTop=
a.popupList.domNode.scrollTop})},_createPopupList:function(){var a=this,b=this.itemRenderer||new n.itemRenderers.DefaultItemRenderer;this.popupList=new (this.detectItemHover?u:n)({"class":"esriGEOnDemandSelectFlowList",idProperty:this.idProperty,labelProperty:this.labelProperty,itemRenderer:b,itemClass:this.itemClass,stopMouseEventPropagation:this.stopPopupInteractionEventPropagation,hasSelectableItems:this.hasSelectableItems,allowRepetitiveSelection:this.allowRepetitiveSelection,onChange:function(){a._processOnChangeEvent()},
onItemHovered:function(b){a.onItemHovered(b)}})},_processOnChangeEvent:function(){if(this.popupList.selectedItem){var a=this.value;this.value=this.popupList.selectedItem[this.idProperty];this._updateSelection();this.onChange&&this.onChange({type:"change",value:this.value,previousValue:a})}this._closePopupOnChangeFunc&&!this._closePopupOnChangeFunc(this.value)||v.close(this.popupList)},_makePopup:function(){if(this._popupCreationHandler){this._popupCreationHandler.remove();delete this._popupCreationHandler;
var a=this;v.makePopup(this.popupList,this,this.openButton,{openMouseEvent:this.openMouseEvent,stopEventPropagation:this.stopOpenEventPropagation,toggleOnClick:this.toggleOnClick,wrapperClass:this.listClass?this.listClass.split(" ").map(function(a){return a+"Popup"}).join(" "):null,orient:this.orient,allowAutoOrientation:this.allowAutoOrientation,noOverflow:this.noPopupOverflow,onClickComponent:this.onClickComponent,onPreShow:function(){a.onPopupListPreBuild();a.makePopupListWidthMatchOpenButtonWidth&&
c.set(a.popupList.domNode,"minWidth",b.getContentBox(a.domNode).w+"px");a._updatePopupListStore();a.onPopupPreOpened()},onShow:function(){a.onPopupOpened();t.setFocusedSelect(a)},onClose:function(){a.onPopupClosed();t.setFocusedSelect(null);a.clearPopupOnClose&&a._clearPopup()},isMouseOver:function(){return a.isMouseOverList()}})}},_clearPopup:function(){this.popupList&&this.popupList.clear&&this.popupList.clear()},_tryAssignPlaceholder:function(){if(this.placeHolder&&null===this.value)return this.selectedLabel.innerHTML=
this.placeHolder,g.add(this.selectedLabel,this.placeHolderClass),!0;g.remove(this.selectedLabel,this.placeHolderClass);return!1},_normalizeValue:function(){null!==this.value&&(void 0===this.value?this.value=null:("string"===typeof this.value&&(this.value=this.value.trim()),String(this.value)||(this.value=null)))},_trySelectValue:function(){var a=this;if((null===this.value||!this._setValueAttr(this.value,!0))&&this.requireSelection){var b=this.store&&this.store.query();b&&b.length&&(this.value&&b.some(function(b){return a.value===
b[a.idProperty]})?this._setValueAttr(this.value,!0):this._setValueAttr(b[0][this.idProperty],!0))}},_setValueAttr:function(a,b){this.value=a;this._normalizeValue();if(!this.store||!this.popupList)return!1;var d=this;(a=this.store.query(function(a){return a[d.idProperty]===d.value})[0])&&this.popupList.setSelectedItem(a);this._updateSelection(a);return!!a},_setOptionsAttr:function(a){this.options=a;this.store=this._createStore(a);this._updatePopupListStore();this._trySelectValue()},_setStoreAttr:function(a){this.options=
(this.store=this._createStore(a))&&this.store.query();a.idProperty&&(this.idProperty=a.idProperty);this._updatePopupListStore();this._trySelectValue()},_createStore:function(b){return b instanceof Array?new a({data:b,idProperty:this.idProperty}):b},_updatePopupListStore:function(){this.popupList&&(this.popupList.store&&this.popupList.store===this.store&&!this.clearPopupOnClose||this.popupList.setStore(this.store,!0),this.popupList.setSelectedItem(this.getSelectedItem()),this._lastPopupListScrollTop&&
(this.popupList.domNode.scrollTop=this._lastPopupListScrollTop))},getSelectedItem:function(){if(!this.store)return null;var a=this.get("value"),b=this;return void 0!==a&&this.store.query(function(d){return d[b.idProperty]===a})[0]},setSelectedItem:function(a){this.store&&this.popupList&&a&&this._setValueAttr(a[this.idProperty],!0)},getSelectedIndex:function(){var a=this,b=-1;if(this.store){var d=this.get("value");void 0!==d&&this.store.query().some(function(f,c){if(f[a.idProperty]==d)return b=c,!0})}return b},
setSelectedIndex:function(a){this.setSelectedItem(this.store&&this.store.data[a])},_nodeToKeepAsSelectedPlacedFlag:!1,_updateSelection:function(a){a=a||this.getSelectedItem();this.nodeToKeepAsSelected?this._nodeToKeepAsSelectedPlacedFlag||(p.hide(this.selectedLabel),p.show(this.selectedItemHolder),e.empty(this.selectedItemHolder),e.place(this.nodeToKeepAsSelected,this.selectedItemHolder),this._nodeToKeepAsSelectedPlacedFlag=!0):this.renderSelectionAsItem?(p.hide(this.selectedLabel),p.show(this.selectedItemHolder),
e.empty(this.selectedItemHolder),a&&this.popupList.itemRenderer.createPresentation(a,!1,this.selectedItemHolder,this.popupList)):(p.hide(this.selectedItemHolder),this.labelTextToKeep?this.selectedLabel.innerHTML=this.labelTextToKeep:(this.selectedLabel.innerHTML=a?a[this.labelProperty]:"",this.selectedLabel.innerHTML&&g.remove(this.selectedLabel,this.placeHolderClass),p[this.selectedLabel.innerHTML||this._tryAssignPlaceholder()?"show":"hide"](this.selectedLabel)))},refresh:function(){this.popupList.refresh();
this._updateSelection()},isPopupOpen:function(){return v.isOpen(this.popupList)},openPopup:function(){this.isPopupOpen()||(this._makePopup(),v.open(this.popupList))},closePopup:function(){this._popupCreationHandler||v.close(this.popupList)},refreshPopup:function(){this.isPopupOpen()&&v.refresh(this.popupList)},isMouseOver:function(){return q.isMouseOver(this.domNode)||this.isMouseOverList()},isMouseOverList:function(){return this.popupList&&q.isMouseOver(this.popupList.domNode)},onPopupListPreBuild:function(){},
onPopupPreOpened:function(){},onPopupOpened:function(){},onPopupClosed:function(){},onChange:function(a){},onItemHovered:function(a){},destroy:function(){this._popupCreationHandler&&this._popupCreationHandler.remove();this.closePopup(this.popupList);this.popupList.destroy();this.inherited(arguments)}});k.itemRenderers=n.itemRenderers;return k})},"esri/dijit/geoenrichment/lists/FlowList":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on ../utils/DeviceUtil ../utils/DnDUtil ../utils/PopupUtil ../utils/TooltipUtil ./FlowListDefaultItemRenderer dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l){var p=k([m,l],{templateString:"\x3cdiv class\x3d'esriGEFlowList esriGENonSelectable'\x3e\x3c/div\x3e",idProperty:"value",labelProperty:"label",selectedIndex:-1,selectedItem:null,items:null,store:null,defaultItemRendererClass:n,itemRenderer:null,itemClass:null,itemClassSelected:null,keepScrollPosition:!1,allowRepetitiveSelection:!0,selectOnMouseDown:!1,noDragTolerance:0,selectionValidator:null,allowManualSelection:!0,stopMouseEventPropagation:!0,hasSelectableItems:!0,
autoDetectUrlsInLabels:!1,storeItemsInInnerDiv:!1,_addedWrappers:null,_clickHandles:null,_valueOnCreation:null,_isCreated:!1,itemsDiv:null,postCreate:function(){this.inherited(arguments);this.itemsDiv=this.storeItemsInInnerDiv?e.create("div",{"class":"esriGEFlowList_innerDiv"},this.domNode):this.domNode;this._clearHandlers();this._setUpItemRenderer();d.autoTooltip(this.domNode);this._isCreated=!0;this._valueOnCreation?this._setValueAttr(this._valueOnCreation):this.refresh()},_setUpItemRenderer:function(){this.itemRenderer||
(this.itemRenderer=new this.defaultItemRendererClass);this.itemClass&&(this.itemRenderer.itemClass=this.itemClass);this.itemClassSelected&&(this.itemRenderer.itemClassSelected=this.itemClassSelected)},_getValueAttr:function(){return this.selectedItem&&this.selectedItem[this.idProperty]},_setValueAttr:function(a){var b=this;if(this._isCreated){var d=this.items||this.store&&this.store.data;d&&d.some(function(d){if(d[b.idProperty]==a)return b.setSelectedItem(d),!0})}else this._valueOnCreation=a},_scrollTopMemo:0,
memoScroll:function(){this._scrollTopMemo=this.domNode.scrollTop},applyScrollFromMemo:function(){this.domNode.scrollTop=this._scrollTopMemo||0},_setItemsAttr:function(a){this.setItems(a)},setItems:function(a,b){this.keepScrollPosition&&this.memoScroll();this.clear();this.items=a;b||(this.items&&this._isCreated?(this._addItems(a),this._checkIfStillSelected(),this.keepScrollPosition&&this.applyScrollFromMemo()):this._checkIfStillSelected())},_checkIfStillSelected:function(){if(-1!=this.selectedIndex||
this.selectedItem){var a=this;this._addedWrappers&&this._addedWrappers.some(function(b,d){return a.__isSelectedFunction(b,d)})||(this.selectedIndex=-1,this.selectedItem=null)}},refresh:function(){this.store?this.setStore(this.store):this.setItems(this.items)},setSelectedItem:function(a,b){this.selectedItem=a;this.selectedIndex=-1;this.refresh();b&&this._dispatchChangeEvent()},setSelectedIndex:function(a,b){this.selectedIndex=a;this.selectedItem=null;this.refresh();b&&this._dispatchChangeEvent()},
getItemNode:function(a){var b;this._addedWrappers&&this._addedWrappers.some(function(d){if(d.itemRef===a)return b=d.__itemPresentation,!0});return b},getItemByNode:function(a){var b;this._addedWrappers&&this._addedWrappers.some(function(d){if(d.__itemPresentation===a)return b=d.itemRef,!0});return b},__selectedPresentation:null,_addItems:function(a){this._addedWrappers=this._addedWrappers||[];var b=this;a.forEach(function(a){var d=h.mixin({},a);d.itemRef=a;b.__addWrapper(d)})},__addWrapper:function(a){var b=
this._addedWrappers.length,d=this.itemRenderer.createPresentation(a.itemRef,this.__isSelectedFunction(a,b),this.itemsDiv,this,a);d&&(d.index=b,d.item=a.itemRef,a.__itemPresentation=d,this.__isSelectedFunction(a,b)&&(this.selectedItem=a.itemRef,this.selectedIndex=b,this.__selectedPresentation=d),this._addClickHandler(d),this._addedWrappers.push(a),a=this._addedWrappers.length-1,g.add(d,"listItem_"+a),g.add(d,"listItem_"+(0==a%2?"even":"odd")))},__isSelectedFunction:function(a,b){return this.hasSelectableItems?
b==this.selectedIndex||a.itemRef===this.selectedItem?!0:a.itemRef&&this.selectedItem?(a=a.itemRef[this.idProperty],b=this.selectedItem[this.idProperty],void 0!==a&&a===b):!1:!1},_selectionValidatorDefault:function(a){return!!a&&!a.isSeparator&&!1!==a.enabled},_addClickHandler:function(d){function f(){if(e.allowRepetitiveSelection||e.__selectedPresentation!=d)if(e.selectionValidator?!1!==e.selectionValidator(d.item):e._selectionValidatorDefault(d.item))e.__selectedPresentation&&e.itemRenderer.selectPresentation&&
e.itemRenderer.selectPresentation(e.__selectedPresentation,!1),e.itemRenderer.selectPresentation&&e.itemRenderer.selectPresentation(d,e.hasSelectableItems),e.__selectedPresentation=d,e.selectedIndex=d.index,e.selectedItem=d.item,e._dispatchChangeEvent()}var e=this;if(this.allowManualSelection){var g;g=this.selectOnMouseDown||!this.noDragTolerance?c(d,this.selectOnMouseDown?b.press:b.click,function(a){e.stopMouseEventPropagation&&a.stopPropagation();f()}):a.addNoDragClickHandler(d,f,{tolerance:this.noDragTolerance});
this._clickHandles.push(g)}},_dispatchChangeEvent:function(){this.onChange({type:"change",selectedIndex:this.selectedIndex,selectedItem:this.selectedItem,value:this.selectedItem&&this.selectedItem[this.idProperty]})},clear:function(){this.__selectedPresentation=null;this._addedWrappers=this._addedWrappers||[],this._addedWrappers.forEach(function(a){a.destroyPresentation&&a.destroyPresentation()});this._addedWrappers.length=0;this.itemsDiv&&e.empty(this.itemsDiv);this._clearHandlers()},_clearHandlers:function(){this._clickHandles=
this._clickHandles||[];this._clickHandles.forEach(function(a){a.remove()});this._clickHandles.length=0},scrollToItem:function(a){if(a=this.getItemNode(a))this.domNode.scrollTop=a.offsetTop},store:null,onDemandModeLoadStep:1E3,onDemandPopulateLimit:1E3,onDemandPopulatePeriod:200,_setStoreAttr:function(a){this.setStore(a)},setStore:function(a){this.keepScrollPosition&&this._memoScroll();this.clear();this.idProperty=(this.store=a)&&a.idProperty;if(this.store&&this._isCreated){this._loadNextPart();this._checkIfStillSelected();
this.keepScrollPosition&&this._applyScrollFromMemo();var b=this;this.own(c(this.domNode,"scroll",function(){var a=b._addedWrappers[b._addedWrappers.length-30];(a=a?a.__itemPresentation:null)&&a.offsetTop<b.domNode.scrollTop&&b._loadNextPart()}))}else this._checkIfStillSelected()},_loadNextPart:function(){if(this.store&&this.store.query().length!=this._addedWrappers.length){var a=this.store.query(null,{start:this._addedWrappers.length,count:this.onDemandModeLoadStep});delete a.total;this._addItems(a);
a.length&&this._addedWrappers.length<this.onDemandPopulateLimit&&(a=this._loadNextPart.bind(this),setTimeout(a,this.onDemandPopulatePeriod))}},onChange:function(a){},destroy:function(){this.clear();this.inherited(arguments)}});p.itemRenderers={DefaultItemRenderer:n};p.createPopup=function(a){function b(){d||(d=new p({"class":a.listClass,itemRenderer:a.itemRenderer,items:a.options,onChange:function(b){a.onChange(b);!a.keepSelection&&d.setSelectedItem(null);f.close(d)}}),a.doNotOwn||a.wizard.own(d),
a.isDeferred&&a.isDeferred(d));return d}var d;f.makePopup(a.isDeferred?b:b(),a.wizard,a.aroundNode,a.popupOptions||{});return d};return p})},"esri/dijit/geoenrichment/utils/PopupUtil":function(){define("dojo/_base/lang esri/dijit/geoenrichment/utils/onClickTouch dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style esri/dijit/geoenrichment/when dijit/popup dijit/place ./DeviceUtil ./DnDUtil ./MouseUtil dojo/domReady!".split(" "),function(k,h,e,g,c,b,a,f,d,n,m,l){function p(a){if(!a)return["below"];
var b=[];a.forEach(function(a){var d=c.isBodyLtr();switch(a){case "before-alt":d=!d;case "after-alt":b.push(d?{aroundCorner:"BR",corner:"BL"}:{aroundCorner:"BL",corner:"BR"});b.push(d?{aroundCorner:"TR",corner:"TL"}:{aroundCorner:"TL",corner:"TR"});return}b.push(a)});return b}var q={makePopup:function(d,r,u,t){function v(a){if(t.overlay&&a._popupWrapper){var d=g.create("div",{"class":t.overlay.overlayClass});if(t.overlay.overlayParent)g.place(d,t.overlay.overlayParent);else{g.place(d,D,"before");
var f=b.get(a._popupWrapper,"zIndex");b.set(d,"zIndex",f)}a.__popupOverlay=d}}function w(a){a.__popupOverlay&&(g.destroy(a.__popupOverlay),a.__popupOverlay=null)}function C(a){F=!1;a.__bodyClickHandler&&a.__bodyClickHandler.remove();a.__bodyClickHandler=null;a.__popupWidgetOpenFlag=!1;w(a);t.onClose&&t.onClose()}function A(b){b&&t.stopEventPropagation&&b.stopPropagation();F||(F=!0,a(y||("function"==typeof d?d():d),function(b){y=b;y.domNode?(y.__openPopupWidgetFunc=A,D=f.moveOffScreen(y),a(t.onPreShow&&
t.onPreShow(),function(){var a=p(t.orient);if(D&&!1!==t.allowAutoOrientation){var b=-1!==a.indexOf("below"),d=c.position(u),g=c.position(D);b&&d.y+d.h+g.h>document.body.clientHeight&&(b=!b);a=a.map(function(a){return"below"!=a||b?a:"above"})}t.noOverflow&&(y.baseClass="esriGENoOverflow "+y.baseClass);f.open({parent:r,popup:y,around:u,orient:a,onClose:function(){C(y)}});t.suppressReposition&&clearTimeout(f._aroundMoveListener);t.noOverflow&&(y.baseClass=y.baseClass.replace("esriGENoOverflow ",""));
D&&t.wrapperClass&&e.add(D,t.wrapperClass);y.__popupInfo=k.mixin({},f.getTopPopup());y.__popupInfo.orient=a;y.__popupInfo.around=u;w(y);v(y);t.onShow&&t.onShow();y.__popupWidgetOpenFlag=!0;E&&y.own&&y.own(E);if(!1!==t.closeOnClickOutside){var m="function"===typeof t.closeOnClickOutside?t.closeOnClickOutside:null;setTimeout(function(){y.__bodyClickHandler&&y.__bodyClickHandler.remove();y.__bodyClickHandler=h(document.body,n.isMobileDevice()?n.press:B,function(a){F&&(l.fixTouchEvent(a),m&&!m(a)||l.isMouseOver(D)||
t.isMouseOver&&t.isMouseOver()||y.isMouseOver&&y.isMouseOver()||y.__lockPopupWidgetFlag||q.close(y))})})}})):F=!1}))}if(d){t=t||{};var B=t.openMouseEvent?t.openMouseEvent:n.clickOrRelease,y="function"!==typeof d?d:null;if(y)var D=f.moveOffScreen(y);var F=!1;y&&(y.__openPopupWidgetFunc=A);var E;if(!1!==t.openOnMouseEvent){var G=A;if(t.toggleOnClick)var H,G=function(a){H=H||a.type;y?H===a.type&&q.toggle(y):A()};E=!1===t.onClickComponent?null:void 0!==t.noDragClickTolerance?m.addNoDragClickHandler(t.onClickComponent||
u,G,{tolerance:t.noDragClickTolerance}):h(t.onClickComponent||u,B,G)}t.openPopup&&A();return{remove:function(){y&&"function"!==typeof y&&(q.close(y),C(y),y._popupWrapper&&(y.domNode&&y.domNode.parentNode===y._popupWrapper&&y._popupWrapper.removeChild(y.domNode),g.destroy(y._popupWrapper),delete y._popupWrapper),delete y.__openPopupWidgetFunc,delete y.__popupWidgetOpenFlag);E&&E.remove()}}}},setLocked:function(a,b){a.__lockPopupWidgetFlag=b},open:function(a){a&&!a.__lockPopupWidgetFlag&&!a.__popupWidgetOpenFlag&&
a.__openPopupWidgetFunc&&a.__openPopupWidgetFunc()},close:function(a){a&&!a.__lockPopupWidgetFlag&&f.close(a)},isOpen:function(a){return!(!a||!a.__popupWidgetOpenFlag)},toggle:function(a){q.isOpen(a)?q.close(a):q.open(a)},refresh:function(a){if(a){a=a.__popupInfo;var b=c.isBodyLtr();a&&d.around(a.wrapper,a.around,a.orient,b)}},getWrapper:function(a){return a&&a._popupWrapper}};return q})},"esri/dijit/geoenrichment/utils/onClickTouch":function(){define(["dojo/_base/lang","dojo/on","dojo/sniff"],function(k,
h,e){var g=e("touch");return k.mixin(function(c,b,a,f){if(g){switch(b){case "click":b="touchstart,click";break;case "mousedown":b="touchstart,mousedown";break;case "mouseup":b="touchend,mouseup";break;case "clickend":b="touchend,click";break;default:return h(c,b,a,f)}var d=!1;return h(c,b,function(b){"touchstart"===b.type||"touchend"===b.type?(a.call(this,b),d=!0,setTimeout(function(){d=!1},500)):d||a.call(this,b)},f)}"clickend"==b&&(b="click");return h(c,b,a,f)},h)})},"esri/dijit/geoenrichment/lists/FlowListDefaultItemRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct ../utils/DomUtil ../utils/TooltipUtil ../utils/RegExpUtil ../utils/UrlUtil".split(" "),
function(k,h,e,g,c,b,a,f){return k(null,{itemClass:"",itemClassSelected:"",labelClass:"",createLabelNode:!1,createImageAfterLabel:!1,constructor:function(a){h.mixin(this,a)},createPresentation:function(a,b,f,l,h){if(a.isSeparator)return g.create("div",{"class":"flowList_listSeparator"},f);f=g.create("div",{"class":"listItem "+this.itemClass},f);a.isLink&&e.add(f,"esriGELink");!1===a.enabled&&e.add(f,"disabled");this._createParts(a,f,l);this._setTooltip(a,f,l);this.selectPresentation(f,b);a.hidden&&
c.hide(f);return f},_setTooltip:function(a,f,c){a.tooltip&&c.own(b.setTooltipToNode(f,a.tooltip))},_createParts:function(a,b,f){var d;this.createImageAfterLabel&&(this._createLabel(a,b,f),d=!0);this._createImage(a,b,f);!d&&this._createLabel(a,b,f)},_createImage:function(a,b,f){if(b=this._createImageNode(a,b,f))a.imageClass&&e.add(b,a.imageClass),a.imageUrl&&(b.style="background-image: url("+a.imageUrl+");")},_createImageNode:function(a,b,f){return b},_createLabel:function(a,b,f){if(this.createLabelNode)return b=
g.create("div",{innerHTML:a[f.labelProperty],"class":"dijitInline TrimWithEllipses listItemLabel"},b),a.labelClass&&e.add(b,a.labelClass),this.labelClass&&e.add(b,this.labelClass),f.autoDetectUrlsInLabels&&this._tryConvertToUrls(b),b;a[f.labelProperty]&&(b.innerHTML=a[f.labelProperty],f.autoDetectUrlsInLabels&&this._tryConvertToUrls(b))},_tryConvertToUrls:function(b){var d=b.innerHTML.match(a.IS_URL_RE);if(d=d&&d[0])b.innerHTML=b.innerHTML.replace(d,"\x3ca href\x3d'"+f.toHttpsUrl(d)+"' target\x3d'_blank'\x3e"+
d+"\x3c/a\x3e")},selectPresentation:function(a,b){e[b?"add":"remove"](a,"listItemSelected "+this.itemClassSelected)}})})},"esri/dijit/geoenrichment/utils/RegExpUtil":function(){define([],function(){var k={createRegExp:function(a,b,d){a=k.trimText(a);return!a&&d?null:new RegExp(a,b)},trimText:function(a){return a?a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,"").trim():""},replace:function(a,b,d){return null==a?"":(""+a).replace(b,function(a){return d[a]||""})}},h=/&|<|>/g,e=/&|<|>|"|'/g,g={"\x26":"\x26amp;",
"\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26apos;"};k.encodeXML=function(a,b){return k.replace(a,b?e:h,g)};var c=/&amp;|&lt;|&gt;|&quot;|&apos;/g,b={"\x26amp;":"\x26","\x26lt;":"\x3c","\x26gt;":"\x3e","\x26quot;":'"',"\x26apos;":"'"};k.decodeXML=function(a){return k.replace(a,c,b)};k.IS_RICH_TEXT_RE=/<\w/;k.IS_URL_RE=/((www\.|http:\/\/|https:\/\/)[A-Za-z0-9_.\-~]+\.[A-Za-z0-9_.\-~/]+)|([A-Za-z0-9_.\-~]+\.com[A-Za-z0-9_.\-~/]*)/;k.isRichText=function(a){return a&&k.IS_RICH_TEXT_RE.test(a)};
k.isUrl=function(a){return a&&k.IS_URL_RE.test(a)};return k})},"esri/dijit/geoenrichment/utils/UrlUtil":function(){define(["dojo/_base/url","esri/config","esri/kernel","esri/urlUtils"],function(k,h,e,g){var c={getDomain:function(b){if("string"!==typeof b)return null;b=b.replace(/^(http:\/\/|https:\/\/)/i,"");var a=b.indexOf("/");return 0>a?b:b.substr(0,a)},getPortalUrl:function(b){if("string"!==typeof b)return null;var a=b;b=b.replace(/^(http:\/\/|https:\/\/)/i,"");a=a.substr(0,a.indexOf(b));if(-1!==
b.indexOf("/sharing"))return a+b.substr(0,b.indexOf("/sharing"));if(-1!==b.indexOf("/portal"))return a+b.substr(0,b.indexOf("/portal"))+"/portal";var f=b.indexOf("/");return a+(0>f?b:b.substr(0,f))},getPortalUrlRest:function(b){return(b=c.getPortalUrl(b))&&0===b.indexOf(".arcgis.com")?b+"/sharing":null},getProxyUrl:function(b){var a=h.defaults.io.proxyUrl;a&&!/^http/i.test(a)&&(a=g.getAbsoluteUrl(a));a&&b&&(a=c.toHttpsUrl(a));return a},registerCORS:function(b){(b=c.getDomain(b))&&-1==h.defaults.io.corsEnabledServers.indexOf(b)&&
h.defaults.io.corsEnabledServers.push(b);c._fixCORS()},_fixCORS:function(){h.defaults.io.corsEnabledServers=h.defaults.io.corsEnabledServers.filter(function(b){return b.indexOf&&0===b.indexOf("null://")?(console.log("WARNING: incorrect CORS URL detected: "+b),!1):!0})},indexOfQuery:function(b){var a=b.indexOf("?");0<=a&&(b=b.substr(a+1),/^(http:\/\/|https:\/\/)/i.test(b)&&(b=b.indexOf("?"),a=0<=b?a+1+b:-1));return a},removeQuery:function(b){var a=c.indexOfQuery(b);return 0>a?b:b.substr(0,a)},addQueryPart:function(b,
a){var f=0>c.indexOfQuery(b)?"?":"\x26";return b+f+a},getVariableValue:function(b,a){if(b&&"string"===typeof a){var f=g.urlToObject(b);if(f.query){var d={};Object.keys(f.query).forEach(function(a){d[a.toLowerCase()]=f.query[a]});return d[a.toLowerCase()]}}},addUrlVariable:function(b,a,f){a=encodeURIComponent(a);f=encodeURIComponent(f);return c.addQueryPart(b,a+"\x3d"+f)},securePortsMap:{80:"443",8080:"8443"},toHttpUrl:function(b){return!b||/^http/i.test(b)?b:"http://"+b},toHttpsUrl:function(b){b&&
(b=c.toHttpUrl(b));if(!b||!/^http:\/\//i.test(b))return b;var a=new k(b);b=b.replace(/^http/i,"https");var f=c.securePortsMap[a.port];f&&(b=b.replace(":"+a.port,":"+f));return b},combine:function(b,a){"number"===typeof a&&(a+="");if(a){if(/^(http:\/\/|https:\/\/)/i.test(a)||!b)return a;"/"!=a.charAt(0)&&(a="/"+a);if(1==a.length)return b;var f=b.length-1;"/"==b.charAt(f)&&(b=b.substr(0,f));var d=g.urlToObject(b);b=c.removeQuery(b);f=b.length-a.length;0<=f&&b.substr(f).toLowerCase()==a.toLowerCase()&&
(b=b.substr(0,f));b+=a;for(var e in d.query)c.addQueryPart(b,d.query[e])}return b},combineMulti:function(b){for(var a=b[0],f=1;f<b.length;f++)a=c.combine(a,b[f]);return a},openUrl:function(b,a){if(a)return window.open(b,"_blank");a=window.open();a.opener=null;a.referrer=null;a.location=b;return a},isPageRunOnWebService:function(){return/^http/i.test(window.location.protocol)},getToken:function(b){return(b=b&&e.id.findCredential(b)||e.id.credentials[0])&&b.token}};return c})},"esri/dijit/geoenrichment/lists/_FlowListHoverSupport":function(){define(["dojo/_base/declare",
"dojo/on","../utils/MouseUtil"],function(k,h,e){var g=k(null,{_list:null,_checkIntervalH:null,constructor:function(c){this._list=c},setHoveredItem:function(c){clearInterval(this._checkIntervalH);this._emitHoverEvent(c);this._checkIntervalH=setInterval(function(){e.isMouseOver(c)||this.setHoveredItem(null)}.bind(this),100)},_emitHoverEvent:function(c){this._list.onItemHovered({type:"itemHover",index:c?c.index:-1,item:c?c.item:null,value:c?c.item[this._list.idProperty]:void 0})}});return k(null,{_mouseHelper:null,
postCreate:function(){this._mouseHelper=new g(this);this.inherited(arguments)},_addClickHandler:function(c){this.inherited(arguments);this._clickHandles.push(h(c,"mouseover",function(){this._mouseHelper.setHoveredItem(c)}.bind(this)))},onItemHovered:function(c){}})})},"esri/dijit/geoenrichment/ReportPlayer/supportClasses/ToolbarArranger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","esri/dijit/geoenrichment/utils/DomUtil"],function(k,h,e,g){return k(null,{showAreaTitle:!1,
stretchToolbarNode:null,domNode:null,infographicsSelectDiv:null,areaTitleDiv:null,areaTitleInnerDiv:null,rightSideControlsBlock:null,areasSelectDiv:null,zoomSelectDiv:null,pageSelectDiv:null,commandButtonsContainer:null,constructor:function(c){h.mixin(this,c)},arrangeControls:function(){g[0<this.infographicsSelectDiv.children.length?"show":"hide"](this.infographicsSelectDiv);g[this.showAreaTitle?"show":"hide"](this.areaTitleDiv);this.domNode.style.width="";this.areaTitleDiv.style.marginLeft="";this.areaTitleInnerDiv.style.maxWidth=
"";this.rightSideControlsBlock.style.position=this.stretchToolbarNode?"absolute":"static";this.stretchToolbarNode&&(this.domNode.style.width=this.stretchToolbarNode.clientWidth+"px",this._processStretchSpecialCases(this.stretchToolbarNode));this.syncRightSideVisibility()},_processStretchSpecialCases:function(c){function b(b){return g.isHidden(b)?0:b.clientWidth+a(b)}function a(a){return g.isHidden(a)?0:e.get(a,"marginLeft")+e.get(a,"marginRight")}this.showAreaTitle&&(c=c.clientWidth,c-=b(this.infographicsSelectDiv),
c-=b(this.rightSideControlsBlock),c-=b(this.areasSelectDiv),c-=a(this.areaTitleDiv),this.areaTitleInnerDiv.style.maxWidth=c+"px",g.isHidden(this.infographicsSelectDiv)||g.isHidden(this.infographicsSelectDiv)||(this.areaTitleDiv.style.marginLeft=Math.min(c-this.areaTitleDiv.clientWidth,(this.domNode.clientWidth-this.areaTitleDiv.clientWidth)/2-b(this.infographicsSelectDiv))+"px"))},hasVisibleControls:function(){return[this.infographicsSelectDiv,this.areaTitleDiv,this.areasSelectDiv,this.pageSelectDiv,
this.zoomSelectDiv,this.commandButtonsContainer].some(g.isNodeInLayout)},syncRightSideVisibility:function(){g.show(this.rightSideControlsBlock);var c=[this.pageSelectDiv,this.zoomSelectDiv,this.commandButtonsContainer].some(g.isNodeInLayout);g[c?"show":"hide"](this.rightSideControlsBlock)}})})},"esri/dijit/geoenrichment/ReportPlayer/supportClasses/ZoomUtil":function(){define(["dojo/i18n!esri/nls/jsapi"],function(k){var h={};k=k.geoenrichment.dijit.ReportPlayer.PlayerToolbar;h.FIT_PAGE="fitPage";h.FIT_PAGE_WIDTH=
"fitPageWidth";h.FIT_PAGE_HEIGHT="fitPageHeight";h.getOptions=function(){return[{value:h.FIT_PAGE,label:k.fitPage},{value:h.FIT_PAGE_WIDTH,label:k.fitPageWidth},{value:h.FIT_PAGE_HEIGHT,label:k.fitPageHeight},{value:0,label:"",isCustomBig:!0},{value:150,label:"150%"},{value:125,label:"125%"},{value:100,label:"100%"},{value:90,label:"90%"},{value:80,label:"80%"},{value:70,label:"70%"},{value:60,label:"60%"},{value:50,label:"50%"},{value:0,label:"",isCustomSmall:!0}]};h.getClosestZoomAndUpdateOptions=
function(e,g){var c=g.filter(function(a){return a.isCustomBig})[0],b=g.filter(function(a){return a.isCustomSmall})[0];c.value=0;c.hidden=!0;b.value=0;b.hidden=!0;if(50>e)return b.value=e,b.label=Math.round(e)+"%",b.hidden=!1,b.value;if(150<e)return c.value=e,c.label=Math.round(e)+"%",c.hidden=!1,c.value;var a=[];g.forEach(function(b){"number"===typeof b.value&&a.push({value:b.value,score:e<b.value?e/b.value:b.value/e})});a.sort(function(a,b){return b.score-a.score});return a[0].value};return h})},
"esri/dijit/geoenrichment/utils/InvokeUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(k,h){return{invoke:function(e,g,c,b,a){e.__invokeTimeoutIDs||(e.__invokeTimeoutIDs={});var f=e.__invokeTimeoutIDs[g];if(f){if(null==c||!1===b)return f.dfd.promise;clearTimeout(f.handle)}f||(f=e.__invokeTimeoutIDs[g]={dfd:new k});f.handle=setTimeout(function(){delete e.__invokeTimeoutIDs[g];h(a?e[g].apply(e,a):e[g](),function(a){f.dfd.resolve(a)},function(a){f.dfd.reject(a)})},
c||0);return f.dfd.promise},hasPendingInvoke:function(e,g){return!(!e.__invokeTimeoutIDs||!e.__invokeTimeoutIDs[g])},cancelInvoke:function(e,g){e.__invokeTimeoutIDs&&e.__invokeTimeoutIDs[g]&&(clearTimeout(e.__invokeTimeoutIDs[g].handle),delete e.__invokeTimeoutIDs[g])}}})},"esri/dijit/geoenrichment/ReportPlayer/ReportPlayerViewModel":function(){define("dojo/_base/declare dojo/aspect esri/dijit/geoenrichment/promise/all ./core/layout/LayoutBuilder ./core/themes/ThemeLibrary ./core/themes/ReportThemes ./core/supportClasses/map/layers/locator/LocatorPointsController ./core/supportClasses/map/layers/std/StdPolygonsController ./core/supportClasses/map/layers/thisAreas/ThisAreasHighlightController ./core/supportClasses/EditorUnits ../utils/ColorUtil".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m){return k(null,{isGraphicStyle:!1,layoutBuilder:null,dynamicReportInfo:null,animationAllowed:!1,enableDataDrilling:!1,showDataDrillingInsidePanel:!1,preInitialize:function(){this.layoutBuilder=this.layoutBuilder||new g;return this.layoutBuilder.initCoreComponents()},initialize:function(a,b){this.preInitialize();return this.layoutBuilder[a?"initClassicComponents":"initGraphicComponents"](b)},_theme:null,getCurrentTheme:function(a){return a||this._theme},setTheme:function(a){this._theme=
a||c.getReportThemeById(b.GRAPHIC)},getTableDefaultStyles:function(a,b){a=this.getCurrentTheme(a).table.overrideStyles;return b?a[b]:a},getChartDefaultStyles:function(a){return this.getCurrentTheme(a).chart},getDocumentDefaultStyles:function(a){return this.getCurrentTheme(a).document},getInfographicDefaultStyles:function(a){return this.getCurrentTheme(a).infographic},getStaticInfographicDefaultStyles:function(a){return(a=this.getInfographicDefaultStyles(a))&&a.staticInfographic},isLightDocumentTheme:function(a){return m.isLightColor(this.getCurrentTheme(a).document.backgroundColor)},
setDynamicReportInfo:function(a){this.dynamicReportInfo=a;this.isGraphicStyle=!a.isClassic},getDynamicImageFunc:function(a,b,d){},enrichFieldData:function(a){},_locatorPointsControllers:null,getLocatorPointsController:function(b,d){var f=b.calculatorName+"_"+d;this._locatorPointsControllers=this._locatorPointsControllers||{};var c=this._locatorPointsControllers[f];c||(c=this._locatorPointsControllers[f]=new a(b,this.dynamicReportInfo.fieldData,this.dynamicReportInfo.isMultiFeature,d),h.after(c,"destroy",
function(){delete this._locatorPointsControllers[f]}.bind(this)));return c},_stdPolygonsControllers:null,getStdPolygonsController:function(a,b){this._stdPolygonsControllers=this._stdPolygonsControllers||{};var d=a+"_"+(b||0);a=this._stdPolygonsControllers[d];a||(a=this._stdPolygonsControllers[d]=new f(d),h.after(a,"destroy",function(){delete this._stdPolygonsControllers[d]}.bind(this)));return a},loadAllStdFeatures:function(){var a=[],b;for(b in this._stdPolygonsControllers)a.push(this._stdPolygonsControllers[b].loadAllFeatures());
return e(a)},_thisAreasHighlightController:null,getThisAreasHighlightController:function(){this._thisAreasHighlightController||(this._thisAreasHighlightController=new d,h.after(this._thisAreasHighlightController,"destroy",function(){this._thisAreasHighlightController=null}.bind(this)));return this._thisAreasHighlightController},reset:function(){[this._locatorPointsControllers,this._stdPolygonsControllers].forEach(function(a){a&&Object.keys(a).forEach(function(b){(b=a[b])&&b.destroy()})});this._stdPolygonsControllers=
this._locatorPointsControllers=null;this._thisAreasHighlightController&&this._thisAreasHighlightController.destroy();this._thisAreasHighlightController=null},canExportToExcel:function(){return!1},exportToExcel:function(a){},pepareExportToExcelParameters:function(a){},getUnits:function(){return"px"},provideUnits:function(a){return n.provideUnits(a,this.getUnits())},roundForUnits:function(a){return n.round(a,this.getUnits())}})})},"esri/dijit/geoenrichment/ReportPlayer/core/layout/LayoutBuilder":function(){define(["dojo/_base/declare",
"dojo/_base/lang","esri/dijit/geoenrichment/Deferred","dojo/dom-construct"],function(k,h,e,g){return k(null,{_moduleMap:null,_getModulePaths:function(){return{core:{section:"esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionRenderer",grid:"esri/dijit/geoenrichment/ReportPlayer/core/grid/AdjustableGrid",image:"esri/dijit/geoenrichment/ReportPlayer/core/annotations/image/ImageRenderer",chart:"esri/dijit/geoenrichment/ReportPlayer/core/charts/ChartRenderer",map:"esri/dijit/geoenrichment/ReportPlayer/core/map/MapRenderer"},
classic:{reportContainer:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainer/ReportContainer"},graphicCore:{shape:"esri/dijit/geoenrichment/ReportPlayer/core/annotations/shape/ShapeRenderer",infographic:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicRenderer"},graphic_fullPages:{reportContainerGrid:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerGrid/ReportContainerGrid"},graphic_panelsInSlides:{reportContainerPagination:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerPagination/ReportContainerPagination",
infographicPage:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPage"},graphic_panelsInStack:{reportContainerStack:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerStack/ReportContainerStack",infographicPageStack:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPageStack"},graphic_panelsInRow:{reportContainerStack:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerStack/ReportContainerStack",infographicPageStack:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPageStack"}}},
initCoreComponents:function(){var c=this._getModulePaths();return this._initPaths(h.mixin({},c.core,c.graphicCore))},initClassicComponents:function(){var c=this._getModulePaths();return this._initPaths(h.mixin({},c.core,c.classic))},initGraphicComponents:function(c){var b=this._getModulePaths();return this._initPaths(h.mixin({},b.core,b.graphicCore,b["graphic_"+c]||b.graphic_fullPages))},_initPaths:function(c){var b=this;this._moduleMap=this._moduleMap||{};var a=[],f;for(f in c)a.push({id:f,path:c[f]});
var d=new e;require(a.map(function(a){return a.path}),function(){for(var f=0;f<arguments.length;f++)b._moduleMap[a[f].id]=arguments[f];d.resolve()});return d.promise},createElement:function(c,b,a,f){switch(c){case "grid":case "reportContainer":case "reportContainerGrid":case "reportContainerPagination":case "reportContainerStack":case "infographicPage":case "infographicPageStack":return new this._moduleMap[c](b,a?g.create("div",null,a,f):void 0);case "section":return this._moduleMap.section.createSection(b,
a,f);case "emptySection":return this._moduleMap.section.createEmptySection(b,a,f);case "image":return this._moduleMap.image.createImageContainer(b);case "shape":return this._moduleMap.shape.createShapeContainer(b);case "chart":return this._moduleMap.chart.createChartPage(b);case "infographic":return this._moduleMap.infographic.createInfographicPage(b);case "map":return this._moduleMap.map.createMapContainer(b)}return!1},getClass:function(c){return this._moduleMap[c]}})})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeLibrary":function(){define("dojo/_base/lang ./PageBorderStyles ../charts/utils/ChartLineStyles ./ReportThemes ./ThemeUtil esri/dijit/geoenrichment/utils/ObjectUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(k,h,e,g,c,b,a){function f(a){a=a||{};a=a.defaultFontFamilty||"Avenir Next";return{backgroundColor:"#FFFFFF",padding:5,icon:{backgroundColor:"#56a5d8"},highlightedIcon:{backgroundColor:"#D6851A"},iconBarBackground:{backgroundColor:"#AAAAAA"},titleLine:{color:"#A8A7A8"},titleStyle:{fontFamily:a,color:"#828282",fontSize:16,backgroundColor:"transparent"},variableLabelStyle:{fontFamily:a,color:"#56a5d8",fontSize:24,backgroundColor:"transparent"},variableLabelStyleHighlighted:{fontFamily:a,fontSize:24},
variableLabelStyleContrast:{fontFamily:a,fontSize:24},variableDescriptionStyle:{fontFamily:a,color:"#828282",fontSize:13,backgroundColor:"transparent"}}}function d(){return{style:h.ALL,lineStyle:"dashed",thickness:1,color:"#b2b2b2"}}function n(a){a=a||{};var b=a.defaultFontFamilty||"Avenir Next",c=a.defaultFontSize||13;return{document:{fontSize:c,fontFamily:b,backgroundImage:{data:null,position:"center",repeat:!1,scale:!0,opacity:1,size:null},border:d()},icon:{backgroundColor:"#56a5d8"},highlightedIcon:{backgroundColor:"#D6851A"},
table:{dataTablePadding:5},chart:{renderSingleDataSeriesWithSameColor:!0,line:{},column:{},bar:{},pie:{},donut:{},ring:{},pictureColumn:{},pictureBar:{},gauge:{dataLabelStyle:{fontFamily:b}},waffle:{dataValueStyle:{fontFamily:b,fontSize:30},dataLabelStyle:{fontFamily:b,fontSize:16}},titleStyle:{fontFamily:b,fontSize:16},dataLabelsStyle:{fontFamily:b,fontSize:10},xAxis:{gridLinesStyle:e.SOLID,axisStyle:{fontFamily:b,fontSize:9},titleStyle:{fontFamily:b,fontSize:c}},yAxis:{gridLinesStyle:e.SOLID,baseLineStyle:e.SOLID,
axisStyle:{fontFamily:b,fontSize:9},titleStyle:{fontFamily:b,fontSize:c}},legendStyle:{fontFamily:b,fontSize:10},minMaxLegend:{titleStyle:{fontFamily:b,fontSize:10},minVariableLabelStyle:{fontFamily:b,fontSize:16},maxVariableLabelStyle:{fontFamily:b,fontSize:16}},icon:{backgroundColor:"#56a5d8"}},infographic:{staticInfographic:f(a)}}}var m={DEFAULT_FONT_FAMILY_CLASSIC:"Verdana",DEFAULT_FONT_FAMILY_GRAPHIC:"Avenir Next",DEFAULT_FONT_SIZE_CLASSIC:10,DEFAULT_FONT_SIZE_GRAPHIC:13,CHART_DATA_FONT_SIZE:10,
defaultStaticInfographic:f(),standardRamps:[{id:g.CLASSIC,colors:["#FFFFFF","#13729F","#DEA429"],additional:{table:{overrideStyles:{Default:{color:"#4C4C4C",backgroundColor:"#FFFFFF"},ReportTitle:{color:"#FFFFFF",backgroundColor:"#00436D"},TableHeader:{color:"#4C4C4C",backgroundColor:"#CCCCCC"},GreyText:{color:"#AAAAAA",backgroundColor:"#FFFFFF"},BlueText:{color:"#00436D",backgroundColor:"#FFFFFF"},AlternatingRow:{color:"#4C4C4C",backgroundColor:"#EEEEEE"}}},chart:{renderSingleDataSeriesWithSameColor:!1,
colors:"#13729F #DEA429 #6A9741 #A75523 #456E35 #D7DF22 #868686 #3C546D #829AB3 #DEDEDE #03406E #B1B1B1".split(" ")}}},{id:g.GRAPHIC,colors:["#FFFFFF","#56A5D8","#D6851A"],additional:{chart:{colors3series:["#56A5D8","#AED6F1","#2874A6"],colors:"#AED6F1 #85C1E9 #5DADE2 #3498DB #2E86C1 #2874A6 #21618C #1B4F72".split(" ")}}},{id:"red",colors:["#d3d3d3","#8b4513","#ff4500"],additional:{chart:{colors3series:["#8b4513","#F1948A","#E74C3C"],colors:"#8b4513 #F1948A #EC7063 #E74C3C #CB4335 #B03A2E #943126 #78281F".split(" ")}}},
{id:"dark",colors:["#6A6A6A","#FFFFFF","#EEEEEE"],additional:{chart:{colors3series:["#FFFFFF","#CACFD2","#A6ACAF"],colors:"#FFFFFF #D7DBDD #CACFD2 #BDC3C7 #A6ACAF #909497 #797D7F #626567 #4d4d4d #3e3e3e #262626".split(" ")}}},{id:"green",colors:["#556b2f","#90ee90","#ffffe0"],additional:{chart:{colors3series:["#E9F7EF","#A9DFBF","#27AE60"],colors:"#E9F7EF #A9DFBF #7DCEA0 #52BE80 #27AE60 #229954 #1E8449 #196F3D #145A32".split(" ")}}},{id:"green2",colors:["#FFFFFF","#0B7AC0","#35AC46"],additional:{chart:{colors3series:["#56A5D8",
"#AED6F1","#2874A6"],colors:"#56A5D8 #AED6F1 #85C1E9 #5DADE2 #3498DB #2E86C1 #2874A6 #21618C #1B4F72".split(" ")}}}]},l={};m.standardRamps.forEach(function(a){var d=k.mixin({},a.additional);d.id=a.id;var f=n({defaultFontFamilty:a.id===g.CLASSIC?"Verdana":"Avenir Next",defaultFontSize:a.id===g.CLASSIC?10:13});c.applyThemeColorsToTheme({theme:f,colors:a.colors});b.populateObject(f,d,!0);m[a.id]=f;l[a.id]=f});m.TABLE_STYLES="Default ReportTitle TableHeader GreyText BlueText AlternatingRow".split(" ");
m.getReportThemeById=function(a){return l[a]};m.isStandardTheme=function(a){return!!l[a]};m.getStandardThemes=function(){return Object.keys(l).map(function(a){return l[a]})};m.getDefaultStaticInfographicSettings=function(){return k.clone(m.defaultStaticInfographic)};m.getDefaultBorderSettings=function(){return d()};m.getDefaultTheme=function(a){return n(a)};return m})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/PageBorderStyles":function(){define([],function(){var k={NONE:"none",ALL:"all",
INNER_ONLY:"innerOnly",OUTER_ONLY:"outerOnly",HORIZONTAL_INNER_ONLY:"horizontalInnerOnly",VERTICAL_INNER_ONLY:"verticalInnerOnly",isSupported:function(h){for(var e in k)if(k[e]===h)return!0;return!1},toSupportedValue:function(h){return k.isSupported(h)?h:k.ALL}};return k})},"esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/ChartLineStyles":function(){define([],function(){var k={SOLID:"Solid",DASHED:"Dashed",DOTTED:"Dotted",isSupported:function(h){for(var e in k)if(k[e]===h)return!0;return!1},
toGFXValue:function(h,e){switch(h){case "Dashed":return 1>e?"LongDash":"Dash";case "Dotted":return 1>e?"Dash":"Dot";default:return"Solid"}}};return k})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ReportThemes":function(){define([],function(){return{GRAPHIC:"graphic",CLASSIC:"classic",COMPARISON:"comparison"}})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeUtil":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/utils/ColorUtil","esri/dijit/geoenrichment/utils/ObjectUtil"],
function(k,h,e){function g(a){var b=h.isLightColor(a);return h.transform(a,{dv:b?-7:7}).toHex()}var c={getPanelTitleColor:function(a){var b=h.isLightColor(a);return h.transform(a,{dv:b?-50:50}).toHex()},getChartElementBackgroundColor:function(a){var b=h.isLightColor(a);return h.transform(a,{dv:b?-13:13}).toHex()}},b={getThemeColors:function(a){return[a.document.backgroundColor,a.icon.backgroundColor,a.highlightedIcon.backgroundColor]},generateChartColors:function(a,b,c){c=c||{};var d=c.gradientFactor||
1,f=[b,h.transform(b,{dv:-20*d}).toHex(),h.transform(b,{dv:-40*d}).toHex(),h.transform(b,{dv:-50*d}).toHex(),h.transform(b,{dv:-55*d}).toHex(),h.transform(b,{dv:-60*d}).toHex(),h.transform(b,{dv:-65*d}).toHex(),h.transform(b,{dv:-70*d}).toHex()];if(c.numLighterColors)for(var e=0;e<c.numLighterColors;e++)f.unshift(h.transform(b,{dv:20*d*(e+1),ds:-20*(e+1)}).toHex());a&&a!==b&&f.unshift(a);var g={};return f.filter(function(a){return g[a]?!1:g[a]=!0})},applyThemeColorsToTheme:function(a){var d=a.theme,
f=a.colors,m=a.preserveForegroundColor,l=a.chartColors,p=a.colors3series;a=a.preprocessGeneratedThemeFunc;var q=f[0],k=f[1],f=f[2],r=m&&d.chart&&d.chart.dataLabelsStyle&&d.chart.dataLabelsStyle.color||h.getContrastColor(q).toHex(),m=m&&d.document.color||("#FFFFFF"===q.toUpperCase()?"#4C4C4C":r),u=h.isLightColor(q),t=c.getChartElementBackgroundColor(q),z=c.getPanelTitleColor(q),w=h.transform(q,{dv:u?-33:33}).toHex(),C={overrideStyles:{Default:{color:m,backgroundColor:"transparent"},TableHeader:{color:h.getContrastColor(k,
void 0,void 0,200).toHex(),backgroundColor:k},AlternatingRow:{color:m,backgroundColor:h.transform(q,{dv:u?-7:7}).toHex()},ReportTitle:{color:f,backgroundColor:"transparent"},GreyText:{color:w,backgroundColor:"transparent"},BlueText:{color:"#56A5D8",backgroundColor:"transparent"}}},A={lineColor:r,gridLinesColor:r,gridStripesColor:g(q),gridStripesColorAlt:"transparent",axisStyle:{color:r},titleStyle:{color:r}},B={lineColor:r,gridLinesColor:r,gridStripesColor:g(q),gridStripesColorAlt:"transparent",baseLineColor:r,
axisStyle:{color:r},titleStyle:{color:r}},y=h.isLightColor(q),q={document:{color:m,backgroundColor:q,border:{color:w}},icon:{backgroundColor:k},highlightedIcon:{backgroundColor:f},table:C,chart:{backgroundColor:"transparent",dataLabelsAltColor:r,titleStyle:{color:z},dataLabelsStyle:{color:r},xAxis:A,yAxis:B,legendStyle:{color:r,backgroundColor:"transparent"},minMaxLegend:{titleStyle:{color:r}},ring:{ringBackground:{backgroundColor:t}},gauge:{dataLabelStyle:{color:k},othersColor:t,arrowIndicator:{lineColor:z,
backgroundColor:z}},waffle:{dataValueStyle:{color:k},dataLabelStyle:{color:k},othersColor:t},icon:{backgroundColor:k},columnBarBackground:{backgroundColor:t},comparisonInfo:{lineColor:y?"#666666":"#BBBBBB"}},infographic:{backgroundColor:"transparent",agePyramid:{theme:u?"light":"common",male:{backgroundColor:k},female:{backgroundColor:f}},staticInfographic:{backgroundColor:"transparent",icon:{backgroundColor:k},highlightedIcon:{backgroundColor:f},iconBarBackground:{},titleLine:{color:h.transform(q,
{dv:u?-40:40}).toHex()},titleStyle:{color:z},variableLabelStyle:{color:k},variableLabelStyleHighlighted:{color:f},variableLabelStyleContrast:{color:q},variableDescriptionStyle:{color:h.transform(q,{dv:u?-50:50}).toHex()}}}};a&&a(q);e.populateObject(d,q,!0);d.chart.colors=l&&l.length?l:b.generateChartColors(k,f);d.chart.colors3series=p},applyTextStyleToTheme:function(a,d){function f(a,b){var f=k.mixin({},d);a&&delete f.color;b||delete f.fontSize;return f}d=b.filterTextStyles(d);var c={document:f(!1,
!0),table:{overrideStyles:{Default:f(!1,!0),TableHeader:f(!1,!0),AlternatingRow:f(!1,!0),ReportTitle:f(!1,!0),GreyText:f(!1,!0),BlueText:f(!1,!0)}},chart:{titleStyle:f(),dataLabelsStyle:f(),xAxis:{axisStyle:f(),titleStyle:f()},yAxis:{axisStyle:f(),titleStyle:f()},legendStyle:f(),minMaxLegend:{titleStyle:f(),minVariableLabelStyle:f(!0),maxVariableLabelStyle:f(!0)},gauge:{dataLabelStyle:f()},waffle:{dataValueStyle:f(),dataLabelStyle:f()}},infographic:{staticInfographic:{titleStyle:f(),variableLabelStyle:f(),
variableLabelStyleHighlighted:f(),variableLabelStyleContrast:f(),variableDescriptionStyle:f()}}};e.populateObject(a,c,!0)}},a={fontFamily:1,fontSize:1,fontWeight:1,fontStyle:1,textDecoration:1,color:1};b.filterTextStyles=function(b){var d={},f;for(f in a){var c=b[f];void 0!==c&&(d[f]=c)}return d};return b})},"esri/dijit/geoenrichment/utils/ObjectUtil":function(){define(["dojo/number"],function(k){var h={};Math.log10=Math.log10||function(e){return Math.log(e)*Math.LOG10E};h.populateObject=function(e,
c,b){function a(f,d){function c(c){var e=f[c],g=d[c],l=e&&"object"===typeof e;void 0!==e&&(void 0===g?d[c]=e:g&&"object"===typeof g&&l?a(e,g):b&&(l?(g=d[c]={},a(e,g)):d[c]=f[c]))}if(f&&d&&!(Array.isArray(f)&&!Array.isArray(d)||Array.isArray(d)&&!Array.isArray(f)))if(Array.isArray(f))f.forEach(function(a,b){c(b)});else for(var e in f)c(e)}a(c,e);return e};h.filterByPattern=function(e,c){function b(a,d,c){for(var f in a){var e=a[f],g=d[f];if(Array.isArray(e)){var h=e[0];if(g&&Array.isArray(g)){var n=
c[f]=[];g.forEach(function(a){if(a&&"object"===typeof a){var d=Array.isArray(a)?[]:{};b(h,a,d);n.push(d)}})}}else if("object"===typeof e){if(g&&"object"===typeof g){var k=c[f]={};b(e,g,k)}}else void 0!==g&&(c[f]=g)}}var a={};b(c,e,a);return a};h.traverseObject=function(e,c){for(var b in e){var a=e[b];c(a);a&&"object"===typeof a&&h.traverseObject(a,c)}};h.copyOwnJsonProperties=function(e,c,b){c=c||{};for(var a in e){var f=e[a];e.hasOwnProperty(a)&&"function"!=typeof f&&(f&&"object"==typeof f&&b&&(f=
b(a,f)),void 0!==f&&(c[a]=f))}return c};h.removeUndefinedProperties=function(e){e&&Object.keys(e).forEach(function(c){void 0===e[c]&&delete e[c]});return e};h.roundNumber=function(e,c){return"number"!==typeof e?e:parseFloat(e.toFixed(void 0!==c?c:0))};h.getBestPrecision=function(e){return 0===e?0:Math.max(0,Math.round(Math.log10(3E3/Math.abs(e))))};h.getPlaces=function(e,c){function b(b,d){var c=e.indexOf(b,a);if(0>c)return f;b=e.charAt(c+b.length);return!b||0>d.indexOf(b)?f:c-a}e=+e;if(isNaN(e))return-1;
e+="";var a=e.indexOf(".")+1,f=a?e.length-a:0;if(2>=f||!c)return f;c=0;if(!+e.substr(0,a-1))for(;"0"===e.charAt(a);)a++,c++,f--;for(var d=f-1;2<=d;d--){var g=Math.min(b("000000000000000".substr(0,d),"01234"),b("999999999999999".substr(0,d),"56789"));if(g!==f){f=g;break}}return f+c};h.formatNumber=function(g,c){c="number"===typeof c?{places:c}:c||{};var b=c.places,a={};0<=b?a.places=b:b=-1;g=k.format(g,a);if(c.noSeparator){void 0===e&&(e=k.format(9999,{places:0}).replace(/9/g,""));var a=e,f;if(a)for(;0<=
(f=g.indexOf(a));)g=g.substr(0,f)+g.substr(f+1)}if(c.preserveTrailingZeroes||0>=b||!g)return g;for(c=g.length;0<b&&"0"==g.charAt(c-1);)c--,--b||c--;return g.substr(0,c)};h.formatNumberAsCurrency=function(e,c,b){return c?c.split(";")[0>e?1:0].replace("0",h.formatNumber(Math.abs(e),b)):h.formatNumber(e,b)};var e;h.parseNumber=function(e,c,b,a){if(""===e)return"undefined"!==typeof b?b:NaN;if(null==e||"string"!==typeof e&&isNaN(e))return NaN;e=String(e);if(!e.trim())return void 0!==b?b:NaN;b=k.parse(e,
{strict:a});isNaN(b)&&e.trim().length&&(b=a?k.parse(e,{strict:a,locale:"en-US"}):Number(e));return isNaN(b)||void 0===c||0>c?b:k.round(b,c)};h.parsePercentOrCurrency=function(e,c,b,a,f){"string"===typeof e&&(e=e.replace("%",""),c&&(c=c.split(";")[0].replace("0",""),e=e.replace(c,"")));return h.parseNumber(e,b,a,f)};h.compareEqual=function(e,c,b){return void 0===b?e===c:Number(Number(e).toFixed(b))===Number(Number(c).toFixed(b))};h.objectToTime=function(e){if(!e)return null;e="string"===typeof e?new Date(e):
e;return e.getTime?e.getTime():Number(e)||null};h.objectToDate=function(e){return e?e.getTime?e:new Date(e):null};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/locator/LocatorPointsController":function(){define("dojo/_base/declare dojo/on dijit/Destroyable ../../../../../dataProvider/supportClasses/AreaDataUtil ../../MapEventUtil esri/dijit/geoenrichment/utils/DeviceUtil".split(" "),function(k,h,e,g,c,b){return k(e,{_info:null,_fieldData:null,_isMultiFeature:null,
_calcDataArray:null,_currentFeatureIndex:null,_layerNames:null,constructor:function(a,b,d,c){this._info=a;this._fieldData=b;this._isMultiFeature=d;this._currentFeatureIndex=c;this._layerIndexes={};this._layerNames={};this._rendererJsons={};this._mapInfos={};this._graphicLayerInfos={}},getCalculatorName:function(){return this._info.calculatorName},getVariableObjects:function(){return this._info.variableObjects},getLayerID:function(){return this._info.layerID},getLayerUrl:function(){return this._info.layerUrl},
getLayerName:function(a){return this._layerNames[a]||this._info.layerName},setLayerName:function(a,b){this._layerNames[a]=b},getCalculatorDataArray:function(){if(!this._calcDataArray)if(this._isMultiFeature){var a=g.combineAreaDataObjectCalculators(this._fieldData.areaData,this.getCalculatorName());this._calcDataArray=g.removeDuplicacatedCalcData(a.thisAreas.concat(a.comparisonLevels))}else this._calcDataArray=(a=g.getAreaDataObjectCalculator(this._fieldData.areaData[this._currentFeatureIndex],this.getCalculatorName()))&&
[a.data].concat(a.comparisonLevels);return this._calcDataArray},_rendererJsons:null,getRendererJson:function(a){return this._rendererJsons[a]},setRendererJson:function(a,b){this._rendererJsons[a]=b},_layerIndexes:null,getLayerIndex:function(a){return this._layerIndexes[a]},setLayerIndex:function(a,b){this._layerIndexes[a]=b},_mapInfos:null,getMapInfo:function(a){return this._mapInfos[a]},getMapInfos:function(){var a=[],b;for(b in this._mapInfos)a.push(this._mapInfos[b]);return a},setMapInfo:function(a,
b){this._mapInfos[a]=b},_getPointIndexForCellFunc:null,_getCellForPointAtFunc:null,_highlightedCell:null,setLocatorTableCallbacks:function(a){this._getPointIndexForCellFunc=a.getPointIndexForCellFunc;this._getCellForPointAtFunc=a.getCellForPointAtFunc},registerLocatorTable:function(a){var b=this,d;a.set("highlightRowsOnHover",!0);h(a.domNode,"mouseover,mousemove",function(){var f=a.getOverFieldCell();f&&f!==d&&(d=f,b._highlightGraphicForFieldCell(d))});h(a.domNode,"mouseout",function(){b._highlightGraphicForFieldCell(null);
d=null})},_highlightRowForGraphic:function(a,b){this._highlightedCell&&(this._highlightedCell.parentGrid&&this._highlightedCell.parentGrid.setCellRowHighlighted(this._highlightedCell,!1),this._highlightedCell=null);b&&this._getCellForPointAtFunc&&(a=a.getPointIndexForGraphicFunc(b),(a=this._getCellForPointAtFunc(a))&&a.parentGrid&&(a.parentGrid.setCellRowHighlighted(a,!0),this._highlightedCell=a))},_graphicLayerInfos:null,setLocatorPointsLayer:function(a,b,d,c){this._unSetInfo(a);b={map:d,graphicsLayer:b,
getPointIndexForGraphicFunc:c.getPointIndexForGraphicFunc,getGraphicForPointAtFunc:c.getGraphicForPointAtFunc,setGraphicHighlightedFunc:c.setGraphicHighlightedFunc,layerMouseOverHandle:null,layerMouseOutHandle:null,highlightedGraphic:null,overGraphic:null};this._graphicLayerInfos[a]=b;this._addLayerListeners(b)},_addLayerListeners:function(a){var f=this,d=a.map,e=a.graphicsLayer;a.layerMouseOverHandle=c.onLayerMouseOver(e,d,function(c){c.graphic&&c.graphic._graphicsLayer===e&&a.overGraphic!==c.graphic&&
((a.layerMouseOutHandle&&a.layerMouseOutHandle.remove(),a.layerMouseOutHandle=null,f._removeHighlight(a),a.overGraphic=c.graphic,f._highlightRowForGraphic(a,a.overGraphic),a.setGraphicHighlightedFunc(a.overGraphic,!0),b.isMobileDevice())?d.infoWindow&&(d.infoWindow.setFeatures([a.overGraphic]),d.infoWindow.show(c.mapPoint,{closestFirst:!0})):a.layerMouseOutHandle=h.once(e,"mouse-out",function(b){f._removeHighlight(a,!0)}))})},_highlightGraphicForFieldCell:function(a){for(var b in this._graphicLayerInfos){var d=
this._graphicLayerInfos[b];this._removeHighlight(d);if(a){var c=this._getPointIndexForCellFunc(a);if(c=d.getGraphicForPointAtFunc(c))d.setGraphicHighlightedFunc(c,!0),d.highlightedGraphic=c}}},_removeHighlight:function(a,b){this._highlightRowForGraphic(a,null);a.highlightedGraphic&&(a.setGraphicHighlightedFunc(a.highlightedGraphic,!1),a.highlightedGraphic=null);a.overGraphic&&a.setGraphicHighlightedFunc(a.overGraphic,!1);a.overGraphic=null;!b&&a.map.infoWindow&&a.map.infoWindow.hide()},setPointVisibleAt:function(a,
b){for(var d in this._graphicLayerInfos){var c=this._graphicLayerInfos[d].getGraphicForPointAtFunc(a);if(c)c[b?"show":"hide"]()}},_unSetInfo:function(a){var b=this._graphicLayerInfos[a];delete this._graphicLayerInfos[a];b&&(b.layerMouseOverHandle&&b.layerMouseOverHandle.remove(),b.layerMouseOutHandle&&b.layerMouseOutHandle.remove())},_unSetLayers:function(){Object.keys(this._graphicLayerInfos).forEach(this._unSetInfo.bind(this));this._graphicLayerInfos={}},destroy:function(){this._unSetLayers()}})})},
"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/AreaDataUtil":function(){define(["dojo/_base/lang","../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil","../../_devConfig"],function(k,h,e){var g={getAreaDataValue:function(c){function b(a){!1!==u&&(t=a[u]);void 0===t&&(t=a[f])}function a(){var a=g[m];a&&(0<=p?b(a.comparisonLevels[p]):b(a.data))}var f=c.fieldName,d=c.fieldData,g=c.areaDataObject,m=c.calculatorName,l=c.featureIndex,p=c.comparisonIndex,q=c.ignoreMetadata,
k=c.isMultiFeature;if(!e.showAreaDataUtilUndefinedData&&f){var r=f.indexOf("."),u=!1;-1!==r&&(u=f.substr(r+1));m||-1===r||(m=f.substr(0,r));l=void 0===l?0:Number(l)||0;if(g=c.areaDataObject||d.areaData[l]){var t;k&&m===h.AREA_ATTRIBUTES_CALCULATOR_NAME&&!q&&d&&b(d.metadata);void 0===t&&a();if(m)return t;void 0===t&&!q&&d&&b(d.metadata);if(void 0===t)for(var z in g)if(c=g[z],0<=p?b(c.comparisonLevels[p]):b(c.data),void 0!==t)break;return t}}},getAreaDataObjectCalculator:function(c,b,a){if(!c)return null;
var f=c[b];!f&&a&&(f=c[b]=g.createCalculator());return f},createCalculator:function(c,b){return{data:c||{},comparisonLevels:b||[]}},combineAreaDataObjectCalculators:function(c,b,a){var f=[],d=[];c.forEach(function(a){if(a=g.getAreaDataObjectCalculator(a,b))f.push(a.data),d=d.concat(a.comparisonLevels)});a&&a.removeDuplicates&&(d=g.removeDuplicacatedCalcData(d));return{thisAreas:f,comparisonLevels:d}},removeDuplicacatedCalcData:function(c){if(!c.length)return c;var b=[],a={},f=Object.keys(c[0]);c.forEach(function(d){var c=
function(a){var b="";f.forEach(function(d){b+=a[d]+";"});return b}(d);a[c]||(a[c]=!0,b.push(d))});return b},setAreaDataValue:function(c,b,a,f,d){d=void 0===d?0:Number(d)||0;g.setAreaDataObjectValue(c,b,a[d],f)},setAreaDataObjectValue:function(c,b,a,f){a&&f&&null!==b&&void 0!==b&&(g.getAreaDataObjectCalculator(a,f,!0).data[c]=b)},mergeAreaData:function(c,b){b.forEach(function(a,b){(b=c[b])&&g.mergeAreaDataObjects(b,a)})},mergeAreaDataObjects:function(c,b){for(var a in c){var f=c[a],d=b[a];d?f.comparisonLevels.length!==
d.comparisonLevels.length?console.log("Error: can't merge calculators with different comparison levels!"):(k.mixin(d.data,f.data),f.comparisonLevels.forEach(function(a,b){k.mixin(d.comparisonLevels[b],a)})):b[a]=f}console.log("AreaDataUtil.js merging area data \x3d\x3e areaData");console.log(b)}};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil":function(){define([],function(){var k={SCRIPT_PREFIX:"",DEFAULT_SCRIPT_NAME:"Custom",
TOTAL_SCRIPT_NAME:"Total",AVG_SCRIPT_NAME:"Average",SCRIPT_PREFIX_RE:/^SCRIPT_/i,FIRST_SYMBOL_IS_NUMBER_RE:/^[0-9]/,DATA_COLLECTIONS_CALCULATOR_NAME:"dataCollectionsCalculator",MAPS_CALCULATOR_NAME:"mapsCalculator",UNITED_MAPS_CALCULATOR_NAME:"unitedMapsCalculator",AREA_ATTRIBUTES_CALCULATOR_NAME:"headers",ENRICHED_DATA_NO_LEVELS:"enrichFieldData_noLevels",createFieldNameFromVariable:function(h,e){if(!h)return"";if(h.isSiteAttribute)return h.attribute.name;if(h.isWebMap)return h.webMapFieldName||
h.fieldName;h=(h.fullName||h).replace(/_|\.|\s/g,"");e=e||"n";h+="n"===e?"":"_"+e;k.FIRST_SYMBOL_IS_NUMBER_RE.test(h)&&(h="_"+h);return k._checkXMLValidName(h.toUpperCase())},createFieldNameFromScript:function(h){h=h.name;k.SCRIPT_PREFIX_RE.test(h)&&(h=h.replace(k.SCRIPT_PREFIX_RE,""));return k._checkXMLValidName(k.SCRIPT_PREFIX+h.replace(/\.|-/g,""))},_XML_MASK_NAME_RE:/(_X)(\d\d\d\d)/i,_checkXMLValidName:function(h){return k._XML_MASK_NAME_RE.test(h)?h.replace(k._XML_MASK_NAME_RE,"$1_$2"):h},renderScriptName:function(h){return h.replace(k.SCRIPT_PREFIX_RE,
"")},provideQualifiedFieldInfoTemplateName:function(h,e){h&&(h.templateName=e?e+"."+h.name:h.isWebMap?k.AREA_ATTRIBUTES_CALCULATOR_NAME+"."+h.name:h.isSiteAttribute?k.AREA_ATTRIBUTES_CALCULATOR_NAME+"."+h.name:k.DATA_COLLECTIONS_CALCULATOR_NAME+"."+h.name)},getCalculatorName:function(h){return h&&h.templateName&&h.templateName.substr(0,h.templateName.indexOf("."))},isAreaAttributesFieldInfo:function(h){return k.getCalculatorName(h)===k.AREA_ATTRIBUTES_CALCULATOR_NAME},updateCalculatorName:function(h,
e){h&&h.templateName&&(h.templateName=e+h.templateName.substr(h.templateName.indexOf(".")))},refreshNameAndTemplateName:function(h){h.statefulName&&h.fullName&&(h.name=k.createFieldNameFromVariable(h,h.statefulName.charAt(0)),h.templateName=h.templateName.substr(0,h.templateName.lastIndexOf(".")+1)+h.name)}};return k})},"esri/dijit/geoenrichment/ReportPlayer/_devConfig":function(){define([],function(){return{showAreaDataUtilUndefinedData:!1,createPlayerCommand:{saveDataJsonAsTextFile:!1,useTestBuild:!1,
configUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/build/report-player/release/reportPlayer/config.js",baseUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/build/report-player/release",mainUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/build/report-player/release/reportPlayer/main.js",esriDijitCssUrl:"https://js.arcgis.com/3.29/dijit/themes/claro/claro.css",esriCssUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/build/report-player/release/reportPlayer/esri.css"},
createPDFCommand:{removeUnicodeChars:!1},preview:{bigValues:!1},charts:{enableEffects:!1,showStatisticsInTooltips:!1},table:{printGridRefresh:!1},emulateErrors:{playerError:!1,contentErrors:!1,themeParseError:!1,metadataParseError:!1,layoutParseError:0,reportContainerRenderError:!1,createReportError:!1,createReportNaN:!1}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/MapEventUtil":function(){define(["dojo/on","dojo/sniff","esri/dijit/geoenrichment/utils/DeviceUtil"],function(k,
h,e){return{onLayerMouseOver:function(g,c,b){var a=e.isMobileDevice();g=a?g:h("touch")?c:g;a=a?"mouse-over":h("touch")?"mouse-down, mouse-move":"mouse-move";return k(g,a,b)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/std/StdPolygonsController":function(){define("dojo/_base/declare esri/dijit/geoenrichment/Deferred dojo/on esri/dijit/geoenrichment/promise/all dijit/Destroyable ../../MapEventUtil esri/dijit/geoenrichment/ReportPlayer/countryConfig".split(" "),function(k,
h,e,g,c,b,a){return k(c,{_calculatorName:null,_hasRegisteredLayers:!1,_hasRegisteredInfographics:!1,constructor:function(a){this._calculatorName=a;this._layerIndexes={};this._rendererJsons={};this._labelRendererJsons={};this._mapInfos={};this._graphicLayerInfos={};this._pendingLayerInfos={}},getCalculatorName:function(){return this._calculatorName},_rendererJsons:null,_labelRendererJsons:null,getRendererJson:function(a){return this._rendererJsons[a]},getLabelRendererJson:function(a){return this._labelRendererJsons[a]},
setRendererJson:function(a,b){this._rendererJsons[a]=b},setLabelRendererJson:function(a,b){this._labelRendererJsons[a]=b},_layerIndexes:null,getLayerIndex:function(b,d){var c=a.getGeographiesModel().getLevels(),f=-1;c.some(function(a,b){if(a.id===d)return f=b,!0});return this._layerIndexes[b]+f/c.length},setLayerIndex:function(a,b){this._layerIndexes[a]=b},_mapInfos:null,getMapInfo:function(a){return this._mapInfos[a]},getMapInfos:function(){var a=[],b;for(b in this._mapInfos)a.push(this._mapInfos[b]);
return a},setMapInfo:function(a,b){this._mapInfos[a]=b},_attributeFields:null,getAttributeFields:function(){return this._attributeFields},setAttributeFields:function(a){this._attributeFields=a},_shownFeatureAttributes:null,_featuresChangedHandlers:null,getShownFeatureAttributes:function(){return this._shownFeatureAttributes},setShownFeaturesChangedListener:function(a){var b=this;this._featuresChangedHandlers=this._featuresChangedHandlers||[];this._featuresChangedHandlers.push(a);return{remove:function(){var d=
b._featuresChangedHandlers;d&&d.splice(d.indexOf(a),1)}}},setShownFeatureAttributes:function(a){this._shownFeatureAttributes=a;this._featuresChangedHandlers&&this._featuresChangedHandlers.forEach(function(a){a()})},_allFeatureAttributes:null,_loadAllFeaturesHandlers:null,getAllFeatureAttributes:function(){return this._allFeatureAttributes},setAllFeatureAttributes:function(a){this._allFeatureAttributes=a},setLoadAllFeaturesListener:function(a){var b=this;this._loadAllFeaturesHandlers=this._loadAllFeaturesHandlers||
[];this._loadAllFeaturesHandlers.push(a);return{remove:function(){var d=b._loadAllFeaturesHandlers;d&&d.splice(d.indexOf(a),1)}}},loadAllFeatures:function(){return this._loadAllFeaturesHandlers&&g(this._loadAllFeaturesHandlers.map(function(a){return a()}))},_highlightInfographicForAttributesFunc:null,_registerInfographicDfd:null,registerInfographic:function(a){this._highlightInfographicForAttributesFunc=a.highlightInfographicForAttributes;this._registerInfographicDfd=new h;this._hasRegisteredLayers&&
this._registerInfographicDfd.resolve();this._hasRegisteredInfographics||(this._hasRegisteredInfographics=!0,this._doRegisterLayers());return this._registerInfographicDfd.promise},_graphicLayerInfos:null,_pendingLayerInfos:null,setStdPolygonsLayer:function(a,b,c,e){this._unSetInfo(a);this._pendingLayerInfos[a]={map:c,graphicsLayer:b,getGraphicForAttributesFunc:e.getGraphicForAttributesFunc,setGraphicHighlightedFunc:e.setGraphicHighlightedFunc,layerMouseOverHandle:null,layerMouseOutHandle:null,highlightedGraphic:null};
this._hasRegisteredInfographics&&this._doRegisterLayers();this._hasRegisteredLayers||(this._hasRegisteredLayers=!0,this._registerInfographicDfd&&this._registerInfographicDfd.resolve())},_doRegisterLayers:function(){for(var a in this._pendingLayerInfos){var b=this._pendingLayerInfos[a];this._graphicLayerInfos[a]=b;this._addLayerListeners(b)}this._pendingLayerInfos={}},_addLayerListeners:function(a){var d=this,c=a.graphicsLayer,f;a.layerMouseOverHandle=b.onLayerMouseOver(c,a.map,function(b){b.graphic&&
b.graphic._graphicsLayer===c&&f!==b.graphic&&(a.layerMouseOutHandle&&a.layerMouseOutHandle.remove(),a.layerMouseOutHandle=null,f&&a.setGraphicHighlightedFunc(f,!1),f=b.graphic,d._highlightInfographicForAttributesFunc(f.attributes),a.setGraphicHighlightedFunc(f,!0),a.layerMouseOutHandle=e.once(c,"mouse-out",function(b){d._highlightInfographicForAttributesFunc(null);f&&a.setGraphicHighlightedFunc(f,!1);f=null}))})},highlightGraphicForAttributes:function(a){for(var b in this._graphicLayerInfos){var c=
this._graphicLayerInfos[b];c.highlightedGraphic&&(c.setGraphicHighlightedFunc(c.highlightedGraphic,!1),c.highlightedGraphic=null);if(a){var f=c.getGraphicForAttributesFunc(a);f&&(c.setGraphicHighlightedFunc(f,!0),c.highlightedGraphic=f)}}},_unSetInfo:function(a){var b=this._graphicLayerInfos[a];delete this._graphicLayerInfos[a];b&&(b.layerMouseOverHandle&&b.layerMouseOverHandle.remove(),b.layerMouseOutHandle&&b.layerMouseOutHandle.remove())},_unSetLayers:function(){Object.keys(this._graphicLayerInfos).forEach(this._unSetInfo.bind(this));
this._graphicLayerInfos={}},destroy:function(){this._unSetLayers()}})})},"esri/dijit/geoenrichment/ReportPlayer/countryConfig":function(){define(["./dataProvider/supportClasses/stdGeographies/StdGeographiesModel"],function(k){var h={},e;h.getCountryID=function(){return e&&e.id};h.getCurrencySymbol=function(){return e&&e.currencySymbol||"$"};h.getCurrencyFormat=function(){if(e&&e.currencyFormat)return e.currencyFormat;var a=h.getCurrencySymbol();return a+"0;-"+a+"0"};h.setCountry=function(a){e=a};
var g,c;h.getSingleUnits=function(){return g};h.getPluralUnits=function(){return c};h.setSingleAndPluralUnits=function(a,b){g=a;c=b};var b;h.getHierarchyID=function(){return b};h.setHierarchyID=function(a){b=a||"census"};var a;h.getGeographiesModel=function(){return a};h.setGeographiesModel=function(b){a=b};h.toJson=function(){return{country:{id:h.getCountryID(),currencySymbol:h.getCurrencySymbol(),currencyFormat:h.getCurrencyFormat()},hierarchy:b,geographiesModel:a&&a.toJson()}};h.fromJson=function(c){c&&
(e=c.country,b=c.hierarchy,a=c.geographiesModel&&new k(c.geographiesModel))};return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/stdGeographies/StdGeographiesModel":function(){define(["dojo/_base/declare","dojo/i18n!esri/nls/jsapi"],function(k,h){h=h.geoenrichment.dijit.ReportPlayer.ReportPlayer;return k(null,{countryID:null,hierarchyID:null,_levelsCache:null,_levels:null,_countryLevel:null,constructor:function(e){this.countryID=e.countryID;this.hierarchyID=e.hierarchyID;
this._initWithLevels(e.levels)},_initWithLevels:function(e){this._levels=e;this._levelsCache={};this._levels.forEach(function(e){this._levelsCache[e.id]=e;e.adminLevel&&(this._levelsCache[e.adminLevel]=e);e.isWholeCountry&&(this._countryLevel=e)},this)},getLevels:function(e){return e?this._levels.filter(function(e){return!e.isWholeCountry}):this._levels.slice()},getLevel:function(e){return this._levelsCache[e]},getLevelPluralName:function(e){var g=this.getLevel(e);return g?g.isWholeCountry?h.wholeCountry:
this.getLevel(e).pluralName:null},getCountryLevel:function(){return this._countryLevel},toJson:function(){return{countryID:this.countryID,hierarchyID:this.hierarchyID,levels:this._levels}}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/thisAreas/ThisAreasHighlightController":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/Deferred","dojo/on","dijit/Destroyable","../../MapEventUtil"],function(k,h,e,g,c){return k(g,{_hasRegisteredLayers:!1,_hasRegisteredTables:!1,
constructor:function(b){this._graphicLayerInfos={};this._registerTableDfds=[];this._highlightTableForAreaIndexFuncs=[];this._pendingLayerInfos={}},_highlightTableForAreaIndexFuncs:null,_registerTableDfds:null,registerTable:function(b){this._highlightTableForAreaIndexFuncs.push(b.highlightTableForAreaIndex);b=new h;this._registerTableDfds.push(b);this._hasRegisteredLayers&&this._doRegisterTables();this._hasRegisteredTables||(this._hasRegisteredTables=!0,this._doRegisterLayers());return b.promise},
_doRegisterTables:function(){this._registerTableDfds.forEach(function(b){b.resolve()});this._registerTableDfds.length=0},_graphicLayerInfos:null,_pendingLayerInfos:null,setThisAreaLayer:function(b,a,c,d){this._unSetInfo(b);this._pendingLayerInfos[b]={graphicsLayer:a,areaIndex:d.thisAreaIndex,getGraphicForAreaIndexFunc:d.getGraphicForAreaIndexFunc,setGraphicHighlightedFunc:d.setGraphicHighlightedFunc,layerMouseOverHandle:null,layerMouseOutHandle:null,highlightedGraphic:null,map:c};this._hasRegisteredTables&&
this._doRegisterLayers();this._hasRegisteredLayers||(this._hasRegisteredLayers=!0,this._doRegisterTables())},_doRegisterLayers:function(){for(var b in this._pendingLayerInfos){var a=this._pendingLayerInfos[b];this._graphicLayerInfos[b]=a;this._addLayerListeners(a)}this._pendingLayerInfos={}},_addLayerListeners:function(b){var a=this,f=b.graphicsLayer,d;b.layerMouseOverHandle=c.onLayerMouseOver(f,b.map,function(c){c.graphic&&c.graphic._graphicsLayer===f&&d!==c.graphic&&(b.layerMouseOutHandle&&b.layerMouseOutHandle.remove(),
b.layerMouseOutHandle=null,d&&b.setGraphicHighlightedFunc(d,!1),d=c.graphic,a._highlightTableForAreaIndexFuncs.forEach(function(a){a(b.areaIndex)}),b.setGraphicHighlightedFunc(d,!0),b.layerMouseOutHandle=e.once(f,"mouse-out",function(c){a._highlightTableForAreaIndexFuncs.forEach(function(a){a(null)});d&&b.setGraphicHighlightedFunc(d,!1);d=null}))})},highlightGraphicForAreaIndex:function(b){for(var a in this._graphicLayerInfos){var c=this._graphicLayerInfos[a];c.highlightedGraphic&&(c.setGraphicHighlightedFunc(c.highlightedGraphic,
!1),c.highlightedGraphic=null);var d=c.getGraphicForAreaIndexFunc(b);d&&(c.setGraphicHighlightedFunc(d,!0),c.highlightedGraphic=d)}},_unSetInfo:function(b){var a=this._graphicLayerInfos[b];delete this._graphicLayerInfos[b];a&&(a.layerMouseOverHandle&&a.layerMouseOverHandle.remove(),a.layerMouseOutHandle&&a.layerMouseOutHandle.remove())},_unSetLayers:function(){Object.keys(this._graphicLayerInfos).forEach(this._unSetInfo.bind(this));this._graphicLayerInfos={}},destroy:function(){this._unSetLayers()}})})},
"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/EditorUnits":function(){define(["esri/dijit/geoenrichment/utils/ObjectUtil","dojo/i18n!esri/nls/jsapi"],function(k,h){h=h.geoenrichment.dijit.ReportPlayer.units;var e={},g=["px","pt","mm","cm","in"],c={px:0,pt:1,mm:1,cm:2,"in":2};e.getSupportedUnits=function(){return g};e.getShortName=function(b){return h.shortNames[b]};e.getLongName=function(b){return h.longNames[b]};e.getLongNameWithUnits=function(b){return h.longNamesWithUnits[b]};e.getPlaces=
function(b){return c[b]||0};e.round=function(b,a){return k.roundNumber(b,e.getPlaces(a))};e.provideUnits=function(b,a){return b.replace("${units}",e.getShortName(a))};return e})},"esri/dijit/geoenrichment/ReportPlayer/ReportPlayerState":function(){define([],function(){return{isViewingDataDrillingZoom:!1,isViewingDynamicSettings:!1,isAnimationSuspended:!1}})},"esri/dijit/geoenrichment/ReportPlayer/DataProviderGE":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/when esri/kernel ./dataProvider/_CommandSupport ./dataProvider/_SerializationSupport ./dataProvider/_ServerSerializationSupport ./dataProvider/supportClasses/AnalysisAreaUtil ./dataProvider/supportClasses/AnalysisAreaJsonUtil ./dataProvider/supportClasses/CustomReportsManager ./dataProvider/supportClasses/TemplateJsonLoader ./dataProvider/supportClasses/ReportDataProcessor ./dataProvider/supportClasses/InfographicOptionsProvider ./dataProvider/supportClasses/AreasPreprocessor ./dataProvider/supportClasses/GEUtil ./dataProvider/supportClasses/attachments/DefaultAttachmentsStore ./dataProvider/supportClasses/attachments/CustomAttachmentsStore ./dataProvider/supportClasses/PortalManager ./dataProvider/supportClasses/VariablesUtil ./dataProvider/commands/mapToImage/MapToURLUtil ./core/themes/ThemeLibrary ./core/themes/ReportThemes esri/dijit/geoenrichment/ReportPlayer/countryConfig esri/dijit/geoenrichment/utils/ProjectionUtil esri/dijit/geoenrichment/utils/UrlUtil".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v,r,u,t,z,w,C,A,B,y,D,F){return k([b,a,f],{analysisAreasLimit:-1,cacheTemplates:!0,printMapTaskUrl:null,resetReportItemsCache:!0,_infographicOptionsProvider:null,constructor:function(a){h.mixin(this,a);this._infographicOptionsProvider=new q},_getAttachmentsStore:function(a){return(new u(a)).initialize()},getCustomReports:function(a){return m.getCustomReports(a)},_currentContext:null,getReportData:function(a,b){var c=this;progressCallback=b&&b.progressCallback||
function(){};var f=h.mixin({},a);f.portalUrl=F.getPortalUrl(f.portalUrl);f.hierarchy||f.analysisAreas.some(function(a){if(a.geographies&&a.geographies[0].hierarchy)return f.hierarchy=a.geographies[0].hierarchy,!0});c.resetReportItemsCache&&m.resetCache();c._currentContext=f;f.analysisAreas=n.areasFromJson(f.analysisAreas);f.combinedAreasInfo=f.combinedAreasInfo&&n.combinedAreasInfoFromJson(f.combinedAreasInfo)||{};d.populateCombinedAreasInfo(f.combinedAreasInfo,f.analysisAreas);f.fieldData={runReportTaskID:null,
metadata:{},areaData:[],errors:[]};return e([g(m.tryFindReportIdByAlias(f),function(a){f.reportID=a||f.reportID}),this._discoverPortal(f),function(){return f.variables&&g(w.preprocessVariables(f.variables,f.portalUrl),function(a){f.variables=a})}()]).then(function(){return g(v.preprocessAreas(f,{analysisAreasLimit:c.analysisAreasLimit}),function(){progressCallback(.25);setTimeout(function(){c._onCreateReportStarted()});var a={initGE:r.initialize(),countryInfo:r.getCountryInfo(f.countryID),infographicOptions:c._infographicOptionsProvider.getInfographicOptions(f),
attachmentsStore:f.attachmentsProvider?t(f.attachmentsProvider):c._getAttachmentsStore(f.analysisAreas)};f.reportID?(a.reportObject=m.getCustomReportByID(f),a.templateJsonInfo=l.getTemplateJsonByID(f,c.cacheTemplates),a.runReportResult=p.runReportAndGetData(f)):f.variables&&(a.reportObject=m.getFakeCustomReportByContext(f),a.templateJsonInfo=l.createTemplateJsonFromVariables(f),a.runReportResult=p.runReportFromVariables(f));return e(a).then(function(a){var b=a.reportObject,d=a.infographicOptions,
c=a.attachmentsStore,e=a.templateJsonInfo.templateJson,l=a.templateJsonInfo.templateVariableProvider,h=a.runReportResult;progressCallback(.75);if(!e||!b||!f.fieldData)return null;p.applyRunReportAndGetDataResults(h,f);y.setCountry(a.countryInfo.country);y.setHierarchyID(f.hierarchy);y.setGeographiesModel(a.countryInfo.geographiesModels[y.getHierarchyID()]);return g(c&&p.populateReportDataFromAttachmentsStore(f,c),function(){progressCallback(1);e.theme||(e.theme=A.getReportThemeById(b.isGraphicReport?
B.GRAPHIC:B.CLASSIC));return{isClassic:!b.isGraphicReport,isMultiFeature:b.isMultiFeature&&1<f.analysisAreas.length,reportType:b.type,reportTitle:b.title,templateJson:e,reportObject:b,fieldData:f.fieldData,analysisAreas:f.analysisAreas,combinedAreasInfo:f.combinedAreasInfo,reverseAnalysisAreasOnMap:f.reverseAnalysisAreasOnMap,infographicOptions:d,attachmentsStore:c,geClient:r.getClient(),templateVariableProvider:l,customLogo:f.customLogo,config:{portalUrl:f.portalUrl,geoenrichmentUrl:f.geoenrichmentUrl,
geometryServiceUrl:f.geometryServiceUrl,printMapTaskUrl:f.printMapTaskUrl,countryID:f.countryID,hierarchy:f.hierarchy,reportID:f.reportID,variables:f.variables}}})})})})},_discoverPortal:function(a){var b=this;return z.getPortalInfo(a.portalUrl).then(function(d){a.geoenrichmentUrl=a.geoenrichmentUrl||d.portal.helperServices.geoenrichment.url;var f=c.id.findCredential(a.portalUrl),f=f&&f.token;r.setGeoenrichmentUrl(a.geoenrichmentUrl,f);b._infographicOptionsProvider.setServerUrl(a.geoenrichmentUrl,
f);a.geometryServiceUrl=a.geometryServiceUrl||d.portal.helperServices.geometry.url;D.setGeometryServiceUrl(a.geometryServiceUrl);a.printMapTaskUrl=a.printMapTaskUrl||d.portal.helperServices.printTask.url;C.setPrintMapTaskUrl(a.printMapTaskUrl)})},reportDataToSingleAreaReportData:function(a,b){var d=b.currentFeatureIndex||0,c=h.mixin({},a.fieldData);c.areaData=[c.areaData[d]];var f=[a.analysisAreas[d]],e=a.infographicOptions&&this._infographicOptionsProvider.getInfographicOptionsFromJson(a.infographicOptions.toJsonAt(d)),
g=a.attachmentsStore;return{isClassic:a.isClassic,isMultiFeature:!1,reportType:a.reportType,reportTitle:b.reportTitle,templateJson:b.templateJson,reportObject:a.reportObject,fieldData:c,analysisAreas:f,combinedAreasInfo:null,reverseAnalysisAreasOnMap:!1,infographicOptions:e,attachmentsStore:g&&{getAttachments:function(){g.setCurrentAnalysisAreaIndex&&g.setCurrentAnalysisAreaIndex(d);return g.getAttachments()},getAttributes:function(){g.setCurrentAnalysisAreaIndex&&g.setCurrentAnalysisAreaIndex(d);
return g.getAttributes()},getNotes:function(){g.setCurrentAnalysisAreaIndex&&g.setCurrentAnalysisAreaIndex(d);return g.getNotes()}},geClient:a.geClient,templateVariableProvider:a.templateVariableProvider,config:a.config}},_getCurrentContext:function(){return this._currentContext},_onCreateReportStarted:function(){},enrichFieldData:function(a,b){return p.enrichFieldData(a,b)}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_CommandSupport":function(){define("require dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ../PlayerCommands ./supportClasses/GEUtil esri/dijit/geoenrichment/ReportPlayer/config".split(" "),
function(k,h,e,g,c,b,a,f){var d={};return h(null,{_commands:null,_commandIndex:0,_initCommandsPromise:null,constructor:function(){this._commands={}},_initCommands:function(){if(this._initCommandsPromise)return this._initCommandsPromise;var c=new g;if(f.modules.exportCommands)k(["./commands/CreateHTMLCommand","./commands/CreatePDFCommand","./commands/CreateImageCommand","./commands/PrintReportCommand","./commands/CreatePlayerCommand"],function(f,e,g,h,n){d[b.HTML]=f;d[b.PDF]=e;d[b.IMAGE]=g;d[b.PRINT]=
h;d[b.DYNAMIC_HTML]=n;a.getInitPromise().then(c.resolve)});else return c.resolve();return this._initCommandsPromise=c.promise},registerCommand:function(a,b,c){function f(d){if(!d.isBrowserSupported||d.isBrowserSupported())e._commands[a]||(e._commands[a]={index:e._commandIndex++,id:a,label:b||d.label,command:d})}var e=this;if(c)f(c);else return this._initCommands().then(function(){var b=d[a];b&&f(new b)})},getCommands:function(){return this._initCommands().then(function(){var d=[],f=this._commands[b.PDF],
e;for(e in this._commands)d.push(this._commands[e]);d.sort(function(a,b){return a.index-b.index});return(e=this._getCurrentContext())&&e.geoenrichmentUrl&&f?c(a.hasCapability("FormatInfographics"),function(a){a||(d=d.filter(function(a){return a!==f}));return d}):c(d)}.bind(this))},getCommandById:function(a){return this._commands[a]&&this._commands[a].command},executeCommand:function(a,b,d,c){return this._initCommands().then(function(){d=e.mixin({printMapTaskUrl:this.printMapTaskUrl},d);return this._commands[a]&&
this._commands[a].command&&this._commands[a].command.execute(b,d||{},c)}.bind(this))}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/GEUtil":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojox/uuid/generateRandomUuid esri/kernel esri/request esri/urlUtils esri/dijit/geoenrichment/utils/requests/FileContent esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/UrlUtil ./stdGeographies/StdGeographiesModel".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p){function q(b){return w?w:(b=b&&a.id.findCredential(b)||a.id.credentials[0])&&b.token}function v(a,b){var c=d.urlToObject(a);b=h.mixin({f:"json",token:q(a),langCode:dojo.locale},c.query||{},b);for(var f in b)a=b[f],a instanceof n||a&&"object"===typeof a&&(b[f]=JSON.stringify("function"===typeof a.toJson?a.toJson():a));return{url:c.path,taskParams:b}}function r(a){A||(A=new u(z));return!a||A.initialized?A:A.initialize()}var u=k(null,{url:null,_geInfo:null,_capabilities:null,
_supportedOperations:null,constructor:function(a){this.url=a},_initDfd:null,initialized:!1,initialize:function(){var a=this;if(this._initDfd)return this._initDfd.promise;this._initDfd=new e;m.requestPublicFirst(v(this.url).url+"/Geoenrichment",{content:{f:"json"},handleAs:"json"}).then(function(b){a.initWithJson(b)});return this._initDfd.promise},initWithJson:function(a){this._geInfo=a;this._capabilities={};this._supportedOperations={};a.capabilities&&a.capabilities.forEach(function(a){this._capabilities[a.toLowerCase()]=
!0},this);a.supportedOperations&&a.supportedOperations.forEach(function(a){this._supportedOperations[a.toLowerCase()]=!0},this);this._initDfd=this._initDfd||new e;this._initDfd.resolve();this.initialized=!0},hasCapability:function(a){return this._capabilities[a.toLowerCase()]},supportsOperation:function(a){return this._supportedOperations[a.toLowerCase()]},enrich:function(a){a=v(this.url,a);a.taskParams.AddDerivativeVariables="all";return f({url:a.url+"/Geoenrichment/Enrich",content:a.taskParams,
handleAs:"json"}).then(function(a){return a.results[0].value.FeatureSet||[]})},stdGeographyQuery:function(a){a=v(this.url,a);return f({url:a.url+"/StandardGeographyQuery/execute",content:a.taskParams,handleAs:"json"}).then(function(a){return a.results[0].value.features||[]})},getDataCollections:function(a,b,d){d=v(this.url,d);return f({url:d.url+"/Geoenrichment/DataCollections/"+a+(b?"/"+b:""),content:d.taskParams,handleAs:"json"}).then(function(a){return a.DataCollections})},_contriesCache:{},getCountries:function(){var a=
v(this.url);return f({url:a.url+"/Geoenrichment/Countries",content:a.taskParams,handleAs:"json"}).then(function(a){return a.countries})},getCountryInfo:function(a){var b=this;if(!this._contriesCache[a]){var d=v(this.url);this._contriesCache[a]=f({url:d.url+"/Geoenrichment/Countries/"+a,content:d.taskParams,handleAs:"json"}).then(function(d){var f=d.countries[0],e={};return c(f.hierarchies.map(function(d){return g(b._getStdGeographyModel(a,d.ID),function(a){e[d.ID]=a})})).then(function(){return{country:f,
geographiesModels:e}})})}return this._contriesCache[a]},_stdModelCache:null,_getStdGeographyModel:function(a,b){b=b||"census";this._stdModelCache=this._stdModelCache||{};var d=a+b;if(!this._stdModelCache[d]){var c=v(this.url);this._stdModelCache[d]=f({url:c.url+"/Geoenrichment/StandardGeographyLevels/"+a+"/"+b,content:c.taskParams,handleAs:"json"}).then(function(d){return new p({countryID:a,hierarchyID:b,levels:d.geographyLevels[0].hierarchies[0].levels})})}return this._stdModelCache[d]},formatReport:function(a){a=
v(this.url,a);return m.request({url:a.url,urlSuffix:"Geoenrichment/FormatReport"},{handleAs:"bin",content:a.taskParams}).then(function(a){return a&&a.data&&"text/plain"===a.data.type?null:a})},getReports:function(a){var b=v(this.url);return f({url:b.url+"/Geoenrichment/reports/"+a,content:b.taskParams,handleAs:"json"}).then(function(a){return a.reports})},_tasksHash:{},createReport:function(a){var d=v(this.url,a),c=b();this._tasksHash[c]={taskName:"createReport",taskParams:h.clone(a)};return m.request({url:d.url,
urlSuffix:"Geoenrichment/createReport"},{handleAs:"xml"===a.format?"text":"bin",content:d.taskParams}).then(function(a){return{taskID:c,result:a}})},consumeCredits:function(a){if(a=this._tasksHash[a])return a=h.clone(a),delete a.taskParams.forStorage,this[a.taskName](a.taskParams)},_dataLayersCache:{},getLayerInfos:function(a){this._dataLayersCache[a]||(this._dataLayersCache[a]=this._getLayerInfos(a));return this._dataLayersCache[a]},_getLayerInfos:function(a){var b=v(this.url);return f({url:b.url+
"/Geoenrichment/DataLayers/"+a,content:b.taskParams,handleAs:"json"}).then(function(a){return a&&a.layers||[]}).otherwise(function(a){console.log(a);return[]})},getLayerInfo:function(a,b){var d=a+"_"+b;this._dataLayersCache[d]||(this._dataLayersCache[d]=this._getLayerInfo(a,b));return this._dataLayersCache[d]},_getLayerInfo:function(a,b){var d=v(this.url);return f({url:d.url+"/Geoenrichment/DataLayers/"+a+"/"+b,content:d.taskParams,handleAs:"json"}).then(function(a){return a&&a.layer}).otherwise(function(a){console.log(a);
return null})}}),t={},z,w,C=new e;t.setGeoenrichmentUrl=function(a,b){(z=a||z)&&l.registerCORS(z);w=b||w;!C.promise.isFulfilled()&&C.resolve()};t.canMakeRequests=function(){return!!z};t.getInitPromise=function(){return C.promise};t.GEClient=u;var A;t.getClient=function(){return r()};t.initialize=function(){return r(!0)};t.initWithJson=function(a,b){t.setGeoenrichmentUrl(a);r().initWithJson(b)};t.enrich=function(a){return r().enrich(a)};t.stdGeographyQuery=function(a){return r().stdGeographyQuery(a)};
t.getDataCollections=function(a,b,d){return r().getDataCollections(a,b,d)};t.formatReport=function(a){return r().formatReport(a)};t.createReport=function(a){return r().createReport(a)};t.consumeCredits=function(a){return r().consumeCredits(a)};t.getLayerInfos=function(a){return r().getLayerInfos(a)};t.hasCapability=function(a){return g(r(!0),function(){return A&&A.hasCapability(a)})};t.supportsOperation=function(a){return g(r(!0),function(){return A&&A.supportsOperation(a)})};t.getCountryInfo=function(a){return r().getCountryInfo(a)};
return t})},"dojox/uuid/generateRandomUuid":function(){define(["./_base"],function(){dojox.uuid.generateRandomUuid=function(){function k(){for(var b=Math.floor(Math.random()%1*Math.pow(2,32)).toString(16);8>b.length;)b="0"+b;return b}var h=k(),e=k(),e=e.substring(0,4)+"-4"+e.substring(5,8),g=k(),g="8"+g.substring(1,4)+"-"+g.substring(4,8),c=k();return(h+"-"+e+"-"+g+c).toLowerCase()};return dojox.uuid.generateRandomUuid})},"dojox/uuid/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang"],
function(k){k.getObject("uuid",!0,dojox);dojox.uuid.NIL_UUID="00000000-0000-0000-0000-000000000000";dojox.uuid.version={UNKNOWN:0,TIME_BASED:1,DCE_SECURITY:2,NAME_BASED_MD5:3,RANDOM:4,NAME_BASED_SHA1:5};dojox.uuid.variant={NCS:"0",DCE:"10",MICROSOFT:"110",UNKNOWN:"111"};dojox.uuid.assert=function(h,e){if(!h)throw e||(e="An assert statement failed.\nThe method dojox.uuid.assert() was called with a 'false' value.\n"),Error(e);};dojox.uuid.generateNilUuid=function(){return dojox.uuid.NIL_UUID};dojox.uuid.isValid=
function(h){h=h.toString();var e=k.isString(h)&&36==h.length&&h==h.toLowerCase();if(e){h=h.split("-");var e=5==h.length&&8==h[0].length&&4==h[1].length&&4==h[2].length&&4==h[3].length&&12==h[4].length,g;for(g in h)var c=parseInt(h[g],16),e=e&&isFinite(c)}return e};dojox.uuid.getVariant=function(h){if(!dojox.uuid._ourVariantLookupTable){var e=dojox.uuid.variant,g=[];g[0]=e.NCS;g[1]=e.NCS;g[2]=e.NCS;g[3]=e.NCS;g[4]=e.NCS;g[5]=e.NCS;g[6]=e.NCS;g[7]=e.NCS;g[8]=e.DCE;g[9]=e.DCE;g[10]=e.DCE;g[11]=e.DCE;
g[12]=e.MICROSOFT;g[13]=e.MICROSOFT;g[14]=e.UNKNOWN;g[15]=e.UNKNOWN;dojox.uuid._ourVariantLookupTable=g}h=h.toString();h=h.charAt(19);h=parseInt(h,16);dojox.uuid.assert(0<=h&&16>=h);return dojox.uuid._ourVariantLookupTable[h]};dojox.uuid.getVersion=function(h){dojox.uuid.assert(dojox.uuid.getVariant(h)==dojox.uuid.variant.DCE,"dojox.uuid.getVersion() was not passed a DCE Variant UUID.");h=h.toString();h=h.charAt(14);return parseInt(h,16)};dojox.uuid.getNode=function(h){dojox.uuid.assert(dojox.uuid.getVersion(h)==
dojox.uuid.version.TIME_BASED,"dojox.uuid.getNode() was not passed a TIME_BASED UUID.");h=h.toString();return h.split("-")[4]};dojox.uuid.getTimestamp=function(h,e){dojox.uuid.assert(dojox.uuid.getVersion(h)==dojox.uuid.version.TIME_BASED,"dojox.uuid.getTimestamp() was not passed a TIME_BASED UUID.");h=h.toString();e||(e=null);switch(e){case "string":case String:return dojox.uuid.getTimestamp(h,Date).toUTCString();case "hex":var g=h.split("-");h=g[0];e=g[1];g=g[2];g=g.slice(1);h=g+e+h;dojox.uuid.assert(15==
h.length);return h;case null:case "date":case Date:return g=h.split("-"),h=parseInt(g[0],16),e=parseInt(g[1],16),g=(parseInt(g[2],16)&4095)<<16,g=4294967296*(g+e),g+=h,new Date(g/1E4-122192928E5);default:dojox.uuid.assert(!1,"dojox.uuid.getTimestamp was not passed a valid returnType: "+e)}};return dojox.uuid})},"esri/dijit/geoenrichment/utils/requests/FileContent":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/utils/DataUtil"],function(k,h){function e(c){return c?/^image\//.test(c)?
"base64":/^text\//.test(c)?"text":/application\/json/.test(c)?"json":"bin":"bin"}var g=k(null,{data:null,filename:null,contentType:"application/octet-stream",contentTransferEncoding:"binary",constructor:function(c,b,a){this.data=c;b&&(this.contentType=b);a&&(this.contentTransferEncoding=a)},getBase64Data:function(){return this.data?"base64"==this.contentTransferEncoding?this.data:h.base64FromByteSource(this.data):null},toString:function(){return this.filename||"\x3cunknown\x3e"}});g.fromArrayBuffer=
function(c,b){return new g(h.binaryStringFromByteSource(c),b)};g.fromBlob=function(c,b){return h.arrayBufferFromBlob(c).then(function(a){return new g(h.binaryStringFromByteSource(a),b||c.type)})};g.fromFileData=function(c,b,a){a=a||h.getContentType(c);if("object"==typeof b&&window.ArrayBuffer&&(b instanceof ArrayBuffer||b.buffer instanceof ArrayBuffer))b=h.binaryStringFromByteSource(b.buffer||b);else{var f=e(a);"json"==f&&"object"==typeof b&&(b=JSON.stringify(b));if("string"!=typeof b)throw Error("Wrong file data.");
switch(f){case "base64":b=atob(b);break;case "text":case "json":b=unescape(encodeURIComponent(b))}}b=new g(b,a);b.filename=c;return b};g.getContentConversionType=e;return g})},"esri/dijit/geoenrichment/utils/requests/UniversalClient":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred dojo/request/xhr dojo/io-query dojo/sniff esri/dijit/geoenrichment/when esri/kernel esri/config esri/lang esri/urlUtils ../UrlUtil ./BinaryData ./FileContent ./MultipartDataBuilder ./ErrorUtil".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v,r){function u(a,b){if(b)this.reject(b);else{b=a.xhr;var d=b.getResponseHeader&&b.getResponseHeader("Content-Type");a.status=b.status;a.data=new p(b.response||b.responseBody||b.responseText,d);this.resolve(a)}}var t=0,z=b("safari"),w=k(null,{constructor:function(a){"string"===typeof a?this.url=a:"object"===typeof a&&h.mixin(this,a)},url:null,preventCache:null,usePost:!1,timeout:0,multipartThreshold:0,useCommonAuth:!1,useProxy:!1,allowSSL:null,send:function(a,
b){return this.sendUrlRequest(this.prepareUrlRequest(a,b),"UniversalClient.send")},prepareUrlRequest:function(a,b){"string"===typeof a?a={urlSuffix:a}:a||(a={});b||(b={});var e=a.url||this.url;a=a.urlSuffix;e||(e=a,a=null);if(!e)throw Error("URL is missing.");var g=m.urlToObject(e),e=l.combine(g.path,a);a=g.query||{};"object"===typeof b.content&&(a=h.mixin(a,b.content));g=b.requireSSL;!0!==g&&!1===this.allowSSL&&(g=!1);!1!==g&&!0===this.allowSSL&&/^https/i.test(window.location.protocol)&&(g=!0);if(f.id){var p=
f.id.findCredential(e);!p&&this.useCommonAuth&&(p="string"==typeof this.useCommonAuth?f.id.findCredential(this.useCommonAuth):f.id.credentials[0]);p&&(a.token||!1===a.token||(a.token=p.token),p.ssl&&!1!==g&&(g=!0))}!0===g&&(e=l.toHttpsUrl(e));!1===a.token&&delete a.token;var k=b.handleAs||"json";"json"===k&&(a.f="json");var p=(b.sendAs||(b.usePost||this.usePost||a.token?"post":"get")).toLowerCase(),g="multipart"==p?!0:b.sendAs||b.sizeLimit?!1:null,r=0,u;for(u in a){var w=a[u];w instanceof q?g=!0:
("object"==typeof w&&(w=a[u]=JSON.stringify(w)),!g&&0<this.multipartThreshold&&(r+=u.length+(w?w.length:0)+2))}!1!==g&&0<this.multipartThreshold&&r>this.multipartThreshold&&(g=!0);if(b.useProxy||!m.hasSameOrigin(e,window.location.href)&&this.useProxy&&!b.hasOwnProperty("useProxy")){var A=l.getProxyUrl();A&&(e=A+"?"+e)}else m.getProxyRule(e)&&(e=m.getProxyRule(e).proxyUrl+"?"+e);u=(u=b.hasOwnProperty("preventCache")?b.preventCache:this.preventCache)||null===u&&A||z?"_ts\x3d"+(new Date).getTime()+t++:
"";A={handleAs:k};if(k=Number(n.isDefined(b.timeout)?b.timeout:this.timeout))A.timeout=k;k="get"!=p||g;p=g?null:c.objectToQuery(a);k||(k=p.length+e.length+u.length+1>=d.defaults.io.postLength);A.method=k?"POST":"GET";A.headers={"X-Requested-With":null};A.headers["Content-Type"]="undefined"!=typeof b.contentType?b.contentType:"application/x-www-form-urlencoded; charset\x3dutf-8";g?(g=new v,g.addVariables(a),g.build(A)):k?A.data=p:p&&(e+="?"+p,u&&(e+="\x26"+u),u=null);!p&&u&&(e+="?"+u);return{url:e,
options:A,sizeLimit:b.sizeLimit}},sendUrlRequest:function(b,d){var c="string"===typeof b.options.data?b.options.data.length:null;if(b.sizeLimit&&c&&("function"===typeof b.sizeLimit?b.sizeLimit(c):c>b.sizeLimit))return(new e).reject(Error("SIZE_LIMIT_EXCEEDED"));d=d||"UniversalClient.sendUrlRequest";var f=b.deferred||new e;if(c="bin"==b.options.handleAs)b.options.handleAs="blob";var l=g(b.url,b.options,!0);c&&(l.handleResponse=u);var h=this;l.then(function(c){c="json"===b.options.handleAs&&c&&r.parseError(c)||
c;if(c instanceof Error){if(!0===h.useCommonAuth&&498===c.code)var e=w.handleInvalidTokenError(c);a(e).always(function(){f.reject(c)})}else f.resolve(h._makeResponse(d,c))},function(a){f.reject(r.makeError(a))});return f.promise},requestToUrl:function(a){if(a.options.headers&&a.options.headers["Content-Type"]&&0==a.options.headers["Content-Type"].indexOf("multipart/form-data"))return null;var b=a.url;if(a=a.options.data){if(b.length+a.length>=d.defaults.io.postLength)return null;b+="?"+a}return b},
_makeResponse:function(a,b){return b}});w.makeError=r.makeError;w.handleInvalidTokenError=function(a){};var C=new w({useCommonAuth:!0,allowSSL:!0});w.request=function(a,b){return C.send(a,b).otherwise(function(d){var c=b&&b.content&&b.content.token;if(498!==d.code||null!=c)return(new e).reject(d);b=h.mixin({},b);b.content=h.mixin({},b.content);b.content.token=!1;return C.send(a,b)})};w.requestPublicFirst=function(a,b){var d=h.mixin({},b);d.content=h.mixin({},b.content);d.content.token=!1;return C.send(a,
d).otherwise(function(d){return 499===d.code?C.send(a,b):(new e).reject(d)})};return w})},"esri/dijit/geoenrichment/utils/requests/BinaryData":function(){define(["dojo/_base/declare"],function(k){return k(null,{data:null,type:null,constructor:function(h,e){this.type=e||h&&h.type||null;this.data=h}})})},"esri/dijit/geoenrichment/utils/requests/MultipartDataBuilder":function(){define(["dojo/_base/declare","dojo/request/util","esri/lang","./FileContent"],function(k,h,e,g){var c=k(null,{data:null,constructor:function(a){this.data=
a}}),b=h.parseArgs;h.parseArgs=function(a,d,e){d.data&&d.data instanceof c&&(d.data=d.data.data,e=!0);return b(a,d,e)};var a=h.deepCreate;h.deepCreate=function(b,d){return d instanceof c?new c(d.data):a(b,d)};return k(null,{addVariables:function(a){for(var b in a)this.addVariable(b,a[b])},addVariable:function(a,b){e.isDefined(b)&&(b instanceof g?this._writeFileContent(a,b):this._writeVariable(a,b.toString()))},build:function(a){this._writeBoundary(!0);a.data=new c(this._prepareBinaryData());var b=
a.headers||{};b["Content-Type"]="multipart/form-data; boundary\x3d"+this._dataProvider.boundary;a.headers=b;this._dataProvider=null},_prepareBinaryData:function(){var a=this._dataProvider.buffer;if(!window.Uint8Array)return a;for(var b=a.length,c=new Uint8Array(new ArrayBuffer(b)),e=0;e<b;e++)c[e]=a.charCodeAt(e);return c},_getDataProvider:function(){if(!this._dataProvider){for(var a="",b=0;32>b;b++)a+=String.fromCharCode(Math.floor(97+25*Math.random()));this._dataProvider={buffer:"",boundary:a}}return this._dataProvider},
_dataProvider:null,_writeVariable:function(a,b){this._writeBoundary();this._writeContentDisposition(a);this._writeLineBreak();this._writeData(this._toUTF8(b));this._writeLineBreak()},_writeFileContent:function(a,b){this._writeBoundary();this._writeContentDisposition(a,b.filename);b.contentType&&(this._writeData("Content-Type: "+b.contentType),this._writeLineBreak());b.contentTransferEncoding&&(this._writeData("Content-Transfer-Encoding: "+b.contentTransferEncoding),this._writeLineBreak());this._writeLineBreak();
this._writeData(b.data);this._writeLineBreak()},_writeBoundary:function(a){this._writeDoubleDash();this._writeData(this._getDataProvider().boundary);a?this._writeDoubleDash():this._writeLineBreak()},_writeContentDisposition:function(a,b){b=b?'"; filename\x3d"'+this._toUTF8(b.replace(/"/g,"'")):"";this._writeData('Content-Disposition: form-data; name\x3d"'+this._toUTF8(a)+b+'"');this._writeLineBreak()},_writeDoubleDash:function(){this._writeData("--")},_writeLineBreak:function(){this._writeData("\r\n")},
_writeData:function(a){this._getDataProvider().buffer+=a},_toUTF8:function(a){return unescape(encodeURIComponent(a))}})})},"esri/dijit/geoenrichment/utils/requests/ErrorUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","require"],function(k,h,e){function g(b){var a=new k;e(["./DataResource"],function(c){h((new c(b)).getFileContent(),a.resolve,a.reject)});return a.promise}var c={getErrorFromBin:function(b){var a=/^text\/|^application\/json/;return b&&b.type&&
!a.test(b.type)?null:h(b&&g(b),function(b){if(b){if(b.hasOwnProperty("contentType")&&!a.test(b.contentType))return null;try{var d=JSON.parse(decodeURIComponent(escape(b.data))),f=c.parseError(d);if(f)return f;if(d.messages&&d.messages.length){var e=d.messages[0];if("esriJobMessageTypeError"==e.type)return Error(e.description)}}catch(l){}}return Error("Binary data error.")})},parseError:function(b){var a;b.error?a=c.makeError(b.error):"error"===b.status&&(a=c.makeError(b));a&&a.code&&null==a.httpCode&&
(a.httpCode=a.code);return a},makeError:function(b){null==b?b=Error():"string"===typeof b&&(b={message:b});if(!(b instanceof Error)&&"object"===typeof b){var a=b;b=Error();a.code&&(b.code=a.code);a.message&&(b.message=a.message);a.details&&(b.details=a.details)}b.log=dojoConfig.isDebug;return b}};return c})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_SerializationSupport":function(){define("require dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all ./supportClasses/AnalysisAreaJsonUtil ./supportClasses/AnalysisAreaUtil esri/dijit/geoenrichment/ReportPlayer/countryConfig".split(" "),
function(k,h,e,g,c,b,a,f,d){function n(){var a=new g;k("./supportClasses/attachments/AttachmentsStoreSerializer ./supportClasses/GEUtil ../core/supportClasses/templateJsonUtils/TemplateJsonSerializer ../core/supportClasses/templateJsonUtils/TemplateJsonAnalyzer ../core/infographics/simpleInfographic/dataDrilling/EnrichUtil ../core/infographics/utils/InfographicJsonUtil ../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../core/infographics/InfographicTypes ../core/infographics/simpleInfographic/dataDrilling/DataDrillingLibrary ./commands/mapToImage/MapToURLUtil esri/dijit/geoenrichment/utils/ProjectionUtil".split(" "),
function(b,d,c,f,e,g,h,n,k,A,K){m=b;l=d;p=c;q=f;v=e;r=g;u=h;t=n;z=k;w=A;C=K;a.resolve()});return a.promise}var m,l,p,q,v,r,u,t,z,w,C;return h(null,{reportDataToJson:function(b,f){var g=this;f=f||{};return n().then(function(){return c(f.loadDataDrillingData&&g._serializeDataDrilling(b),function(){return c(b.attachmentsStore&&m.getAttachmentsStoreJson(b.attachmentsStore,b.analysisAreas.length),function(c){var l=e.mixin({},b.config);!1!==f.forceFixedDataMode&&delete l.geoenrichmentUrl;c={isClassic:b.isClassic,
isMultiFeature:b.isMultiFeature,reportType:b.reportType,reportTitle:b.reportTitle,templateJson:p.serialize(b.templateJson),reportObject:g._prepareReportObjectJson(b.reportObject),fieldData:b.fieldData,analysisAreas:a.areasToJson(b.analysisAreas),combinedAreasInfo:b.combinedAreasInfo&&a.combinedAreasInfoToJson(b.combinedAreasInfo),reverseAnalysisAreasOnMap:b.reverseAnalysisAreasOnMap,infographicOptions:b.infographicOptions&&b.infographicOptions.toJson(),attachmentsStore:c,templateVariableProvider:b.templateVariableProvider&&
b.templateVariableProvider.toJson(),config:l,countryConfig:d.toJson(),mapImageInfos:f.mapImageInfos,customLogo:b.customLogo};console.log("_SerializationSupport.js \x3d\x3e reportDataJson");console.log(c);return c})})})},_prepareReportObjectJson:function(a){var b={},d;for(d in a)a[d]&&"object"!==typeof a[d]&&(b[d]=a[d]);return b},_serializeDataDrilling:function(a){var d=v.getEnrichInfosForTemplateJson(a.infographicOptions.countryID,a.templateJson),c=[];c.push(this.enrichFieldData(d,e.mixin({analysisAreas:a.analysisAreas,
fieldData:a.fieldData},a.config)));c.push(this._enrichInfographicVariables(a,d));var f={};d&&d.forEach(function(a){a.isChart||a.isGeneral?a.fields.forEach(function(a){a.mapTo&&(f[a.mapTo]=1)}):a.isInfographic&&(a.fieldInfos?a.fieldInfos.forEach(function(a){a.hasVariable&&a.fullName&&(f[a.fullName]=1)}):a.variables&&a.variables.forEach(function(a){f[a]=1}))});var d=q.collectVariablesStats(a.templateJson),g;for(g in d)f[g]=1;(g=z.getSubstitutionVariables(a.config.countryID))&&g.forEach(function(a){f[a]=
1});c.push(a.templateVariableProvider.tryFetchDataVintageInfo(a.config,f));return b(c)},_enrichInfographicVariables:function(a,d){var f=a.infographicOptions;return c(f.getOptions().getItems(f.countryID),function(){var c=[];d.forEach(function(b){b.isInfographic&&b.variables&&a.analysisAreas.forEach(function(a,d){f.setCurrentAnalysisAreaIndex(d);var e=new g;a=f.createGeoenrichment({currentFeatureIndex:d});a.onDone=function(){e.resolve()};a.country=f.countryID;d=t.supportsComparison(b.type);a.setGeoLevels(d?
r.getSubLevels(b):null,d?r.getHighestLevel(b):null);a.setVariables(b.variables);a.setStudyArea(f.studyArea);c.push(e.promise)})});return b(c)})},reportDataFromJson:function(b){var c=this;return n().then(function(){var e=b.fieldData;e.featureData&&(e.areaData=e.featureData.map(function(a){return{mainCalculator:{data:a}}}),delete e.featureData);e={isClassic:b.isClassic,isMultiFeature:b.isMultiFeature,reportType:b.reportType,reportTitle:b.reportTitle,templateJson:p.deserialize(b.templateJson),reportObject:b.reportObject,
fieldData:e,analysisAreas:a.areasFromJson(b.analysisAreas),combinedAreasInfo:b.combinedAreasInfo&&a.combinedAreasInfoFromJson(b.combinedAreasInfo)||{},reverseAnalysisAreasOnMap:b.reverseAnalysisAreasOnMap,infographicOptions:b.infographicOptions&&c._infographicOptionsProvider.getInfographicOptionsFromJson(b.infographicOptions),attachmentsStore:b.attachmentsStore&&m.getAttachmentsStoreFromJson(b.attachmentsStore),templateVariableProvider:b.templateVariableProvider&&new u(b.templateVariableProvider),
config:b.config||{},mapImageInfos:b.mapImageInfos,customLogo:b.customLogo};f.populateCombinedAreasInfo(e.combinedAreasInfo,e.analysisAreas);l.setGeoenrichmentUrl(e.config.geoenrichmentUrl);e.config.geometryServiceUrl&&C.setGeometryServiceUrl(e.config.geometryServiceUrl);e.config.printMapTaskUrl&&w.setPrintMapTaskUrl(e.config.printMapTaskUrl);d.fromJson(b.countryConfig);return e})}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/AnalysisAreaJsonUtil":function(){define(["esri/graphic",
"esri/dijit/PopupTemplate"],function(k,h){function e(b,a){if(!b)return null;b.getLayer()&&(b=new k(b.geometry,b.symbol,b.attributes,b.infoTemplate));b=b.toJson();a&&delete b.infoTemplate;return b}function g(b){if(!b)return null;if(b instanceof k)return b;var a=b.infoTemplate&&new h(b.infoTemplate);delete b.infoTemplate;b=new k(b);a&&b.setInfoTemplate(a);return b}function c(b){var a={},c;for(c in b){var d=b[c];if("string"===typeof d||"number"===typeof d&&!isNaN(d))a[c]=d}return a}return{areasToJson:function(b,
a){var f=a&&a.excludeInfoTemplate;return b.map(function(a){var b=c(a);b.feature=e(a.feature,f);b.location=a.location&&e(a.location,f);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(function(a){return e(a,f)});b.geographies=a.geographies;b.buffer=a.buffer;return b})},combinedAreasInfoToJson:function(b){var a=c(b);a.groups=b.groups&&b.groups.map(function(a){var b=c(a);b.indexes=a.indexes.slice();b.location=a.location&&e(a.location);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(e);
return b});return a},areasFromJson:function(b){return b.map(function(a){var b=c(a);b.feature=g(a.feature);b.location=a.location&&g(a.location);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(g);b.geographies=a.geographies;b.buffer=a.buffer;return b})},combinedAreasInfoFromJson:function(b){var a=c(b);a.groups=b.groups&&b.groups.map(function(a){var b=c(a);b.indexes=a.indexes.slice();b.location=a.location&&g(a.location);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(g);
return b});return a}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/AnalysisAreaUtil":function(){define(["esri/geometry/webMercatorUtils","esri/dijit/geoenrichment/utils/CoordinateUtil"],function(k,h){return{geometryToLatLong:function(e){var g=e.spatialReference.wkid;return g===h.WGS_84_WKID?{STORE_LONG:e.x,STORE_LAT:e.y}:h.isWebMercator(g)?(e=k.xyToLngLat(e.x,e.y),{STORE_LONG:e[0],STORE_LAT:e[1]}):null},populateCombinedAreasInfo:function(e,g){var c={},b={};g.forEach(function(a){a.latitude&&
(c[a.latitude]=1);a.longitude&&(b[a.longitude]=1)});e.name=e.name||g.map(function(a){return a.name}).join(", ");e.shortName=e.shortName||g.map(function(a){return a.shortName||a.name}).join(", ");e.description=e.description||g.map(function(a){return a.description||a.name}).join(", ");e.address=e.address||g.map(function(a){return a.address||a.name}).join(", ");e.latitude=e.latitude||Object.keys(c).join(", ");e.longitude=e.longitude||Object.keys(b).join(", ");return e}}})},"esri/dijit/geoenrichment/utils/CoordinateUtil":function(){define(["esri/geometry/webMercatorUtils",
"esri/geometry/jsonUtils"],function(k,h){var e={},g=[4326,102100,102113,3857];e.WGS_84_WKID=4326;e.WEB_MERCATOR_WKID=102100;e.getSupportedWKIDs=function(){return g.slice()};e.testSpatialReferenceWKID=function(c){c=g.indexOf(Number(c&&"object"===typeof c?c.wkid:c));return 0<=c?g[0===c?0:1]:0};e.isWebMercator=function(c){return 102100===e.testSpatialReferenceWKID(c)};e.isWGS84=function(c){return 4326===e.testSpatialReferenceWKID(c)};e.getGeometryConverter=function(c,b){c=e.testSpatialReferenceWKID(c);
b=e.testSpatialReferenceWKID(b);return c&&b&&c!==b?4326===c?k.geographicToWebMercator:k.webMercatorToGeographic:null};e.toWGS84=function(c){return e.toSpatialReference(c,4326)};e.toWebMercator=function(c){return e.toSpatialReference(c,102100)};e.toSpatialReference=function(c,b){c&&!c.toJson&&(c=h.fromJson(c));b=e.getGeometryConverter(c&&c.spatialReference,b);return null!=b?b(c):c};return e})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_ServerSerializationSupport":function(){define("require dojo/_base/declare esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./supportClasses/ReportDataProcessor ./supportClasses/tasks/parsers/DataXMLParser ./supportClasses/tasks/RunReportTask ./supportClasses/AnalysisAreaUtil ./supportClasses/AnalysisAreaJsonUtil ./supportClasses/CustomReportsManager ./supportClasses/GEUtil ../core/supportClasses/ReportTemplateTypes ../core/conversion/PortalToEditorConverter esri/dijit/geoenrichment/utils/ImageInfoUtil".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v){function r(){var a=new g;k(["./supportClasses/attachments/AttachmentsStoreSerializer","../core/supportClasses/templateJsonUtils/TemplateJsonSerializer","../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider","./commands/mapToImage/MapToURLUtil","esri/dijit/geoenrichment/utils/ProjectionUtil"],function(b,d,c,f,e){u=b;t=d;z=c;w=f;C=e;a.resolve()});return a.promise}var u,t,z,w,C;return h(null,{reportDataToServerData:function(a){var b=a.getReportData(),
d=this;return r().then(function(){return e({files:b.reportObject.templateData.getFiles(),attachmentsProvider:b.attachmentsStore&&u.getAttachmentsStoreJson(b.attachmentsStore,b.analysisAreas.length),mapImages:d._getMapImages(a)}).then(function(a){var d=f.CreateReportResultCache.getResults()[0].originalXML;a.mapImages&&a.mapImages.forEach(function(a){d=d.replace(/\<mapImage_0\>mapImage_.*?\.png\<\/mapImage_0\>/,"\x3cmapImage_0\x3e"+a+"\x3c/mapImage_0\x3e")});a.files.push({name:"data.xml",data:d});return{portalItem:{properties:{isMultiFeature:b.reportObject.isMultiFeature?
"true":"false"},resources:a.files},attachmentsProvider:a.attachmentsProvider,customLogo:b.customLogo,portalUrl:b.config.portalUrl,geometryServiceUrl:b.config.geometryServiceUrl,printMapTaskUrl:b.config.printMapTaskUrl,analysisAreas:n.areasToJson(b.analysisAreas),combinedAreasInfo:b.combinedAreasInfo&&n.combinedAreasInfoToJson(b.combinedAreasInfo),reverseAnalysisAreasOnMap:b.reverseAnalysisAreasOnMap}})})},_getMapImages:function(a){a=a.collectMaps({allAreas:!0});return e(a.map(function(a){return w.mapToURL(a.map,
a.legend,a.node).then(function(a){return v.getRemoteImageDataUrl(a,{sizeLimit:100})})}))},reportDataFromServerData:function(f){function e(){var a=m.prepareCustomReportFromItem(f.portalItem);a.isGraphicReport=!0;a.portalJson={files:v};return c(q.provideEditorJson(a),function(){a.templateJson=t.deserialize(a.templateJson);delete a.portalJson;return a})}function g(d,c){var f=v.filter(function(a){return"data.xml"===a.name})[0],e=/.*\.png/i,g={};v.forEach(function(a){e.test(a.name)&&(g[a.name]=a.data)});
d={selectedReport:d,areaData:a.parse(f.data,function(a,b){return g[b]||b})};b.applyRunReportAndGetDataResults(d,c)}var h=this,k=f.portalItem.resources,v;if(Array.isArray(k))v=k;else{v=[];for(var A in k)v.push({name:A,data:k[A]})}return r().then(function(){return c(e(),function(a){var e=n.areasFromJson(f.analysisAreas),m={isClassic:!1,isMultiFeature:a.isMultiFeature&&1<e.length,reportType:a.type||p.STANDARD,reportTitle:a.title||"",templateJson:a.templateJson,reportObject:a,fieldData:{metadata:{},areaData:[],
errors:[]},analysisAreas:e,combinedAreasInfo:f.combinedAreasInfo&&n.combinedAreasInfoFromJson(f.combinedAreasInfo)||{},reverseAnalysisAreasOnMap:f.reverseAnalysisAreasOnMap,infographicOptions:h._infographicOptionsProvider.getInfographicOptions({geoenrichmentUrl:"",countryID:"",reportID:"",analysisAreas:e}),attachmentsStore:f.attachmentsProvider&&u.getAttachmentsStoreFromJson(f.attachmentsProvider),geClient:null,templateVariableProvider:new z,config:{portalUrl:f.portalUrl,geoenrichmentUrl:null,geometryServiceUrl:f.geometryServiceUrl,
printMapTaskUrl:f.printMapTaskUrl,countryID:null,hierarchy:null,reportID:a.reportID,variables:null},customLogo:f.customLogo};d.populateCombinedAreasInfo(m.combinedAreasInfo,m.analysisAreas);g(a,m);l.setGeoenrichmentUrl(m.config.geoenrichmentUrl);m.config.geometryServiceUrl&&C.setGeometryServiceUrl(m.config.geometryServiceUrl);m.config.printMapTaskUrl&&w.setPrintMapTaskUrl(m.config.printMapTaskUrl);return c(m.attachmentsStore&&b.populateReportDataFromAttachmentsStore(m,m.attachmentsStore),function(){return m})})})}})})},
"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ReportDataProcessor":function(){define("esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred ./tasks/EnrichAreasTask ./tasks/RunReportTask ./AreaDataUtil ./AreaCalculatorsUtil ./CustomReportsManager ./VariablesUtil esri/dijit/geoenrichment/utils/DateUtil ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldLibrary ../../core/infographics/simpleInfographic/dataDrilling/EnrichUtil ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil ../../core/infographics/utils/InfographicJsonUtil".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q){return{populateReportDataFromAttachmentsStore:function(b,d){var c=[];d.setCurrentAnalysisAreaIndex&&d.setCurrentAnalysisAreaIndex(0);c.push(k(d.getNotes(),function(a){a&&a.length&&(b.fieldData.metadata[m.SITENOTE_FIELD_NAME]=a[0].text,b.fieldData.metadata[m.SITENOTES_FIELD_NAME]=a.map(function(a){return a.text}).join("\x3cbr/\x3e\x3cbr/\x3e"))}));c.push(k(d.getAttributes(),function(d){if(!d||!d.length)return null;var c={attributes:{}};d.forEach(function(a){c.attributes[a.name]=
a});b.analysisAreas.forEach(function(d,f){(d=b.fieldData.areaData[f])&&a.addFeatureAttributesCalculator(c,d)})}));return h(c)},runReportAndGetData:function(a){return k(f.getCustomReportByID(a),function(b){return(new c).execute({portalUrl:a.portalUrl,analysisAreas:a.analysisAreas,combinedAreasInfo:a.combinedAreasInfo,countryID:a.countryID,hierarchy:a.hierarchy,report:{reportID:b.reportID,portalUrl:b.templateData.getPortalUrl(!0),modified:b.modified,isMultiFeature:b.isMultiFeature},cacheResult:!0}).then(function(a){return{taskID:a.taskID,
selectedReport:b,areaData:a.areaData}},function(b){a.fieldData.errors.push(b);return(new e).reject(b)})})},runReportFromVariables:function(b){var c={};b.variables.fullNames.forEach(function(a){var b=p.createFieldNameFromVariable(a);c[a.substr(a.indexOf(".")+1)]=b});return(new g).enrichAreas({portalUrl:b.portalUrl,analysisAreas:b.analysisAreas,countryID:b.countryID,hierarchy:b.hierarchy,fields:d.convertForEnrich(b.variables),comparisonLevels:b.comparisonLevels||q.getDefaultLevels()}).then(function(d){var f=
b.analysisAreas.map(function(){return{}});a.addEnrichFeatures(d,c,p.DATA_COLLECTIONS_CALCULATOR_NAME,f);return{areaData:f}},function(a){b.fieldData.errors.push(a);return(new e).reject(a)})},applyRunReportAndGetDataResults:function(a,b){a&&a.areaData&&(b.fieldData.runReportTaskID=a.taskID,b.fieldData.areaData=a.areaData,b.analysisAreas&&this._reportDataFromAreas(b.analysisAreas,b.fieldData.areaData),a.selectedReport&&this._reportDataFromReport(a.selectedReport,b.fieldData,b.combinedAreasInfo))},_reportDataFromAreas:function(b,
d){b.forEach(function(b,c){if(c=d[c])a.addFeatureAttributesCalculator(b.feature,c),a.addAreaInfoCalculator(b,c)})},_reportDataFromReport:function(a,b,d){b=b.metadata;a&&!b.Title&&(b.Title=a.title);b.Source="Esri";b.Date=n.getReportFooterDate();b.Copyright="\u00a9"+n.getFullYear()+" Esri";b.ProductLabel="";b.ProductUrl="";b.PhoneNumber="";b.TrialUrlText="";a.isMultiFeature&&(b.SITE_NAME=d.locationName||d.name,b.STORE_NAME=d.locationName||d.name,b.AREA_DESC2=d.description||d.name,b.STORE_ADDR=d.address)},
enrichFieldData:function(d,c){function e(a,d,f){function e(a){return c.fieldData.areaData.every(function(d,e){return void 0!==b.getAreaDataValue({fieldName:a,fieldData:c.fieldData,calculatorName:f,featureIndex:e,ignoreMetadata:!0})})}f=f||p.ENRICHED_DATA_NO_LEVELS;var g=[],l={};a.forEach(function(a){e(a.fieldName)||(g.push(a.mapTo),l[a.mapTo]=a.fieldName,l[a.mapTo.substr(a.mapTo.indexOf(".")+1)]=a.fieldName)});return g.length?{fields:g,fieldsMap:l,comparisonLevels:d,calculatorName:f}:null}var m=[];
d=l.optimizeInfos(d);d.forEach(function(a){var b;if(a.isGeneral||a.isChart)b=e(a.fields,a.levels,a.calculatorName);b&&m.push(b)});if(m.length)return k(f.getCustomReportByID(c),function(b){function d(a){c.fieldData.errors.push(a)}return h(m.map(function(b){return(new g).enrichAreas({portalUrl:c.portalUrl,analysisAreas:c.analysisAreas,countryID:c.countryID,hierarchy:c.hierarchy,fields:b.fields,comparisonLevels:b.comparisonLevels}).then(function(d){a.addEnrichFeatures(d,b.fieldsMap,b.calculatorName,
c.fieldData.areaData)},d)}))})}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/EnrichAreasTask":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all esri/kernel esri/SpatialReference esri/tasks/FeatureSet ../GEUtil ../AnalysisAreaUtil ./parsers/FeatureSetParser ../../../core/supportClasses/map/Projector esri/dijit/geoenrichment/utils/CoordinateUtil".split(" "),function(k,h,e,g,c,b,a,f,d,n,m,l){function p(a){return(a=
a&&c.id.findCredential(a)||c.id.credentials[0])&&a.token}return k(null,{enrichAreas:function(a){var b={};return e(this._analysisAreasToStudyAreas(a.analysisAreas,a.countryID,a.comparisonLevels),function(d){b.studyAreas=d;a.report?b.analysisVariables=[{itemid:a.report.reportID,url:a.report.portalUrl,token:p(a.portalUrl),outFields:["*"]}]:a.fields&&(b.analysisVariables=a.fields);return this._doRunTask(b,a,"enrich")}.bind(this)).then(this._handleFeatureSetsRequest.bind(this))},createReport:function(a){var b=
{f:"bin",format:"xml",reportfields:{}};b.report={itemid:a.report.reportID,url:a.report.portalUrl,token:p(a.portalUrl)};return e(this._analysisAreasToStudyAreas(a.analysisAreas,a.countryID,null,null),function(d){b.studyAreas=d;return this._doRunTask(b,a,"createReport")}.bind(this))},_analysisAreasToStudyAreas:function(a,b,d,c){var f=this;d=d&&d.map(function(a){return{layer:a}});return g(a.map(function(a,c){var g;g=a.geographies&&a.geographies.length?f._studyAreaFromGeographies(a.geographies,b,!0):
{attributes:h.mixin({},a.feature.attributes),geometry:a.feature.geometry.toJson()};d&&(g.comparisonLevels=d);return e(f._getStorePointForArea(a),function(a){g.attributes=g.attributes||{};a&&(g.attributes.STORE_LAT=g.attributes.STORE_LAT||a.STORE_LAT,g.attributes.STORE_LONG=g.attributes.STORE_LONG||a.STORE_LONG);g.attributes&&n.ID_FIELDS.forEach(function(a){delete g.attributes[a]});return g})})).then(function(a){return f._groupStudyAreasByStores(a,c)})},_groupStudyAreasByStores:function(a,b){var d=
0,c={},f={};b&&b.groups&&b.groups.forEach(function(a,b){a.indexes.forEach(function(a){f[a]=b})});a.forEach(function(a,b){b=f[b];if("number"===typeof b){var e=c[b];"number"!==typeof e&&(e=c[b]=d++);a.attributes.STORE_ID=e+""}else a.attributes.STORE_ID=d++ +""});return a},_getStorePointForArea:function(a){if(a.location){var c=d.geometryToLatLong(a.location.geometry);return c?c:e(m.projectGeometries(a.location.geometry,new b(l.WGS_84_WKID)),function(a){return d.geometryToLatLong(a)})}},createFeatureForGeographies:function(a,
b){return this._createFeaturesForGeographies(a,b,!0).then(function(a){return a[0]})},createFeaturesForGeographies:function(a,b){return this._createFeaturesForGeographies(a,b,!1)},_createFeaturesForGeographies:function(a,d,c){a={returnGeometry:!0,outSR:d.outSR||new b(l.WEB_MERCATOR_WKID),studyAreas:c?[this._studyAreaFromGeographies(a,d.countryID,!0,d.generalizationLevel)]:a.map(function(a){return this._studyAreaFromGeographies([a],d.countryID,!1,d.generalizationLevel)},this),dataCollections:["GlobalIntersect"]};
return this._doRunTask(a,d,"enrich").then(this._handleFeatureSetsRequest.bind(this))},_studyAreaFromGeographies:function(a,b,d,c){var f={sourceCountry:b,layer:null,ids:null},e=null,g=[],l;a.forEach(function(a){if(!a||!a.id)throw Error("Wrong geography.");var b=a.levelId;if(b)if(!e)e=b;else if(d&&e!==b)throw Error("Geographies have different level IDs.");g.push(a.id);a.sourceCountry&&(f.sourceCountry=a.sourceCountry);a.hierarchy&&(f.hierarchy=a.hierarchy);a.attributes&&(l=h.mixin(l||{},a.attributes))});
f.layer=e;f.ids=d?[g.join(",")]:g;f.attributes=l;f.generalizationlevel=c;return f},createFeaturesForBuffer:function(a,d){d=d||{};var c={bufferUnits:a.units,bufferRadii:a.radii||[a.radius],areaType:a.areaType||"RingBuffer"};"NetworkServiceArea"===c.areaType&&(c.travelMode=a.travelMode,c.networkOptions=a.networkOptions);a=a.point||a.polyline;c={returnGeometry:!0,outSR:d.outSR||a.spatialReference||new b(l.WEB_MERCATOR_WKID),dataCollections:["GlobalIntersect"],studyAreasOptions:c,studyAreas:[{geometry:a.toJson?
a.toJson():a}]};return this._doRunTask(c,d,"enrich").then(this._handleFeatureSetsRequest.bind(this))},createFeaturesForBuffers:function(a,b){var d={},c=[];a.forEach(function(a){var b;b=a.point||a.polyline;b=JSON.stringify(b.toJson?b.toJson():b)+";"+a.units+";"+a.areaType+";"+a.travelMode+";"+JSON.stringify(a.networkOptions);var f=d[b];f||(f=d[b]=h.clone(a),delete f.radius,f.radii=[],c.push(f));a.radii?f.radii=f.radii.concat(a.radii):f.radii.push(a.radius)});return g(c.map(function(a){return this.createFeaturesForBuffer(a,
b)},this)).then(function(a){var b=[];a.forEach(function(a){b=b.concat(a)});return b})},_doRunTask:function(a,b,d){a=h.mixin({useData:{sourceCountry:b.countryID,hierarchy:b.hierarchy||"census"},forStorage:!1},a);return f[d](a)},_handleFeatureSetsRequest:function(b){return(new a(b[0])).features}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/FeatureSetParser":function(){define(["./AttrUtil"],function(k){var h={ID_FIELDS:["ID","AREA_ID","IDFNDFIELD"],KNOWN_ATTRIBUTES:{StdGeographyLevel:1,
StdGeographyName:1,StdGeographyID:1},parse:function(e,g,c){if(!e)return[];e=e.features||e;if(!e.length)return[];var b=[],a={},f=0;e.forEach(function(d){var e=d.attributes[h.ID_FIELDS[0]]||d.attributes[h.ID_FIELDS[1]];if(e){void 0===a[e]&&(a[e]=f++);var m={},l;for(l in d.attributes){var p=h.KNOWN_ATTRIBUTES[l]?l:c?c(l):l;p&&(m[p]=d.attributes[l])}k.cleanUpAttrs(m);d={name:g,attrs:m,areaIndex:a[e]}}else d=null;d&&(e=b[d.areaIndex]=b[d.areaIndex]||{},e[d.name]?e[d.name].comparisonLevels.push(d.attrs):
e[d.name]={data:d.attrs,comparisonLevels:[]})});console.log("FeatureSetPareser.js \x3d\x3e areaData:");console.log(b);return b}};return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/AttrUtil":function(){define([],function(){var k={},h="ID OBJECTID AREA_ID STORE_ID HasData aggregationMethod sourceCountry radiusIndex".split(" ");k.cleanUpAttrs=function(e){e&&h.forEach(function(g){delete e[g]})};return k})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/Projector":function(){define(["dojo/_base/declare",
"esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/utils/ProjectionUtil"],function(k,h,e,g,c){function b(a,b){return c.projectGeometries(a,b)}k=k(null,{_pendingInfos:null,_isBusy:!1,constructor:function(){this._pendingInfos=[]},addForProjection:function(a,b){if(this._isBusy)throw Error("Can't interrupt the current projection process.");a=a&&a.geometry||a;var d=new h;this._pendingInfos.push({geom:a,mapOrSR:b,dfd:d,index:this._pendingInfos.length});
return d.promise},project:function(){function a(a){var c=h[a];return e(b(c.geoms,c.mapOrSR),function(a){a.forEach(function(a,b){b=c.indexMap[b];l[b]=a;d[b].resolve(a)})})}var f=this;if(this._isBusy)throw Error("Can't interrupt the current projection process.");this._isBusy=!0;var d=[],h={};this._pendingInfos.forEach(function(a){d.push(a.dfd);var b=a.geom.type+";"+a.geom.spatialReference.wkid+";"+c.getSpatialReference(a.mapOrSR).wkid,b=h[b]=h[b]||{geoms:[],indexMap:{},mapOrSR:a.mapOrSR};b.geoms.push(a.geom);
b.indexMap[b.geoms.length-1]=a.index});this._pendingInfos.length=0;var m=[],l=[],p;for(p in h)m.push(a(p));return g(m).then(function(){f._isBusy=!1;return l})}});k.needProject=function(a,b){a=a&&a.geometry||a;return a.spatialReference&&a.spatialReference.wkid!==c.getSpatialReference(b).wkid};k.projectGeometries=b;return k})},"esri/dijit/geoenrichment/utils/ProjectionUtil":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/SpatialReference esri/geometry/jsonUtils esri/dijit/geoenrichment/utils/CoordinateUtil esri/dijit/geoenrichment/utils/PolygonUtil esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/requests/EveryRequest".split(" "),
function(k,h,e,g,c,b,a,f,d){function n(a){return a&&a.spatialReference||a instanceof e&&a||a&&new e(a)||new e(c.WEB_MERCATOR_WKID)}function m(a,b){var d=[];try{for(var f=0;f<a.length;f++)d.push(c.toSpatialReference(a[f],b))}catch(A){console.log(A)}return(new h).resolve(d)}function l(a,c){function f(a){m.push(function(){return p(h,a,l,c)})}var e=a[0],l=g.getJsonType(e),h={outSR:c.wkid||c.toJson(),inSR:e.spatialReference.wkid||e.spatialReference.toJson()},m=[],n=0,k=[];1==a.length?k.push(e):a.forEach(function(a){var d=
b.getNumberOfPoints(a);n+=d;if(1E4<n){var c=[];k.length?(c.push(a),n=d):(k.push(a),n=0);f(k);k=c}else k.push(a)});k.length&&f(k);return d(m,!0).then(function(a){for(var b=a[0],d=1;d<a.length;d++)b=b.concat(a[d]);return b},function(a){console.log(a);return[]})}function p(a,b,d,c){a.geometries=q(b);return f.requestPublicFirst({url:u,urlSuffix:"project"},{content:a}).then(function(a){return v(a.geometries,d,c)})}function q(a){var b=a.map(function(a){a=a.toJson();delete a.spatialReference;return a});
return{geometryType:g.getJsonType(a[0]),geometries:b}}function v(a,b,d){var c=g.getGeometryType(b),f={spatialReference:d.toJson()};return a.map(function(a){return new c(k.mixin(a,f))})}var r={},u;r.setGeometryServiceUrl=function(b){u=b;a.registerCORS(b)};r.getSpatialReference=n;r.projectGeometries=function(a,b){var d=n(b);b=Array.isArray(a)?a:[a];if(!b.length)return(new h).resolve(a);var f={},e=b.slice(),g=0;b=b.filter(function(a,b){if(a.spatialReference&&a.spatialReference.wkid!==d.wkid)return f[b]=
g++,!0});return b.length?(c.testSpatialReferenceWKID(d)&&c.testSpatialReferenceWKID(b[0].spatialReference)?m(b,d):l(b,d)).then(function(b){e.forEach(function(a,d){void 0!==f[d]&&(e[d]=b[f[d]])});b=e;return Array.isArray(a)?b:b[0]}):(new h).resolve(a)};r.unionGeometries=function(a){var b=n(a[0].spatialReference);a={sr:b.wkid||b.toJson(),geometries:q(a)};return f.requestPublicFirst({url:u,urlSuffix:"union"},{content:a}).then(function(a){return v([a.geometry],a.geometryType,b)[0]})};return r})},"esri/dijit/geoenrichment/utils/PolygonUtil":function(){define([],
function(){var k={getNumberOfPoints:function(h){if(!h)return 0;Array.isArray(h)||(h=[h]);var e=0;h.forEach(function(g){e+=k.getGeometryPointCount(g.geometry||g)});return e},getGeometryPointCount:function(h){if(!h)return 0;var e=0,g=h.rings||h.paths;!g&&h.points&&(g=[h.points]);g?g.forEach(function(c){e+=c&&c.length||0}):e+="x"in h?1:2;return e}};return k})},"esri/dijit/geoenrichment/utils/requests/EveryRequest":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],
function(k,h,e){var g=k(null,{requests:null,results:null,requestCount:0,chunkSize:0,stopOnError:!1,index:0,completeCount:0,executeCount:0,isExecuting:!1,dfd:null,constructor:function(c,b,a,f){this.requests=c;this.results=b;this.requestCount=this.requests.length;this.chunkSize=Number(a);if(isNaN(this.chunkSize)||0>=this.chunkSize)this.chunkSize=this.requestCount;this.stopOnError=!!f},execute:function(){this.isExecuting=!0;for(this.dfd=new h;this.tryStartNextRequest(););return this.dfd.promise},tryStartNextRequest:function(){if(!this.isExecuting)return!1;
if(this.index==this.requestCount&&!this.executeCount)return this.isExecuting=!1,this.dfd.resolve(this.results),!1;if(this.index==this.requestCount||this.executeCount==this.chunkSize)return!1;var c=this.requests[this.index++];this.executeCount++;var b=c.request;"function"===typeof b&&(b=b());var a=this,f=!0;e(b,function(b){a.processResult(b,c.key,b instanceof Error,f)},function(b){a.processResult(b,c.key,!0,f)});f=!1;return!0},processResult:function(c,b,a,f){if(this.isExecuting)if(a&&this.stopOnError)this.isExecuting=
!1,this.dfd.progress(1),this.dfd.reject(c);else if(this.results[b]=c,this.completeCount++,this.executeCount--,this.dfd.progress(this.completeCount/this.requestCount),!f)for(;this.tryStartNextRequest(););}});return function(c,b,a){void 0===a&&(a=10);var f=[],d;if(Array.isArray(c))d=[],c.forEach(function(a,b){f.push({key:b,request:a})});else for(var e in c)d={},f.push({key:e,request:c[e]});return(new g(f,d,a,b)).execute()}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/RunReportTask":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./parsers/DataXMLParser ./EnrichAreasTask ../AnalysisAreaJsonUtil esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/ReportPlayer/_devConfig".split(" "),
function(k,h,e,g,c,b,a,f,d){var n={_cache:{},_buildKey:function(b){return[b.countryID,b.hierarchy,JSON.stringify(a.areasToJson(b.analysisAreas,{excludeInfoTemplate:!0})),b.report.reportID,b.report.portalUrl,b.report.modified].join("_")},getCopy:function(a){a=this._buildKey(a);return(a=this._cache[a])&&h.clone(a)},copyAndPut:function(a,b){a=this._buildKey(a);this._cache[a]=b&&h.clone(b)},getResults:function(){var a=[],b;for(b in this._cache)a.push(this._cache[b]);return a}},m={execute:function(a){function h(){return(new b).createReport(a).then(function(b){var g=
b&&b.taskID;b=b&&b.result;try{d.emulateErrors.createReportError&&(b={error:{message:"Error test: something crashed on the server!"}});var h;b&&"object"===typeof b&&(h=b.error);if(!h&&"string"===typeof b&&-1!==b.indexOf("{"))try{var l=JSON.parse(b);h=l&&l.error}catch(w){}if(h)if(f.runReportTask.ignoreErrors)b=[];else return(new e).reject(h);var m={taskID:g,areaData:c.parse(b),originalXML:b,error:h};a.cacheResult&&!h&&n.copyAndPut(a,m);return m}catch(w){return(new e).reject(w)}})}var l=a.cacheResult&&
n.getCopy(a);return l?g(l):g(h(),function(a){return!a||a.error?f.runReportTask.secondAttempt?h():a:a},function(a){return f.runReportTask.secondAttempt?h():(new e).reject(a)})}};k=k(null,{execute:function(a){console.log("Creating a new report...");return m.execute(a)}});k.CreateReportResultCache=n;return k})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/DataXMLParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","../../AreaDataUtil","./AttrUtil",
"esri/dijit/geoenrichment/ReportPlayer/_devConfig"],function(k,h,e,g){var c={parseSchema:function(b){var a={};b.tags.forEach(function(b){"xs:element"===b.name&&b.attributes&&"ReportData"===b.attributes.name&&k.queryJson(b,"xs:element").filter(function(a){return!!a.tags}).forEach(function(b){var d=a[b.attributes.name]={};k.queryJson(b,"xs:element").forEach(function(a){d[a.attributes.name]="xs:string"===a.attributes.type?"string":"number"})})});return a}};return{parse:function(b,a){return this._parseDataXmlJson(k.parseXml(b,
{saveInnerHTML:!0}),a)},_parseDataXmlJson:function(b,a){function f(b){function f(b){if(b=function(b){var d={},c,f,h;b.tags.forEach(function(e){var m;m=e.innerHTML?e.innerHTML:e.tags&&e.tags.length&&e.tags[0].text||"";var n=m;"string"===l[b.name][e.name]?m=String(m):(m=Number(m),isNaN(m)&&(m=n),g.emulateErrors.createReportNaN&&(m=NaN));a&&(m=a(e.name,m));d[e.name]||(d[e.name]=m);"AREA_ID"===e.name&&(c=m);"IDFNDFIELD"===e.name&&(f=m);"STORE_ID"===e.name&&(h=m)});c=c||f;if(!c&&!h)return null;var k;!c&&
h&&(k=Number(h));c&&void 0===n[c]&&(n[c]=m++);e.cleanUpAttrs(d);return{name:b.name,attrs:d,areaIndex:void 0!==k?k:n[c]}}(b)){var c=d[b.areaIndex]=d[b.areaIndex]||{};c[b.name]?c[b.name].comparisonLevels.push(b.attrs):c[b.name]=h.createCalculator(b.attrs)}}var l;b.tags[0].tags.forEach(function(a){"xs:schema"===a.name?l=c.parseSchema(a):f(a)})}if(!b||!b.tags||2>b.tags.length)return[];var d=[],n={},m=0;b.tags.forEach(function(a){"ReportData"===a.name&&f(a)});console.log("DataXMLPareser.js \x3d\x3e areaData:");
console.log(d);return d}}})},"esri/dijit/geoenrichment/utils/JsonXmlConverter":function(){define(["dojo/_base/declare","./RegExpUtil"],function(k,h){function e(b,d,c,e){return f(c,e)+"\x3c"+b+(d?a(d):"")+"\x3e"+(e?"\n":"")}function g(a,b,d){return f(b,d)+"\x3c/"+a+"\x3e"+(d?"\n":"")}function c(b,d,c,e){return f(c,e)+"\x3c"+b+(d?a(d):"")+" /\x3e"+(e?"\n":"")}function b(a,b,d){a=h.encodeXML(a,!1);return f(b,d)+a+(d?"\n":"")}function a(a){var b="",d;for(d in a){var c=a[d];Array.isArray(c)&&(c=c.join(";"));
void 0===c||null===c||""===c||"number"===typeof c&&isNaN(c)||(b+=" "+d+'\x3d"'+h.encodeXML(c,!0)+'"')}return b}function f(a,b){if(!b)return"";b="";for(var d=0;d<a;d++)b+="     ";return b}var d=k(null,{parseJson:function(a,d){function f(a,d){a.text||"#text"===a.name?m+=b(a.text,d,h):a.name&&(a.tags&&a.tags.length?(m+=e(a.name,a.attributes,d,h),a.tags&&a.tags.forEach(function(a){f(a,d+1)}),m+=g(a.name,d,h)):m+=c(a.name,a.attributes,d,h))}var h=d&&d.prettify,m="";d&&d.addDocumentOptions&&(m+='\x3c?xml version\x3d"1.0" encoding\x3d"utf-8"?\x3e');
f(a,0);return m=decodeURIComponent(encodeURIComponent(m).replace("%19",""))},parseXml:function(a,b){function d(a,e){a.name=e.nodeName;b.saveInnerHTML&&(a.innerHTML=e.innerHTML);if(e.attributes&&e.attributes.length){a.attributes={};for(var g=0;g<e.attributes.length;g++){var l=e.attributes[g],m=l.value;if(!0===m||"true"===m)m=!0;else if(!1===m||"false"===m)m=!1;else if(c&&m){var n=Number(m);isNaN(n)||(m=n)}a.attributes[l.nodeName]=m}}if(e.childNodes&&e.childNodes.length)for(a.tags=[],g=0;g<e.childNodes.length;g++){if(m=
l=e.childNodes[g],"#text"!==m.nodeName||(f?m.nodeValue.trim():m.nodeValue))m={},a.tags.push(m),d(m,l)}else"#text"===e.nodeName&&(delete a.name,a.text=h.decodeXML(e.nodeValue))}b=b||{};var c=b.parseNumbers,f=b.ignoreWhiteSpacedTextNodes,f=void 0===f?!0:f,e={},g;a=(new DOMParser).parseFromString(a,"text/xml").childNodes;for(var m=0;m<a.length;m++)if(1===a[m].nodeType){g=a[m];break}g&&d(e,g);return e},queryJson:function(a,b,d){function c(a,e){a.tags&&a.tags.forEach(function(a){(b.test?b.test(a.name):
a.name===b)&&f.push(a);d&&0===e||c(a,e+1)})}var f=[];c(a,0);return f},traverseJson:function(a,b){function d(a){c||(!0===b(a)?c=!0:a.tags&&a.tags.forEach(d))}var c=!1;d(a)},getInnerHTML:function(a){return a.innerHTML?a.innerHTML.trim():this.parseJson(a).replace(/^<[^<]*>/,"").replace(/<\/[^<]*>$/,"").trim()},_IS_RICH_RE:/<.+>.*<\/.+>|<br\s*\/>|<\/br>/,_UNRICH_RE:/<.{1,3}>|<\/.{1,3}>|<br\s*\/>|<\/br>/g,isRichText:function(a){return(a=String(a))&&this._IS_RICH_RE.test(a)},unrichHTML:function(a){if(!a)return"";
a=h.decodeXML(String(a).trim()).replace(this._UNRICH_RE,"");0===a.indexOf("\x3c")&&-1!==a.indexOf("\x3e")&&(a="");return a}});k=d();k.runTest=function(){console.log("------------------------------Testing JsonXmlConverter.js (1)------------------------------");var a={name:"HTMLReport",attributes:{pagesize:"letter",orientation:"portrait",left:"15.75",label:"10 \x3c 5"},tags:[{name:"section",attributes:{type:"PageHeader"},tags:[{text:"Plain text 1 \x3cb\x3eBold Text\x3c/b\x3e"}]},{text:"Plain text 2"}]},
b=new d,a=JSON.parse(JSON.stringify(a)),c=b.parseJson(a),f=b.parseXml(c),b=b.parseJson(f);console.log("Compare JSON1 and JSON2: "+(JSON.stringify(a)===JSON.stringify(f)));console.log("Compare XML1 and XML2: "+(c===b));console.log("------------------------------Testing JsonXmlConverter.js (1)------------------------------");console.log("------------------------------Testing JsonXmlConverter.js (2)------------------------------");a={name:"DataCollection",attributes:{Title:"2016 Crime Indices",ScriptLanguage:"Python"},
tags:[{name:"Metadata",tags:[{name:"name",tags:[{text:"Crime"}]},{name:"shortDescription",tags:[{text:"Data Collection of Esri's Crime Index variables for the United States"}]},{name:"longDescription",tags:[{text:"This data collection includes Esri's Crime Index variables incorporating information from the AGS national CrimeRisk database that is based on an extensive analysis of several years of crime incidents reported by most US law enforcement jurisdictions. The Crime Indexes database includes standardized indexes for a range of serious crimes against both persons and property.  The data vintage is 2016A."}]},
{name:"keywords",tags:[{text:"Crime"}]},{name:"coverage",tags:[{text:"US"}]},{name:"author",tags:[{text:"Esri"}]},{name:"datasets"},{name:"countries",tags:[{name:"country",tags:[{text:"US"}]}]},{name:"categories"},{name:"filters",tags:[{name:"filter",attributes:{ID:"Year",Name:"Year",Type:"Enumeration",aliasname:"Year",enumValues:"2016"}},{name:"filter",attributes:{ID:"Source",Name:"Source",Type:"Enumeration",aliasname:"Source",enumValues:"Applied Geographic Solutions (AGS)"}}]}]},{name:"Parameters"},
{name:"Calculators",tags:[{name:"FeatureService",attributes:{Name:"Crime",url:"http://demographics5dev.arcgis.com/arcgis/rest/services/USA_Crime/MapServer/2"}},{name:"Fields",tags:[{name:"Field",attributes:{Name:"CRMCYTOTC",Alias:"2016 Total Crime Index",baseType:"NONE",MapTo:"CRMCYTOTC",summaryType:"AVG",weightField:"POP WEIGHT",FieldCategory:"2016 Crime Indices",Type:"Double",Decimals:"0",Units:"COUNT",Vintage:"2016"},tags:[{name:"Tag",attributes:{ID:"Year",Name:"Year",Value:"2016"}},{name:"Tag",
attributes:{ID:"Source",Name:"Source",Value:"Applied Geographic Solutions (AGS)"}}]}]}]}]};b=new d;a=JSON.parse(JSON.stringify(a));c=b.parseJson(a);f=b.parseXml(c);b=b.parseJson(f);console.log("Compare JSON1 and JSON2: "+(JSON.stringify(a)===JSON.stringify(f)));console.log("Compare XML1 and XML2: "+(c===b));console.log("------------------------------Testing JsonXmlConverter.js (2)------------------------------")};return k})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/AreaCalculatorsUtil":function(){define(["./AreaDataUtil",
"../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil","./tasks/parsers/FeatureSetParser"],function(k,h,e){return{addFeatureAttributesCalculator:function(e,c,b){for(var a in e.attributes)k.setAreaDataObjectValue(a,e.attributes[a],c,b||h.AREA_ATTRIBUTES_CALCULATOR_NAME)},addAreaInfoCalculator:function(e,c){k.setAreaDataObjectValue("SITE_NAME",e.locationName||e.name,c,h.AREA_ATTRIBUTES_CALCULATOR_NAME);k.setAreaDataObjectValue("STORE_NAME",e.locationName||e.name,c,h.AREA_ATTRIBUTES_CALCULATOR_NAME);
k.setAreaDataObjectValue("AREA_DESC",e.shortName||e.name,c,h.AREA_ATTRIBUTES_CALCULATOR_NAME);k.setAreaDataObjectValue("AREA_DESC2",e.description||e.name,c,h.AREA_ATTRIBUTES_CALCULATOR_NAME);k.setAreaDataObjectValue("AREA_DESC3",e.description||e.name,c,h.AREA_ATTRIBUTES_CALCULATOR_NAME);k.setAreaDataObjectValue("STORE_ADDR",e.address||"",c,h.AREA_ATTRIBUTES_CALCULATOR_NAME);k.setAreaDataObjectValue("STORE_LAT",e.latitude||"",c,h.AREA_ATTRIBUTES_CALCULATOR_NAME);k.setAreaDataObjectValue("STORE_LONG",
e.longitude||"",c,h.AREA_ATTRIBUTES_CALCULATOR_NAME)},addEnrichFeatures:function(g,c,b,a){var f={},d={},n;for(n in c)f[n.toLowerCase()]=c[n],d[n.toUpperCase()]=c[n];g=e.parse(g,b||h.ENRICHED_DATA_NO_LEVELS,function(a){return c[a]||f[a.toLowerCase()]||d[a.toUpperCase()]});k.mergeAreaData(g,a)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/CustomReportsManager":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./PortalManager ./ReportTemplateData ./StandardGraphicReportTemplates esri/dijit/geoenrichment/utils/PortalUtil esri/dijit/geoenrichment/utils/PortalQueryUtil esri/dijit/geoenrichment/utils/UrlUtil ../../config".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m){var l=k(null,{cache:null,constructor:function(){this.cache={}}});k={TEMPLATE_TYPE:"Report Template",PLAYER_STANDARD_INFOGRAPHIC_TYPEKEYWORD:"esriReportPlayerStandardInfographic",_reportsCache:null,resetCache:function(){this._reportsCache=new l},getCustomReports:function(a){var b=this,e=n.getPortalUrl(a.portalUrl);return g(c.getPortalInfo(e),function(c){var g=c.user.username,g={q:d.combineQueryString({type:"Report Template",typeKeywords:a.typeKeywords,owner:!a.publicOnly&&
g}),sortField:"modified",sortOrder:"desc"};return f.queryCommon(n.combine(e,"sharing/rest/search"),g).then(function(d){d=d.map(function(a){return b.prepareCustomReportFromItem(a,c.portal.url)});return b._getCountryReports(d,a.countryID)})})},_getCountryReports:function(a,b){return a&&a.filter(function(a){return!a.countries||a.countries.split(",").some(function(a){return b===a.trim()})})},prepareCustomReportFromItem:function(a,d){var c=h.mixin({},a.properties||a.details);c.isGraphicReport="true"===
c.isGraphicReport;c.isMultiFeature="true"===c.isMultiFeature;c.reportID=a.id;a={title:a.title,templateData:d&&new b(a,d),modified:a.modified instanceof Date?a.modified.getTime():a.modified};h.mixin(a,c);return a},getCustomReportByID:function(a){var b=this,d=this._reportsCache.cache[a.reportID];if(d)return d;d=n.getPortalUrl(a.portalUrl);return this._reportsCache.cache[a.reportID]=g(c.getPortalInfo(d),function(d){return d.user.getItem(a.reportID).then(function(a){return a&&b.prepareCustomReportFromItem(a,
d.portal.url)})}).otherwise(function(d){delete b._reportsCache.cache[a.reportID];return a.ignoreError?null:(new e).reject(d)})},tryFindReportIdByAlias:function(b){var d=this,c=a.aliasToID(b.countryID,b.reportID);if(!c)return null;var f=n.getPortalUrl(b.portalUrl);return g(this.getCustomReportByID({reportID:c,portalUrl:f,ignoreError:!0}),function(a){return a?a.reportID:g(d.getCustomReports({portalUrl:f,countryID:b.countryID,typeKeywords:"esriReportPlayerStandardInfographic",publicOnly:!0},!0),function(a){function d(a){a=
a.split(".");return Number((Number(a[0])+Number(a[1])/100).toFixed(2))}var c=d(m.jsapiVersion),f,e,g=-Infinity,h=Infinity;a.forEach(function(a){if(a.playerAlias===b.reportID){var l=d(a.jsapiVersion);c>=l&&l>g&&(g=l,f=a);c<l&&l<h&&(h=l,e=a)}});return f&&f.reportID||e&&e.reportID})})},itemUpdated:function(a){delete this._reportsCache.cache[a]},getFakeCustomReportByContext:function(a){return{title:"Generic template",type:"esriReportTemplateStandard",coverage:a.countryID,countries:a.countryID,hierarchy:a.hierarchy||
"census",isGraphicReport:!0,isMultiFeature:!1,reportID:null}}};k.resetCache();return k})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/PortalManager":function(){define(["esri/dijit/geoenrichment/when","esri/arcgis/Portal"],function(k,h){var e={_cache:{},getPortalInfo:function(g){if(!e._cache[g]){var c=new h.Portal(g);e._cache[g]=k(c.signIn(),function(b){return{user:b,portal:c}})}return e._cache[g]}};return e})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ReportTemplateData":function(){define("dojo/_base/declare dojo/_base/lang dojo/request/xhr esri/dijit/geoenrichment/promise/all esri/kernel esri/request esri/urlUtils esri/dijit/geoenrichment/utils/DataUtil esri/dijit/geoenrichment/utils/PortalUtil esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/utils/requests/FileContent esri/dijit/geoenrichment/utils/requests/UniversalClient".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l){function p(b,d){var c=b.substr(b.lastIndexOf("/")+1),g=a.getProxyRule(b);return e(g&&g.proxyUrl?g.proxyUrl+"?"+b:b,{method:"POST",handleAs:"arraybuffer",data:"token\x3d"+d,headers:{"X-Requested-With":null,"Content-Type":"application/x-www-form-urlencoded; charset\x3dutf-8"}}).then(function(a){var b=!/\.xml$|\.txt$|\.json$/i.test(c);return{name:c,data:b?f.base64FromByteSource(a):decodeURIComponent(escape(f.binaryStringFromByteSource(a)))}})}k=k(null,{id:null,_portalUrl:null,
_baseUrl:null,constructor:function(a,b){this.id=a.id;this._portalUrl=b;this._baseUrl=n.combine(this._portalUrl,"sharing/rest")},getFiles:function(){var a=this;return this._getResources().then(function(b){var d=[];b.map(function(b){b=b.resource;"thumbnail.png"!==b&&d.push(a.getFileByName(b))});return g(d)})},getFileByName:function(a){a=this._baseUrl+"/"+this._contentItemPath(this.id+"/resources/"+a);return p(a,this._getToken())},updateFile:function(a,b){var d=this;return l.request({url:this._baseUrl,
urlSuffix:"content/items/"+this.id}).then(function(c){var f=m.fromFileData(a,b);return l.request({url:d._baseUrl,urlSuffix:"content/users/"+c.owner+"/"+c.ownerFolder+"/items/"+d.id+"/updateResources"},{content:{file:f,filename:a}})})},_contentItemPath:function(a){return"content/items/"+a},_getToken:function(){var a=c.id.findCredential(this._portalUrl)||c.id.credentials[0];return a&&a.token},_getResources:function(){var a=this;return d.query(function(d){return b({url:a._baseUrl+"/"+a._contentItemPath(a.id+
"/resources"),content:h.mixin({f:"json",token:a._getToken()},d),handleAs:"json"},{usePost:!0})},null,"resources").then(function(a){return a.resources})},getPortalUrl:function(a){return a?/[^:]+:\/\/(.+)$/i.exec(this._portalUrl)[1]:this._portalUrl}});k.loadResource=p;return k})},"esri/dijit/geoenrichment/utils/PortalUtil":function(){define(["dojo/_base/lang","esri/kernel","esri/request","./requests/EveryRequest"],function(k,h,e,g){var c={query:function(b,a,c,d){a=a||{};c=c||"results";d=d||100;var f=
"number"===typeof a.num?a.num:-1,e=a.num=0>f||a.num>d?d:a.num;a.start=a.start||1;return b(a).then(function(d){var h=d[c],l=d.total-a.start+1;0<=f&&l>f&&(l=f);l-=e;if(0>=l)return d;a.num=e;for(var m=[];0<l;)a.start+=e,m.push(b.bind(null,k.mixin({},a))),l-=e;return g(m,!0).then(function(a){a.forEach(function(a){Array.prototype.push.apply(h,a[c])});return d})})},queryCommon:function(b,a){return c.query(function(c){var d=h.id.findCredential(b)||h.id.credentials[0];return e({url:b,content:k.mixin({f:"json",
token:d.token},a,c),handleAs:"json"},{usePost:!0})}).then(function(a){return a.results})}};return c})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/StandardGraphicReportTemplates":function(){define(["dojo/i18n!esri/nls/jsapi"],function(k){k=k.geoenrichment.dijit.ReportPlayer.StandardTemplates;var h={US:{"demographic-summary":"368e2bf603fb42c4aa3dac0fce50cdf8","key-facts":"a32be4a9e51d4affa4cc1ddc812cb629","marketing-profile":"df985e2579004a3292c3d00615d53c39","at-risk-population":"8c56287427f84ae8b59142fc5bf1df4c",
"portrait-property-flyer":"d95e40c3c93d480ab4d1d0b0adbbc5d4",skyscraper:"f989f9b820cd44d390187402447051b4","transportation-to-work":"0d322ac073584079a8cd6a1bda981fe7","health-care":"2b9f186425844ec390584b739ffca026","executive-summary-call-outs":"3e9ccce6cca64e70be19ed789de5f290","tapestry-profile":"2a812da4de404ceba3969472d32c42e7","nearby-restaurants":"2cc25f7b5f194012b39c90b5f9bdb8d3","multi-area-comparison":"72d1e9e4cdf94bf9a2020f8214bef9ca","property-details":"27034d31ab124b9bbe4e63b7df2a0d90",
"employment-overview":"4a59e329df06480eaa534513eb15f465","office-market-profile":"d4fe343c4d6f4bea840a715f5b033d2d","health-care-and-insurance":"cb2224cc9cb24ce288da729f0650ebf0","demographic-profile":"484825ed241c49d58eaf718d46772051","commute-profile":"afee0a2eb16e46cc9bc61b5d82133249","target-market-summary":"1d32fabd95b446e99049aa0a04f5508e","population-trends":""},CA:{"key-facts":"73f1c835b1624ff0b29a6a364f7ba6dc","multi-area-comparison":"84b05aed2d2f478eb6bb1e4749811cf1"},NL:{"housing-profile":"3d8cb941742d4fffbaca48c65b4bd5b5",
"insurance-profile":"f126395e7bcc494899cfc1a13a34be1f","media-profile":"8da901e5729e457683f2e4f7081b1bda","personicx-segmentation":"f9ba90b373a245e1b8fd14a027cf1ba5","spending-profile":"81fc53b93a0c4269848ce2ae22ec19e2"},all:{"key-facts":"5645a1d6023c4d8a9d02943ad57a7ab2 ","multi-area-comparison":"e29f56b6d67447e08a45d08981db987c"}},e={"demographic-summary":k.demographicSummary,"key-facts":k.keyFacts,"marketing-profile":k.marketingProfile,"at-risk-population":k.atRiskPopulation,"portrait-property-flyer":k.portraitPropertyFlyer,
skyscraper:k.skyscraper,"transportation-to-work":k.transportationToWork,"health-care":k.healthCare,"executive-summary-call-outs":k.executiveSummaryCallOuts,"tapestry-profile":k.tapestryProfile,"nearby-restaurants":k.nearbyRestaurants,"multi-area-comparison":k.multiAreaComparison,"property-details":k.propertyDetails,"employment-overview":k.employmentOverview,"office-market-profile":k.officeMarketProfile,"health-care-and-insurance":k.healthCareAndInsuranceStatistics,"demographic-profile":k.demographicProfile,
"commute-profile":k.commuteProfile,"target-market-summary":k.targetMarketSummary,"population-trends":k.populationTrends,"housing-profile":k.housingProfile,"insurance-profile":k.insuranceProfile,"media-profile":k.mediaProfile,"personicx-segmentation":k.personicxSegmentation,"spending-profile":k.spendingProfile},g={portalUrl:"http://www.arcgis.com",user:"esri_reports",query:"http://www.arcgis.com/home/search.html?q\x3downer%3Aesri_reports",aliasToID:function(c,b){return(h[c]||h.all)[b]},aliasToLabel:function(c){return e[c]},
getAliases:function(c){c=Object.keys(h[c]||h.all);c.sort(function(b,a){return b.localeCompare(a)});return c},getListOptions:function(c){return g.getAliases(c).map(function(b){return{value:g.aliasToID(c,b),label:e[b]}})},getSupportedCountries:function(){return Object.keys(h).filter(function(c){return"all"!==c})}};return g})},"esri/dijit/geoenrichment/utils/PortalQueryUtil":function(){define([],function(){var k={combineQueryString:function(h){var e="";h.type&&(e+='type:"'+h.type+'"');h.typeKeywords?
e=Array.isArray(h.typeKeywords[0])?e+(" typekeywords:("+h.typeKeywords.map(function(e){return k.combineTypeKeywords(e)}).join(" OR ")+")"):e+(" typekeywords:"+k.combineTypeKeywords(h.typeKeywords,h.typeKeywordsNot)):h.typeKeywordsNot&&(e+=" typekeywords:"+k.combineTypeKeywords(null,h.typeKeywordsNot));h.owner&&(e+=" owner:"+h.owner);h.isShared&&(e+=' (access:"shared" OR access:"org")');h.ownerNot&&(e+=" NOT owner:"+h.ownerNot);return e},combineTypeKeywords:function(h,e){h=h?k._combineArray(h):"";
return e?(e=k._combineArray(e),"("+h+" NOT "+e+")"):h},_combineArray:function(h){return"string"===typeof h?"("===h.charAt(0)||'"'===h.charAt(0)?h:'"'+h+'"':1===h.length?'"'+h[0]+'"':"("+h.map(function(e){return'"'+e+'"'}).join(" ")+")"}};return k})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/VariablesUtil":function(){define(["./dataCollections/DataCollectionsLoader"],function(k){var h={preprocessVariables:function(e,g){var c=h.convertForEnrich(h._splitVariables(e)).filter(function(b){return b.itemid});
return k.loadCustomDataVariables(c,{forceLowerCase:!0,portalUrl:g}).then(function(b){return h._splitVariables(e,b)})},_splitVariables:function(e,g){var c=[],b={};e.forEach(function(a){"string"===typeof a?c.push(a.toLowerCase()):a&&a.outFields&&a.outFields.forEach(function(f,d){d=a.itemid+"."+f;d=d.toLowerCase();c.push(d);b[d]={itemid:a.itemid,url:a.url,token:a.token,variable:g?g.fullNameToVariableCache[d]:{id:f}}})});return{fullNames:c,customDataMapping:b}},convertForEnrich:function(e){var g={},c=
[];e.fullNames.forEach(function(b){var a=e.customDataMapping[b];a?(b=g[a.itemid],b||(b={itemid:a.itemid,url:a.url,token:a.token,outFields:[]},b.url||delete b.url,b.token||delete b.token),b.outFields.push(a.variable.id),g[b.itemid]||(g[b.itemid]=b,c.push(b))):c.push(b)});return c}};return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/dataCollections/DataCollectionsLoader":function(){define(["esri/dijit/geoenrichment/promise/all","../GEUtil","../ReportTemplateData","esri/dijit/geoenrichment/utils/JsonXmlConverter",
"esri/dijit/geoenrichment/utils/UrlUtil"],function(k,h,e,g,c){return{_cache:{},canLoad:function(){return h.canMakeRequests()},loadVariables:function(b){var a="*"===b.outFields,c=a?["*"]:b.outFields,d=b.countryID+";"+b.hierarchy+";"+c.join(";")+";"+!!b.forceLowerCase;this._cache[d]||(a||(c=c.slice(),-1===c.indexOf("id")&&c.push("id")),this._cache[d]=h.getDataCollections(b.countryID,b.hierarchy,{f:"json",outFields:a?"*":JSON.stringify(c),suppressNullValues:!0,AddDerivativeVariables:"all"}).then(function(d){var f=
{dataCollections:d,idToVariableCache:{},fullNameToVariableCache:{}};d.forEach(function(d){d.data.forEach(function(e){function g(a){return b.forceLowerCase?a.toLowerCase():a}function h(b){if(a)return Object.keys(b).length;var d=0;c.forEach(function(a){void 0!==b[a]&&d++});return d}var l=f.idToVariableCache[g(e.id)];if(!l||h(e)>h(l))f.idToVariableCache[g(e.id)]=e;f.fullNameToVariableCache[g(d.dataCollectionID+"."+e.id)]=e})});return f}));return this._cache[d]},loadCustomDataVariables:function(b,a){a=
a||{};var f={idToVariableCache:{},fullNameToVariableCache:{}};return k(b.map(function(b){var d=c.combineMulti([b.url||a.portalUrl,"sharing/rest/content/items",b.itemid,"resources/metadata.xml"]);return e.loadResource(d,b.token||c.getToken(a.portalUrl)).then(function(d){d=g.parseXml(d.data);g.queryJson(d,"Field").forEach(function(d){function c(b){return a.forceLowerCase?b.toLowerCase():b}d=d.attributes;d={id:d.Name,fullName:b.itemid+"."+d.Name,alias:d.Alias,description:d.Alias,type:"esriFieldType"+
d.Type,precision:d.Precision?Number(d.Precision):void 0,vintage:d.Vintage};f.idToVariableCache[c(d.id)]=d;f.fullNameToVariableCache[c(d.fullName)]=d})})})).then(function(){return f})}}})},"esri/dijit/geoenrichment/utils/DateUtil":function(){define(["dojo/date/locale","esri/moment","./ObjectUtil"],function(k,h,e){var g={formatDate:function(c,b){return(c=e.objectToDate(c))?k.format(c,b):""},formatMoment:function(c,b){return(c=e.objectToTime(c))?h(c).format(b):""},formatDateShort:function(c){return g.formatMoment(c,
"L")},formatDateTimeShort:function(c){return g.formatMoment(c,"L LT")},formatLiveTime:function(c){var b=g.formatMoment(c,"l, LT").replace(/\d\d\d\d/,function(a){return a.substr(2)});return b?b+" "+g.formatDate(c,{datePattern:"ZZZZ",selector:"date"}):""},formatTypicalTime:function(c){return g.formatMoment(c,"ddd LT")},parseDateShort:function(c){return(c=+h(c,"L"))?new Date(c):null},getReportFooterDate:function(c){return k.format(c||new Date,{datePattern:"MMMM d, yyyy",selector:"date"})},getFullYear:function(){return(new Date).getFullYear()}};
return g})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldLibrary":function(){define(["dojo/i18n!esri/nls/jsapi"],function(k){k=k.geoenrichment.dijit.ReportPlayer.FieldInfoPreview;k={SPECIAL_HEADER_FIELDS_NAME_MAP:{SITE_NAME:"SiteName",STORE_ADDR:"SiteAddr",AREA_DESC2:"SiteDesc",STORE_LAT:"Latitude",STORE_LONG:"Longitude",AREA_ID:"AreaID",AREA_DESC:"AreaDesc",STORE_ID:"StoreID",RING:"Ring",STORE_NAME:"StoreName",GROUPCOUNT:"SummaryCount",SITENOTE:"SiteNote",
SITENOTES:"SiteNotes"},REPORT_VAR_FIELDS_MAP:{REPORTNAME:"Title",REPORTTITLE2:"Subtitle",CURRPAGE:"Page",COPYRIGHT:"Copyright",TRIALURLTEXT:"TrialUrlText",PHONENUMBER:"PhoneNumber",PRODUCTURL:"ProductUrl",PRODUCTLABEL:"ProductLabel",SOURCE:"Source",CENSUSYEAR:"CensusYear",CURRENTYEAR:"CurrentYear",FUTUREYEAR:"FutureYear",LATITUDELABEL:"LatitudeLabel",LONGITUDELABEL:"LongitudeLabel",PAGEFORMAT:"PageFormat",BANDFROM0TO1UNIT2:"BandFrom0To1Unit2",RADIUS0UNIT1:"Radius0Unit1",AREADELIMITER:"AreaDelimiter",
BANDREGIONFROM0TO1:"BandRegionFrom0To1",ET_AL:"ET_AL",LINEBUFFERSEGMENTFROM0TO1UNIT2RADIUS:"LineBufferSegmentFrom0To1Unit2Radius",LINEBUFFERRADIUS0UNIT1RADIUS:"LineBufferRadius0Unit1Radius",RINGVALUE0UNIT1RADIUS:"RingValue0Unit1Radius",RINGSVALUES0UNIT1RADII:"RingsValues0Unit1Radii",RINGBUFFERBANDFROM0TO1UNIT2RADIUS:"RingBufferBandFrom0To1Unit2Radius",DRIVETIMEBANDFROM0TO1UNIT2RADIUS:"DriveTimeBandFrom0To1Unit2Radius",RINGBUFFERBANDSBANDS0UNIT1RADII:"RingBufferBandsBands0Unit1Radii",RINGBUFFERBANDRING0UNIT1RADIUS:"RingBufferBandRing0Unit1Radius",
DRIVETIMEBANDBAND0UNIT1RADIUS:"DriveTimeBandBand0Unit1Radius",DRIVETIMESRINGS0UNIT1RADII:"DriveTimesRings0Unit1Radii",DRIVETIMERING0UNIT1RADIUS:"DriveTimeRing0Unit1Radius",DRIVEDISTANCEVALUE0UNIT1RADIUS:"DriveDistanceValue0Unit1Radius",DRIVEDISTANCESRINGS0UNIT1RADII:"DriveDistancesRings0Unit1Radii",DRIVEDISTANCERING0UNIT1RADIUS:"DriveDistanceRing0Unit1Radius"},SPECIAL_HEADER_FIELDS_NAME_MAP_BACK:{},REPORT_VAR_FIELDS_MAP_BACK:{},PREVIEW:{Title:k.fieldPreviewTitle,Title_graphic:k.fieldPreviewTitleGraphic,
Subtitle:k.fieldPreviewSubtitle,Date:k.fieldPreviewDate,Page:k.fieldPreviewPage,Count:k.fieldPreviewLocationsCount,Copyright:k.fieldPreviewCopyright,TrialUrlText:k.fieldPreviewTrialUrlText,PhoneNumber:k.fieldPreviewPhoneNumber,ProductUrl:k.fieldPreviewProductUrl,ProductLabel:k.fieldPreviewProductLabel,Source:k.fieldPreviewSource,"headers.SITE_NAME":k.fieldPreviewSiteName,"headers.SITE_NAME_multi":k.fieldPreviewSiteNameMulti,"headers.STORE_LAT":k.fieldPreviewLat,"headers.STORE_LONG":k.fieldPreviewLong,
"headers.AREA_DESC2":k.fieldPreviewAreaDesc2,"headers.STORE_ADDR":k.fieldPreviewStoreAddr,"headers.AREA_DESC":k.fieldPreviewAreaDesc,SiteNote:k.fieldPreviewSiteNote,SiteNotes:k.fieldPreviewSiteNotes},DATE_FIELD_NAME:"Date",DATE_FIELD_ALIAS:"Date",DATE_FIELD_DEFAULT_FORMAT:"d-MMMM dd, yyyy",SITENOTE_FIELD_NAME:"SiteNote",SITENOTE_FIELD_ALIAS:"SiteNote",SITENOTES_FIELD_NAME:"SiteNotes",SITENOTES_FIELD_ALIAS:"SiteNotes",GROUPCOUNT_FIELD_NAME:"SummaryCount",GROUPCOUNT_FIELD_ALIAS:"SummaryCount",init:function(){for(var h in this.SPECIAL_HEADER_FIELDS_NAME_MAP)this.SPECIAL_HEADER_FIELDS_NAME_MAP_BACK[this.SPECIAL_HEADER_FIELDS_NAME_MAP[h].toUpperCase()]=
h;for(h in this.REPORT_VAR_FIELDS_MAP)this.REPORT_VAR_FIELDS_MAP_BACK[this.REPORT_VAR_FIELDS_MAP[h].toUpperCase()]=h},templateToUIHeader:function(h){if(!h)return null;0===h.indexOf("headers.")&&(h=h.substr(h.indexOf(".")+1));return this.SPECIAL_HEADER_FIELDS_NAME_MAP[h]},qualifyTemplateHeaderName:function(h){return h&&0!==h.indexOf("headers.")?"headers."+h.toUpperCase():h},templateToUIReportVar:function(h){return this.REPORT_VAR_FIELDS_MAP[h]},uiToTemplate:function(h){return this.SPECIAL_HEADER_FIELDS_NAME_MAP_BACK[h]||
this.REPORT_VAR_FIELDS_MAP_BACK[h]},getPreview:function(h,e,g){e&&"Title"===h&&(h+="_graphic");g&&"headers.SITE_NAME"===h&&(h+="_multi");return this.PREVIEW[h]},hasField:function(h){return!!this.PREVIEW[h]}};k.init();return k})},"esri/dijit/geoenrichment/ReportPlayer/core/infographics/simpleInfographic/dataDrilling/EnrichUtil":function(){define(["../../../supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil","../../utils/InfographicJsonUtil"],function(k,h){var e={processChartJson:function(c,
b){var a=[];c.seriesItems.forEach(function(d){d.points.forEach(function(d){a.push({fieldName:d.fieldInfo.name,mapTo:b?b(d.fieldInfo.fullName):d.fieldInfo.fullName})})});var f=c.comparisonInfo;return this._createChartInfo(a,f&&f.levels,e.buildCalculatorNameForChart(c))},_createChartInfo:function(c,b,a){c=c||[];var f={isChart:!0,fields:[],levels:b,calculatorName:a,_cache:{}};c.forEach(function(a){e._addField(f,a)});return f},buildCalculatorNameForChart:function(c){if((c=c.comparisonInfo)&&c.calculatorName)return c.calculatorName;
var b=c&&c.levels&&c.levels.length?c.levels.join("_"):null;b&&(c.calculatorName=b);return b},processEsriInfographic:function(c){return{isInfographic:!0,type:c.type,variables:c.variables&&c.variables.slice(),fieldInfos:c.fieldInfos&&c.fieldInfos,levels:h.getLevels(c)}},optimizeInfos:function(c){var b=[],a=[],f=[];c.forEach(function(d){d.isGeneral?b.push(d):d.isChart?a.push(d):d.isInfographic&&f.push(d)});var d=e._createGeneralInfo();b.forEach(function(a){a.fields.forEach(function(a){e._addField(d,
a)})});var g={};a.forEach(function(a){if(a.calculatorName){var b=g[a.calculatorName]=g[a.calculatorName]||a;b!==a&&a.fields.forEach(function(a){e._addField(b,a)})}else a.fields.forEach(function(a){e._addField(d,a)})});var h={};f.forEach(function(a){var b=(a.fieldInfos&&a.fieldInfos.map(function(a){return a.fullName}).join("_")||a.variables.join("_"))+"_"+a.levels.join("_");h[b]=a});c=[];d.fields.length&&c.push(d);for(var l in g)c.push(g[l]);for(l in h)c.push(h[l]);return c},_createGeneralInfo:function(c){c=
c||[];var b={isGeneral:!0,fields:[],_cache:{}};c.forEach(function(a){e._addField(b,a)});return b},_addField:function(c,b){b&&b.fieldName&&!c._cache[b.fieldName]&&(c._cache[b.fieldName]=!0,c.fields.push(b))}},g={ddLibrary:null,_getStandardEnrichInfos:function(c,b,a){var f=[];c=g.ddLibrary.getDrillingOptions(c,b,a);if(!c)return f;c.forEach(function(a){f=f.concat(g._getStandardEnrichInfosForTableInfo(a,!1))});return f},_getStandardEnrichInfosForTableInfo:function(c,b){var a=[],f;for(f in c.stateData){var d=
c.stateData[f];d.fieldInfo.isChart?a.push(e.processChartJson(d.fieldInfo.chartJson,function(a){var b="n"===f?"":"_"+f.toUpperCase();return a+b})):!b&&d.fieldInfo.isInfographic&&(d.fieldInfo.infographicJson.variables||d.fieldInfo.infographicJson.fieldInfos)&&a.push(e.processEsriInfographic(d.fieldInfo.infographicJson))}return a},_getCustomEnrichInfos:function(c){var b=[];k.processSectionFieldInfos(c,function(a){a.isInfographic&&(a.infographicJson.variables||a.infographicJson.fieldInfos)&&b.push(e.processEsriInfographic(a.infographicJson))});
return b},getEnrichInfosForTemplateJson:function(c,b){var a=[];k.processTemplateFieldInfos(b,function(b){b.isInfographic&&b.infographicJson.variableTables&&b.infographicJson.variableTables.forEach(function(d,f){d.variable&&d.variable.fieldInfo&&(f=h.getDataDrilling(b.infographicJson,f))&&(f.sectionJson?a=a.concat(g._getCustomEnrichInfos(f.sectionJson)):f.isStandard&&(a=a.concat(g._getStandardEnrichInfos(c,f.standardId||d.variable.fieldInfo))))})});return e.optimizeInfos(a)}};g.buildCalculatorNameForChart=
e.buildCalculatorNameForChart;g.optimizeInfos=e.optimizeInfos;return g})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil":function(){define(["./_SectionJsonCollector","../../../infographics/InfographicTypes"],function(k,h){var e={},g={process:function(c,b,a,f,d){var e=f;f=function(a,b,d){a&&e.apply(this,arguments)};d={processLevel:b,objJson:a,processFunc:f,ignoreComparisonCalculators:d&&d.ignoreComparisonCalculators};c!==b||"field"===c&&"field"===
b?"document"===c?g._processTemplateJson(a,d):"section"===c?g._processSectionJson(a,d):"table"===c?g._processTableJson(a,d,null):"tableRow"===c?g._processTableDataObj(a,d,null):"field"===c&&g._processFieldInfo(a,d,null):f(a)},_processTemplateJson:function(c,b){c.sectionsTables?c.sectionsTables.forEach(function(a){g._processTableJson(a,b)}):k.collectSectionJsons(c,{saveParentInfo:!1,processFieldInfoFunc:function(a){"field"===b.processLevel&&b.processFunc(a)}}).forEach(function(a){g._processSectionJson(a,
b)})},_processSectionJson:function(c,b){"section"===b.processLevel?b.processFunc(c):c.stack&&c.stack.forEach(function(a){"sectionElement"===b.processLevel&&b.processFunc(a);"table"===a.id&&("table"===b.processLevel?b.processFunc(a):g._processTableJson(a,b))})},_processTableJson:function(c,b,a){c.data.data.forEach(function(c){"tableRow"===b.processLevel&&b.processFunc(c,a);g._processTableDataObj(c,b,a)});c.backgroundSectionJson&&g._processSectionJson(c.backgroundSectionJson,b);c.foregroundSectionJson&&
g._processSectionJson(c.foregroundSectionJson,b);c.backgroundFloatingTablesSectionJson&&g._processSectionJson(c.backgroundFloatingTablesSectionJson,b);c.foregroundFloatingTablesSectionJson&&g._processSectionJson(c.foregroundFloatingTablesSectionJson,b)},_processTableDataObj:function(c,b,a){if(c.fieldInfos)for(var f in c.fieldInfos)g._processFieldInfo(c.fieldInfos[f],b,a)},_processFieldInfo:function(c,b,a){function f(a,c){"field"===b.processLevel&&b.processFunc(a,c)}c&&(f(c,a),c&&c.triggerJson&&c.triggerJson.fieldInfo&&
c.templateName!==c.triggerJson.fieldInfo.templateName&&f(c.triggerJson.fieldInfo,c),c.linkFieldInfo&&f(c.linkFieldInfo,c),c.isInfographic&&g._processInfographicFieldInfo(c,b),c.isRichText&&(c.richTextJson.fieldInfos.forEach(function(a){g._processFieldInfo(a,b,c)}),c.richTextJson.specialFieldInfos.forEach(function(a){g._processFieldInfo(a,b,c)})),c.isChart&&(a=c.chartJson.visualProperties,a.chartIcons&&a.chartIcons.forEach(function(a){g._processFieldInfo(a,b,c)}),a.floatingIcons&&a.floatingIcons.forEach(function(a){g._processTableJson(a,
b,c)}),a.floatingTexts&&a.floatingTexts.forEach(function(a){g._processTableJson(a,b,c)}),c.chartJson.seriesItems.forEach(function(a){a.points.forEach(function(a){b.ignoreComparisonCalculators&&c.chartJson.comparisonInfo||g._processFieldInfo(a.fieldInfo,b,c);a.iconFieldInfo&&g._processFieldInfo(a.iconFieldInfo,b,c);a.captionFieldInfo&&g._processFieldInfo(a.captionFieldInfo,b,c)})})),c.isReportSection&&c.sectionJson&&g._processSectionJson(c.sectionJson,b))},_processInfographicFieldInfo:function(c,b){var a=
c.infographicJson;switch(a.type){case h.STATIC:a.header&&g._processTableJson(a.header,b,c);a.variableTables&&a.variableTables.forEach(function(a){a.variable&&g._processFieldInfo(a.variable.fieldInfo,b,c);a.description&&a.description.fieldInfo&&g._processFieldInfo(a.description.fieldInfo,b,c)});if(a.dataDrilling)for(var f in a.dataDrilling){var d=a.dataDrilling[f];d&&d.sectionJson&&g._processSectionJson(d.sectionJson,b)}break;case h.AGE_PYRAMID:case h.TAPESTRY:case h.PRIZM5:case h.RELATED_VARS:case h.ONE_VAR:!b.ignoreComparisonCalculators&&
a.fieldInfos&&a.fieldInfos.forEach(function(a){g._processFieldInfo(a,b,c)});break;case h.AREA_DETAILS:a.titleSectionJson&&g._processSectionJson(a.titleSectionJson,b,c);a.attributesSectionJson&&g._processSectionJson(a.attributesSectionJson,b,c);a.notesSectionJson&&g._processSectionJson(a.notesSectionJson,b,c);break;case h.LOCATOR_TABLE:a.titleSectionJson&&g._processSectionJson(a.titleSectionJson,b);g._processSectionJson(a.headerSectionJson,b);g._processSectionJson(a.dataSectionJson,b);a.summarySectionJson&&
g._processSectionJson(a.summarySectionJson,b);a.summaryFooterSectionJson&&g._processSectionJson(a.summaryFooterSectionJson,b);break;case h.COMPARISON_TABLE:a.titleSectionJson&&g._processSectionJson(a.titleSectionJson,b),b.ignoreComparisonCalculators||g._processSectionJson(a.dataSectionJson,b)}}};e.DOCUMENT="document";e.SECTION="section";e.TABLE="table";e.SECTION_ELEMENT="sectionElement";e.TABLE_ROW="tableRow";e.FIELD="field";e.process=g.process;e.processTemplateFieldInfos=function(c,b,a){g.process("document",
"field",c,b,a)};e.processSectionFieldInfos=function(c,b,a){g.process("section","field",c,b,a)};e.processSectionElements=function(c,b){g.process("document","sectionElement",c,b)};e.processTableFieldInfos=function(c,b,a){g.process("table","field",c,b,a)};e.hasMultiFeatureChart=function(c){var b=!1;e.processTemplateFieldInfos(c,function(a){a.isChart&&(b=b||a.chartJson&&!!a.chartJson.isMultiFeatureChart)});return b};e.hasComparisonInfographicTable=function(c){var b=!1;e.processTemplateFieldInfos(c,function(a){a.isInfographic&&
(b=b||a.infographicJson&&a.infographicJson.type===h.COMPARISON_TABLE)});return b};e.isGraphicReport=function(c){return!!c.sectionsTables};e.hasDynamicColumns=function(c){return e._checkTableAttributes(c,function(b){return 0<b.dynamicColumns})};e.hasDynamicRows=function(c){return e._checkTableAttributes(c,function(b){return 0<b.dynamicRows})};e._checkTableAttributes=function(c,b){var a;e.isGraphicReport(c)?e.processTemplateFieldInfos(c,function(c){c.isReportSection&&c.sectionJson&&c.sectionJson.stack&&
c.sectionJson.stack.some(function(d){if("table"===d.id&&d.attributes&&b(d.attributes))return a=!0})}):a=e.collectSectionJsons(c).some(function(a){return a.stack&&a.stack.some(function(a){return"table"===a.id&&a.attributes&&b(a.attributes)})});return a};e.hasMultiFeatureSections=function(c){return e.isGraphicReport(c)?e.hasMultiFeatureChart(c)||e.hasDynamicColumns(c)||e.hasComparisonInfographicTable(c):!1};e.collectSectionJsons=k.collectSectionJsons;e.getParentBox=k.getParentBox;e.getParentStyle=k.getParentStyle;
return e})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/query/_SectionJsonCollector":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/utils/MathUtil","esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridDataUtil","../../tableJson/TableJsonUtil"],function(k,h,e,g){var c={},b={provideParentInfo:function(b,c,f,e,g,h){a.collectStatistics(c);var d;a:{switch(g){case "floating":d=c.style.left+h.left;break a;case "page":d=a.calcX(c,f,e)+h.left;break a}d=
void 0}a:{switch(g){case "floating":g=c.style.spaceBefore+h.top;break a;case "page":g=a.calcY(c,f,e)+h.top;break a}g=void 0}b._parentBox={x:d,y:g,w:a.calcFullWidth(c,f,e),h:a.calcFullHeight(c,f,e)};c=e.field;f.style.fields=f.style.fields||{};f=(f.style.fields[c]=f.style.fields[c]||{}).backgroundColor;b._parentStyle={backgroundColor:f}},sanitize:function(b){a.sanitize(b)}},a={collectStatistics:function(b){if(!b._measureInfo){var d={},c={},f;b.data.columns.forEach(function(a){f&&(c[f.field]=a);f=a;
d[a.field]=a});var e={},g={},h={},k={},u={},t={};b.data.data.forEach(function(d,c){b.data.columns.forEach(function(b,f){var l=u[f]||0,m=t[c]||0,n=a._getDataHeight(d,b.field);b=a._getFieldWidth(d,b);l+=n;m+=b;u[f]=l;t[c]=m;n=f+"_"+c;g[n]=l;e[n]=m;h[n]=e[f-1+"_"+c]||0;k[n]=g[f+"_"+(c-1)]||0})});b._measureInfo={xPositions:h,yPositions:k,columnsHash:d,nextColumnHash:c}}},calcX:function(a,b,c){c=a.data.columns.indexOf(c);b=a.data.data.indexOf(b);return a._measureInfo.xPositions[c+"_"+b]||0},calcY:function(a,
b,c){c=a.data.columns.indexOf(c);b=a.data.data.indexOf(b);return a._measureInfo.yPositions[c+"_"+b]||0},calcFullWidth:function(b,c,f){f=f.field;var d=a._getFieldWidth(c,b._measureInfo.columnsHash[f]),e=c.columnSpans&&c.columnSpans[f]||1;if(1<e)for(var g,h=0;h<e-1;h++)g=b._measureInfo.nextColumnHash[g?g.field:f],d+=a._getFieldWidth(c,g);return d},_getFieldWidth:function(a,b){a.style.fields=a.style.fields||{};return(a.style.fields[b.field]=a.style.fields[b.field]||{}).width||b.style.width},calcFullHeight:function(b,
c,f){f=f.field;var d=b.data.data.indexOf(c),e=a._getDataHeight(c,f);c=c.rowSpans&&c.rowSpans[f]||1;if(1<c)for(var g=d+1,h=0;h<c-1;h++)d=b.data.data[g++],e+=a._getDataHeight(d,f);return e},_getDataHeight:function(a,b){a.style.fields=a.style.fields||{};return(a.style.fields[b]=a.style.fields[b]||{}).height||a.style.height},sanitize:function(a){delete a._measureInfo}},f={getIntersectingTableJsonsBehind:function(a,b,c,f,k){function d(a){var d=a.data.data[0].fieldInfos[a.data.columns[0].field];return e.isTextLikeCell(d)||
e.isShapeCell(d)||e.isImageCell(d)?h.checkRectsIntersect([c,{x:a.style.left+b.left,y:a.style.spaceBefore+b.top,w:g.getTableWidth(a),h:g.getTableHeight(a)}]):!1}function l(a){return h.checkRectsIntersect([c,{x:a.style.left+b.left,y:a.style.spaceBefore+b.top,w:a.style.width,h:a.style.height}])}var m=[],n=[];a.backgroundFloatingTablesSectionJson&&a.backgroundFloatingTablesSectionJson.stack.forEach(function(a,b){if(-1===f||k||f!==b)if("table"===a.id&&d(a)||"img"===a.id&&l(a))-1===f||k||f>b?m.push(a):
n.push(a)});a.foregroundFloatingTablesSectionJson&&a.foregroundFloatingTablesSectionJson.stack.forEach(function(a,b){if(k&&f===b)return!0;if("table"===a.id&&d(a)||"img"===a.id&&l(a))k&&f>b?m.push(a):n.push(a)});return{elementJsonsBehind:m,elementJsonsAbove:n}}};c.collectSectionJsons=function(a,b){b=b||{};var d=[];if(!a)return[];if(a.sections)return a.sections;if(!a.sectionsTables)return[];b.processSectionJson=b.processSectionJson||function(){};a.sectionsTables.forEach(function(f,e){!1!==b.backgroundForeground&&
f.foregroundSectionJson&&f.foregroundSectionJson.stack&&d.push(f.foregroundSectionJson);var g=[];!1!==b.floatingTables&&f.foregroundFloatingTablesSectionJson&&f.foregroundFloatingTablesSectionJson.stack.forEach(function(d,e){"table"===d.id&&c._processTableJson(d,g,"floating",a.documentOptions,b,f,e,!0)});g.reverse();g.forEach(function(a){b.processSectionJson(a,{pageIndex:e,source:"foreground",floatingIndex:a.__floatingIndex});delete a.__floatingIndex});d=d.concat(g);var h=[];c._processTableJson(f,
h,"page",a.documentOptions,b,f);h.forEach(function(a){b.processSectionJson(a,{pageIndex:e,source:"grid",index:a.__inGridIndex});delete a.__inGridIndex});d=d.concat(h);g.length=0;!1!==b.floatingTables&&f.backgroundFloatingTablesSectionJson&&f.backgroundFloatingTablesSectionJson.stack.forEach(function(d,e){"table"===d.id&&c._processTableJson(d,g,"floating",a.documentOptions,b,f,e,!1)});g.reverse();g.forEach(function(a){b.processSectionJson(a,{pageIndex:e,source:"foreground",floatingIndex:a.__floatingIndex});
delete a.__floatingIndex});d=d.concat(g);!1!==b.backgroundForeground&&f.backgroundSectionJson&&f.backgroundSectionJson.stack&&d.push(f.backgroundSectionJson)});return d};c._processTableJson=function(a,c,e,g,h,q,v,r){a.data.data.forEach(function(d,l){d.fieldInfos&&a.data.columns.forEach(function(m,n){var p=d.fieldInfos[m.field];if(p&&p.sectionJson&&p.sectionJson.stack){h.processFieldInfoFunc&&h.processFieldInfoFunc(p);(!1!==h.saveParentInfo||h.populateWithFloatingElementsBehind)&&b.provideParentInfo(p.sectionJson,
a,d,m,e,g);if(h.populateWithFloatingElementsBehind){m=function(a){a=k.clone(a);a.isContextFloatingElement=!0;a.style.left=a.style.left+g.left-t._parentBox.x;if("table"===a.id)a.style.spaceBefore=a.style.spaceBefore+g.top-t._parentBox.y;else if("img"===a.id||"map"===a.id)a.style.top=a.style.top+g.top-t._parentBox.y;return a};var t=k.clone(p.sectionJson),w;"page"===e?w=f.getIntersectingTableJsonsBehind(q,g,t._parentBox,-1,void 0):"floating"===e&&(w=f.getIntersectingTableJsonsBehind(q,g,t._parentBox,
v,r));p=w.elementJsonsBehind.map(m);w=w.elementJsonsAbove.map(m);t.stack=p.concat(t.stack);t.stack=t.stack.concat(w);c.push(t)}else c.push(p.sectionJson);w=c[c.length-1];"page"===e?w.__inGridIndex=l*a.data.columns.length+n:w.__floatingIndex=v}})});b.sanitize(a)};c.getParentBox=function(a){return a&&a._parentBox};c.getParentStyle=function(a){return a&&a._parentStyle};return c})},"esri/dijit/geoenrichment/utils/MathUtil":function(){define([],function(){function k(b){return Array.isArray(b)?b:[b.x,b.y]}
function h(b){return Array.isArray(b)?b:[b.x,b.y,b.x+b.w,b.y+b.h]}function e(b){return Array.isArray(b)?{x:b[0],y:b[1],w:b[2]-b[0],h:b[3]-b[1]}:b}function g(b){return[[b[0],b[1]],[b[2],b[1]],[b[2],b[3]],[b[0],b[3]],[b[0]+(b[2]-b[0])/2,b[1]+(b[3]-b[1])/2]]}var c={rotatePointAroundPoint:function(b,a,f){f=c.degToRad(f);var d=k(b),e=k(a);a=Math.cos(f)*(e[0]-d[0])-Math.sin(f)*(e[1]-d[1])+d[0];f=Math.sin(f)*(e[0]-d[0])+Math.cos(f)*(e[1]-d[1])+d[1];return Array.isArray(b)?[a,f]:{x:a,y:f}},degToRad:function(b){return b*
Math.PI/180},radToDeg:function(b){return 180*b/Math.PI},cosDeg:function(b){return Math.cos(c.degToRad(b))},sinDeg:function(b){return Math.sin(c.degToRad(b))},angleTo180_180Range:function(b){b=(b+180)%360;0>b&&(b=360+b);return b-180},angleTo0_360Range:function(b){b%=360;0>b&&(b=360+b);return b},calcVectorLength:function(b){var a=b[0]-b[2];b=b[1]-b[3];return Math.sqrt(a*a+b*b)},addPointToVector:function(b,a){a=k(a);b=b.slice();b[0]+=a[0];b[1]+=a[1];b[2]+=a[0];b[3]+=a[1];return b},subtractPointFromVector:function(b,
a){a=k(a);b=b.slice();b[0]-=a[0];b[1]-=a[1];b[2]-=a[0];b[3]-=a[1];return b},putVectorToOrigin:function(b){return c.subtractPointFromVector(b,[b[0],b[1]])},normalizeVector:function(b){b=c.putVectorToOrigin(b);var a=c.calcVectorLength(b);b[2]/=a;b[3]/=a;return b},calcDotProduct:function(b,a){b=c.putVectorToOrigin(b);a=c.putVectorToOrigin(a);return b[2]*a[2]+b[3]*a[3]},calcAngleBetweenVectors:function(b,a){b=c.normalizeVector(b);a=c.normalizeVector(a);return Math.acos(c.calcDotProduct(b,a))},addLengthToVector:function(b,
a){var f=c.calcVectorLength(b),d=[b[0],b[1]];b=c.normalizeVector(b);b[2]*=f+a;b[3]*=f+a;return c.addPointToVector(b,d)},rotateVectorAroundPoint:function(b,a,f){a=k(a);var d=c.rotatePointAroundPoint(a,[b[0],b[1]],f);b=c.rotatePointAroundPoint(a,[b[2],b[3]],f);return[d[0],d[1],b[0],b[1]]},toLineABC:function(b){var a=b[3]-b[1],c=b[0]-b[2];return[a,c,-a*b[0]-c*b[1]]},intersect2Lines:function(b,a){var f=c.toLineABC(b),d=c.toLineABC(a);a=f[0];b=f[1];var f=f[2],e=d[0],g=d[1],d=d[2],h=a*g-e*b;return 0===
h?null:[(d*b-f*g)/h,(e*f-a*d)/h]},intersectLineWithRect:function(b,a){function f(d,f){(d=c.intersect2Lines(b,[d[0],d[1],f[0],f[1]]))&&c.isPointInRect(a,d)&&k.push(d)}var d=g(a),e=d[0],h=d[1],l=d[2],d=d[3],k=[];f(e,h);f(h,l);f(l,d);f(d,e);if(2!==k.length)return null;e=[k[0][0],k[0][1],k[1][0],k[1][1]];return c.calcVectorLength(e)?e:null},isPointInRect:function(b,a){b=h(b);a=k(a);var c=b[2]-b[0],d=b[3]-b[1];return!(a[0]<b[0]||a[0]>b[0]+c||a[1]<b[1]||a[1]>b[1]+d)},checkRectsIntersect:function(b){b=b.map(h);
return b.every(function(a){var f=g(a);return b.every(function(b){return a===b?!0:f.some(function(a){return c.isPointInRect(b,a)})||g(b).some(function(b){return c.isPointInRect(a,b)})})})},getRotatedRectBox:function(b,a){var f=!Array.isArray(b);b=h(b);var d=g(b);b=d[0];var k=d[1],m=d[2],l=d[3],d=d[4];b=c.rotatePointAroundPoint(d,b,a);k=c.rotatePointAroundPoint(d,k,a);m=c.rotatePointAroundPoint(d,m,a);l=c.rotatePointAroundPoint(d,l,a);b=c.getPointsExtent([b,k,m,l]);return f?e(b):b},uniteRects:function(b){var a=
!Array.isArray(b[0]);b=b.map(h);var f=[];b.forEach(function(a){f=f.concat(g(a))});b=c.getPointsExtent(f);return a?e(b):b},getPointsExtent:function(b){var a=!Array.isArray(b[0]),c=Infinity,d=-Infinity,g=Infinity,h=-Infinity;b.forEach(function(a){a=k(a);c=Math.min(c,a[0]);d=Math.max(d,a[0]);g=Math.min(g,a[1]);h=Math.max(h,a[1])});b=[c,g,d,h];return a?e(b):b}};return c})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridDataUtil":function(){define(["dojo/_base/lang","../../supportClasses/templateJsonUtils/fieldInfo/FieldLibrary",
"esri/dijit/geoenrichment/utils/FieldUtil","esri/dijit/geoenrichment/utils/ObjectUtil","esri/dijit/geoenrichment/ReportPlayer/countryConfig"],function(k,h,e,g,c){var b={getFieldCellValue:function(a){return a.gridData&&a.gridData[a.column.field]},setFieldCellContent:function(a,b){a.set("value",b);a.gridData[a.column.field]=b},clearFieldInfo:function(a,c){a.fieldInfos&&delete a.fieldInfos[c];a[c]="";b.setNumericDataValue(void 0,a,c)},getNumericCellValue:function(a){return b.getNumericDataValue(a.gridData,
a.column.field)},setNumericCellValue:function(a,c){return b.setNumericDataValue(c,a.gridData,a.column.field)},getNumericDataValue:function(a,b){return a&&b&&a[b+"_numeric"]},setNumericDataValue:function(a,b,d){b[d+"_numeric"]=a},getRenderedValue:function(a,b,d){b={parentGrid:a,gridData:b,column:d};a=a._getCellRenderer().getRenderedContent(b);var f;"number"===typeof a.value?f=a.value:"string"===typeof a.formattedValue&&(b=g.parsePercentOrCurrency(a.formattedValue,c.getCurrencyFormat()),isNaN(b)||(f=
b));return{numericValue:f,formattedValue:a.formattedValue}},isEmptyCell:function(a){return!a.get("value")&&!a.gridData[a.column.field]&&!b.getFieldInfo(a)},hasSpans:function(a){return b.getColumnSpan(a)||b.getRowSpan(a)},getColumnSpan:function(a){return a.gridData&&a.gridData.columnSpans&&a.gridData.columnSpans[a.column.field]},getRowSpan:function(a){return a.gridData&&a.gridData.rowSpans&&a.gridData.rowSpans[a.column.field]},getDataColumnSpan:function(a,b){return a&&a.columnSpans&&a.columnSpans[b]},
getDataRowSpan:function(a,b){return a&&a.rowSpans&&a.rowSpans[b]},getFieldInfo:function(a){return a&&a.gridData&&a.column&&a.gridData.fieldInfos&&a.gridData.fieldInfos[a.column.field]},getGridFirstFieldInfo:function(a){return b.getFieldInfo(a.getFirstCell())},setFieldInfo:function(a,b){a.gridData&&(a.gridData.fieldInfos[a.column.field]=b)},provideFieldInfo:function(a){b.setFieldInfo(a,b.getFieldInfo(a)||{});return b.getFieldInfo(a)},getCellStyle:function(a,c){if(!a||!a.gridData)return null;var d=
a.gridData.style&&a.gridData.style.fields&&a.gridData.style.fields[a.column.field];!d&&c&&(d={},b.setCellStyle(a,d));return d},setCellStyle:function(a,b){var d=a.gridData.style=a.gridData.style||{};d.fields=d.fields||{};d.fields[a.column.field]=b},updateCellStyle:function(a,c){a=b.getCellStyle(a,!0);k.mixin(a,c)},copyFieldStyle:function(a,c,d){a=b.getCellStyle(a);c=b.getCellStyle(c,!0);for(var f in d)void 0!==a[f]&&(c[f]=a[f])},getFieldCellUrl:function(a){if(a.gridData&&a.gridData.urls&&a.column)return a.gridData.urls[a.column.field]},
setFieldCellUrl:function(a,b){a.gridData&&a.column&&(a.gridData.urls=a.gridData.urls||{},void 0===b?delete a.gridData.urls[a.column.field]:a.gridData.urls[a.column.field]=b)},getConditionalFormatting:function(a){return(a=b.getFieldInfo(a))&&a.triggerJson},setConditionalFormatting:function(a,c){a=b.provideFieldInfo(a);c&&c.fieldInfo===a&&(c.fieldInfo=k.clone(c.fieldInfo),delete c.fieldInfo.triggerJson);a.triggerJson=c},_toFieldInfo:function(a){return a?a.gridData?b.getFieldInfo(a):"object"===typeof a&&
a:null},isRichTextCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isRichText)},isVariableFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.hasVariable&&!a.script)},isOnlyVariableFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.hasVariable)},isScriptFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.script)},isUneditableScript:function(a){a=b._toFieldInfo(a);return!!(a&&a.script&&a.script.isUneditableScript)},isNumericVariableFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||
!(a.hasVariable&&e.isNumericField(a)||a.script&&!a.script.isUneditableScript&&"String"!==a.script.type))},isCalculatableNumericVariableFieldCell:function(a){var c=b._toFieldInfo(a);return c&&(c.isSiteAttribute||c.isWebMap)?!1:b.isNumericVariableFieldCell(a)},isStringVariableFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!(a.hasVariable&&"esriFieldTypeString"===a.type||a.script&&"String"===a.script.type))},isImageCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isImage)},isMapCell:function(a){a=
b._toFieldInfo(a);return!(!a||!a.isMap)},isImageTriggerCell:function(a){a=b._toFieldInfo(a);return!!(a&&a.isImage&&a.triggerJson)},isShapeCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isShape)},isEmptyShapeCell:function(a){a=(a=b._toFieldInfo(a))&&a.shapeJson;return!(!a||a.g&&a.g.length)},isReportSectionCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isReportSection)},isInfographicCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isInfographic)},isChartCell:function(a){a=b._toFieldInfo(a);
return!(!a||!a.isChart)},isSpecialFieldCell:function(a){var c=b._toFieldInfo(a);return c&&!b.isVariableFieldCell(a)&&h.hasField(c.name)},isTextLikeCell:function(a){return!b._toFieldInfo(a)||b.isRichTextCell(a)||b.isVariableFieldCell(a)||b.isSpecialFieldCell(a)}};return b})},"esri/dijit/geoenrichment/utils/FieldUtil":function(){define([],function(){var k={isNumericField:function(e){switch(e&&e.type){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":return"i";case "esriFieldTypeSingle":case "esriFieldTypeDouble":return"f"}return!1},
isStringField:function(e){return e&&"esriFieldTypeString"==e.type||!1},isDateField:function(e){return e&&"esriFieldTypeDate"==e.type||!1}},h=/DISTANCE$/;k.isDistanceField=function(e){return e&&h.test(e)};var e=/^(SHAPE__Area|SHAPE__Length)$/;k.canShowField=function(g,c){if(!g||!g.name||"esriFieldTypeOID"===g.type)return!1;if("esriFieldTypeDate"===g.type)return"d";var b=k.isNumericField(g)||k.isStringField(g);if("f"===b&&!1===g.editable&&e.test(g.name))return null;void 0===c&&(c=/^(OBJECTID|OID|FID)$/i);
return c&&c.test(g.name)?!1:!0===b?"s":b};k.createFieldInfo=function(e){var c=k.canShowField(e);e={fieldName:e.name,label:e.alias||e.name,isEditable:!!e.editable,visible:!!c};switch(c){case "i":e.format={places:0,digitSeparator:!0};break;case "f":e.format={digitSeparator:!0};break;case "s":e.stringFieldOption="textbox"}return e};return k})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/tableJson/TableJsonUtil":function(){define(["dojo/_base/lang","../templateJsonUtils/fieldInfo/FieldInfoBuilder",
"esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes"],function(k,h,e){var g={createTable:function(c){var b=c.numColumns,a=c.numRows,f=c.width,d=c.widths,e=c.style,g=c.attributes&&c.attributes.fixedColumns,l=c.attributes&&c.attributes.dynamicColumns;if(f)if(d)d=d.map(function(a){return f*Number(a.replace("%",""))/100});else for(var p=f/b,d=[],q=0;q<b;q++)d.push(p);if(d)f||isNaN(Number(d[0]))||(f=0,d.forEach(function(a){f+=a}));else for(p=Number(100/b).toFixed(3)+"%",d=[],q=0;q<b;q++)d.push(p);
p=[];for(q=0;q<b;q++)p.push({field:"field"+q,style:{width:d[q]}});for(var d=[],v=!0,r=c.height?c.height/a:c.rowHeight||15.07,u=0;u<a;u++){for(var t={style:{height:r,fields:{}},fieldInfos:{}},q=0;q<b;q++){var z="field"+q;!1!==c.useDefaultTheme&&(t.style.fields[z]=k.mixin({horizontalAlign:0===q?"left":"right",overrideStyle:0===u?1<a?!1!==c.useDefaultHeaderTheme?"TableHeader":"Default":void 0:v?"AlternatingRow":"Default"},c.cellParams));l&&q>=g&&0===u&&(t.fieldInfos[z]=h.createFieldInfoFromSpecialFieldName("AREA_DESC"));
c.processTableCell&&c.processTableCell(t,z,u,q,c)}d.push(t);v=!v}return{id:"table",attributes:k.mixin({},c.attributes),style:k.mixin({width:f||772.33},e),data:{columns:p,data:d}}},createSingleCellTable:function(c){c=c||{};var b=g.createTable({numColumns:1,numRows:1,attributes:c.attributes,useDefaultTheme:!1});g.modifyTableJson(b,0,0,c);return b},modifyTableJson:function(c,b,a,f){b=c.data.data[b];a=c.data.columns[a];var d=a.field;f.text&&(b[d]=f.text);f.fieldInfo&&(b.fieldInfos[d]=f.fieldInfo);f.cellStyle&&
(b.style.fields[d]=f.cellStyle);f.columnSpan&&(b.columnSpans=b.columnSpans||{},b.columnSpans[d]=f.columnSpan);f.rowSpan&&(b.rowSpans=b.rowSpans||{},b.rowSpans[d]=f.rowSpan);b.themeStyle=f.themeStyle;f.width&&(c.style.width=f.width,a.style.width=f.width);f.height&&(b.style.height=f.height);void 0!==f.left&&(c.style.left=f.left);void 0!==f.spaceBefore&&(c.style.spaceBefore=f.spaceBefore)},getTableWidth:function(c){return c.style.width},getTableHeight:function(c){var b=0;c.data.data.forEach(function(a){b+=
a.style?a.style.height:0});return b},createDetailsSection:function(c){return{type:e.DETAILS,stack:[g.createTable(c)]}},createDetailsSectionForFieldInfos:function(c,b){return{type:e.DETAILS,stack:[function(){var a=g.createTable(k.mixin({numColumns:2,numRows:c.length+1},b));a.data.data.forEach(function(a,b){0===b?a.field0=c[0].hasVariable?c[0].fieldCategory:"":(b=c[b-1],a.field0=b.script?b.script.alias:b.alias,a.fieldInfos.field1=b)});g.provideSpaceAfter(a);return a}()]}},createDetailsSectionForFieldInfoGroups:function(c,
b){return{type:e.DETAILS,stack:[function(){var a=g.createTable(k.mixin({numColumns:c.length+1,numRows:c[0].length+1},b));a.data.data.forEach(function(b,d){a.data.columns.forEach(function(a,f){0!==f&&(0===d?b[a.field]=c[f-1][0].fieldCategory||"":(f=c[f-1][d-1],b.field0=b.field0||(f.script?f.script.alias:f.alias),b.fieldInfos[a.field]=f))})});g.provideSpaceAfter(a);return a}()]}},provideSpaceAfter:function(c,b){c.style.spaceAfter=Math.max(b||0,90-15.07*c.data.data.length)},applyDefaultStyling:function(c){var b=
!0;c.data.data.forEach(function(a,f){c.data.columns.forEach(function(c){a.style.fields[c.field].overrideStyle=0===f?"TableHeader":b?"AlternatingRow":void 0});b=!b})},setTableHeaderStyle:function(c){if(c.style)for(var b in c.style.fields)(c.style.fields[b]=c.style.fields[b]||{}).overrideStyle="TableHeader"},DEFAULT_ROW_HEIGHT:15.07,isMultiDataTable:function(c){return c.store?1<c.columns.length||2<c.store.data.length:1<c.data.columns.length||2<c.data.data.length},tableJsonHasInfographic:function(c){return!!g.getTableJsonInfographic(c)},
getTableJsonInfographic:function(c){var b;c.data.data.some(function(a){if(a.fieldInfos)for(var c in a.fieldInfos){var d=a.fieldInfos[c];if(d&&d.isInfographic)return b=d.infographicJson,!0}});return b},getTableJsonFirstFieldInfo:function(c){return c.data.data[0].fieldInfos[c.data.columns[0].field]},tableJsonHasChart:function(c){return c.data.data.some(function(b){if(b.fieldInfos)for(var a in b.fieldInfos){var c=b.fieldInfos[a];if(c&&c.isChart)return!0}})}};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder":function(){define(["./utils",
"dojo/i18n!esri/nls/jsapi"],function(k,h){function e(a){Object.keys(a).forEach(function(b){var c=a[b];void 0!==c&&null!==c||delete a[b]})}h=h.geoenrichment.dijit.ReportPlayer.ReportPlayer;var g={NUMBER:"n/",createFieldInfoFromCalculator:function(a,b,c){if(!a)return null;a=(b="function"===typeof a.getDescriptionWithType?a:null)?b.variable:a;var d=c&&c.format,f=c&&c.autoformatCurrency,g=c&&c.additionalText,h=c&&c.calculatorName,n=c&&c.defaultDistanceUnits,r=c&&c.summaryType,u=b&&b.getToggleGroup&&b.getToggleGroup();
c={comparisonIndex:c&&c.comparisonIndex,alias:b?b.getDescriptionWithType()||b.getAliasWithType():a.description||a.alias,hasVariable:!0,variableID:a.id,fullName:a.fullName,fieldCategory:a.fieldCategory,vintage:a.vintage,type:a.type,statefulName:u?u.value:"n/"+a.fullName,summaryType:r};b=b?b.getCalcType().charAt(0):"n";c.name=k.name.createFieldNameFromVariable(a,b);d?k.format.setFieldInfoFormat(c,d):(c.decimals=a.precision,c.showCurrency=!(!f||"n"!==b||!a.units||"CURRENCY"!==a.units.toUpperCase()),
c.showPercent=!c.showCurrency&&("p"===b||"n"===b&&a.units&&"PCT"===a.units.toUpperCase()),c.useThousandsSeparator=!0);a.isWebMap&&(c.isWebMap=!0,c.webMapFieldName=a.fieldName,c.webMapField=a.field,c.webMapId=a.webMapId,!d&&a.field&&a.field.format&&(c.decimals=a.field.format.places,c.useThousandsSeparator=!1!==a.field.format.digitSeparator));a.customDataCollection&&(c.isCustomDataCollection=!0,c.customDataCollectionId=a.customDataCollection.id,c.customDataCollectionUrl=a.customDataCollection.url,c.customDataCollectionPortalUrl=
a.customDataCollection.portalUrl);a.isSiteAttribute&&(c.isSiteAttribute=!0,c.attribute=a.attribute,c.type=a.attribute.type,!d&&0<a.attribute.places&&(c.decimals=a.attribute.places));a.isDataLayerAttribute&&(c.isDataLayerAttribute=!0,c.layerID=a.layerID,c.layerUrl=a.layerUrl,c.layerName=a.layerName,c.attribute=a.attribute,c.type=a.attribute.type,!d&&0<a.attribute.decimals&&(c.decimals=a.attribute.decimals),"DISTANCE"===a.attribute.name&&(c.units=a.attribute.units||n||"esriMiles"));"string"===typeof g&&
(c.additionalText=g);c.usedFields=a.usedFields;c.expressionText=a.expressionText;k.name.provideQualifiedFieldInfoTemplateName(c,h);e(c);return c},fieldInfoToVariable:function(a){if(!a.hasVariable)return null;var b={id:a.variableID,fullName:a.fullName,fieldCategory:a.fieldCategory,vintage:a.vintage,type:a.type,precision:a.decimals,usedFields:a.usedFields,expressionText:a.expressionText};a.isWebMap&&(b.isWebMap=!0,b.fieldName=a.webMapFieldName,b.field=a.webMapField,b.webMapId=a.webMapId);a.isSiteAttribute&&
(b.isSiteAttribute=!0,b.attribute=a.attribute);return b},createFieldInfoFromScript:function(a,b,c){b=c&&c.format;var d=c&&c.additionalText,f=c&&c.calculatorName;a=a||{};a.name=a.name||k.name.DEFAULT_SCRIPT_NAME;a.alias=a.alias||h.scriptNameDefault;a.decimals=Number(a.decimals)||0;c={comparisonIndex:c&&c.comparisonIndex};c.name=k.name.createFieldNameFromScript(a);k.name.provideQualifiedFieldInfoTemplateName(c,f);c.script=a;b?k.format.setFieldInfoFormat(c,b):(c.decimals=Number(a.decimals),c.showCurrency=
!1,c.showPercent=!1,c.useThousandsSeparator=!0);"string"===typeof d&&(c.additionalText=d);e(c);return c},createFieldInfoFromImage:function(a,b){return{isImage:!0,imageJson:a,triggerJson:b}},createFieldInfoFromMap:function(a){return{isMap:!0,mapJson:a}},createFieldInfoFromShape:function(a){return{isShape:!0,shapeJson:a}},createFieldInfoFromChart:function(a){return{isChart:!0,chartJson:a}},createFieldInfoFromInfographic:function(a){return{isInfographic:!0,infographicJson:a}},createFieldInfoFromSection:function(a){return{isReportSection:!0,
sectionJson:a}},createFieldInfoFromMissingVariable:function(a,b){return{name:a&&a.substr(a.indexOf(".")+1),templateName:a,isMissing:!0,alias:b}},createFieldInfoForUnsupportedContent:function(){return{isUnsupportedContent:!0}}},c=/^\[\w+\]$/,b=/\[\w+\]/;g.createFieldInfoFromLabel=function(a,d){if("string"!==typeof a)return null;a=a.trim();var f=c.test(a);if(!d||f){if(!f)return null;a=a.replace(/\[|\]/g,"").toUpperCase();return g.createFieldInfoFromSpecialFieldName(k.fields.uiToTemplate(a))}return b.test(a)?
(a=k.richText.collectFieldInfosFromRenderedXMLString(a))&&k.richText.createFieldInfoFromRichText(a.xmlString,a.fieldInfos,a.specialFieldInfos):null};g.createFieldInfoFromSpecialFieldName=function(a,b){if("string"!==typeof a)return null;var c;a=a.substr(a.indexOf(".")+1);a=a.toUpperCase();"GROUPCOUNT"===a?c={name:k.fields.GROUPCOUNT_FIELD_NAME,alias:k.fields.GROUPCOUNT_FIELD_ALIAS}:"CURRDATE"===a?c={name:k.fields.DATE_FIELD_NAME,alias:k.fields.DATE_FIELD_ALIAS,format:b||k.fields.DATE_FIELD_DEFAULT_FORMAT}:
"SITENOTE"===a?c={name:k.fields.SITENOTE_FIELD_NAME,alias:k.fields.SITENOTE_FIELD_ALIAS}:"SITENOTES"===a&&(c={name:k.fields.SITENOTES_FIELD_NAME,alias:k.fields.SITENOTES_FIELD_ALIAS});if(c)return c;(b=k.fields.templateToUIHeader(a))?c={name:k.fields.qualifyTemplateHeaderName(a),alias:b}:(b=k.fields.templateToUIReportVar(a))&&(c={name:b,alias:b});return c};var a=/_P$/i;g.isFieldInfoInPercentState=function(b){return b?b.statefulName&&("p"===b.statefulName.charAt(0)||a.test(b.statefulName))||b.alias&&
-1!==b.alias.indexOf("(%)"):!1};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/utils":function(){define(["esri/dijit/geoenrichment/Deferred","require"],function(k,h){var e={},g;e.init=function(){if(g)return g.promise;g=new k;h("./FieldInfoBuilder ./FieldInfoFormatUtil ./FieldInfoNameUtil ./FieldInfoRenderer ./RichTextJsonUtil ./FieldLibrary".split(" "),function(c,b,a,f,d,h){e.builder=c;e.format=b;e.name=a;e.renderer=f;e.richText=d;e.fields=h;g.resolve()});
return g.promise};e.init();return e})},"esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes":function(){define([],function(){return{PAGE_HEADER:"PageHeader",DETAILS_HEADER:"DetailsHeader",DETAILS:"Details",GROUP:"Group",PAGE_FOOTER:"PageFooter",REPORT_FOOTER:"ReportFooter",DATA_SOURCE:"DataSource",EMPTY:"empty",INFOGRAPHIC_HEADER:"InfographicHeader",INFOGRAPHIC_VARIABLE:"InfographicVariable",INFOGRAPHIC_BACKGROUND:"InfographicBackground",INFOGRAPHIC_FOREGROUND:"InfographicForeground",
INFOGRAPHIC_ATTRIBUTES:"InfographicAttributes",INFOGRAPHIC_NOTES:"InfographicNotes",INFOGRAPHIC_SUMMARY:"InfographicSummary",INFOGRAPHIC_SUMMARY_FOOTER:"InfographicSummaryFooter",TABLE_BACKGROUND:"TableBackground",TABLE_FOREGROUND:"TableForeground",TABLE_BACKGROUND_FLOATING_PANELS:"BackgroundFloatingPanels",TABLE_FOREGROUND_FLOATING_PANELS:"ForegroundFloatingPanels",TABLE_FLOATING_PANELS:"FloatingPanels"}})},"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicTypes":function(){define(["dojo/_base/lang"],
function(k){var h={STATIC:"static",ATTACHMENTS:"attachments",AREA_DETAILS:"areaDetails",INTERESTING_FACTS:"interestingFacts",LOCATOR_TABLE:"locatorTable",COMPARISON_TABLE:"comparisonTable"},e={AGE_PYRAMID:"AgePyramid",ONE_VAR:"OneVar",RELATED_VARS:"RelatedVariables",TAPESTRY:"Tapestry",PRIZM5:"Prizm5"},g={},c;for(c in e)g[e[c]]=!0;k.mixin(h,e);var b={};for(c in h)b[h[c]]=!0;h.isDynamic=function(a){return g[a]};h.isSupported=function(a){return b[a]};h.isTableLike=function(a){return a===h.AREA_DETAILS||
a===h.LOCATOR_TABLE||a===h.COMPARISON_TABLE};h.fixTapestryNameToWidget=function(a){return"TapestryNEW"===a?"Tapestry":a};h.fixTapestryNameToData=function(a){return"Tapestry"===a?"TapestryNEW":a};h.supportsMultiFeature=function(a){return a===h.COMPARISON_TABLE||a===h.LOCATOR_TABLE||a===h.ATTACHMENTS||a===h.AREA_DETAILS};h.supportsComparison=function(a){return a===h.ONE_VAR||a===h.AGE_PYRAMID||a===h.RELATED_VARS||a===h.COMPARISON_TABLE};h.isDynamicWithFiltering=function(a){return a===h.ONE_VAR||a===
h.AGE_PYRAMID||a===h.RELATED_VARS};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/infographics/utils/InfographicJsonUtil":function(){define(["esri/dijit/geoenrichment/config","esri/dijit/geoenrichment/utils/ArrayUtil"],function(k,h){var e={getDefaultLevels:function(){var e=k.levels.slice();e.push(k.highestLevel);return e},getLevels:function(g){g=g.levels&&g.levels.length?g.levels:e.getDefaultLevels();return h.removeDuplicates(g)},getSubLevels:function(g){g=e.getLevels(g);g.pop();return g},
getHighestLevel:function(g){g=e.getLevels(g);return g[g.length-1]},setLevels:function(g,c){c=h.removeDuplicates(c||[]);g.levels=c.length?c:e.getDefaultLevels()},getDataDrilling:function(e,c){"string"!==typeof c&&(c=(c=e.variableTables&&e.variableTables[c])&&c.variable.fieldInfo&&c.variable.fieldInfo.templateName);return e.dataDrilling&&e.dataDrilling[c]},setDataDrilling:function(e,c,b){c&&(e.dataDrilling=e.dataDrilling||{},b?e.dataDrilling[c]=b:delete e.dataDrilling[c])},validateDataDrilling:function(e){var c=
e.dataDrilling;if(c){var b={};e.variableTables.forEach(function(a){a.variable&&a.variable.fieldInfo&&a.variable.fieldInfo.templateName&&(b[a.variable.fieldInfo.templateName]=!0)});Object.keys(c).forEach(function(a){b[a]||delete c[a]})}},analyzeVariables:function(e){e=e.fieldInfos?e.fieldInfos.map(function(a){return a.fullName}):e.variables;if(1===e.length&&-1!==e[0].indexOf(".*"))return{dataCollectionID:e[0].substr(0,e[0].indexOf("."))};var c={},b,a;e.forEach(function(f,d){c[f.substr(0,f.indexOf("."))]=
1;b=f.substr(f.indexOf(".")+1);a=f});return{dataCollectionID:1===Object.keys(c).length?Object.keys(c)[0]:null,variableID:1===e.length?b:null,fullName:1===e.length?a:null}}};return e})},"esri/dijit/geoenrichment/config":function(){define(["esri/urlUtils"],function(k){k=k.getProtocolForWebResource();return{portalUrl:k+"//arcgis.com",server:k+"//geoenrich.arcgis.com/arcgis/rest/services/World/GeoenrichmentServer",levels:["Admin3","Admin2"],highestLevel:"Admin1",locatorUrl:k+"//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",
addressFormat:"${Address}, ${City}, ${Region} ${Postal}"}})},"esri/dijit/geoenrichment/utils/ArrayUtil":function(){define(["dojo/_base/array"],function(k){var h={},e={}.toString();h.composeIdentityFunction=function(e,c){var b="function"===typeof e?e:e?function(a){return a[e]}:function(a){return a};return function(a){return(a=b(a))&&a.toString?a.toString():c&&void 0===a?a:String(a)}};h.removeDuplicates=function(g,c){var b=[],a={};c=h.composeIdentityFunction(c,!0);k.forEach(g,function(f,d){var g=c(f);
g===e&&(void 0===f["__ArrayUtil.js_uniqueKey__"]&&(f["__ArrayUtil.js_uniqueKey__"]="__ArrayUtil.js_uniqueKey__"+d),g=f["__ArrayUtil.js_uniqueKey__"]);void 0===g||g in a||(a[g]=f,b.push(f))});return b};h.splitArrayToBunches=function(e,c){c=c||100;for(var b=[],a,f=0,d=e.length;f<d;f++)a&&a.length!==c||(a=[],b.push(a)),a.push(e[f]);return b};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/ReportTemplateTypes":function(){define([],function(){return{STANDARD:"esriReportTemplateStandard",
MULTICOLUMN:"esriReportTemplateMultiColumn",MAP:"esriReportTemplateMapReport",FUSION:"esriReportTemplateFusion"}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/PortalToEditorConverter":function(){define("esri/dijit/geoenrichment/when ./portalToEditorUtils/layout/LayoutParser ./portalToEditorUtils/metadata/MetadataParser ./portalToEditorUtils/ImageCollector ./portalToEditorUtils/parsers/Parsers ./portalToEditorUtils/variables/PlayerVariableProvider ../supportClasses/DefaultStyles ../supportClasses/images/ImageDataHolder ../themes/conversion/CssParser esri/dijit/geoenrichment/utils/async/AsyncQueue esri/dijit/geoenrichment/utils/DelayUtil".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m){return{provideEditorJson:function(l,p){function q(){function a(a,b,c){return k(p.preProcessFile&&p.preProcessFile(a,b,r),function(d){if(!1!==d)return k(c&&c(),function(){return p.postProcessFile&&p.postProcessFile(a,b,r)})})}if(u&&u.files&&u.files){var b=p.filesToProcess||["theme.css.txt","metadata.xml","report.xml"],g={"theme.css.txt":function(b){return a(b,"theme.css.txt",function(){r.theme=d.fromCssText(b.data,p)})},"metadata.xml":function(b){return a(b,"metadata.xml",
function(){return e.parseMetadataXML(b,r,p)})},"report.xml":function(b){return a(b,"report.xml",function(){return h.parseReportXML({isGraphicReport:v,parsers:c,file:b,templateJson:r,variableProvider:p.variableProvider,useVariableProviderToCollectOnly:p.useVariableProviderToCollectOnly,tableDefaultStyles:p.tableDefaultStyles,processFileName:z,putImageData:function(a,b){a=z(a);b=b||t[a];f.putImageData(a,b);return b},log:w,queryMetaDataFunc:function(a){return p.queryMetaDataFunc&&p.queryMetaDataFunc(a,
r)},postProcessChartJson:function(a,b){p.postProcessChartJson&&p.postProcessChartJson(r,a,b)},postProcessMapJson:function(a,b){p.postProcessMapJson&&p.postProcessMapJson(r,a,b)},postProcessInfographicJson:function(a,b){p.postProcessInfographicJson&&p.postProcessInfographicJson(r,a,b)},postProcessTableInSection:function(a,b){p.postProcessTableInSection&&p.postProcessTableInSection(r,a,b)}})})},generic:function(b,c){return a(b,c)}},l=new n;b.forEach(function(a){var b=u.files.filter(function(b){return b.name===
a})[0],c=b&&(g[a]||g.generic);c&&l.add(function(){return k(m.delay(50),function(){return c(b,a)}).otherwise(function(a){r.metadata.parseErrors.push(a);console.log(a)})})});return l.getPromise()}}p=p||{};var v=l.isGraphicReport;p.variableProvider=p.variableProvider||new b;p.tableDefaultStyles=p.tableDefaultStyles||new a;var r={documentOptions:{},metadata:{parseErrors:[],mapImageInfosHash:{},comparisonCalculatorsHash:{},locatorCalculatorsHash:{}},theme:null};v?r.sectionsTables=[]:r.sections=[];var u=
l.portalJson,t={};p.getImageData=function(a){return t[z(a)]};var z=function(a){return a?a.toLowerCase():""},w=p.log||function(a){};return k(c.initialize(),function(){return k(g.collectImageResources(u,t,z),function(){for(var a in t)f.putImageData(a,t[a]);return k(q(),function(){r.metadata.parseErrors.length||(l.templateJson=r);delete r.metadata})})})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/LayoutParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter",
"./GraphicReportSectionsParser","./ClassicReportSectionsParser"],function(k,h,e){return{parseReportXML:function(g){g.log(g.file.data);var c=k.parseXml(g.file.data);g.parsers.getParser("document").parseDocument(c,g);g.isGraphicReport?h.parseSectionsGraphic(c,g):e.parseSectionsClassic(c,g)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/GraphicReportSectionsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(k){return{parseSectionsGraphic:function(h,
e){k.queryJson(h,"table",!0).forEach(function(g){try{e.templateJson.sectionsTables.push(e.parsers.getParser("section").parseTable(g,e,{fixTableWidthsForPage:!0}))}catch(c){console.log(c)}})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/ClassicReportSectionsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(k){return{parseSectionsClassic:function(h,e){k.queryJson(h,"section",!0).forEach(function(g){e.templateJson.sections.push(e.parsers.getParser("section").parseSection(g,
e,{fixTableWidthsForPage:!0}))});this._splitSections(e)},_splitSections:function(h){h=h.templateJson;var e=[];h.sections.forEach(function(g){function c(){b={type:g.type,stack:[]};e.push(b)}var b;c();g.stack.forEach(function(a){if("hr"===a.id){var f=!!b.stack.length;b.stack.push(a);f&&c()}else"table"===a.id?(b.stack.some(function(a){return"table"===a.id})&&c(),b.stack.push(a)):"pageBreak"===a.id?(b.stack.length&&c(),b.stack.push(a),c()):b.stack.push(a)})});e=e.filter(function(e){return!!e.stack.length});
h.sections=e}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/MetadataParser":function(){define("esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/utils/JsonXmlConverter ./DataCollectionsCalculatorsParser ./LocatorCalculatorsParser ./map/MapCalculatorsParser ./TradeAreaCalculatorsParser".split(" "),function(k,h,e,g,c,b){return{parseMetadataXML:function(a,f,d){d.log&&d.log(a.data);var n=h.parseXml(a.data);if(n&&n.tags)return k([b.parseTradeAreaCalculators(n,
d),e.parseDataCollectionsCalculators(n,f,d),g.parseLocatorCalculators(n,f,d)]).then(function(){return c.parseMapCalculators(n,f,d)})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/DataCollectionsCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./VariableScriptCollector","../../../../_devConfig"],function(k,h,e){return{parseDataCollectionsCalculators:function(g,c,b){k.queryJson(g,"DataCollections").forEach(function(a){var f=
k.queryJson(a,"ComparisonLevel");if(e.emulateErrors.metadataParseError)throw Error("Error test: something crashed during the parsing of the metadata!");var d;if(b.variableProvider.isPlayerOnly||f.length)d=h.getObjects(a);f.length&&(a={calculatorName:a.attributes.Name,levels:f.map(function(a){return a.attributes.Name}).filter(function(a){return!b.validateGeographyLevelFunc||b.validateGeographyLevelFunc(a)}),variableObjects:d.variableObjects},c&&(c.metadata.comparisonCalculatorsHash[a.calculatorName]=
a));b.variableProvider.isPlayerOnly&&(d.variableObjects.forEach(function(a){b.variableProvider.addVariable(a)}),d.scriptObjects.forEach(function(a){b.variableProvider.addScriptVariable(a)}))})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/VariableScriptCollector":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","../variables/VariableUtil"],function(k,h){var e={getObjects:function(g,c){c=e._getVariableInfo(g,c);g=e._getScriptObjects(g,
c.fieldNameToVariableCache);return{variables:c.variables,variableObjects:c.variableObjects,scriptObjects:g}},_getVariableInfo:function(e,c){var b=[];k.queryJson(e,c?/^(RawFields|Fields)$/:"Fields").forEach(function(a){b=b.concat(k.queryJson(a,/^(Field|PortalField)$/))});var a=[],f=[],d={};b.forEach(function(b){a.push(b.attributes.MapTo);if(b=h.fieldTagToVariable(b,e.attributes.Name))d[b.fieldName]=b,f.push(b)});return{variables:a,variableObjects:f,fieldNameToVariableCache:d}},_getScriptObjects:function(e,
c){var b=k.queryJson(e,"CalculatedFields")[0];return(b&&k.queryJson(b,"Script")||[]).map(function(a){var b=h.scriptTagToVariable(a,e.attributes.Name);b.usedFields&&(b.usedMapTos=[],b.usedFields.forEach(function(a){var d=c[a];d?d.usedMapTos?b.usedMapTos=b.usedMapTos.concat(d.usedMapTos):b.usedMapTos.push(d.fullName):console.log("Error parsing used fields for "+a)}),c[b.fieldName]=b);return b})}};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/variables/VariableUtil":function(){define([],
function(){var k={getType:function(h){return h&&(0===h.indexOf("esriFieldType")?h:"esriFieldType"+h)},fieldTagToVariable:function(h,e){return h.attributes.MapTo&&"AREA_ID"!==h.attributes.Name?{id:h.attributes.MapTo.substr(h.attributes.MapTo.lastIndexOf(".")+1),fullName:h.attributes.MapTo,alias:h.attributes.Alias,fieldName:h.attributes.Name,precision:Number(h.attributes.Decimals)||0,calculatorName:e,templateName:e+"."+h.attributes.Name,type:k.getType(h.attributes.Type)}:null},scriptTagToVariable:function(h,
e){return{id:h.attributes.Name,fullName:e+"."+h.attributes.Name,fieldName:h.attributes.Name,alias:h.attributes.Alias,precision:Number(h.attributes.Decimals)||0,usedFields:h.attributes.usedFields?h.attributes.usedFields.split(","):[],usedMapTos:null,expressionText:h.tags[0].text,calculatorName:e,templateName:e+"."+h.attributes.Name,type:k.getType(h.attributes.Type)}}};return k})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/LocatorCalculatorsParser":function(){define(["esri/dijit/geoenrichment/promise/all",
"esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/utils/JsonXmlConverter","../variables/VariableUtil"],function(k,h,e,g){return{parseLocatorCalculators:function(c,b,a){c=e.queryJson(c,"Locator");return k(c.map(function(c){var d=[];e.queryJson(c,/^(PointFields|Fields)$/).forEach(function(a){d=d.concat(e.queryJson(a,/^(Field|Direction|Distance)$/))});var f=[];d.forEach(function(a){"Direction"===a.name?a.attributes.MapTo="DIRECTION":"Distance"===a.name&&(a.attributes.MapTo="DISTANCE");(a=g.fieldTagToVariable(a,
c.attributes.Name))&&f.push(a)});var m={calculatorName:c.attributes.Name,variableObjects:f,layerID:null,layerUrl:null,layerName:c.attributes.LayerName};c.attributes.Points&&0===c.attributes.Points.indexOf("std:")?m.layerID=c.attributes.Points.replace("std:",""):m.layerUrl=c.attributes.Layer;b.metadata.locatorCalculatorsHash[c.attributes.Name]=m;a.variableProvider.isPlayerOnly&&f.forEach(function(b){a.variableProvider.addVariable(b)});return h(!a.validateLocatorCalculator||a.validateLocatorCalculator(m.layerID,
m.layerUrl),function(a){m.isValid=a})}))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MapCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./MetadataToRendererParser","esri/dijit/geoenrichment/utils/ImageUtil"],function(k,h,e){var g={},c={tagToColor:function(b){if(!b)return null;b=b.attributes;return[Number(b.Red),Number(b.Green),Number(b.Blue),void 0===b.Transparency?255:255*(1-Number(b.Transparency)/100)]}};g.parseMapCalculators=
function(b,a,f){k.queryJson(b,"Maps").forEach(function(b){k.queryJson(b,"Map").forEach(function(d){var g=k.queryJson(d,/^(|Layer|LocatorResultsLayer|ComparisonResultsLayer)$/),l=g.filter(function(a){return!!a.attributes.PortalItemId}),g=g.filter(function(a){return!!a.attributes.ServiceUrl||"LocatorResultsLayer"===a.name||"ComparisonResultsLayer"===a.name}),p;1<l.length&&(p=l.shift());var l=l.shift(),n=[];g.forEach(function(b){if(b.attributes.ServiceUrl)n.push({url:b.attributes.ServiceUrl});else if("LocatorResultsLayer"===
b.name){var c=b.tags&&b.tags.filter(function(a){return"Renderer"===a.name})[0],d=a.metadata.locatorCalculatorsHash[b.attributes.CalculatorName];d.isValid&&n.push({isLocatorLayer:!0,layerName:b.attributes.LayerName,calculatorName:b.attributes.CalculatorName,calculatorInfo:d,rendererJson:c&&h.parseRendererJson(c)})}else"ComparisonResultsLayer"===b.name&&((c=(c=b.tags&&b.tags.filter(function(a){return"Renderer"===a.name})[0])&&h.parseRendererJson(c))&&"esriTS"===c.uniqueValueInfos[0].symbol.type?n[n.length-
1].labelRendererJson=c:n.push({isComparisonLayer:!0,calculatorName:b.attributes.CalculatorName,rendererJson:c,labelRendererJson:null}))});var v;if(g=k.queryJson(d,"SiteLayer")[0])if((g=k.queryJson(g,"Symbol")[0])&&"Image"===g.attributes.Type){var r=f.getImageData(g.attributes.Name);r&&(v={type:"esriPMS",contentType:e.getContentType(r),imageData:e.base64DataFromDataURL(r),url:g.attributes.Url,width:Number(g.attributes.Width),height:Number(g.attributes.Height),angle:Number(g.attributes.Angle)||0,xoffset:Number(g.attributes.XOffset)||
0,yoffset:Number(g.attributes.YOffset)||0})}else if(g&&"Marker"===g.attributes.Type){v=(v=k.queryJson(g,"Fill")[0])&&k.queryJson(v,"Color")[0];var u=(r=k.queryJson(g,"Outline")[0])&&k.queryJson(r,"Color")[0];v={type:"esriSMS",style:"esriSMS"+(g.attributes.Style||"Circle"),size:Number(g.attributes.Size),angle:Number(g.attributes.Angle)||0,xoffset:Number(g.attributes.XOffset)||0,yoffset:Number(g.attributes.YOffset)||0,color:c.tagToColor(v),outline:r&&{type:"esriSLS",color:c.tagToColor(u),style:"esriSLS"+
(r.attributes.Style||"Solid"),width:void 0===r.attributes.Width?1:Number(r.attributes.Width)}}}p={fieldName:d.attributes.Name,defaultBasemapId:p&&p.attributes.PortalItemId,webMapId:l&&l.attributes.PortalItemId,additionalLayerInfos:n.length&&n,pinSymbolJson:v,mapScale:Number(d.attributes.Scale)||null};a&&(a.metadata.mapImageInfosHash[b.attributes.Name+"."+d.attributes.Name]=p)})})};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MetadataToRendererParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlTypedConverter",
"esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(k,h){return{parseRendererJson:function(e){return k.parseXml(h.parseJson(e))}}})},"esri/dijit/geoenrichment/utils/JsonXmlTypedConverter":function(){define(["dojo/_base/declare","./RegExpUtil"],function(k,h){var e=k(null,{parseJson:function(e,c){function b(b,c){g+="\x3c"+c+' type\x3d"object"\x3e';for(var d in b)a(b[d],d);g+="\x3c/"+c+"\x3e"}function a(a,c){"string"===typeof a?g+="\x3c"+c+' type\x3d"string"\x3e'+h.encodeXML(a,!1)+"\x3c/"+c+
"\x3e":"number"===typeof a?g+="\x3c"+c+' type\x3d"number"\x3e'+a+"\x3c/"+c+"\x3e":"boolean"===typeof a?g+="\x3c"+c+' type\x3d"boolean"\x3e'+a+"\x3c/"+c+"\x3e":Array.isArray(a)?f(a,c):a&&"object"===typeof a&&b(a,c)}function f(b,c){g+="\x3c"+c+' type\x3d"array"\x3e';b.forEach(function(b){a(b,"item")});g+="\x3c/"+c+"\x3e"}var d=c&&c.rootName||"root",g="";c&&c.addDocumentOptions&&(g+='\x3c?xml version\x3d"1.0" encoding\x3d"utf-8"?\x3e');b(e,d);return g=decodeURIComponent(encodeURIComponent(g).replace("%19",
""))},parseXml:function(e){function c(a,c){if(c.childNodes)for(var d=0,f=c.childNodes.length;d<f;d++){var e=c.childNodes[d],g=b(e);void 0!==g&&(a[e.nodeName]=g)}return a}function b(a){var d;a:{if(a.attributes)for(d=0;d<a.attributes.length;d++){var f=a.attributes[d];if("type"===f.name){d=f.value;break a}}d=null}if(a.nodeName&&d)switch(d){case "string":return a.childNodes[0]?h.decodeXML(a.childNodes[0].nodeValue):"";case "number":return Number(a.childNodes[0].nodeValue);case "boolean":return"true"===
a.childNodes[0].nodeValue;case "object":return c({},a);case "array":d=[];if(a.childNodes)for(var f=0,e=a.childNodes.length;f<e;f++)d[f]=b(a.childNodes[f]);return d}}var a={},f;e=(new DOMParser).parseFromString(e,"text/xml").childNodes;for(var d=0;d<e.length;d++)if(1===e[d].nodeType){f=e[d];break}f&&c(a,f);return a}});k=e();k.runTest=function(){console.log("------------------------------Testing JsonXmlTypedConverter.js------------------------------");var g={type:"uniqueValue",field1:"SubtypeCD",fieldDelimiter:", ",
defaultSymbol:{type:"esriSLS",style:"esriSLSSolid",color:[130,130,130,255],width:1},defaultLabel:"\x3cOther values\x3e",uniqueValueInfos:[{value:"1",label:"Duct Bank",description:"Duct Bank description",symbol:{type:"esriSLS",style:"esriSLSDash",color:[76,0,163,255],width:1}},{value:"2",label:"Trench",description:"Trench description",symbol:{type:"esriSLS",style:"esriSLSDot",color:[115,76,0,255],width:1}}],rotationType:"geographic",rotationExpression:"[Rotation] * 2"},c=new e,g=JSON.parse(JSON.stringify(g));
console.log(JSON.stringify(g,void 0,4));var b=c.parseJson(g);console.log(b);var a=c.parseXml(b);console.log(JSON.stringify(a,void 0,4));c=c.parseJson(a);console.log(c);console.log("Compare JSON1 and JSON2: "+(JSON.stringify(g)===JSON.stringify(a)));console.log("Compare XML1 and XML2: "+(b===c));console.log("------------------------------Testing JsonXmlTypedConverter.js------------------------------")};return k})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/TradeAreaCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter",
"./VariableScriptCollector"],function(k,h){return{parseTradeAreaCalculators:function(e,g){k.queryJson(e,"SpecialTradeAreaFields").forEach(function(c){g.variableProvider.isPlayerOnly&&h.getObjects(c,!0).variableObjects.forEach(function(b){g.variableProvider.addVariable(b)})})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/ImageCollector":function(){define(["esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/utils/DataUtil",
"esri/dijit/geoenrichment/utils/ImageUtil","esri/dijit/geoenrichment/utils/ImageInfoUtil"],function(k,h,e,g,c){return{collectImageResources:function(b,a,f){function d(b){return k(c.getImageInfo(a[b],b),null,function(){delete a[b]})}b&&b.files&&b.files.forEach(function(b){var c=e.getContentType(b.name);c&&"image/"===c.substr(0,6)&&(a[f(b.name)]=g.base64DataToDataURL(b.data,c))});b=[];for(var n in a)b.push(d(n));return h(b)}}})},"esri/dijit/geoenrichment/utils/ImageInfoUtil":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/when","./ImageUtil","./UrlUtil"],function(k,h,e,g){var c={_infoCache:{},getImageInfo:function(b,a,f){var d=f&&f.sizeLimit||1E5;c._infoCache[b]||(c._infoCache[b]=e.imageFromUrl(b).then(function(a){var d=e.imageToDataURL(a),f={dataUrl:d,contentType:e.getContentType(d),width:a.width,height:a.height};setTimeout(function(){c._infoCache[b]=f});return f}));return h(c._infoCache[b],function(b){b=k.mixin({},b);a&&(b.filename=a&&a.replace(/\.\w+$/,".png").toLowerCase());return function(a){return h(c._processDataUrl(a,
d),function(b){if(b&&b.dataUrl){var c=k.mixin({},a);c.dataUrl=b.dataUrl;c.width*=b.factor;c.height*=b.factor;return h(c)}return h(a)})}(b)})},getRemoteImageDataUrl:function(b,a){function f(a){var d=b;a&&(a=g.getProxyUrl())&&(d=a+"?"+d);return c.getImageInfo(d)}function d(a){return h(c._processDataUrl(a,e),function(a){return a&&a.dataUrl||a})}var e=a&&a.sizeLimit||1E5;return h(f(!1),function(a){return d(a)},function(){return h(f(!0),function(a){return d(a)},function(){return b})})},_processDataUrl:function(b,
a){var c=Math.max(b.width,b.height);if(c<=a)return b.dataUrl;var d=a/c;return h(e.scaleImage(b.dataUrl,{factor:d}),function(a){return{dataUrl:a,factor:d}})}};return c})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/Parsers":function(){define(["esri/dijit/geoenrichment/Deferred","require"],function(k,h){var e={},g={},c;e.initialize=function(){if(c)return c.promise;c=new k;h("./DocumentParser ./ChartConverterPtoE ./InfographicConverterPtoE ./SectionParser ./FieldParser ./FilterParser ../../../supportClasses/templateJsonUtils/fieldInfo/utils".split(" "),
function(b,a,f,d,e,h,l){g.document=b;g.chart=a;g.infographic=f;g.section=d;g.field=e;g.filter=h;l.init().then(c.resolve)});return c.promise};e.getParser=function(b){return g[b]};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/variables/PlayerVariableProvider":function(){define(["dojo/_base/declare","dojo/_base/lang","esri/dijit/geoenrichment/when","dojo/string","../../../../dataProvider/supportClasses/dataCollections/DataCollectionsLoader"],function(k,h,e,g,
c){var b=k(null,{variable:null,constructor:function(a){this.variable=a},calculate:function(a){return 0},getCalcType:function(){return"n/"},getAliasWithType:function(){return this.variable.alias},getDescriptionWithType:function(){return this.variable.alias},getDecimals:function(){return this.variable.precision||0}});return k(null,{isPlayerOnly:!0,_fieldNameToVariableCache:null,_templateNameToVariableCache:null,_variableIdToVintageCache:null,_variableIdToSourceCache:null,constructor:function(a){this._templateNameToVariableCache=
a&&a.templateNameToVariableCache||{};this._fieldNameToVariableCache={};for(var b in this._templateNameToVariableCache){var c=this._templateNameToVariableCache[b];this._fieldNameToVariableCache[c.fieldName]=c}this._variableIdToVintageCache=a&&a.variableIdToVintageCache;this._variableIdToSourceCache=a&&a.variableIdToSourceCache},get:function(a){return this._templateNameToVariableCache[a]||this._fieldNameToVariableCache[a]},toCalculator:function(a){return(a=this.get(a))&&new b(a)},addVariable:function(a){this._fieldNameToVariableCache[a.fieldName]=
a;this._templateNameToVariableCache[a.templateName]=a},addScriptVariable:function(a){this._fieldNameToVariableCache[a.fieldName]=a;this._templateNameToVariableCache[a.templateName]=a},getVariables:function(){return Object.keys(this._fieldNameToVariableCache).map(function(a){return this._fieldNameToVariableCache[a]},this)},getVariablesDataVintageDescription:function(a){var b=this;return e(this.tryFetchDataVintageInfo(a),function(c){if(!c)return null;c={};var d={},f;for(f in a.usedVariablesCache){f=
f.toLowerCase();var e=b._variableIdToVintageCache[f];e&&(d[e]=1);(e=b._variableIdToSourceCache[f])&&(c[e]=1)}if(!Object.keys(c).length&&!Object.keys(d).length)return null;f=[];Object.keys(c).length&&f.push(g.substitute("This infographic contains data provided by ${source}.",{source:Object.keys(c).join(", ")}));Object.keys(d).length&&f.push(g.substitute("The vintage of the data is ${vintage}.",{vintage:Object.keys(d).join(", ")}));return f.join(" ")})},getVariableVintage:function(a){return this._variableIdToVintageCache&&
this._variableIdToVintageCache[a.toLowerCase()]},tryFetchDataVintageInfo:function(a,b){var d=this;return this._variableIdToVintageCache?(b&&this._trimDataVintageInfoCaches(b),!0):c.canLoad()?e(c.loadVariables({countryID:a.countryID,hierarchy:a.hierarchy,outFields:["vintage","filteringTags"],forceLowerCase:!0}),function(a){function c(a){var b;a.filteringTags&&a.filteringTags.some(function(a){if("Source"===a.name)return b=a.value,!0});return b}d._variableIdToVintageCache={};d._variableIdToSourceCache=
{};var f=a.fullNameToVariableCache,e;for(e in f){var g=f[e];g.vintage&&(d._variableIdToVintageCache[e]=g.vintage);(g=c(g))&&(d._variableIdToSourceCache[e]=g)}a.dataCollections.forEach(function(a){var b=a.data[0];b&&(a=a.dataCollectionID+".*",a=a.toLowerCase(),b.vintage&&(d._variableIdToVintageCache[a]=b.vintage),(b=c(b))&&(d._variableIdToSourceCache[a]=b))});b&&d._trimDataVintageInfoCaches(b);return!0}):!1},_trimDataVintageInfoCaches:function(a){var b={},c={},e;for(e in a)e=e.toLowerCase(),(a=this._variableIdToVintageCache[e])&&
(b[e]=a),(a=this._variableIdToSourceCache[e])&&(c[e]=a);this._variableIdToVintageCache=b;this._variableIdToSourceCache=c},toJson:function(){return{templateNameToVariableCache:h.clone(this._templateNameToVariableCache),variableIdToVintageCache:this._variableIdToVintageCache&&h.clone(this._variableIdToVintageCache),variableIdToSourceCache:this._variableIdToSourceCache&&h.clone(this._variableIdToSourceCache)}}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DefaultStyles":function(){define(["dojo/_base/declare",
"dojo/_base/lang","esri/dijit/geoenrichment/utils/ColorUtil"],function(k,h,e){return k(null,{_styles:null,_stylesArray:null,constructor:function(e){this._styles={Default:{color:"#4C4C4C",backgroundColor:"#FFFFFF"}};h.mixin(this._styles,e);this._stylesArray=[];for(var c in this._styles)this._stylesArray.push(c)},getStyle:function(e){return this._styles[e]},getStylesArray:function(){return this._stylesArray},tryApplyStyle:function(e,c,b){if(c=this.getStyle(c))for(var a in c)b&&void 0!==e[a]||(e[a]=
c[a])},findDefaultStyle:function(g){var c,b=this;this.getStylesArray().some(function(a){var f=b.getStyle(a),d;for(d in f){if(!g[d])return!1;if("color"===d||"backgroundColor"===d){if(!e.colorsEqual(g[d],f[d]))return!1}else if(g[d]!==f[d])return!1}c=a;return!0});return c}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/images/ImageDataHolder":function(){define([],function(){var k={},h={};k.putImageData=function(e,g){"string"===typeof e&&(h[e.toLowerCase()]=g)};k.getImageData=function(e){return"string"!==
typeof e?null:h[e.toLowerCase()]};return k})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/conversion/CssParser":function(){define(["../PageBorderStyles","../ThemeUpdateUtil","../../../_devConfig"],function(k,h,e){var g={"font-size":"fontSize","font-family":"fontFamily","font-style":"fontStyle","font-weight":"fontWeight","text-decoration":"textDecoration",color:"color","background-color":"backgroundColor",opacity:"opacity",url:"data","background-position":"position","background-repeat":"repeat",
"background-size":"scale"},c={colors:1,colors3series:1};return{fromCssText:function(b){function a(a){var b=m;a.split("@").forEach(function(a){b=b[a]=b[a]||{}});return b}function f(a,b){if(b.borderStyle||b.border)if(a.border={},a.border.style=k.toSupportedValue(b.borderStyle),"string"===typeof b.border){var c=b.border.split(" ");3===c.length&&(a.border.thickness=Number(c[0].replace("px","")),a.border.lineStyle=c[1],a.border.color=c[2])}for(var e in b)if("border"!==e&&"borderStyle"!==e){var c=b[e],
f;f=e;var h=c,l=a;"font-size"===f?(l[g[f]]=d(h.replace("px","")),f=!0):"background-repeat"===f?(l[g[f]]=d("repeat"===h),f=!0):"background-size"===f?(l[g[f]]=d("contain"===h||"cover"===h),l.size="auto"===h?null:h,f=!0):f=!1;f||(a[g[e]||e]=d(c))}}function d(a){if(void 0===a||null===a||"null"===a||"undefined"===a)return"";if("true"===a)return!0;if("false"===a)return!1;if(!0===a)return!0;if(!1===a)return!1;var b=Number(a);return isNaN(b)?a:b}function n(a){if(e.emulateErrors.themeParseError)throw Error("Error test: something crashed during the parsing of the theme!");
if("object"===typeof a)for(var b in a){var d=a[b];if(c[b]){var f=[],g=Object.keys(d);if(g.length){var h=g.every(function(a){return-1!==a.indexOf("_")});g.forEach(function(a,b){f[h?a.split("_")[1]:b]=d[a]})}a[b]=f}else n(d)}}var m={};b=b.replace(/\n/g,"");b=b.replace(/(\w|\d)_(\w|\d)/g,"$1@$2");b=b.replace("data:","dataM");b=b.replace(";base64","Mbase64");var l=function(){var a={};(b.match(/\..*?\}/g)||[]).forEach(function(b){var c=b.substring(1,b.indexOf("{")).trim(),d={};b.substring(b.indexOf("{")+
1,b.indexOf("}")).trim().split(";").forEach(function(a){if(a=a.trim()){a=a.split(":");var b=a[1].trim(),b=b.replace("dataM","data:"),b=b.replace("Mbase64",";base64");d[a[0].trim()]=b}});a[c]=d});return a}(),p;for(p in l)f(a(p),l[p]);delete m.themeMetadata;n(m);h.populateMissingStyles(m);return m}}})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeUpdateUtil":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/utils/ObjectUtil","./ThemeLibrary","./ThemeUtil"],function(k,h,e,g){return{populateMissingStyles:function(c){if(c){c.table.overrideStyles||
(c.table={overrideStyles:k.mixin({},c.table)});c.icon||(c.icon=k.clone(c.infographic.staticInfographic.icon),c.highlightedIcon=k.clone(c.infographic.staticInfographic.highlightedIcon));c.chart.icon||(c.chart.icon=k.clone(c.infographic.staticInfographic.icon));c.chart.xAxis.lineColor||(c.chart.xAxis.lineColor=c.chart.xAxis.axisStyle.color,c.chart.yAxis.lineColor=c.chart.yAxis.axisStyle.color);var b=g.getThemeColors(c),a=c.chart.colors.slice(),f=c.chart.colors3series&&c.chart.colors3series.slice(),
d=e.getDefaultTheme({defaultFontFamilty:c.document.fontFamily,defaultFontSize:c.document.fontSize});g.applyThemeColorsToTheme({theme:d,colors:b,chartColors:a,colors3series:f});h.populateObject(c,d,!1)}}}})},"esri/dijit/geoenrichment/utils/async/AsyncQueue":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when dijit/Destroyable ../DelayUtil".split(" "),function(k,h,e,g,c,b){var a=k(c,{_lastPromise:null,_isFinished:!1,_isDestroyed:!1,_lastDfd:null,
_lastResult:null,constructor:function(a){h.mixin(this,a)},add:function(a,c){c=c||{};var d=this;if(!this._isDestroyed){this._lastDfd||(this.onStarted(),this._lastDfd=new e);this._isFinished=!1;var f=function(){var f=function(){if(!d._isDestroyed)try{return"function"===typeof a?a():a}catch(v){return(new e).reject(v)}},h=0<=c.delayBefore?function(){return b.delay(f,c.delayBefore)}:f;return(0<=c.delayAfter?function(){return g(h(),function(a){return b.delay(function(){return a},c.delayAfter)})}:h)()};
!this._lastPromise||this._lastPromise.isFulfilled()?this._lastPromise=g(f()):this._lastPromise=g(this._lastPromise).then(f);var h=this._lastPromise;g(h,function(a){h!==d._lastPromise||d._isDestroyed||d._isFinished||h&&!h.isFulfilled()||(d._isFinished=!0,d._lastDfd.resolve(a),d._lastResult=a,d._lastDfd=null,d.onFinished(a))},this._lastDfd.reject);return this.getPromise()}},getPromise:function(){return this._isDestroyed?null:this._lastDfd&&this._lastDfd.promise||this._lastResult},isFinished:function(){return this._isFinished},
isDestroyed:function(){return this._isDestroyed},destroy:function(){this._isDestroyed=!0},onStarted:function(){},onFinished:function(a){}});a.executeFunctions=function(b,c,e){e=e||{};var d=new a,f=[];b.forEach(function(a,b){d.add(function(){return g(a(),function(a){f.push(a);return a})},{delayBefore:0===b?void 0:c})});e.onQueueReady&&e.onQueueReady(d);return g(d.getPromise(),function(a){return e.collectResults?f:a})};a.processArrayInBatches=function(a,b){function c(){if(a.length){for(var e=[],f=0;f<
b.batchSize&&a.length;f++)e.push(a.shift());e.forEach(b.callback);setTimeout(c,b.timeout||0)}else d.resolve()}a=a.slice();var d=new e;c();return d.promise};return a})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/TemplateJsonLoader":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all ./CustomReportsManager ./GenericTemplateGenerator ./dataCollections/DataCollectionsLoader ../../core/conversion/PortalToEditorConverter ../../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../../core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil ../../core/conversion/portalToEditorUtils/parsers/_FieldInfoBuilder".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l){var p={_templatesCache:{},getCachedTemplateJson:function(a,b){return(a=this._templatesCache[a+";"+b.reportID])&&a.modified===b.modified?{templateJson:k.clone(a.templateJsonInfo.templateJson),templateVariableProvider:a.templateJsonInfo.templateVariableProvider}:null},putCachedTemplateJson:function(a,b,c){this._templatesCache[a+";"+c.reportID]={modified:c.modified,templateJsonInfo:{templateJson:k.clone(b.templateJson),templateVariableProvider:b.templateVariableProvider}}}};
return{getTemplateJsonByID:function(b,l){var k=this,m=new h;e(c.getCustomReportByID(b),function(c){if(c){var h=l&&p.getCachedTemplateJson(b.countryID,c);if(h)m.resolve(h);else{var h=[k._loadCustomReportData(c)],q;"US"!==b.countryID&&"CA"!==b.countryID&&(q=!0,h.push(a.loadVariables({countryID:b.countryID,hierarchy:c.hierarchy,outFields:["description"]})));return g(h).then(function(a){var g=new d;return e(f.provideEditorJson(c,{variableProvider:g}),function(){var d=c.templateJson;if(q){var e=a[1].idToVariableCache,
f=a[1].fullNameToVariableCache;n.processTemplateFieldInfos(d,function(a){if(a.hasVariable&&a.variableID){var b=f[a.fullName]||e[a.variableID];a.alias=b&&b.description||a.alias;b&&b.description||console.log("Can't find variable with ID: "+a.variableID)}})}c.portalJson=null;c.templateJson=null;d={templateJson:d,templateVariableProvider:g};l&&p.putCachedTemplateJson(b.countryID,d,c);m.resolve(d)})})}}else m.reject("Can't find a report")},m.reject);return m.promise},_loadCustomReportData:function(a){a.portalJson=
null;return a.templateData.getFiles().then(function(b){a.portalJson={files:b}})},createTemplateJsonFromVariables:function(c){return a.loadVariables({countryID:c.countryID,outFields:["description","precision","type","vintage"],forceLowerCase:!0}).then(function(a){var e=new d,f=a.fullNameToVariableCache;a=c.variables.fullNames.map(function(a){var b=m.createFieldNameFromVariable(a),d=c.variables.customDataMapping[a],d=d?d.variable:f[a];a={id:d.id.toLowerCase(),fullName:a,alias:d.description,fieldName:b,
precision:d.precision,calculatorName:m.DATA_COLLECTIONS_CALCULATOR_NAME,templateName:m.DATA_COLLECTIONS_CALCULATOR_NAME+"."+b,type:d.type,vintage:d.vintage};e.addVariable(a);return l.getCalculatorOrScriptFieldInfo(a.templateName,{variableProvider:e})});return{templateJson:b.generateTemplatesFromFieldInfos(a,{comparisonLevels:c.comparisonLevels}),templateVariableProvider:e}})}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/GenericTemplateGenerator":function(){define("../../core/supportClasses/templateJsonUtils/BlankTemplateJsonUtil ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder ../../core/supportClasses/tableJson/TableJsonUtil ../../core/sections/sectionUtils/SectionJsonUtil ../../core/infographics/InfographicTypes ../../core/infographics/utils/InfographicJsonUtil".split(" "),
function(k,h,e,g,c,b){var a={},f={calcNumRowsColumns:function(a){var b;b=2>=a?1:6>=a?2:12>=a?3:Math.ceil(a/4);var c;c=1===a?1:4>=a?2:9>=a?3:4;return{numRows:b,numColumns:c,numVarsInLastRow:c-(b*c-a),lastRowCellIndexes:null,lastRowCellWidths:null}}},d={mergeLastRow:function(a,b,c){2===b.numColumns?1===b.numVarsInLastRow&&(e.modifyTableJson(a,b.numRows-1,0,{columnSpan:2}),b.lastRowCellWidths=[2*c]):3===b.numColumns?1===b.numVarsInLastRow?(e.modifyTableJson(a,b.numRows-1,0,{columnSpan:3}),b.lastRowCellWidths=
[3*c]):2===b.numVarsInLastRow&&(e.modifyTableJson(a,b.numRows-1,0,{cellStyle:{width:1.5*c}}),e.modifyTableJson(a,b.numRows-1,1,{columnSpan:2,cellStyle:{width:.5*c}}),b.lastRowCellWidths=[1.5*c,1.5*c]):4===b.numColumns&&(1===b.numVarsInLastRow?(e.modifyTableJson(a,b.numRows-1,0,{columnSpan:4}),b.lastRowCellWidths=[4*c]):2===b.numVarsInLastRow?(e.modifyTableJson(a,b.numRows-1,0,{columnSpan:2}),e.modifyTableJson(a,b.numRows-1,2,{columnSpan:2}),b.lastRowCellIndexes=[0,2],b.lastRowCellWidths=[2*c,2*c]):
3===b.numVarsInLastRow&&(e.modifyTableJson(a,b.numRows-1,0,{cellStyle:{width:4*c/3}}),e.modifyTableJson(a,b.numRows-1,1,{columnSpan:2,cellStyle:{width:2*c/3}}),e.modifyTableJson(a,b.numRows-1,2,{cellStyle:{width:2*c/3}}),e.modifyTableJson(a,b.numRows-1,3,{cellStyle:{width:4*c/3}}),b.lastRowCellIndexes=[0,1,3],b.lastRowCellWidths=[4*c/3,4*c/3,4*c/3]))}},n={insertNextPanel:function(a,b,c){void 0===b.currentRowIndex&&(b.currentRowIndex=0,b.currentColumnIndex=0);var d=b.currentRowIndex===b.numRows-1;
a.data.data[b.currentRowIndex].fieldInfos["field"+(d&&b.lastRowCellIndexes?b.lastRowCellIndexes[b.currentColumnIndex]:b.currentColumnIndex)]=c(d&&b.lastRowCellWidths&&b.lastRowCellWidths[b.currentColumnIndex]);b.currentColumnIndex++;b.currentColumnIndex>b.numColumns-1&&(b.currentColumnIndex=0,b.currentRowIndex++)}};a.generateTemplatesFromFieldInfos=function(b){var c=f.calcNumRowsColumns(b.length),m=k.createBlankTemplate({elementWidth:500,elementHeight:250,layout:{numRows:c.numRows,numColumns:c.numColumns}}),
q=m.sectionsTables[0];d.mergeLastRow(q,c,500);b.forEach(function(b){n.insertNextPanel(q,c,function(c){var d=a._createInfographicJson(b,c||500,250);c=e.createSingleCellTable({width:c||500,height:250,fieldInfo:h.createFieldInfoFromInfographic(d)});return h.createFieldInfoFromSection(g.wrapInDetailsSectionJson(c))})});return m};a._createInfographicJson=function(a,d,e){return{type:c.ONE_VAR,title:a.alias,style:{width:d,height:e},levels:b.getDefaultLevels(),fieldInfos:[a],calcData:{calculatorName:a.templateName.substr(0,
a.templateName.indexOf(".")),variables:[a.fullName]}}};return a})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/BlankTemplateJsonUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions","esri/dijit/geoenrichment/utils/PageUnitsConverter","./TemplateJsonModificationUtil"],function(k,h,e){return{createBlankTemplate:function(g){var c={},b=g.documentOptions||k.getDefaultDocumentOptionsGraphicReport(),a=b.top+b.bottom+g.layout.numRows*
g.elementHeight;b.pagesize=k.combineCustomSizeString(h.pxToIn(b.left+b.right+g.layout.numColumns*g.elementWidth),h.pxToIn(a));c.documentOptions=b;b={style:{width:g.layout.numColumns*g.elementWidth},data:{columns:[],data:[]}};for(a=0;a<g.layout.numColumns;a++)b.data.columns.push({field:"field"+a,style:{width:g.elementWidth}});for(a=0;a<g.layout.numRows;a++)b.data.data.push({style:{height:g.elementHeight},fieldInfos:{}});c.sectionsTables=[b];e.adjustDocumentOptions(c);return c}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/PageUnitsConverter","../themes/ThemeLibrary"],function(k,h,e){var g={},c={a:[[841,1189],[594,841],[420,594],[297,420],[210,297],[148,210],[105,148],[74,105],[52,74],[37,52],[26,37]],b:[[1E3,1414],[707,1E3],[500,707],[353,500],[250,353],[176,250],[125,176],[88,125],[62,88],[44,62],[31,44]],c:[[917,1297],[648,917],[458,648],[324,458],[229,324],[162,229],[114,162],[81,114],[57,81],[40,57],[28,40]],letter:[216,279],legal:[216,356],tabloid:[279,432],ledger:[432,279]};g.PAPER_SIZES=
c;var b={};"a3 a4 a5 b4 b5 c4 c5 letter legal tabloid ledger".split(" ").forEach(function(a){var e;e=2===a.length?c[a[0]][a[1]]:c[a];b[a]={portrait:{w:h.mmToIn(e[0]),h:h.mmToIn(e[1])},landscape:{w:h.mmToIn(e[1]),h:h.mmToIn(e[0])}}});g.SIZE_TYPE_TO_DIM_HASH=b;g.hasStandardSize=function(a){return b[a]};g.getSupportedPageSizes=function(){var a=[],b;for(b in c)1===b.length?c[b].forEach(function(c,e){a.push(b+e)}):a.push(b);return a};g.getPageDim=function(a,c,d){b[a]?a=b[a][c||"portrait"]:(a=a.split("x"),
a={w:h.ptToIn(Number(a[0])),h:h.ptToIn(Number(a[1]))});d&&(a=k.clone(a),h.roundNDigitsObj(a,d.places));return a};g.getPageBox=function(a){if(!a)return null;var b=g.getPageDim(a.pagesize,a.orientation),c=h.inToPx(b.w),b=h.inToPx(b.h);return{w:c,h:b,contentW:c-(a.left||0)-(a.right||0),contentH:b-(a.top||0)-(a.bottom||0)}};g.combineCustomSizeString=function(a,b){return h.inToPt(a)+"x"+h.inToPt(b)};g.getDefaultDocumentOptions=function(a){return k.mixin({pagesize:"letter",orientation:"portrait",left:21.07,
right:22.6,top:19.2,bottom:9.6,align:"left",lineSpacing:1.493,fontSize:10,fontFamily:e.DEFAULT_FONT_FAMILY_CLASSIC},a)};g.getDefaultDocumentOptionsGraphicReport=function(a){return k.mixin({pagesize:"letter",orientation:"landscape",left:21.07,right:22.6,top:19.2,bottom:9.6,align:"left",lineSpacing:1.493,fontSize:10,fontFamily:e.DEFAULT_FONT_FAMILY_GRAPHIC},a)};g.getClosestStandrdSizes=function(a,c){function d(a){var b=a.w/e.w;a=a.h/e.h;return Math.max(1-(1<b?1/b:b),1-(1<a?1/a:a))}c=void 0===c?.4:c;
var e=g.getPageDim(a.pagesize,a.orientation);a=[];for(var f in b){var h=b[f];a.push({pagesize:f,orientation:"portrait",score:d(h.portrait)});a.push({pagesize:f,orientation:"landscape",score:d(h.landscape)})}a=a.filter(function(a){return a.score<=c});a.sort(function(a,b){return a.score-b.score});return a};g.tryGetStandardPageSize=function(a,b){function c(a){var c="portrait"===b?1:0;return a["portrait"===b?0:1]===f&&a[c]===l}if(g.SIZE_TYPE_TO_DIM_HASH[a])return a;var e=a.split("x"),f=h.convert(Number(e[0]),
"pt","mm",0),l=h.convert(Number(e[1]),"pt","mm",0),k,q;for(q in g.PAPER_SIZES)if(e=g.PAPER_SIZES[q],1===q.length){if(e.some(function(a,b){if(c(a))return k=q+b,!0}))break}else if(c(e)){k=q;break}return k||a};return g})},"esri/dijit/geoenrichment/utils/PageUnitsConverter":function(){define(["dojo/_base/lang"],function(k){function h(c,b,a){a&&(c=k.mixin({},c));for(var e in c){var d=c[e];null!==d&&""!==d&&"boolean"!=typeof d&&("object"==typeof d?c[e]=h(d,b,a):(d=Number(d),isNaN(d)||(c[e]=b(d))))}return c}
var e={},g="px pt mm cm in twip".split(" ");g.forEach(function(c){g.forEach(function(b){if(c!==b){var a=c+"To"+b.charAt(0).toUpperCase()+b.substr(1);e[a]=function(a,d){return e.convert(a,c,b,void 0!==d?d:5)}}})});e.convert=function(c,b,a,f){c=Number(c)||0;switch(b){case "in":c*=72;break;case "px":c*=.75;break;case "mm":c=c/25.4*72;break;case "cm":c=c/2.54*72;break;case "twip":c/=20}switch(a){case "in":c/=72;break;case "px":c/=.75;break;case "mm":c=c/72*25.4;break;case "cm":c=c/72*2.54;break;case "twip":c=
Math.round(20*c)}void 0!==f&&(c=e.roundNDigits(c,f));return c};e.pxToPtObj=function(c,b){return h(c,e.pxToPt,b)};e.ptToPxObj=function(c,b){return h(c,e.ptToPx,b)};e.roundNDigits=function(c,b){return Number(Number(c).toFixed(b))};e.roundNDigitsObj=function(c,b){for(var a in c){var f=c[a];"object"==typeof f?e.roundNDigitsObj(f,b):c[a]=e.roundNDigits(f,b)}};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/TemplateJsonModificationUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions",
"esri/dijit/geoenrichment/utils/PageUnitsConverter","esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridLayoutCalculator"],function(k,h,e){var g={},c={getJsonStat:function(a){var c=0,d=0,e=[];a.sectionsTables.forEach(function(a){var f=0;a.data.columns.forEach(function(c){f+=b.getFieldWidth(a,a.data.data[0],c)});c=Math.max(c,f);var g=0;a.data.data.forEach(function(c){g+=b.getDataHeight(a,c,a.data.columns[0])});d=Math.max(d,g);e.push({totalW:f,totalH:g})});return{tableInfos:e,totalWMax:c,
totalHMax:d}}},b={getFieldWidth:function(a,b,c){return e.getFieldWidth({looseResize:!0},b,c)||c.style.width},getDataHeight:function(a,b,c){return e.getDataHeight({looseResize:!0},b,c.field)},getAverageFieldWidth:function(a,c){var d=0;a.data.data.forEach(function(e){d+=b.getFieldWidth(a,e,c)});return d/a.data.data.length},getAverageDataHeight:function(a,c){var d=0;a.data.columns.forEach(function(e){d+=b.getDataHeight(a,c,e)});return d/a.data.columns.length}};g.adjustDocumentOptions=function(a){if(a.documentOptions){var b=
c.getJsonStat(a);if(b.totalWMax&&b.totalHMax&&!isNaN(b.totalWMax)&&!isNaN(b.totalHMax)){a=a.documentOptions;var d=a.top+a.bottom+b.totalHMax;a.pagesize=k.combineCustomSizeString(h.pxToIn(a.left+a.right+b.totalWMax),h.pxToIn(d));(b=k.getClosestStandrdSizes(a)[0])&&.001>b.score&&b.orientation===a.orientation&&(a.pagesize=b.pagesize)}}};g.JsonStatCollector=c;g.DataUtil=b;return g})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridLayoutCalculator":function(){define("dojo/_base/lang ./gridLayoutCalcUtils/GridLayoutCalculatorQueryUtil ./gridLayoutCalcUtils/GridElementBoxCalculator ./gridLayoutCalcUtils/GridCellNodePlacer ./gridLayoutCalcUtils/rows/GridLayoutRowsCalculator ./gridLayoutCalcUtils/columns/GridLayoutColumnsCalculator ./gridLayoutCalcUtils/GridLayoutSnapper ../../supportClasses/tableJson/TableJsonUtil".split(" "),
function(k,h,e,g,c,b,a,f){var d={};e.calculator=d;d.markAsDirty=h.markAsDirty;d.fieldToColumn=h.fieldToColumn;d.dataIdToData=h.dataIdToData;d.getSpannedColumns=h.getSpannedColumns;d.recalcRows=c.recalcRows;d.recalcColumns=b.recalcColumns;d.recalcColumnsTableJson=b.recalcColumnsTableJson;d.recalcRowsToFitHeight=c.recalcRowsToFitHeight;d.adjustColumnWidth=b.adjustColumnWidth;d.getAffectedCellsForColumnAdjust=b.getAffectedCells;d.adjustRowHeight=c.adjustRowHeight;d.getAffectedCellsForRowAdjust=c.getAffectedCells;
d.recalcGridWidth=b.recalcGridWidth;d.calcFieldWidth=b.calcFieldWidth;d.getFieldWidth=b.getFieldWidth;d.setFieldWidth=b.setFieldWidth;d.calcDataHeight=c.calcDataHeight;d.getDataHeight=c.getDataHeight;d.setDataHeight=c.setDataHeight;d.autoSnapLayout=a.autoSnapLayout;d.positionCells=g.positionCells;d.calcFeatureCount=function(a,b,c){return(a-b)/c};d.calcRingIndexForCell=function(a){var b=a.parentGrid;if(!b)return-1;if(b.getNumDynamicRows())return void 0!==a.gridData.currentFeatureIndex?a.gridData.currentFeatureIndex:
a.gridData.index-b.getNumFixedRows();var c=b.getNumFixedColumns();return a.column.index<c?-1:Math.floor((a.column.index-c)/b.getNumDynamicColumns())};d.trimColumnsForNumberOfFeatures=function(a){for(var b=a.viewModel.dynamicReportInfo.fieldData.areaData.length,c=d.recalcGridWidth(a),e=0,f=0;f<a.getNumFixedColumns();f++)e+=a.columns[f].style.width;c-=e;e=d.calcFeatureCount(a.columns.length,a.getNumFixedColumns(),a.getNumDynamicColumns())-b;if(!(0>e)){for(var g=a.columns.slice(),f=g.length=a.getNumFixedColumns(),
h=[],k=0;a.columns[f];){for(var n=0;n<b;n++){var z=a.columns[f++],k=k+z.style.width;h.push(z)}f+=e}var w=c/k;h.forEach(function(a){a.style.width*=w});a.columns=g.concat(h)}};d.adjustRowsForNumberOfFeatures=function(a){var b=a.viewModel.dynamicReportInfo.fieldData.areaData.length;if(!(1>=b)){var c=a.store.data[a.getNumFixedRows()];c.currentFeatureIndex=0;for(var d=1;d<b;d++){var e=k.clone(c);e.currentFeatureIndex=d;a.store.data.push(e)}f.applyDefaultStyling({data:{data:a.store.data,columns:a.columns}})}};
return d})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridLayoutCalculatorQueryUtil":function(){define([],function(){var k={markAsDirty:function(h){h._fieldToColumnHash=null;h._dataIdToDataHash=null},_calcGridHashes:function(h){h._fieldToColumnHash={};h.columns.forEach(function(e){h._fieldToColumnHash[e.field]=e});h._dataIdToDataHash={};h.store.data.forEach(function(e){h._dataIdToDataHash[e.id]=e})},fieldToColumn:function(h,e){h._fieldToColumnHash||k._calcGridHashes(h);
return h._fieldToColumnHash&&h._fieldToColumnHash[e]},dataIdToData:function(h,e){h._dataIdToDataHash||k._calcGridHashes(h);return h._dataIdToDataHash&&h._dataIdToDataHash[e]},getSpannedColumns:function(h,e,g){var c=[];if(1>g)return[];var b;h.columns.some(function(a){if(b||a.field===e)c.push(a),b=!0;if(c.length===g)return!0});return c},getColumnSpannedFields:function(h,e,g){var c=null,b=e.fieldToRowSpanSourceDataIndex&&e.fieldToRowSpanSourceDataIndex[g];e=void 0!==b?h.store.data[b]:e;e=e.columnSpans&&
e.columnSpans[g];if(1<e)for(c=[],g=k.fieldToColumn(h,g),b=g=h.columns.indexOf(g);b<g+e;b++)c.push(h.columns[b].field);return c},getRowSpannedData:function(h,e,g){var c=null;g=e.fieldToColumnSpanSourceField&&e.fieldToColumnSpanSourceField[g]||g;g=e.rowSpans&&e.rowSpans[g];if(1<g)for(var c=[],b=e=h.store.data.indexOf(e);b<e+g;b++)c.push(h.store.data[b]);return c},getMovableData:function(h,e,g){return(e=e.movableIndexHashVertical&&e.movableIndexHashVertical[g])&&h.store.data[e]},getMovableColumn:function(h,
e,g){return(e=e.movableFieldsHashHorizontal&&e.movableFieldsHashHorizontal[g])&&k.fieldToColumn(h,e)}};return k})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridElementBoxCalculator":function(){define([],function(){function k(e,g,c,b,a){function f(a){return b&&void 0!==b.places?Number(a.toFixed(b.places)):a}if(!g||!c)return null;var d=h.calculator[a?"getFieldWidth":"calcFieldWidth"](e,g,c);a=h.calculator[a?"getDataHeight":"calcDataHeight"](e,g,c);for(var k=0,m=
0,l=h.calculator.fieldToColumn(e,c),p=0;p<l.index;p++)k+=h.calculator.getFieldWidth(e,g,e.columns[p].field);for(p=0;p<g.index;p++)m+=h.calculator.getDataHeight(e,e.store.data[p],c);return{x:f(k),y:f(m),w:f(d),h:f(a)}}var h={calculator:null,calcCellBox:function(e,g){return k(e.parentGrid,e.gridData,e.column.field,g,!1)},calcDataBox:function(e,g,c,b){return k(e,g,c,b,!0)}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridCellNodePlacer":function(){define(["./rows/GridLayoutRowsCalculator",
"./columns/GridLayoutColumnsCalculator"],function(k,h){return{positionCells:function(e){var g={},c={},b={},a={};if(e.store.data.length){e.store.data.forEach(function(d,f){e.columns.forEach(function(l,m){var p=b[m]||0,n=a[f]||0,q=k.getDataHeight(e,d,l.field);l=h.getFieldWidth(e,d,l.field);p+=q;n+=l;c[m+"_"+f]=p;g[m+"_"+f]=n;b[m]=p;a[f]=n})});e.getFieldCells().forEach(function(a){a.domNode.style.left=(g[a.column.index-1+"_"+a.gridData.index]||0)+"px";a.domNode.style.top=(c[a.column.index+"_"+(a.gridData.index-
1)]||0)+"px"});var f=0,d;for(d in b)f=Math.max(f,b[d]);var n=0;for(d in a)n=Math.max(n,a[d]);e.mainNode.style.width=n+"px";e.mainNode.style.height=f+"px";e.domNode.style.width=n+"px";e.domNode.style.height=f+"px";e._width=n;e._height=f}}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/GridLayoutRowsCalculator":function(){define(["./RowsProcessor","./RowsScaler","./RowDataUtil","./RowModifier"],function(k,h,e,g){var c={};c.recalcRows=k.recalcRows;c.recalcRowsToFitHeight=
h.recalcRowsToFitHeight;c.adjustRowHeight=g.adjustRowHeight;c.getAffectedCells=g.getAffectedCells;c.getDataHeight=e.getDataHeight;c.setDataHeight=e.setDataHeight;c.calcDataHeight=e.calcDataHeight;return c})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowsProcessor":function(){define(["dojox/uuid/generateRandomUuid","./RowDataUtil","../GridLayoutCalculatorQueryUtil"],function(k,h,e){function g(b,a){var c=[],d,g=0;a&&Object.keys(a).forEach(function(c){e.fieldToColumn(b,
c)?g++:delete a});g&&b.columns.some(function(b){if(d||a[b.field])c.push(b),d=!0;a[b.field]&&g--;if(!g)return!0});return c}function c(b,a){var c=[],d,g=0;a&&Object.keys(a).forEach(function(c){e.dataIdToData(b,c)?g++:delete a});g&&b.store.data.some(function(b){if(d||a[b.id])c.push(b),d=!0;a[b.id]&&g--;if(!g)return!0});return c}return{recalcRows:function(b){var a={};b.columns.forEach(function(b,c){a[b.field]=c});var f;b.store.data.forEach(function(c,d){c.index=d;c.style=c.style||{};c.style.fields=c.style.fields||
{};void 0===c.id&&(c.id=k());void 0===c.style.height&&(c.style.height=b.layoutDefaults.defaultRowHeight);delete c.excludedIndexHorizontal;delete c.movableFieldsHashHorizontal;delete c.fieldToColumnSpanSourceField;if(c.columnSpans){c.excludedIndexHorizontal={};c.movableFieldsHashHorizontal={};c.fieldToColumnSpanSourceField={};c._columnSpans=c._columnSpans||{};for(f in c.columnSpans){d=c._columnSpans[f];var h={};d=d?g(b,d):e.getSpannedColumns(b,f,c.columnSpans[f]);1<d.length&&(d.forEach(function(b){h[b.field]=
!0;b.field!==f&&(c.excludedIndexHorizontal[a[b.field]]=!0,c.fieldToColumnSpanSourceField[b.field]=f)}),c.movableFieldsHashHorizontal[f]=d[d.length-1].field);c.columnSpans[f]=d.length;c._columnSpans[f]=h}var l=0;Object.keys(c.columnSpans).forEach(function(a){2>c.columnSpans[a]?(delete c.columnSpans[a],delete c._columnSpans[a]):l++});l||(delete c.columnSpans,delete c._columnSpans)}delete c.excludedIndexVertical;delete c.movableIndexHashVertical;delete c.fieldToRowSpanSourceDataIndex;c.fieldInfos=c.fieldInfos||
{}});b.store.data.forEach(function(d,e){if(d.rowSpans)for(f in d._rowSpans=d._rowSpans||{},d.rowSpans){var g=d._rowSpans[f],h={};h[d.id]=!0;var k=a[f],l=d.rowSpans[f];if(g)g=c(b,g);else for(var g=[],m=e;m<e+l;m++)g.push(b.store.data[m]);1<g.length&&(g.forEach(function(a){if(a.id!==d.id){a.excludedIndexVertical=a.excludedIndexVertical||{};a.excludedIndexVertical[k]=!0;a.fieldToRowSpanSourceDataIndex=a.fieldToRowSpanSourceDataIndex||{};a.fieldToRowSpanSourceDataIndex[f]=d.index;var c=d.columnSpans&&
d.columnSpans[f];if(c)for(var e=1;e<c;e++)a.excludedIndexVertical[k+e]=!0,a.fieldToRowSpanSourceDataIndex[b.columns[k+e].field]=d.index}h[a.id]=!0}),d.movableIndexHashVertical=d.movableIndexHashVertical||{},d.movableIndexHashVertical[f]=e+g.length-1);d.rowSpans[f]=g.length;d._rowSpans[f]=h}});b.store.data.forEach(function(a,c){if(a.rowSpans){for(f in a.rowSpans)a.rowSpans[f]=Math.min(a.rowSpans[f],b.store.data.length-c);var d=0;Object.keys(a.rowSpans).forEach(function(b){2>a.rowSpans[b]?(delete a.rowSpans[b],
a._rowSpans&&delete a._rowSpans[b]):d++});d||(delete a.rowSpans,delete a._rowSpans)}});b.store.data.forEach(function(b,c){b.fieldInfos&&Object.keys(b.fieldInfos).forEach(function(c){void 0===a[c]&&delete b.fieldInfos[c]});b.style&&b.style.fields&&Object.keys(b.style.fields).forEach(function(c){void 0===a[c]&&delete b.style.fields[c]})});if(b.looseResize){b.store.data.forEach(function(a){b.columns.some(function(c){h.getDataHeightOwn(b,a,c.field)||h.setDataHeight(b,a,c.field,a.style.height)})});var d=
b.store.data[b.store.data.length-1],n=h.recalcGridHeight(b);b.columns.some(function(a){var c=0;b.store.data.forEach(function(d){c+=h.getDataHeightOwn(b,d,a.field)});var e=n-c;0!==e&&h.setDataHeight(b,d,a.field,h.getDataHeightOwn(b,d,a.field)+e)})}h.recalcGridHeight(b)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowDataUtil":function(){define(["../GridLayoutCalculatorQueryUtil"],function(k){var h={getDataHeight:function(e,g,c){return e.looseResize?h.getDataHeightOwn(e,
g,c)||g.style.height:g.style.height},getDataHeightOwn:function(e,g,c){if(e.looseResize)return g.style.fields=g.style.fields||{},(g.style.fields[c]=g.style.fields[c]||{}).height},setDataHeight:function(e,g,c,b,a){e.looseResize?(a?k.getColumnSpannedFields(e,g,c)||[c]:[c]).forEach(function(a){g.style.fields=g.style.fields||{};(g.style.fields[a]=g.style.fields[a]||{}).height=b}):g.style.height=b},calcDataHeight:function(e,g,c,b){var a=0,f=g.rowSpans&&g.rowSpans[c];if(1<f)for(var d=g.index;d<g.index+f;d++)d!==
b&&(a+=h.getDataHeight(e,e.store.data[d],c));else a=h.getDataHeight(e,g,c);return a},recalcGridHeight:function(e){e._height=0;var g=e.columns[0].field;e.store.data.forEach(function(c){e._height+=h.getDataHeight(e,c,g)});return e._height}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowsScaler":function(){define(["./RowDataUtil"],function(k){return{recalcRowsToFitHeight:function(h,e){function g(a){a.forEach(function(a){h.columns.some(function(c,e){if(!h.looseResize&&
e)return!0;k.setDataHeight(h,a,c.field,k.getDataHeight(h,a,c.field)*b)})})}var c=k.recalcGridHeight(h),b=e/c;1!==b&&(g(h.store.data),h._getSavedOriginalData()&&g(h._getSavedOriginalData()),k.recalcGridHeight(h))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowModifier":function(){define(["../GridLayoutCalculatorQueryUtil","./RowDataUtil","./_RowModifierLoose","./_RowModifierNormal"],function(k,h,e,g){var c={},b={checkHeightLimit:function(a,b,c,e){if(a.getMaxHeight()){var d=
0;a.store.data.forEach(function(e){e!==b&&(d+=h.getDataHeight(a,e,c))});e=Math.min(a.getMaxHeight()-d,e)}return e}},a={findDataToMove:function(a,b,c,e){var d=k.getMovableData(a,b,c);d&&(a=h.calcDataHeight(a,b,c,d.index),e-=a);return{data:d||b,height:e}}},f={finalResizeGridCells:function(a){a.getFieldCells().forEach(function(b){b.setHeight(h.calcDataHeight(a,b.gridData,b.column.field))})}};c.adjustRowHeight=function(c,h,k,l){l=b.checkHeightLimit(c,h,k,l);h=a.findDataToMove(c,h,k,l);(c.looseResize?
e:g).adjustRowHeight(c,h.data,k,h.height);f.finalResizeGridCells(c)};c.getAffectedCells=function(b,c,f){return b.looseResize?e.getAffectedCells(b,a.findDataToMove(b,c,f).data,f):null};return c})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/_RowModifierLoose":function(){define("dojo/_base/lang dojox/uuid/generateRandomUuid ../GridLayoutCalculatorQueryUtil ../GridElementBoxCalculator ./RowDataUtil ../../GridQueryUtil".split(" "),function(k,h,e,g,c,b){var a={collectRowBoxes:function(a,
b){for(var c=[],d=0;d<a.columns.length;){var f=a.columns[d],g=this._createEmptyBox(),f=e.getColumnSpannedFields(a,b,f.field)||[f.field];g.elements=this._getFieldsElements(a,b,f);this._measureBox(g);var h=c[c.length-1];h&&(h.nextSibling=g,g.prevSibling=h);c.push(g);d+=f.length}return c},_createEmptyBox:function(){return{id:h(),box:null,elements:[],overlappingBoxes:[],overlappingBoxesCache:{},prevSibling:null,nextSibling:null}},_getFieldsElements:function(a,b,c){var d=[];c.forEach(function(c){c={data:b,
dataIndex:b.index,field:c,box:g.calcDataBox(a,b,c,{places:2})};d.push(c)});return d},_measureBox:function(a){var b=0;a.elements.forEach(function(a){b+=a.box.w});a.box={x:a.elements[0].box.x,y:a.elements[0].box.y,h:a.elements[0].box.h,w:b}},mergeBoxesForBottomRow:function(a){var b=this._createEmptyBox();a.forEach(function(a){a.elements.forEach(function(a){b.elements.push({data:null,field:a.field,box:k.clone(a.box)})})});this._measureBox(b);b.box.h=1E6;return[b]},getBoxAtField:function(a,b){return a.filter(function(a){return a.elements[0].field===
b})[0]}},f={buildInfluenceTree:function(b,c,d){function e(a,d){(d?c:b).forEach(function(b){var c;if(c=!b.overlappingBoxesCache[a.id]){c=a.box;var d=b.box;c=!(c.x+.5>=d.x+d.w||c.x+c.w<=d.x+.5)}c&&(a.overlappingBoxes.push(b),a.overlappingBoxesCache[b.id]=!0)});a.overlappingBoxes.forEach(function(a){e(a,!d)})}d=a.getBoxAtField(b,d);e(d,!0);return d}},d={applyForce:function(a,b,d){function e(b,d){var g=b.elements[0];g.data&&c.setDataHeight(a,g.data,g.field,c.getDataHeight(a,g.data,g.field)+(d?-1:1)*f,
!0);b.overlappingBoxes.forEach(function(a){e(a,!d)})}var f=this._checkDelta(a,b,d);e(b,!1)},_checkDelta:function(a,b,c){function d(a,b){0!==f&&(b?0>f||(f=Math.min(f,a.box.h-e),a.prevSibling&&(f=Math.min(f,a.prevSibling.box.y+a.prevSibling.box.h-e-a.box.y)),a.nextSibling&&(f=Math.min(f,a.nextSibling.box.y+a.nextSibling.box.h-e-a.box.y))):0<f||(f=Math.max(f,-(a.box.h-e)),a.prevSibling&&(f=Math.max(f,-(a.box.y+a.box.h-(a.prevSibling.box.y+e)))),a.nextSibling&&(f=Math.max(f,-(a.box.y+a.box.h-(a.nextSibling.box.y+
e))))),a.overlappingBoxes.forEach(function(a){d(a,!b)}))}var e=a.layoutDefaults.rowMinHeight;c=Math.max(c,e);var f=c-b.box.h;d(b,!1);return f}},n={_getInluencedStartBox:function(b,c,d){var e=b.store.data[c.index+1];c=a.collectRowBoxes(b,c);b=e?a.collectRowBoxes(b,e):a.mergeBoxesForBottomRow(c);return f.buildInfluenceTree(c,b,d)},getAffectedCells:function(a,c,d){function e(c){if(c.elements[0].data){var d=b.querySingleCell(a,{rowIndex:c.elements[0].data.index,columnField:c.elements[0].field,considerSpans:!0});
d&&f.push(d)}c.overlappingBoxes.forEach(e)}var f=[];c=this._getInluencedStartBox(a,c,d);e(c);return f},adjustRowCell:function(a,b,c,e){b=this._getInluencedStartBox(a,b,c);d.applyForce(a,b,e)}};return{adjustRowHeight:function(a,b,c,d){n.adjustRowCell(a,b,c,d)},getAffectedCells:function(a,b,c){return n.getAffectedCells(a,b,c)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridQueryUtil":function(){define(["dojo/dom-geometry","./GridDataUtil","esri/dijit/geoenrichment/utils/ArrayUtil",
"esri/dijit/geoenrichment/utils/DomUtil","esri/dijit/geoenrichment/utils/MouseUtil"],function(k,h,e,g,c){var b={querySingleCell:function(a,c){c.fieldCell&&(c={rowId:c.fieldCell.rowId,columnId:c.fieldCell.columnId});var d;a.getFieldCells().some(function(a){if(a.parentGrid&&a.column&&a.gridData&&!(a.columnId!==c.columnId&&a.column.index!==c.columnIndex&&a.column.field!==c.columnField||a.rowId!==c.rowId&&a.gridData.index!==c.rowIndex))return d=a,!0});if(d)return d;if(c.considerSpans){var e=b.queryColumn(a,
c),f=b.queryData(a,c);if(!e||!f)return null;var g=e.index,h=f.index;a.store.data.some(function(c){return a.columns.some(function(e){var f=e.index,k=e.index+(c.columnSpans&&c.columnSpans[e.field]||0),l=c.index;e=c.index+(c.rowSpans&&c.rowSpans[e.field]||0);if(f<=g&&k>=g&&l<=h&&e>=h)return d=b.querySingleCell(a,{columnIndex:f,rowIndex:l}),!0})})}return d},queryColumn:function(a,b){var c;a.columns.some(function(a){if(a.id===b.columnId||a.index===b.columnIndex||a.field===b.columnField)return c=a,!0});
return c},queryData:function(a,b){var c;a.store.data.some(function(a){if(a.id===b.rowId||a.index===b.rowIndex)return c=a,!0});return c},queryCells:function(a,c){if(c.fieldCell){var d=[],e=c.rowSpan||1,f=c.columnSpan||1;if(c=b.querySingleCell(a,c))for(var g=c.gridData.index;g<c.gridData.index+e;g++)for(var h=c.column.index;h<c.column.index+f;h++){var k=b.querySingleCell(a,{rowIndex:g,columnIndex:h});k&&d.push(k)}return d}return this.queryCellsInArray(a.getFieldCells(),c)},queryCellsInArray:function(a,
b){var c=[];if(!Object.keys(b).length)return c;a.forEach(function(a,d){if(void 0===b.cellIndex||d===b.cellIndex)if(void 0===b.cellIndexes||-1!==b.cellIndexes.indexOf(d))if(void 0===b.columnId||a.columnId===b.columnId)if(void 0===b.columnIds||-1!==b.columnIds.indexOf(a.columnId))if(void 0===b.columnIndex||a.column.index===b.columnIndex)if(void 0===b.columnIndexes||-1!==b.columnIndexes.indexOf(a.column.index))if(void 0===b.columnField||a.column.field===b.columnField)if(void 0===b.columnFields||-1!==
b.columnFields.indexOf(a.column.field))if(void 0===b.rowId||a.rowId===b.rowId)if(void 0===b.rowIds||-1!==b.rowIds.indexOf(a.rowId))if(void 0===b.rowIndex||a.gridData.index===b.rowIndex)void 0!==b.rowIndexes&&-1===b.rowIndexes.indexOf(a.gridData.index)||c.push(a)});return c},getTitleCell:function(a){var c=b.querySingleCell(a,{rowIndex:0,columnIndex:0});if(c&&!h.getFieldInfo(c)&&(1===a.columns.length||h.getColumnSpan(c)===a.columns.length))return c},isDynamicFieldCell:function(a,b){return a._dynamicBindings&&
a._dynamicBindings[b.column.field]},getDynamicallyBoundColumns:function(a,b){return a._dynamicBindings&&a._dynamicBindings[b.field]},getDynamicallyBoundFieldCells:function(a,c){if(c.column){var d=a._dynamicBindings&&a._dynamicBindings[c.column.field];if(!d)return null;var e=[];d.forEach(function(d){(d=d&&b.querySingleCell(a,{columnId:d.id,rowId:c.rowId}))&&e.push(d)});return e}},getAllBoundCells:function(a,c,d){var f=[],g={};c&&c.forEach(function(c){if((!d||d(c))&&!g[c.uniqueId]){g[c.uniqueId]=!0;
var e=b.getDynamicallyBoundFieldCells(a,c);e?e.forEach(function(a){f.push(a);g[a.uniqueId]=!0}):f.push(c)}});return e.removeDuplicates(f,"uniqueId")},trimDynamicBindings:function(a,c){var d=[],e={};c&&c.forEach(function(c){var f=b.getDynamicallyBoundFieldCells(a,c);f&&f.length?(e[f[0].uniqueId]||d.push(f[0]),f.forEach(function(a){e[a.uniqueId]=!0})):d.push(c)});return d},collectFieldInfos:function(a,c){var d=[];c=c||{};var e=c.fieldCells||a.getFieldCells();c.trimDynamicBinding&&e&&(e=b.trimDynamicBindings(a,
e));e&&e.forEach(function(a){(a=h.getFieldInfo(a))&&d.push(a)});return d},cellHasFloatingTableParent:function(a){function b(a){return a.isSection&&a.isDataDrillingView?!1:a.isFloatingTable?!0:a.parentWidget?b(a.parentWidget):!1}return a&&a.parentGrid?b(a.parentGrid):!1},isMouseOver:function(a){return c.isMouseOverBox(b.getBBox(a))},getOverFieldCell:function(a,b){b=b||{};var c=b.cellFilter||function(){return!0},e;a.getForegroundFloatingCells({topFirst:!0}).some(function(a){if(c(a)&&a.isMouseOver())return e=
a,!0});e||a.getFieldCells().some(function(a){if(c(a)&&a.isMouseOver())return e=a,!0});e||a.getBackgroundFloatingCells({topFirst:!0}).some(function(a){if(c(a)&&a.isMouseOver())return e=a,!0});return e},getBBox:function(a,b){var c=a.isSingleCelledTable()&&a.getFirstCell().getAngle();return"number"===typeof c&&0!==c?a.getFirstCell().getBBox(b):b&&b.noTransformation?g.noTransformPosition(a.domNode):k.position(a.domNode)}};return b})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/_RowModifierNormal":function(){define(["./RowDataUtil"],
function(k){return{adjustRowHeight:function(h,e,g,c){var b=h.layoutDefaults.rowMinHeight;c=Math.max(c,b);var a=c-k.getDataHeight(h,e,g);if(h.keepGridHeightWhenResized){var f=h.store.data[e.index+1];f&&(a=k.getDataHeight(h,f,g)-a,a<b&&(c-=b-a,a=b),k.setDataHeight(h,f,g,a,!0))}k.setDataHeight(h,e,g,c,!0)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/GridLayoutColumnsCalculator":function(){define(["./ColumnDataUtil","./ColumnModifier","./ColumnsProcessor"],
function(k,h,e){var g={};g.recalcColumns=e.recalcColumns;g.recalcColumnsTableJson=e.recalcColumnsTableJson;g.adjustColumnWidth=h.adjustColumnWidth;g.getAffectedCells=h.getAffectedCells;g.getFieldWidth=k.getFieldWidth;g.setFieldWidth=k.setFieldWidth;g.calcFieldWidth=k.calcFieldWidth;g.recalcGridWidth=k.recalcGridWidth;return g})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnDataUtil":function(){define(["../GridLayoutCalculatorQueryUtil"],function(k){var h=
{getFieldWidth:function(e,g,c){var b="string"===typeof c?k.fieldToColumn(e,c):c;c=b?b.field:"string"===typeof c?c:null;return e.looseResize?h.getFieldWidthOwn(e,g,c)||b&&b.style.width:b&&b.style.width},getFieldWidthOwn:function(e,g,c){if(e.looseResize)return g.style.fields=g.style.fields||{},(g.style.fields[c]=g.style.fields[c]||{}).width},setFieldWidth:function(e,g,c,b,a){var f="string"===typeof c?k.fieldToColumn(e,c):c,d=f?f.field:"string"===typeof c?c:null;e.looseResize?(a?k.getRowSpannedData(e,
g,d)||[g]:[g]).forEach(function(a){a.style.fields=a.style.fields||{};(a.style.fields[d]=a.style.fields[d]||{}).width=b}):f&&(f.style.width=b)},calcFieldWidth:function(e,g,c,b){var a=0;1<(g.columnSpans&&g.columnSpans[c])?k.getSpannedColumns(e,c,g.columnSpans[c]).forEach(function(c){b!==c.field&&(a+=h.getFieldWidth(e,g,c.field))}):a=h.getFieldWidth(e,g,c);return a},recalcGridWidth:function(e){e._width=0;var g=e.store.data[0];e.columns.forEach(function(c){e._width+=h.getFieldWidth(e,g,c.field)});return e._width},
getAllowedWidth:function(e){return e.fitParentWhenResized?e.getAllowedWidthFromParent():e.getAllowedWidth()}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnModifier":function(){define(["../GridLayoutCalculatorQueryUtil","./ColumnDataUtil","./_ColumnModifierNormal","./_ColumnModifierLoose"],function(k,h,e,g){var c={},b={getColumnToChange:function(a,b,c,e){var d=k.getMovableColumn(a,b,c.field);d&&(a=h.calcFieldWidth(a,b,c.field,d.field),e-=
a);return{column:d||c,width:e}}},a={finalResizeGridCells:function(a){a.getFieldCells().forEach(function(b){b.setWidth(h.calcFieldWidth(a,b.gridData,b.column.field))});h.recalcGridWidth(a)}},f={recalcToStick:function(a){var b=a.columns[a.columns.length-1];a.store.data.some(function(c,d){if(!a.looseResize&&d)return!0;var e=0;a.columns.forEach(function(d){d!==b&&(e+=h.getFieldWidth(a,c,d.field))});h.setFieldWidth(a,c,b.field,h.getAllowedWidth(a)-e)})}};c.adjustColumnWidth=function(c,h,k,l){k=b.getColumnToChange(c,
h,k,l);(c.looseResize?g:e).adjustColumnWidth(c,h,k.column,k.width);c.stickToRight&&f.recalcToStick(c);a.finalResizeGridCells(c)};c.getAffectedCells=function(a,c,e){return a.looseResize?g.getAffectedCells(a,c,b.getColumnToChange(a,c,e).column):null};return c})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/_ColumnModifierNormal":function(){define(["./ColumnDataUtil"],function(k){var h={},e={adjustColumnWidth:function(g,c,b,a,f){function d(a,b){return k.setFieldWidth(g,
c,a.field,b,!0)}var h=g.layoutDefaults.columnMinWidth,m=function(){if(!b)return null;var d=k.getFieldWidth(g,c,b.field);void 0!==f&&(a=d+f);a=Math.max(h,a);var e,l=0,m=!1;g.columns.forEach(function(a){l+=k.getFieldWidth(g,c,a.field);m&&!e?e=a:a===b&&(m=!0)});var p=k.getAllowedWidth(g)-(l-d);return isNaN(p)?null:{width:a,widthMemo:d,maxAllowedColumnWidth:p,nextColumn:e}}();if(m){a=m.width;var l=m.widthMemo,p=m.maxAllowedColumnWidth,q=(m=m.nextColumn)&&k.getFieldWidth(g,c,m.field),l=a-l,v=0;g.keepGridWidthWhenResized?
(m&&(l=q-l,l<h&&(a-=h-l,l=h),l<q&&(p+=q-l),d(m,l)),d(b,Math.min(p,a))):(m&&p<a&&q>h?(d(b,a),v=p-a):d(b,Math.min(p,a)),0!==v&&e.adjustColumnWidth(g,c,m,null,v))}}};h.adjustColumnWidth=function(g,c,b,a){e.adjustColumnWidth(g,c,b,a)};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/_ColumnModifierLoose":function(){define("dojo/_base/lang dojox/uuid/generateRandomUuid ../GridLayoutCalculatorQueryUtil ../GridElementBoxCalculator ./ColumnDataUtil ../../GridQueryUtil".split(" "),
function(k,h,e,g,c,b){var a={collectColumnBoxes:function(a,b){for(var c=[],d=0;d<a.store.data.length;){var f=a.store.data[d],g=this._createEmptyBox(),f=e.getRowSpannedData(a,f,b.field)||[f];g.elements=this._getSpannedDataElements(a,b,f);this._measureBox(g);var h=c[c.length-1];h&&(h.nextSibling=g,g.prevSibling=h);c.push(g);d+=f.length}return c},_createEmptyBox:function(){return{id:h(),box:null,elements:[],overlappingBoxes:[],overlappingBoxesCache:{},prevSibling:null,nextSibling:null}},_getSpannedDataElements:function(a,
b,c){var d=[];c.forEach(function(c){c={data:c,dataIndex:c.index,field:b.field,box:g.calcDataBox(a,c,b.field)};d.push(c)});return d},_measureBox:function(a){var b=0;a.elements.forEach(function(a){b+=a.box.h});a.box={x:a.elements[0].box.x,y:a.elements[0].box.y,w:a.elements[0].box.w,h:b}},mergeBoxesForRightColumn:function(a){var b=this._createEmptyBox();a.forEach(function(a){a.elements.forEach(function(a){b.elements.push({data:a.data,field:null,box:k.clone(a.box)})})});this._measureBox(b);b.box.w=1E6;
return[b]},getBoxAtDataIndex:function(a,b){return a.filter(function(a){return a.elements[0].dataIndex===b})[0]}},f={buildInfluenceTree:function(b,c,d){function e(a,d){(d?c:b).forEach(function(b){var c;if(c=!b.overlappingBoxesCache[a.id]){c=a.box;var d=b.box;c=!(c.y+.5>=d.y+d.h||c.y+c.h<=d.y+.5)}c&&(a.overlappingBoxes.push(b),a.overlappingBoxesCache[b.id]=!0)});a.overlappingBoxes.forEach(function(a){e(a,!d)})}d=a.getBoxAtDataIndex(b,d.index);e(d,!0);return d}},d={applyForce:function(a,b,d){function e(b,
d){var g=b.elements[0];g.field&&c.setFieldWidth(a,g.data,g.field,c.getFieldWidth(a,g.data,g.field)+(d?-1:1)*f,!0);b.overlappingBoxes.forEach(function(a){e(a,!d)})}var f=this._checkDelta(a,b,d);e(b,!1)},_checkDelta:function(a,b,d){function e(a,b){0!==g&&(b?0>g||(g=Math.min(g,a.box.w-f),a.prevSibling&&(g=Math.min(g,a.prevSibling.box.x+a.prevSibling.box.w-f-a.box.x)),a.nextSibling&&(g=Math.min(g,a.nextSibling.box.x+a.nextSibling.box.w-f-a.box.x))):0<g||(g=Math.max(g,-(a.box.w-f)),a.prevSibling&&(g=Math.max(g,
-(a.box.x+a.box.w-(a.prevSibling.box.x+f)))),a.nextSibling&&(g=Math.max(g,-(a.box.x+a.box.w-(a.nextSibling.box.x+f))))),a.overlappingBoxes.forEach(function(a){e(a,!b)}))}var f=a.layoutDefaults.columnMinWidth;d=Math.max(d,f);var g=d-b.box.w;if(0<g&&b.elements[0].field===a.columns[a.columns.length-1].field){var h=0;a.columns.forEach(function(d){h+=c.getFieldWidth(a,b.elements[0].data,d.field)});g=Math.min(g,c.getAllowedWidth(a)-h)}e(b,!1);return g}},n={_getInluencedStartBox:function(b,c,d){var e=b.columns[d.index+
1];d=a.collectColumnBoxes(b,d);b=e?a.collectColumnBoxes(b,e):a.mergeBoxesForRightColumn(d);return f.buildInfluenceTree(d,b,c)},getAffectedCells:function(a,c,d){function e(c){if(c.elements[0].data){var d=b.querySingleCell(a,{rowIndex:c.elements[0].data.index,columnField:c.elements[0].field,considerSpans:!0});d&&f.push(d)}c.overlappingBoxes.forEach(e)}var f=[];c=this._getInluencedStartBox(a,c,d);e(c);return f},adjustColumnCell:function(a,b,c,e){b=this._getInluencedStartBox(a,b,c);d.applyForce(a,b,e)}};
return{adjustColumnWidth:function(a,b,c,d){n.adjustColumnCell(a,b,c,d)},getAffectedCells:function(a,b,c){return n.getAffectedCells(a,b,c)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnsProcessor":function(){define(["dojox/uuid/generateRandomUuid","./ColumnDataUtil"],function(k,h){function e(c){c._dynamicBindings={};if(c.getNumDynamicColumns()){for(var b=c.getNumDynamicColumns(),a=c.getNumFixedColumns(),e=0;e<a;e++)c.columns[e].isFixed=!0;for(var e=
[],d=0;d<b;d++){for(var g=a,h=[];g<c.columns.length;){var k=c.columns[g+d];k.isDynamic=!0;h.push(k);g+=b}e.push(h)}e.forEach(function(a){a.forEach(function(b){c._dynamicBindings[b.field]=a})})}}var g={recalcColumns:function(c,b){var a=b&&b.resetWidth,f=b&&b.columnsToPreserve,d=b&&b.stickToRight,g=b&&b.newWidth,m=b&&b.rightOffsetWeight;b=b&&b._isJson;var l={},p=0;c.columns.every(function(a,b){if(!a.style||!a.style.width||isNaN(a.style.width)||"number"!==typeof a.style.width)return p=0,!1;p+=a.style.width;
l[b]=a.style.width;return!0});var q;q=g?g:d?c.getAllowedWidth():p?Math.min(p,c._width):c._width;q-=0<m?q*m:0;var v=q/c.columns.length,r=q;if(f){var u=f.length*v,t=0;f.forEach(function(a){t+=a.style.width});f.forEach(function(a){a.style.width=u/t*a.style.width/r*100+"%"})}c.columns.forEach(function(b,c,d){b.index=c;b.style=b.style||{};if("number"!==typeof b.style.width||a)if(c===d.length-1)b.style.width=r;else{var e=b.style.width;"string"===typeof e&&-1!==e.indexOf("%")?b.style.width=parseFloat(e.substr(0,
e.length-1))/100*q:b.style.width=v}r-=b.style.width;c===d.length-1&&0>r&&(b.style.width+=r);void 0===b.id&&(b.id=k())});if(c.looseResize){c.columns.some(function(a,b){var d=l[b]?a.style.width/l[b]:void 0;c.store.data.forEach(function(b){var e=h.getFieldWidthOwn(c,b,a.field);e?d&&1!==d&&h.setFieldWidth(c,b,a.field,e*d):h.setFieldWidth(c,b,a.field,a.style.width)})});var z=c.columns[c.columns.length-1].field;c.store.data.forEach(function(a){var b=0;c.columns.some(function(d){b+=h.getFieldWidthOwn(c,
a,d.field)});var d=q-b;0!==d&&h.setFieldWidth(c,a,z,h.getFieldWidthOwn(c,a,z)+d)})}b||(e(c),h.recalcGridWidth(c));return q},recalcColumnsTableJson:function(c){g.recalcColumns(c.data,{resetWidth:!0,newWidth:c.style.width,_isJson:!0})}};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridLayoutSnapper":function(){define(["dojo/_base/lang","./rows/RowDataUtil","./columns/ColumnDataUtil","./GridElementBoxCalculator"],function(k,h,e,g){return{autoSnapLayout:function(c){function b(){var a=
[];c.store.data.forEach(function(b){c.columns.forEach(function(d){a.push(k.mixin({id:b.index+"_"+d.field,data:b,dataIndex:b.index,column:d,field:d.field},g.calcDataBox(c,b,d.field)))})});return a}if(c.looseResize)for(var a=c.store.data.length*c.columns.length,f={},d=0;d<a;d++){var n=b(),m=n[d],l=m.x+m.w,p=m.y+m.h;f[m.id]=!0;n.forEach(function(a){if(!f[a.id]){var b=l-(a.x+a.w);.5>=Math.abs(b)&&e.setFieldWidth(c,a.data,a.field,a.w+b);b=p-(a.y+a.h);.5>=Math.abs(b)&&h.setDataHeight(c,a.data,a.field,a.h+
b)}})}}}})},"esri/dijit/geoenrichment/ReportPlayer/core/sections/sectionUtils/SectionJsonUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes","../../supportClasses/tableJson/TableJsonUtil"],function(k,h){return{wrapInDetailsSectionJson:function(e,g){e=Array.isArray(e)?e:[e];var c=e.some(function(b){return"table"===b.id&&b.attributes&&(0<b.attributes.dynamicColumns||0<b.attributes.dynamicRows)});return{type:g||(c?k.GROUP:k.DETAILS),stack:e}},getSectionJsonInfographic:function(e){return(e=
e.stack&&e.stack[0])&&"table"===e.id&&h.getTableJsonInfographic(e)},calcSectionJsonBox:function(e){var g,c,b,a;function f(d){g=Math.min(g,d.l);c=Math.min(c,d.t);b=Math.max(b,d.l+d.w);a=Math.max(a,d.t+d.h)}c=g=Infinity;a=b=0;e.stack&&e.stack.forEach(function(a){switch(a.id){case "table":var b=0;a.data.data.forEach(function(a){b+=a.style.height});f({l:a.style.left,t:a.style.spaceBefore,w:a.style.width,h:b});break;case "img":case "map":f({l:a.style.left,t:a.style.top,w:a.style.width,h:a.style.height})}});
return{w:g+b,h:c+a,contentLeft:g,contentTop:c,contentW:b-g,contentH:a-c}}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/_FieldInfoBuilder":function(){define(["../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder","dojo/i18n!esri/nls/jsapi"],function(k,h){h=h.geoenrichment.dijit.ReportPlayer.ReportPlayer;return{getCalculatorOrScriptFieldInfo:function(e,g,c){if(!e)return null;if(g.variableProvider.isPlayerOnly&&!g.useVariableProviderToCollectOnly){var b=
g.variableProvider.toCalculator(e);if(!b)return console.log("Can't create a dummy calculator for \x3d\x3e "+e),null;c=c||{};c.calculatorName=b.variable.calculatorName;e=k.createFieldInfoFromCalculator(b,g.variableProvider,c);e.name=b.variable.fieldName;e.templateName=b.variable.templateName;return e}var b=g.queryMetaDataFunc(e),a=e.substr(0,e.indexOf("."));c=c||{};c.calculatorName=a;if(b)return b.isScript?k.createFieldInfoFromScript(b,g.variableProvider,c):k.createFieldInfoFromCalculator(b,g.variableProvider,
c);c=k.createFieldInfoFromMissingVariable(e);g.variableProvider.isPlayerOnly&&(b=g.variableProvider.toCalculator(e),c.alias=b&&b.variable.alias);c.alias=c.alias?c.alias+" ("+h.missingVariable+")":h.missingVariable;return c}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/InfographicOptionsProvider":function(){define("dojo/_base/declare esri/kernel esri/dijit/geoenrichment/InfographicsOptions esri/dijit/geoenrichment/Geoenrichment esri/dijit/geoenrichment/config esri/tasks/geoenrichment/GeometryStudyArea esri/tasks/geoenrichment/StandardGeographyStudyArea esri/tasks/geoenrichment/studyAreaFromJson ./ge/LocalGEInfographic ./ge/_GEFilterSupport esri/dijit/geoenrichment/utils/StudyAreaKeyBuilder".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m){var l=k(null,{_options:null,getTask:function(){return null},createGeoenrichment:function(a,b,c,e,f){return a&&a.calcData?new d(a,b,c,e,f):(new k([g,n]))()},getCountry:function(a){return null},getOptions:function(){this._options||(this._options=new e);return this._options}}),p=k(null,{countryID:null,reportID:null,geoenrichmentUrl:null,areaNames:null,studyAreas:null,studyArea:null,_provider:null,constructor:function(c,d){this.countryID=c.countryID;this.reportID=c.reportID;
this.geoenrichmentUrl=c.geoenrichmentUrl;this.studyAreas=c.studyAreas.map(function(c){return c instanceof b||c instanceof a?c:f(c)});this.areaNames=c.areaNames;this._provider=d;this.setCurrentAnalysisAreaIndex(0)},setCurrentAnalysisAreaIndex:function(a){this.studyArea=this.studyAreas[a]},_getGEKey:function(a){a=a||this.studyArea;return JSON.stringify(m.studyAreaToJson(a))+this.countryID+this.reportID},_getGEKeys:function(){return this.studyAreas.map(function(a){return this._getGEKey(a)},this)},getOptions:function(){return this._provider._getFactory().getOptions()},
createGeoenrichment:function(a){this.setCurrentAnalysisAreaIndex(a.currentFeatureIndex||0);return this._provider._createGE(this._getGEKey(),a.infographicJson,a.areaData,a.isMultiFeature,this.areaNames,a.currentFeatureIndex)},toJson:function(){return{countryID:this.countryID,reportID:this.reportID,geoenrichmentUrl:this.geoenrichmentUrl,geoenrichmentCache:this._provider._getGECacheJson(this._getGEKeys()),infographicsOptions:this.getOptions().toJson(),studyAreas:this.studyAreas.map(function(a){return a.toJson()}),
areaNames:this.areaNames}},toJsonAt:function(a){var b=this.studyAreas[a];return{countryID:this.countryID,reportID:this.reportID,geoenrichmentUrl:this.geoenrichmentUrl,geoenrichmentCache:this._provider._getGECacheJson([this._getGEKey(b)]),infographicsOptions:this.getOptions().toJson(),studyAreas:[b.toJson()],areaNames:[this.areaNames[a]]}}});return k(null,{_infographicsFactory:null,_geoenrichmentCache:null,constructor:function(){this._geoenrichmentCache={}},_getFactory:function(){return this._infographicsFactory=
this._infographicsFactory||new l},_createGE:function(a,b,c,d,e,f){b=this._getFactory().createGeoenrichment(b,c,d,e,f);(c=this._geoenrichmentCache[a])?b.cache=c:this._geoenrichmentCache[a]=b.cache;return b},_getGECacheJson:function(a){var b={};a.forEach(function(a){var c=this._geoenrichmentCache[a];c&&(b[a]=c.toJson())},this);return b},setServerUrl:function(a,b){c.server=a;b?c.token=b:(a=a&&h.id.findCredential(a)||h.id.credentials[0],c.token=a&&a.token)},getInfographicOptions:function(c){return new p({geoenrichmentUrl:c.geoenrichmentUrl,
countryID:c.countryID,reportID:c.reportID,studyAreas:c.analysisAreas.map(function(d){return d.geographies&&d.geographies.length?new a({countryID:c.countryID,layer:d.geographies[0].levelId,ids:[d.geographies.map(function(a){return a.id}).join(",")],attributes:{}}):new b({geometry:d.feature.geometry,attributes:{}})}),areaNames:c.analysisAreas.map(function(a){return a.shortName||a.name})},this)},getInfographicOptionsFromJson:function(a){this.setServerUrl(a.geoenrichmentUrl);for(var b in a.geoenrichmentCache){var c=
a.geoenrichmentCache[b];this._createGE(b);this._geoenrichmentCache[b].fromJson(c)}this._infographicsFactory&&(this._infographicsFactory._options=new e(a.infographicsOptions));return new p(a,this)}})})},"esri/dijit/geoenrichment/InfographicsOptions":function(){define("esri/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/tasks/geoenrichment/studyAreaOptionsFromJson esri/tasks/geoenrichment/GeoenrichmentTask ./utils/lang ./config ./InfographicsOptionsItem".split(" "),function(k,h,e,g,
c,b,a,f){function d(a,b){if(a)for(var c in a)if(a.hasOwnProperty(c)){b[c]=[];for(var d=0;d<a[c].length;d++){var e={};l(a[c][d],e);b[c].push(e)}}}function n(a,b){a=parseFloat(a.index);b=parseFloat(b.index);return isNaN(a)&&isNaN(b)?0:isNaN(a)?1:isNaN(b)?-1:a-b}function m(a,c){for(var d=0;d<a.length;d++){var e=a[d];if(e.type==c.type&&b.arraysEqual(e.variables,c.variables))return{report:e,index:d}}return null}function l(a,c){c.type=a.type||("OneVarMultiComparison"==a.report?"OneVar":a.report);if(a.dataCollection)if(a.vars){c.variables=
[];for(var d=0;d<a.vars.length;d++)c.variables.push(a.dataCollection+"."+a.vars[d])}else c.variables=[a.dataCollection+".*"];else c.variables=a.variables;b.isBoolean(a.isVisible)?c.isVisible=a.isVisible:b.isBoolean(a.checked)&&(c.isVisible=a.checked)}k=k("esri.dijit.geoenrichment.InfographicsOptions",null,{_items:null,_loaded:null,_loadPromises:null,studyAreaOptions:null,theme:"common",constructor:function(a){this._loaded={};this._loadPromises={};this.studyAreaOptions=g(a&&(a.buffer||a.studyAreaOptions));
this._items={};if(a){var b=a.reports||a.items;if(b){d(b,this._items);for(var c in b)b[c]&&b[c].length&&(this._loaded[c]=!0)}a.theme&&(this.theme=a.theme)}},getItems:function(b){var d=new e;if(this._loaded[b])d.resolve(this._items[b]);else{if(this._loadPromises[b])return this._loadPromises[b];var f=new c(a.server);f.token=a.token;f.getDataCollections(b,null,["id","alias"]).then(h.hitch(this,this._mergeItems,b,d),function(a){d.reject(a)})}return this._loadPromises[b]=d.promise},_mergeItems:function(a,
b,c){try{var d={AgePyramid:1,TapestryNEW:1,RelatedVariables:1,OneVar:1},e={TapestryNEW:"Tapestry"},g,h,k=[];for(g=0;g<c.length;g++){var p=c[g].metadata.infographics||c[g].metadata.infographics2;if(p){var q=JSON.parse(p),v;for(v in q)if(d[v]){var y=new f(e[v]||v,[c[g].id+".*"]),D;for(D in q[v])q[v].hasOwnProperty(D)&&(y[D]=q[v][D]);(h=m(k,y))?k[h.index]=y:k.push(y)}}}var F,E=this._items[a];E||(E=[],E.push(new f("OneVar",["KeyGlobalFacts.AVGHHSZ"])),this._items[a]=E);for(g=E.length-1;0<=g;g--)if(h=
m(k,E[g]))l(E[g],h.report),E[g]=h.report,k.splice(h.index,1);else{if("OneVar"==E[g].type&&1==E[g].variables.length){var G,H=E[g].variables[0];if(!F)for(F={},d=0;d<c.length;d++)for(e=0;e<c[d].variables.length;e++)F[c[d].id+"."+c[d].variables[e].id]=c[d].variables[e];if(G=F[H]){E[g].title=G.alias;continue}}E.splice(g,1);g--}for(g=0;g<k.length;g++)E.push(k[g]);E.sort(n);this._loaded[a]=!0;delete this._loadPromises[a];b.resolve(E)}catch(I){b.reject(I)}},toJson:function(){var a={};d(this._items,a);return{studyAreaOptions:this.studyAreaOptions.toJson(),
items:a,theme:this.theme}}});k.Item=f;return k})},"esri/tasks/geoenrichment/studyAreaOptionsFromJson":function(){define(["./RingBuffer","./DriveBuffer","./IntersectingGeographies","../../extend"],function(k,h,e,g){var c=function(b){if(b){switch(b.areaType){case "DriveTimeBuffer":return new h(b);case "StandardGeography":return new e(b)}switch(b.type){case "DriveTime":return new h(b);case "StdGeo":return new e(b)}return new k(b)}return new k};g("esri.tasks.geoenrichment.studyAreaOptionsFromJson",c);
return c})},"esri/tasks/geoenrichment/RingBuffer":function(){define(["../../declare","../../units","./StudyAreaOptions"],function(k,h,e){return k("esri.tasks.geoenrichment.RingBuffer",[e],{radii:null,units:null,constructor:function(e){e&&(e.bufferRadii?this.radii=e.bufferRadii:e.radius?this.radii=[e.radius]:e.radii&&(this.radii=e.radii),this.units=e.bufferUnits||e.units);this.radii||(this.radii=[1]);this.units||(this.units=h.MILES)},toJson:function(){return{areaType:"RingBuffer",bufferUnits:this.units,
bufferRadii:this.radii}}})})},"esri/tasks/geoenrichment/StudyAreaOptions":function(){define(["../../declare"],function(k){return k("esri.tasks.geoenrichment.StudyAreaOptions",null,{toJson:function(){throw"'toJson' method is not implemented";}})})},"esri/tasks/geoenrichment/DriveBuffer":function(){define(["../../declare","./StudyAreaOptions","./DriveUnits"],function(k,h,e){return k("esri.tasks.geoenrichment.DriveBuffer",[h],{radii:null,units:null,constructor:function(g){g&&(g.bufferRadii?this.radii=
g.bufferRadii:g.radius?this.radii=[g.radius]:g.radii&&(this.radii=g.radii),this.units=g.bufferUnits||g.units);this.radii||(this.radii=[5]);this.units||(this.units=e.MINUTES)},toJson:function(){return{areaType:"DriveTimeBuffer",bufferUnits:this.units,bufferRadii:this.radii}}})})},"esri/tasks/geoenrichment/DriveUnits":function(){define(["dojo/_base/lang","../../units"],function(k,h){h=k.clone(h);k.mixin(h,{MINUTES:"esriDriveTimeUnitsMinutes"});return h})},"esri/tasks/geoenrichment/IntersectingGeographies":function(){define(["../../declare",
"./StudyAreaOptions","./GeographyLevel"],function(k,h,e){return k("esri.tasks.geoenrichment.IntersectingGeographies",[h],{geographyLevels:null,constructor:function(g){this.geographyLevels=e.fromJsonArray(g?g.intersectingGeographies||g.levels||g.geographyLevels:[{layerID:"Admin2"}])},toJson:function(){return{areaType:"StandardGeography",intersectingGeographies:e.toJsonArray(this.geographyLevels)}}})})},"esri/tasks/geoenrichment/GeographyLevel":function(){define(["../../declare"],function(k){var h=
k("esri.tasks.geoenrichment.GeographyLevel",null,{layerID:null,datasetID:null,countryID:null,constructor:function(e){e&&(this.layerID=e.layer||e.layerID||null,this.datasetID=e.dataset||e.datasetID||null,this.countryID=e.sourceCountry||e.countryID||null)},toJson:function(){var e={};this.layerID&&(e.layer=this.layerID);this.datasetID&&(e.dataset=this.datasetID);this.countryID&&(e.sourceCountry=this.countryID);return e}});h.fromJsonArray=function(e){var g=[];if(!e)return g;for(var c=0;c<e.length;c++){var b=
e[c];b instanceof h||(b=new h(b));g.push(b)}return g};h.toJsonArray=function(e){if(!e||0===e.length)return null;for(var g=[],c=0;c<e.length;c++)g.push(e[c].toJson());return g};return h})},"esri/tasks/geoenrichment/GeoenrichmentTask":function(){define("../../declare dojo/_base/array dojo/_base/lang dojo/dom-construct ./taskHelper ../FeatureSet ./EnrichParameters ./ReportParameters ../../urlUtils ../../IdentityManager ../../geometry/Point ../../geometry/Polygon ../../geometry/Polyline dojo/i18n!../../nls/jsapi".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q){function v(a){this.name="UserError";this.message=a||""}function r(a,b){return a.getAvailableCountries().then(function(a){for(var c=0;c<a.length;c++)if(a[c].id==b)return a[c].name})}function u(a){a=a.getExtent();return new m((a.xmin+a.xmax)/2,(a.ymin+a.ymax)/2,a.spatialReference)}q=q.geoenrichment.task.GeoenrichmentTask;v.prototype=Error.prototype;return k("esri.tasks.geoenrichment.GeoenrichmentTask",null,{token:null,url:null,_query:null,constructor:function(a){if(a){var b=
d.urlToObject(a);a=b.path;this._query=b.query}this.url=a||d.getProtocolForWebResource()+"//geoenrich.arcgis.com/arcgis/rest/services/World/GeoenrichmentServer"},enrich:function(d){var e=this;return c.invokeMethod(this,"/Geoenrichment/enrich",function(){d instanceof a||(d=new a(d));return c.jsonToRest(d.toJson(),e._query)},function(a){(!a.results||1>a.results.length||!a.results[0].value||!a.results[0].value.FeatureSet||1>a.results[0].value.FeatureSet.length)&&c.throwEmptyResponse();var d={featureSets:[],
messages:a.messages};a=a.results[0].value.FeatureSet;for(var e=0;e<a.length;e++)d.featureSets.push(new b(a[e]));return d},"onEnrichComplete","onError")},getAvailableCountries:function(){var a=this;return c.invokeMethod(this,"/Geoenrichment/Countries",function(){return e.mixin({},a._query)},function(a){if(a.error)throw a.error;a=a.countries;for(var b=0;b<a.length;b++){var c=a[b].datasets;delete a[b].datasets;a[b].datasetIDs=c}return a},"onGetAvailableCountriesComplete","onError")},getDataCollections:function(a,
b,d,f){var g;b?g="/GetDataCollections/execute":(g="/Geoenrichment/DataCollections",a&&(g+="/"+a));var h=this;return c.invokeMethod(this,g,function(){var c=e.mixin({},h._query);c.suppressNullValues=!0;d&&(c.outFields=0===d.length?"none":JSON.stringify(d));b&&(a&&(c.sourcecountry=a),c.searchtext="id:"+b);f&&(c.addDerivativeVariables=JSON.stringify(f));return c},function(a){if(a.error)throw a.error;a=a.results||a.dataCollections||a.DataCollections;for(var b=0;b<a.length;b++)a[b]={id:a[b].dataCollectionID,
metadata:a[b].metadata,variables:a[b].data};return a},"onGetDataCollectionsComplete","onError")},createReport:function(a){var b=this;n.getCredential(this.url).then(function(d){try{var e=g.create("form",{target:"_blank",action:b.url+"/Geoenrichment/CreateReport",method:"post"});a instanceof f||(a=new f(a));var h=c.jsonToRest(a.toJson(),b._query);h.f="bin";h.token=d.token;for(var k in h)h.hasOwnProperty(k)&&g.create("input",{type:"hidden",name:k,value:h[k]},e);g.place(e,document.body);e.submit();g.destroy(e)}catch(y){b.onError(y)}},
function(a){b.onError(a)})},getReports:function(a){var b=this;return r(this,a).then(function(a){return c.invokeMethod(b,"/Geoenrichment/Reports/"+a,function(){return e.mixin({},b._query)},function(a){for(var b=0;b<a.reports.length;b++){var c=a.reports[b].reportID;delete a.reports[b].reportID;a.reports[b].id=c}return a.reports},"onGetReportsComplete","onError")})},getStandardGeographyLevels:function(a){function b(a){return c.invokeMethod(d,a,function(){return e.mixin({},d._query)},function(a){a=a.geographyLevels;
for(var b=0;b<a.length;b++){var c=a[b];c.id=c.countryID;delete c.countryID;c.name=c.countryName;delete c.countryName;for(var c=c.datasets,d=0;d<c.length;d++){var e=c[d];e.id=e.datasetID;delete e.datasetID;e.geographyLayers=e.levels;delete e.levels}}return a},"onGetStandardGeographyLevelsComplete","onError")}var d=this;return a?r(this,a).then(function(a){return b("/Geoenrichment/StandardGeographyLevels/"+a)}):b("/Geoenrichment/StandardGeographyLevels")},getServiceLimits:function(){var a=this;return c.invokeMethod(this,
"/Geoenrichment/ServiceLimits",function(){return e.mixin({},a._query)},function(a){return a.serviceLimits.value},"onGetServiceLimitsComplete","onError")},getCountries:function(a){var b;switch(a.type){case "point":b=a;break;case "polyline":b=a.paths[0];a=new p(a.spatialReference);a.addPath(b);b=u(a);break;case "polygon":b=a.rings[0],a=new l(a.spatialReference),a.addRing(b),b=u(a)}return this.enrich({variables:["GlobalIntersect.*"],studyAreas:[{geometry:b}],forStorage:!1}).then(function(a){var b=[];
a=a.featureSets[0].features;for(var c=0;c<a.length;c++){var d=a[c].attributes.sourceCountry;0>h.indexOf(b,d)&&b.push(d)}if(0===b.length)throw new v(q.noData);return b})},onEnrichComplete:function(a){},onGetAvailableCountriesComplete:function(a){},onGetDataCollectionsComplete:function(a){},onCreateReportComplete:function(a){},onGetReportsComplete:function(a){},onGetStandardGeographyLevelsComplete:function(a){},onGetServiceLimitsComplete:function(a){},onError:function(a){}})})},"esri/tasks/geoenrichment/taskHelper":function(){define(["dojo/_base/lang",
"dojo/Deferred","dojo/json","../../request","../../extend"],function(k,h,e,g,c){var b={invokeMethod:function(a,b,c,e,k,l){function d(b){var c;try{c=e(b)}catch(w){f(w);return}n&&n.resolve(c);a[k](c)}function f(b){n&&n.reject(b);a[l](b)}var m=null,n=null,n=new h(function(){m&&(m.cancel(),m=null)});try{var u=c?c():{};u.f="json";a.token&&(u.token=a.token);m=g({url:a.url+b,content:u,handleAs:"json"});m.then(d,f)}catch(t){f(t)}return n.promise},jsonToRest:function(a,b){b=k.mixin({},b);for(var c in a)k.isString(a[c])?
b[c]=a[c]:b[c]=e.stringify(a[c]);return b},throwEmptyResponse:function(){throw Error("Geoenrichment service returned empty response");}};c("esri.tasks.geoenrichment.taskHelper",b);return b})},"esri/tasks/geoenrichment/EnrichParameters":function(){define(["../../declare","../../SpatialReference","./EnrichParametersBase","./StandardIntersectingGeography"],function(k,h,e,g){return k("esri.tasks.geoenrichment.EnrichParameters",[e],{variables:null,returnGeometry:!1,outSR:null,intersectingGeographies:null,
forStorage:!0,constructor:function(c){this.variables=[];if(c&&(this.variables=c.analysisVariables||c.variables||null,c.returnGeometry&&(this.returnGeometry=!0),c.outSR&&(this.outSR=new h(c.outSR)),c.forStorage&&(this.forStorage=c.forStorage),c.intersectingGeographies)){this.intersectingGeographies=[];for(var b=0;b<c.intersectingGeographies.length;b++){var a=c.intersectingGeographies[b];if("standard"==a.geographyType)this.intersectingGeographies.push(new g(a));else if("external"==a.geographyType)throw Error("Not implemented");
}}},toJson:function(){var c=this.inherited(arguments);c.analysisVariables=this.variables;this.returnGeometry&&(c.returnGeometry=!0);this.outSR&&(c.outSR=this.outSR.toJson());this.forStorage||(c.forStorage=!1);if(this.intersectingGeographies){c.intersectingGeographies=[];for(var b=0;b<this.intersectingGeographies.length;b++)c.intersectingGeographies.push(this.intersectingGeographies[b].toJson())}return c}})})},"esri/tasks/geoenrichment/EnrichParametersBase":function(){define(["../../declare","../../SpatialReference",
"./StudyAreaOptions","./studyAreaFromJson","./studyAreaOptionsFromJson"],function(k,h,e,g,c){return k("esri.tasks.geoenrichment.EnrichParametersBase",null,{studyAreaOptions:null,studyAreas:null,countryID:null,datasetID:null,constructor:function(b){this.studyAreas=[];if(b){if(b.studyAreas){var a;b.inSR&&(a=b.inSR);for(var f=b.studyAreas,d=0;d<f.length;d++){var k=g(f[d]);a&&k.geometry&&k.geometry.setSpatialReference(new h(a));this.studyAreas.push(k)}}b.studyAreasOptions?this.studyAreaOptions=c(b.studyAreasOptions):
b.studyAreaOptions&&(this.studyAreaOptions=b.studyAreaOptions instanceof e?b.studyAreaOptions:c(b.studyAreaOptions));(a=b.useData)?(a.sourceCountry&&(this.countryID=a.sourceCountry),a.dataset&&(this.datasetID=a.dataset)):(b.countryID&&(this.countryID=b.countryID),b.datasetID&&(this.datasetID=b.datasetID))}},toJson:function(){for(var b={},a=[],c=0;c<this.studyAreas.length;c++)a.push(this.studyAreas[c].toJson());0<a.length&&(b.studyAreas=a);this.studyAreaOptions&&(b.studyAreasOptions=this.studyAreaOptions.toJson());
if(this.countryID||this.datasetID)a={},this.countryID&&(a.sourceCountry=this.countryID),this.datasetID&&(a.dataset=this.datasetID),b.useData=a;return b}})})},"esri/tasks/geoenrichment/studyAreaFromJson":function(){define(["./GeometryStudyArea","./AddressStudyArea","./StandardGeographyStudyArea","../../extend"],function(k,h,e,g){var c=function(b){if(b.geometry)return new k(b);if(b.address)return new h(b);if(b.layer)return new e(b)};g("esri.tasks.geoenrichment.studyAreaFromJson",c);return c})},"esri/tasks/geoenrichment/GeometryStudyArea":function(){define(["../../declare",
"../../geometry/jsonUtils","../../geometry/Geometry","./StudyArea"],function(k,h,e,g){return k("esri.tasks.geoenrichment.GeometryStudyArea",[g],{geometry:null,constructor:function(c){c&&c.geometry&&(this.geometry=c.geometry instanceof e?c.geometry:h.fromJson(c.geometry))},toJson:function(){var c=this.inherited(arguments);c.geometry=this.geometry.toJson();return c},getGeomType:function(){return this.geometry.type}})})},"esri/tasks/geoenrichment/StudyArea":function(){define(["../../declare","dojo/_base/lang",
"./StudyAreaOptions","./studyAreaOptionsFromJson","./GeographyLevel"],function(k,h,e,g,c){return k("esri.tasks.geoenrichment.StudyArea",null,{attributes:null,options:null,returnGeometry:!1,comparisonGeographyLevels:null,constructor:function(b){b&&(b.attributes&&(this.attributes=b.attributes),b.areaType?this.options=g(b):b.options instanceof e&&(this.options=b.options),b.returnGeometry&&(this.returnGeometry=!0),this.comparisonGeographyLevels=c.fromJsonArray(b.comparisonGeographyLevels||b.comparisonLevels));
this.comparisonGeographyLevels||(this.comparisonGeographyLevels=[])},toJson:function(){var b={};this.attributes&&(b.attributes=this.attributes);this.options&&h.mixin(b,this.options.toJson());this.returnGeometry&&(b.returnGeometry=!0);var a=c.toJsonArray(this.comparisonGeographyLevels);a&&(b.comparisonLevels=a);return b},getGeomType:function(){throw"Not implemented";}})})},"esri/tasks/geoenrichment/AddressStudyArea":function(){define(["../../declare","./StudyArea"],function(k,h){return k("esri.tasks.geoenrichment.AddressStudyArea",
[h],{address:null,constructor:function(e){e&&e.address&&(this.address=e.address)},toJson:function(){var e=this.inherited(arguments);e.address=this.address;return e},getGeomType:function(){return"point"}})})},"esri/tasks/geoenrichment/StandardGeographyStudyArea":function(){define(["../../declare","./StudyArea"],function(k,h){return k("esri.tasks.geoenrichment.StandardGeographyStudyArea",[h],{countryID:null,geographyLayerID:null,ids:null,constructor:function(e){if(e){var g=e.sourceCountry||e.countryID;
g&&(this.countryID=g);if(g=e.layer||e.geographyLayerID)this.geographyLayerID=g;e.ids&&(this.ids=e.ids)}},toJson:function(){var e=this.inherited(arguments);this.countryID&&(e.sourceCountry=this.countryID);this.geographyLayerID&&(e.layer=this.geographyLayerID);this.ids&&(e.ids=this.ids);return e},getGeomType:function(){return"polygon"}})})},"esri/tasks/geoenrichment/StandardIntersectingGeography":function(){define(["../../declare","./IntersectingGeography"],function(k,h){return k("esri.tasks.geoenrichment.StandardIntersectingGeography",
[h],{geographyLayerID:null,constructor:function(e){e&&(this.geographyLayerID=e.geographyLayer||e.geographyLayerID||null)},toJson:function(){var e=this.inherited(arguments);e.geographyType="standard";e.geographyLayer=this.geographyLayerID;return e}})})},"esri/tasks/geoenrichment/IntersectingGeography":function(){define(["../../declare"],function(k){return k("esri.tasks.geoenrichment.IntersectingGeography",null,{name:null,geometryType:"esriGeometryPoint",spatialRel:"esriSpatialRelIntersects",outFields:null,
constructor:function(h){h&&(this.name=h.name||null,this.outFields=h.outFields||null,h.intersectionInfo?(h.intersectionInfo.geometryType&&(this.geometryType=h.intersectionInfo.geometryType),h.intersectionInfo.spatialRel&&(this.spatialRel=h.intersectionInfo.spatialRel)):(h.geometryType&&(this.geometryType=h.geometryType),h.spatialRel&&(this.spatialRel=h.spatialRel)))},toJson:function(){return{name:this.name,outFields:this.outFields,intersectionInfo:{geometryType:this.geometryType,spatialRel:this.spatialRel}}}})})},
"esri/tasks/geoenrichment/ReportParameters":function(){define(["../../declare","./EnrichParametersBase"],function(k,h){return k("esri.tasks.geoenrichment.ReportParameters",[h],{reportID:null,format:"pdf",fields:null,constructor:function(e){e&&(this.reportID=e.report||e.reportID||null,this.format=e.format,this.fields=e.reportFields||e.fields||null)},toJson:function(){var e=this.inherited(arguments);this.reportID&&(e.report=this.reportID);this.format&&(e.format=this.format);this.fields&&(e.reportFields=
this.fields);return e}})})},"esri/dijit/geoenrichment/utils/lang":function(){define([],function(){return{arraysEqual:function(k,h){if(!k&&!h)return!0;if(!k||!h||k.length!=h.length)return!1;for(var e=0;e<k.length;e++)if(k[e]!=h[e])return!1;return!0},isNumber:function(k){return!isNaN(parseFloat(k))&&isFinite(k)},startsWith:function(k,h){return 0===k.lastIndexOf(h,0)},endsWith:function(k,h){var e=k.length-h.length;return 0>e?!1:k.indexOf(h,e)===e},isBoolean:function(k){return"boolean"==typeof k||k instanceof
Boolean}}})},"esri/dijit/geoenrichment/InfographicsOptionsItem":function(){define([],function(){return function(k,h){this.type=k;this.variables=h;this.index=this.title=null;this.isVisible=!0}})},"esri/dijit/geoenrichment/Geoenrichment":function(){define("esri/declare dojo/_base/lang dojo/on dojo/string esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/when esri/graphic esri/geometry/jsonUtils esri/tasks/locator esri/tasks/FeatureSet esri/tasks/geoenrichment/GeoenrichmentTask esri/tasks/geoenrichment/EnrichParameters esri/tasks/geoenrichment/RingBuffer esri/tasks/geoenrichment/DriveBuffer esri/tasks/geoenrichment/GeographyLevel esri/tasks/geoenrichment/GeometryStudyArea esri/tasks/geoenrichment/AddressStudyArea esri/tasks/geoenrichment/studyAreaFromJson ./_Invoke ./config ./utils/lang ./utils/StudyAreaKeyBuilder ./infographicUtils/bufferTitle ./infographicUtils/DataProvider".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v,r,u,t,z,w,C,A,B,y){function D(a){a=A.studyAreaToJson(a);delete a.returnGeometry;delete a.comparisonLevels;delete a.attributes;return a=JSON.stringify(a)}var F=k(null,{_keys:null,_values:null,_capacity:5,constructor:function(a){this._keys=[];this._values={};a&&(this._capacity=a)},getValue:function(a){return this._values[a]},setValue:function(a,b){this._keys.push(a);this._values[a]=b;this._removeOverflow()},hasValue:function(a){return this._values.hasOwnProperty(a)},
_removeOverflow:function(){if(this._keys.length>this._capacity)for(var a=this._keys.splice(0,this._keys.length-this._capacity),b=0;b<a.length;b++)delete this._values[a[b]]},setCapacity:function(a){this._capacity=a;this._removeOverflow()},toJson:function(){var a={},b;for(b in this._values){var c=this._values[b];void 0===c||null===c||"number"==typeof c&&isNaN(c)||("string"==typeof c||"boolean"==typeof c||"number"==typeof c?a[b]=c:"object"==typeof c&&c.toJson&&(a[b]=c.toJson()))}return{keys:this._keys.slice(),
values:a,capacity:this._capacity}},fromJson:function(a,b){if(a){this._keys=a.keys;this._capacity=a.capacity;this._values={};for(var c in a.values)this._values[c]=b?b(a.values[c]):a.values[c]}}}),E=k(null,{_values:null,constructor:function(a){this._values=new F(a)},getValue:function(a){var b=this.keyToString(a);if(this._values.hasValue(b))return this._values.getValue(b);var c=this;return this.keyToValue(a).then(function(a){c._values.setValue(b,a);return a})},keyToString:function(a){return JSON.stringify(a)},
keyToValue:function(a){throw"Not implemented";},setCapacity:function(a){this._values.setCapacity(a)},toJson:function(){return this._values.toJson()},fromJson:function(a,b){a&&this._values.fromJson(a,b)}}),G=k([E],{keyToString:function(a){return JSON.stringify(a.toJson())},keyToValue:function(a){return(new d(w.locatorUrl)).locationToAddress(a).then(function(a){return g.substitute(w.addressFormat,a.address,function(a){return a||""})},function(a){return""})}}),H=k([E],{_countryValues:null,_geometries:null,
constructor:function(){this._countryValues=new F;this._geometries=new F(3)},keyToValue:function(a){var b=this,c=t(a.studyArea),d=c.returnGeometry,e,f;d&&(f=D(c),e=this._geometries.hasValue(f));var g=d&&!e,h=new m(w.server);h.token=w.token;for(var k=null,n=c.comparisonGeographyLevels.length-1;0<=n;n--)"Admin1"==c.comparisonGeographyLevels[n].layerID&&(k=c.comparisonGeographyLevels.splice(n,1)[0]);var p,q;k&&(p=JSON.stringify({variables:a.variables,country:a.country}),(q=this._countryValues.hasValue(p))||
c.comparisonGeographyLevels.push(k));n=new l;n.forStorage=!1;n.countryID=a.country;n.variables=a.variables;if(c.returnGeometry=g)n.outSR=c.geometry?c.geometry.spatialReference:a.outSR;n.studyAreas.push(c);return h.enrich(n).then(function(a){var c=a.featureSets[0].features;k&&(q?c.push(b._countryValues.getValue(p)):b._countryValues.setValue(p,c[c.length-1]));d&&(e?c[0].geometry=b._geometries.getValue(f):b._geometries.setValue(f,c[0].geometry));return a.featureSets[0]})},setCapacity:function(a){this.inherited(arguments);
this._countryValues.setCapacity(a)},toJson:function(){var a=this.inherited(arguments);a.countryValues=this._countryValues.toJson();a.geometries=this._geometries.toJson();return a},fromJson:function(b){b&&(this._countryValues.fromJson(b.countryValues,function(b){return new a(b)}),this._geometries.fromJson(b.geometries,function(a){return f.fromJson(a)}),this.inherited(arguments,[b,function(a){return new n(a)}]))}}),I=k([E],{metadata:null,_enrichCache:null,_addressCache:null,constructor:function(a){this._enrichCache=
new H(a);this._addressCache=new G(3)},keyToValue:function(a){var b=this,d=[],e=a.returnAddress;delete a.returnAddress;d.push(this._enrichCache.getValue(a));var f=t(a.studyArea);e&&d.push(this._addressCache.getValue(f.geometry));return c(d).then(function(a){var c=a[0],d=c.features[0];d.attributes[b.metadata.name]||(d.attributes[b.metadata.name]=B(f.getGeomType(),f.options),e?d.attributes[b.metadata.address]=a[1]:f instanceof u&&(d.attributes[b.metadata.address]=f.address.text));return c})},setCapacity:function(a){this.inherited(arguments);
this._enrichCache.setCapacity(a)},toJson:function(){var a=this.inherited(arguments);a.metadata=h.clone(this.metadata);a.enrichCache=this._enrichCache.toJson();a.addressCache=this._addressCache.toJson();return a},fromJson:function(a){a&&(this.metadata=a.metadata,this._enrichCache.fromJson(a.enrichCache),this._addressCache.fromJson(a.addressCache),this.inherited(arguments,[a,function(a){return new n(a)}]))}});return k("esri.dijit.geoenrichment.Geoenrichment",[y,z],{country:null,returnGeometry:!1,returnAddress:!1,
returnData:!0,studyArea:null,outSR:null,buffer:null,variables:null,levels:null,highestLevel:null,data:null,restartOnDone:!1,requests:null,started:!1,cache:null,constructor:function(){this.buffer=new p;this.cache=new I;this.cache.metadata=this.metadata},getData:function(){return this.data},getGeometry:function(){return this.data.features[0].geometry},isBusy:function(){return this.pendingInvoke("requestData")||this.requests||this.restartOnDone},setBuffer:function(a){this.buffer=a;this.invalidate()},
getBuffer:function(){return this.buffer},setStudyArea:function(a){this.studyArea=a;this.invalidate()},setVariables:function(a){C.arraysEqual(this.variables,a)||(this.variables=a,this.invalidateData())},setGeoLevels:function(a,b){C.arraysEqual(this.levels,a)&&this.highestLevel==b||(this.levels=a,this.highestLevel=b,this.invalidateData())},setReturnAddress:function(a){this.returnAddress!=a&&(this.returnAddress=a)&&this.invalidateData()},setCacheLimit:function(a){this.cache.setCapacity(a)},invalidateData:function(){this.data=
null;this.invalidate()},invalidate:function(){this.pendingInvoke("requestData")||(this.requests?this.restartOnDone=!0:(this.geometry=null,this.invoke("requestData")))},requestData:function(){if(this.studyArea&&this.variables&&this.buffer){this.requests=[];this.started||(e.emit(this,"start"),this.started=!0);var a,c=this.buffer;a=!1;if(this.studyArea instanceof r)switch(this.studyArea.geometry.type){case "point":a=this.returnAddress;break;case "polyline":this.buffer instanceof q&&(c=new p);break;case "polygon":c=
null}var d=h.clone(this.studyArea);!d.options&&c&&(d.options=c);if(this.levels)for(c=0;c<this.levels.length;c++)d.comparisonGeographyLevels.push(new v({layerID:this.levels[c]}));this.highestLevel&&d.comparisonGeographyLevels.push(new v({layerID:this.highestLevel}));d.returnGeometry=this.returnGeometry;a=b(this.cache.getValue({country:this.country,variables:this.variables,returnData:this.returnData,studyArea:A.studyAreaToJson(d),outSR:this.outSR,returnAddress:a}));this.requests.push(a);a.then(h.hitch(this,
this.handleResponse),h.hitch(this,this.handleError))}},stop:function(){this.restartOnDone=!1;this.cancelInvoke("requestData");if(this.requests)for(var a=this.requests.slice(0),b=0;b<a.length;b++)a[b].cancel()},handleResponse:function(a){try{this.data=a,this.data.features[0].attributes.isThisArea=!0,this.onDone(null)}catch(N){this.onDone(N)}},handleError:function(a){this.onDone(a)},onDone:function(a){this.requests=null;a?"CancelError"!==a.name&&(console.log(a),e.emit(this,"error",a)):e.emit(this,"data");
this.restartOnDone?(this.invalidate(),this.restartOnDone=!1):(e.emit(this,"end"),this.started=!1)}})})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),function(k,h,e,g,c,b,a,f,d,n,m){k=k(n,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],
"suggest-locations-complete":["suggestions"]},constructor:function(a){this._geocodeHandler=h.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=h.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=h.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},outSpatialReference:null,setOutSpatialReference:function(a){this.outSpatialReference=a},_geocodeHandler:function(a,b,c,d,e){try{var f=a.candidates,g;b=[];var h,k=f.length,l=a.spatialReference,n;for(h=0;h<
k;h++){g=f[h];if(n=g.location)n.spatialReference=l;b[h]=new m(g)}this._successHandler([b],"onAddressToLocationsComplete",c,e)}catch(B){this._errorHandler(B,d,e)}},_geocodeAddressesHandler:function(a,b,c,d,e){try{var f=a.locations;b=[];var g,h=f.length,k=a.spatialReference,l;for(g=0;g<h;g++){if(l=f[g].location)l.spatialReference=k;b[g]=new m(f[g])}this._successHandler([b],"onAddressesToLocationsComplete",c,e)}catch(A){this._errorHandler(A,d,e)}},addressToLocations:function(a,b,e,k,m){var l,n,p,q,v,
r,B,y;a.address&&(k=e,e=b,b=a.outFields,m=a.searchExtent,y=a.countryCode,l=a.magicKey,n=a.distance,B=a.categories,a.location&&this.normalization&&(p=a.location.normalize()),q=a.locationType,v=a.maxLocations,r=a.forStorage,a=a.address);m&&(m=m.shiftCentralMeridian());var D=this.outSpatialReference;a=this._encode(h.mixin({},this._url.query,a,{f:"json",outSR:D&&c.toJson(D.toJson()),outFields:b&&b.join(",")||null,searchExtent:m&&c.toJson(m.toJson()),category:B&&B.join(",")||null,countryCode:y||null,magicKey:l||
null,distance:n||null,location:p||null,locationType:q||null,maxLocations:v||null,forStorage:r||null}));var F=this._geocodeHandler,E=this._errorHandler,G=new g(d._dfdCanceller);G._pendingDfd=f({url:this._url.path+"/findAddressCandidates",content:a,callbackParamName:"callback",load:function(a,b){F(a,b,e,k,G)},error:function(a){E(a,k,G)}});return G},suggestLocations:function(a){var b;b=new g(d._dfdCanceller);a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.normalize());a.searchExtent&&
(a.searchExtent=a.searchExtent.shiftCentralMeridian());a=this._encode(h.mixin({},this._url.query,{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:a.searchExtent&&c.toJson(a.searchExtent.toJson()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||null,location:a.location||null,distance:a.distance||null},{f:"json"}));a=f({url:this._url.path+"/suggest",content:a,callbackParamName:"callback"});b._pendingDfd=a;a.then(h.hitch(this,function(a){a=a.suggestions||
[];this.onSuggestLocationsComplete(a);b.resolve(a)}),h.hitch(this,function(a){this._errorHandler(a);b.reject(a)}));return b},addressesToLocations:function(a,b,k){var l=this.outSpatialReference,m=[],n=a.categories,p=a.locationType,q=a.countryCode;e.forEach(a.addresses,function(a,b){m.push({attributes:a})});a=this._encode(h.mixin({},this._url.query,{category:n&&n.join(",")||null,locationType:p||null,sourceCountry:q||null},{addresses:c.toJson({records:m})},{f:"json",outSR:l&&c.toJson(l.toJson())}));
var w=this._geocodeAddressesHandler,C=this._errorHandler,A=new g(d._dfdCanceller);A._pendingDfd=f({url:this._url.path+"/geocodeAddresses",content:a,callbackParamName:"callback",load:function(a,c){w(a,c,b,k,A)},error:function(a){C(a,k,A)}});return A},_reverseGeocodeHandler:function(a,b,c,d,e){try{var f=new m({address:a.address,location:a.location,score:100});this._successHandler([f],"onLocationToAddressComplete",c,e)}catch(t){this._errorHandler(t,d,e)}},locationToAddress:function(a,b,e,k){a&&this.normalization&&
(a=a.normalize());var l=this.outSpatialReference;a=this._encode(h.mixin({},this._url.query,{outSR:l&&c.toJson(l.toJson()),location:a&&c.toJson(a.toJson()),distance:b,f:"json"}));var m=this._reverseGeocodeHandler,n=this._errorHandler,p=new g(d._dfdCanceller);p._pendingDfd=f({url:this._url.path+"/reverseGeocode",content:a,callbackParamName:"callback",load:function(a,b){m(a,b,e,k,p)},error:function(a){n(a,k,p)}});return p},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},
onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});b("extend-esri")&&h.setObject("tasks.Locator",k,a);return k})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(k,h,e,g,c){k=k(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(b){h.mixin(this,b);this.location=new c(this.location)}});e("extend-esri")&&h.setObject("tasks.AddressCandidate",k,g);return k})},
"esri/dijit/geoenrichment/_Invoke":function(){define(["esri/declare"],function(k){return k("esri.dijit.geoenrichment._Invoke",null,{_invokeTimeoutIDs:null,invoke:function(h,e){if(!this._invokeTimeoutIDs)this._invokeTimeoutIDs={};else if(this._invokeTimeoutIDs[h]){if(void 0===e)return;clearTimeout(this._invokeTimeoutIDs[h])}var g=this;this._invokeTimeoutIDs[h]=setTimeout(function(){g._invokeTimeoutIDs[h]=0;g[h]()},e||0)},pendingInvoke:function(h){return this._invokeTimeoutIDs?this._invokeTimeoutIDs[h]:
!1},cancelInvoke:function(h){if(this._invokeTimeoutIDs){var e=this._invokeTimeoutIDs[h];e&&(clearTimeout(e),this._invokeTimeoutIDs[h]=0)}}})})},"esri/dijit/geoenrichment/utils/StudyAreaKeyBuilder":function(){define([],function(){var k={studyAreaToJson:function(h){h=h.toJson();h.geometry&&(h.geometry.points?k._processPoints(h.geometry.points):h.geometry.paths?h.geometry.paths.forEach(k._processPoints):h.geometry.rings&&h.geometry.rings.forEach(k._processPoints));return h},_processPoints:function(h){h.forEach(function(e){e[0]=
parseFloat(e[0].toFixed(10));e[1]=parseFloat(e[1].toFixed(10))})}};return k})},"esri/dijit/geoenrichment/infographicUtils/bufferTitle":function(){define("dojo/string esri/tasks/geoenrichment/DriveBuffer esri/tasks/geoenrichment/IntersectingGeographies esri/tasks/geoenrichment/DriveUnits dojo/i18n!esri/nls/jsapi esri/extend".split(" "),function(k,h,e,g,c,b){function a(a,b){switch(a){case "polyline":return b instanceof h?k.substitute(c.lineBuffer[g.MILES],{radius:"1"}):k.substitute(c.lineBuffer[b&&
b.units||g.MILES],{radius:(b&&b.radii[0]||1).toString()});case "polygon":return c.polygon;default:return b instanceof h?k.substitute(c.pointDriveTime[b&&b.units||g.MILES],{radius:(b&&b.radii[0]||1).toString()}):b instanceof e?k.substitute(c.stdGeo,{level:b.geographyLevels[0].layerID}):k.substitute(c.pointRing[b&&b.units||g.MILES],{radius:(b&&b.radii[0]||1).toString()})}}c=c.geoenrichment.dijit.bufferTitle;b("esri.dijit.geoenrichment.bufferTitle",a);return a})},"esri/dijit/geoenrichment/infographicUtils/DataProvider":function(){define(["esri/declare",
"dojo/Evented"],function(k,h){return k([h],{metadata:null,constructor:function(){this.metadata={name:"StdGeographyName",address:"address"}},getData:function(){throw Error("Not implemented");}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ge/LocalGEInfographic":function(){define(["dojo/_base/declare","dojo/_base/lang","./LocalGEBase","../AreaDataUtil"],function(k,h,e,g){return k(e,{_fieldNameToFieldInfoCache:null,_variableIdToFieldInfoCache:null,constructor:function(c,b,a,
e,d){this._fieldNameToFieldInfoCache={};this._variableIdToFieldInfoCache={};c.fieldInfos.forEach(function(a){this._fieldNameToFieldInfoCache[a.name]=a;this._variableIdToFieldInfoCache[a.variableID]=a},this);var f=c.calcData.calculatorName;(this._skipThisArea=a&&1<b.length)?(a=g.combineAreaDataObjectCalculators(b,f,{removeDuplicates:!0}),d=a.thisAreas.map(function(a,b){a=h.mixin({},a);a.StdGeographyName=e[b];a.isThisArea=!0;return a}),b={},b[f]={data:d.shift(),comparisonLevels:d.concat(a.comparisonLevels)}):
b=b[d||0];this._initGE(c.calcData.variables,b,f)},_propulateAttributesFromAreaData:function(c,b){for(var a in b){var e=this._fieldNameToFieldInfoCache[a];e?c[e.variableID]=b[a]:c[a]=b[a]}},_createField:function(c,b){var a=this.inherited(arguments),e=this._variableIdToFieldInfoCache[c];e?(a.alias=e.alias,a.decimals=e.decimals,a.units=e.showPercent?"pct":e.showCurrency?"currency":a.units,a.type=e.type||a.type):a.noVariableField=!0;return a},_filterAttributeField:function(c){return!c.noVariableField}})})},
"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ge/LocalGEBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/Evented dojo/on esri/graphic esri/tasks/FeatureSet ./_GEFilterSupport ../AreaDataUtil ../stdGeographies/StdGeographiesUtil esri/dijit/geoenrichment/ReportPlayer/countryConfig dojo/i18n!esri/nls/jsapi".split(" "),function(k,h,e,g,c,b,a,f,d,n,m){m=m.geoenrichment.dijit.ReportPlayer.ReportPlayer;return k([e,a],{metadata:{name:"StdGeographyName",address:"address"},
variables:null,data:null,_variableShortToFullNameCache:null,_areaData:null,_skipThisArea:!1,_initGE:function(a,b,c){this.variables=a||[];this._variableShortToFullNameCache={};this.variables.forEach(function(a){this._variableShortToFullNameCache[-1===a.indexOf(".")?a:a.substr(a.indexOf(".")+1)]=a},this);(a=b&&f.getAreaDataObjectCalculator(b,c))?this._areaData=[a.data].concat(a.comparisonLevels||[]):this._handleError(Error("Can't get calculator"))},setVariables:function(a){this.variables=a},_createFeatureSet:function(){var a=
new b,c=this._prepareFeatures();a.features=c;a.fields=this._prepareFields(c);this._prepareFieldAliases(a);return a},_prepareFeatures:function(){var a=[];if(!this._areaData)return a;for(var b=0;b<this._areaData.length;b++){var e={};this._propulateAttributesFromAreaData(e,this._areaData[b]);e.StdGeographyName=String(e.StdGeographyName||"");e.StdGeographyID=String(e.StdGeographyID||"");e.StdGeographyLevel=String(e.StdGeographyLevel||"");if(0!==b||this._skipThisArea){if(!e.StdGeographyName&&!e.StdGeographyID&&
!e.StdGeographyLevel){console.log("LocalGEBase.js can't add an unidentifiable geography.");continue}e.StdGeographyName=d.getAreaName(e)}else e.StdGeographyName=m.thisArea,e.isThisArea=!0;a.push(new c(null,null,e))}return a},_propulateAttributesFromAreaData:function(a,b){h.mixin(a,b)},_prepareFields:function(a){var b=[];if(!a.length)return b;a=a[0].attributes;for(var c in a)b.push(this._createField(c,a));return b},_stringAttrs:{StdGeographyName:1,StdGeographyID:1,StdGeographyLevel:1},_createField:function(a,
b){b=this._stringAttrs[a]||"string"===typeof b[a];return{name:a,alias:a,type:b?"esriFieldTypeString":"esriFieldTypeDouble",length:b?256:void 0,fullName:this._variableShortToFullNameCache[a],decimals:b?void 0:0,units:b?"other":"double",symbol:n.getCurrencySymbol()}},_prepareFieldAliases:function(a){a.fieldAliases={};a.fields.forEach(function(b){a.fieldAliases[b.name]=b.alias})},_handleError:function(a){setTimeout(function(){a&&g.emit(this,"error",a)}.bind(this))},isBusy:function(){return!1},setOutSR:function(){},
setGeoLevels:function(){},setStudyArea:function(){},stop:function(){}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ge/_GEFilterSupport":function(){define(["dojo/_base/declare","esri/tasks/FeatureSet","esri/dijit/geoenrichment/infographicUtils/formatVariable","esri/dijit/geoenrichment/utils/ObjectUtil"],function(k,h,e,g){return k(null,{_filterRanges:null,_alwaysAllowThisAreasWhenFiltering:!1,getData:function(c){this.data||(this.data=this._createFeatureSet());return c&&c.ignoreFilters?
this.data:this._filterRanges&&this._filterRanges.length&&this.data?this._filterData(this.data):this.data},_createFeatureSet:function(){},_filterData:function(c){var b=new h;b.fields=c.fields;b.fieldAliases=c.fieldAliases;b.features=c.features.filter(function(a){return this._alwaysAllowThisAreasWhenFiltering&&a.attributes.isThisArea?!0:!this._filterRanges.some(function(b){var c=a.attributes[b.fieldName];return c<b.min||c>b.max})},this);return b},_excludeMap:{StdGeographyName:1,StdGeographyID:1,StdGeographyLevel:1,
isThisArea:1},getAttributeFields:function(){var c=this.getData({ignoreFilters:!0});if(!c)return[];for(var c=c.fields,b=[],a=0;a<c.length;a++){var f=c[a];!this._excludeMap[f.name]&&this._filterAttributeField(f)&&b.push({name:f.name,label:f.alias,decimals:0<=f.decimals?f.decimals:void 0,type:f.type,formatFunction:function(a){return function(b){return-1===a.decimals?g.formatNumber(b):e(a,b)}}(f)})}return b},_filterAttributeField:function(c){return this.variables&&this.variables.length?"HouseholdsByIncome.*"===
this.variables[0]?0===c.name.indexOf("HIN"):"HouseholdIncomeCurrentYear.*"===this.variables[0]?0===c.name.indexOf("EHYHNI"):"Age.*"===this.variables[0]?0===c.name.indexOf("FEM")||0===c.name.indexOf("MAL")||0===c.name.indexOf("ECYP"):-1!==this.variables[0].indexOf("AVGHHSZ")?-1!==c.name.indexOf("AVGHHSZ"):"RaceAndEthnicity.*"===this.variables[0]?-1!==c.name.indexOf("_CY_"):!0:!0},getAllGeographyAttributes:function(c){c=this.getData(c);if(!c)return[];c=c.features;for(var b=[],a=0;a<c.length;a++){var e=
c[a].attributes;e.isThisArea||b.push(e)}return b},setFilterRanges:function(c,b){this._filterRanges=c;this._alwaysAllowThisAreasWhenFiltering=b&&b.ignoreThisAreas},collectFilterRangesStats:function(c){if(!this.getData())return null;c=c||{};var b=c.additionalAttributes||[],b=b.concat(c.excludeThisAreas?this.getAllGeographyAttributes({ignoreFilters:!0}):this.getData({ignoreFilters:!0}).features.map(function(a){return a.attributes})),a=[];this.getAttributeFields().forEach(function(c){if("esriFieldTypeString"!==
c.type){var d={fieldName:c.name,alias:c.label,min:Infinity,max:-Infinity,decimals:c.decimals,dataArray:[]};a.push(d);b.forEach(function(a){a=a[c.name];d.min=Math.min(d.min,a);d.max=Math.max(d.max,a);d.dataArray.push(a)})}});return{filterRanges:a,numAreasTotal:b.length}}})})},"esri/dijit/geoenrichment/infographicUtils/formatVariable":function(){define(["dojo/number"],function(k){return function(h,e){var g=h.decimals||0;switch(h.units){case "pct":return k.format(e/100,{places:g,type:"percent"});case "currency":return k.format(e,
{places:g,type:"currency",symbol:h.symbol||"$"});default:return"esriFieldTypeDouble"==h.type?k.format(e,{places:g}):e}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/stdGeographies/StdGeographiesUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/countryConfig"],function(k){var h={US_STATES_IDS:{"01":"AL","02":"AK","03":"AS","04":"AZ","05":"AR","06":"CA","08":"CO","09":"CT",10:"DE",11:"DC",12:"FL",13:"GA",14:"GU",15:"HI",16:"ID",17:"IL",18:"IN",19:"IA",20:"KS",
21:"KY",22:"LA",23:"ME",24:"MD",25:"MA",26:"MI",27:"MN",28:"MS",29:"MO",30:"MT",31:"NE",32:"NV",33:"NH",34:"NJ",35:"NM",36:"NY",37:"NC",38:"ND",39:"OH",40:"OK",41:"OR",42:"PA",43:"PR",44:"RI",45:"SC",46:"SD",47:"TN",48:"TX",49:"UT",50:"VT",51:"VA",53:"WA",54:"WV",55:"WI",56:"WY"},CA_PROVINCE_IDS:{10:"NL",59:"BC",60:"YT",61:"NT",62:"NU",11:"PE",12:"NS",13:"NB",24:"QC",35:"ON",46:"MB",47:"SK",48:"AB"},BUILDER_DATA:{US_census:{"US.CD":"%name%, %state%","US.CSD":"%name%, %state%","US.Counties":"%name%, %state%",
"US.Places":"%city%, %state%","US.ZIP5":"%id% (%name%)"},CA_census:{"CAN.FSA":"%id% (%name%)","CAN.CD":"%name%, %province%"}},getAreaName:function(e){var g=k.getCountryID(),c=k.getHierarchyID();if(!g||!c)return e.StdGeographyName;var g=g+"_"+c,b=h.BUILDER_DATA[g];b||(c=k.getGeographiesModel(),b=h.BUILDER_DATA[g]={},c.getLevels(!0).forEach(function(a){b[a.id.toUpperCase()]="%id% (%name%)"}));return h.buildDescription(e.StdGeographyID,e.StdGeographyName,e.StdGeographyLevel,b)},buildDescription:function(e,
g,c,b){b=b&&b[c.toUpperCase()];g=g||e;return"%id% (%name%)"===b&&0<=g.indexOf(e)?g:b?b.replace(/%(\w+)%/g,function(a,b){return h._buildDescriptionPart(a,b,e,g,c)}):g},_buildDescriptionPart:function(e,g,c,b,a){try{a.substr(0,a.indexOf(".")).toLowerCase();var f=h["_build_"+g];return f&&f(c,b)}catch(d){}return e},_build_id:function(e,g){return e},_build_name:function(e,g){return g},_build_city:function(e,g){return g.replace(/(\s|^)(\w)/g,function(c,b,a){return b+a.toUpperCase()})},_build_state:function(e,
g){return(e=e&&2<=e.length?h.US_STATES_IDS[e.substr(0,2)]:null)?e:"??"},_build_province:function(e,g){return(e=e&&2<=e.length?h.CA_PROVINCE_IDS[e.substr(0,2)]:null)?e:"??"}};return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/AreasPreprocessor":function(){define("dojo/_base/Color dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojo/string esri/graphic esri/symbols/SimpleFillSymbol esri/symbols/SimpleLineSymbol esri/symbols/jsonUtils ./FeatureNameUtil ./tasks/EnrichAreasTask esri/dijit/geoenrichment/utils/GeometryUtil esri/dijit/geoenrichment/ReportPlayer/config dojo/i18n!esri/nls/jsapi".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q){var v={symbolizeFeature:function(b){function c(){var b=new a;b.setOutline(new f(f.STYLE_SOLID,new k([105,134,68,.55]),2));b.setColor(new k([105,134,68,.55]));return b}b.symbol||b.setSymbol(c())},symbolizeAreas:function(a){a.forEach(function(a){a.feature&&v.symbolizeFeature(a.feature)})}},r={generalize:function(a){var c=[],d=[];a.forEach(function(a,b){!a.feature||a.geographies&&a.geographies.length||(c.push(a.feature),d.push(b))});return e(function(a){function c(a){var b=
0;a.geometry.rings.forEach(function(a){b+=a.length});return b}var d,f,g=l.needGeneralizeGeometry(a,p.generalization.factor,p.generalization.maxVerticesInAllFeatures,p.generalization.numVerticesPerFeature),h;g&&(d=!0,f=[],a=a.map(function(a,d){f.push(c(a));return new b(a.geometry,a.symbol,a.attributes)}),h=l.generalizeGeometry(a,g,p.generalization.numVerticesPerFeature,!0));return e(h,function(){d&&(console.log("Generalize features:"),a.forEach(function(a,b){console.log("#"+b+" "+f[b]+" \x3d\x3e "+
c(a))}));return a})}(c),function(b){d.forEach(function(c){a[c].feature=b[c]})})}},u={provideGeographyFeatures:function(a){return g(a.analysisAreas.map(function(b){if(!b.feature&&b.geographies&&b.geographies.length)return(new m).createFeatureForGeographies(b.geographies,{countryID:a.countryID,hierarchy:a.hierarchy}).then(function(a){b.feature=a;b.name=b.name||b.feature.attributes.StdGeographyName;b.description=b.description||q.geoenrichment.dijit.ReportPlayer.ReportPlayer.geography;b.address=b.address||
b.name;b.geographies[0].attributes&&h.mixin(b.feature.attributes,b.geographies[0].attributes);(a=b.geographies[0].symbol)?(a=a.toJson?a:d.fromJson(a),b.feature.setSymbol(a)):v.symbolizeFeature(b.feature)})}))}},t={provideBufferFeatures:function(a){var b=this,c=a.analysisAreas.filter(function(a){return!a.feature&&a.buffer}),d=c.map(function(a){return a.buffer});return(new m).createFeaturesForBuffers(d,{countryID:a.countryID}).then(function(a){a.forEach(function(a,d){d=c[d];d.feature=a;b._applyBufferParamsToArea(d)})})},
_applyBufferParamsToArea:function(a){var b=a.buffer;if(!a.name){var e=q.geoenrichment.dijit.bufferTitle.pointRing;e[b.units]&&(a.name=c.substitute(e[b.units],{radius:b.radius}))}a.description=a.description||"Ring";b.attributes&&h.mixin(a.feature.attributes,b.attributes);(b=b.symbol)?(b=b.toJson?b:d.fromJson(b),a.feature.setSymbol(b)):v.symbolizeFeature(a.feature)}};return{preprocessAreas:function(a,b){a.analysisAreas=a.analysisAreas.filter(function(a){return a.feature&&a.feature.geometry&&"polygon"===
a.feature.geometry.type||a.geographies&&a.geographies.length||a.buffer});-1!==b.analysisAreasLimit&&(b.analysisAreasLimit=b.analysisAreasLimit||10,a.analysisAreas.length=Math.min(a.analysisAreas.length,b.analysisAreasLimit));a.analysisAreas.forEach(function(a){a.feature&&!a.feature.attributes&&(a.feature.attributes={})});a.analysisAreas.forEach(function(a){a.name=a.name||a.shortName;if(!a.name&&a.feature){var b=n.guessFeatureName(a.feature);b&&(a.name=a.shortName=b)}});b.symbolizeAreas&&v.symbolizeAreas(a.analysisAreas);
return e(r.generalize(a.analysisAreas),function(){return g([u.provideGeographyFeatures(a),t.provideBufferFeatures(a)])})}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/FeatureNameUtil":function(){define([],function(){return{_nameScores:[/^name$/i,/^title$/i,/(^name)|(name$)/i,/(^title)|(title$)/i],guessFeatureName:function(k){var h=Object.keys(k.attributes),e;this._nameScores.some(function(g){return h.some(function(c){if(g.test(c))return e=c,!0})});return k.attributes[e]||
""}}})},"esri/dijit/geoenrichment/utils/GeometryUtil":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/geometry/Polygon esri/workers/WorkerClient ./PolygonUtil ./GeometryUtil_base".split(" "),function(k,h,e,g,c,b){function a(a,b,c){var d=new h,e=new g("./mutableWorker",function(){e.importScripts(["../dijit/geoenrichment/utils/GeometryUtil_worker","../dijit/geoenrichment/utils/GeometryUtil_base"]).then(function(){e.postMessage({rings:a,maxAllowableOffset:c}).then(function(a){var c=
a.rings;b.forEach(function(a){for(var b=a.source.length=0;b<a.count;b++)a.source.push(c.shift())});d.resolve();e.terminate()})})},!0);return d.promise}var f=k.mixin({},b);f.calculateMaxAllowableOffset=function(a,b){void 0===b&&(b=1);return a.extent.getWidth()/a.width*b};f.getNumberOfPoints=c.getNumberOfPoints;f.needGeneralizeGeometry=function(a,b,c,e){if(!a||!b)return!1;e=e||(c?c/10:500);c=c||5E3;Array.isArray(a)||(a=[a]);var d=0>b,g=0,h=Math.abs(b)/100,k=0,l=0,m;a.forEach(function(a){a=a.geometry||
a;if(!a.rings||!a.getExtent)return!1;var e=a.getExtent();if(e=e.getWidth()*e.getHeight())e=Math.sqrt(e),a=f.getNumberOfPoints(a),k+=a,l=Math.max(l,a),d&&(g=Math.max(g,e*h)),m||(m=d?k>c:a*b>4*e)});return m&&l>e?g||b:0};f.generalizeGeometry=function(b,c,g,h){if(!b||!c||0>c)return!1;g=g||500;Array.isArray(b)||(b=[b]);var d=[],k=[];b.map(function(a){var b=a.geometry||a;if(b!=a&&b.rings){a.geometry=new e;a.geometry.setSpatialReference(b.spatialReference);var c=a.geometry.rings}c&&b.rings.forEach(function(a){c.push(a.slice())});
f.getNumberOfPoints(b)>g&&(a=c||b.rings,d=d.concat(a),k.push({source:a,count:a.length}))});if(h&&window.Worker)return a(d,k,c);d.forEach(function(a){(new f.RingInfo(a)).generalize(c,.8)})};return f})},"esri/workers/WorkerClient":function(){define("dojo/Evented dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/request ../sniff ../kernel ../urlUtils require".split(" "),function(k,h,e,g,c,b,a,f,d){var n=window.Blob||window.webkitBlob||window.mozBlob,m=window.URL||window.webkitURL||window.mozURL;
k=h([k],{declaredClass:"esri.workers.WorkerClient",worker:null,returnDeferreds:!1,_queue:null,constructor:function(a,c,d){this._isIE=b("ie");this.returnDeferreds=!!d;this._queue={};this._acceptMessage=g.hitch(this,this._acceptMessage);this._errorMessage=g.hitch(this,this._errorMessage);a&&this.setWorker(a,g.hitch(this,function(a){this.worker=a;c(a)}))},setWorker:function(a,b){if(a instanceof Array){var c=a;a=c.shift()}var d=this._getUrl(a),d=f.normalize(d);a=!f.hasSameOrigin(d,location.href);var e;
if(!1===d)return console.log("Can not resolve worker path"),!1;this.worker&&(e=this.worker,e.removeEventListener("message",this._acceptMessage,!1),e.removeEventListener("error",this._errorMessage,!1),e.terminate(),e=null);if(a){a=this._getUrl("./mutableWorker",!0);try{this._getRemoteText(a,g.hitch(this,function(a){a=m.createObjectURL(new n([a],{type:"text/javascript"}));b(this._createWorker(a,d))}))}catch(u){try{a=f.getProxyUrl(a).path+"?"+encodeURI(a),this._useProxy=!0,b(this._createWorker(a,c))}catch(t){return console.log("Can not create worker"),
!1}}}else setTimeout(g.hitch(this,function(){b(this._createWorker(d,c))}),0)},_createWorker:function(a,b){a=new Worker(a);a.addEventListener("message",this._acceptMessage,!1);a.addEventListener("error",this._errorMessage,!1);this.worker=a;b&&this.importScripts(b);return a},postMessage:function(a,b){if(a instanceof Array||"object"!=typeof a)a={data:a};var c=Math.floor(64E9*Math.random()).toString(36);a.msgId=c;c=this._queue[c]=new e;this.worker?(b?this.worker.postMessage(a,b):this.worker.postMessage(a),
this.emit("start-message",{target:this,message:a})):c.reject({message:"No worker was set."});return this.returnDeferreds?c:c.promise||c},terminate:function(){var a=Object.keys(this._queue);this.worker&&this.worker.terminate();for(var b=a.length-1;0<=b;b--)this._queue[a[b]].cancel("terminated"),delete this._queue[a[b]]},addWorkerCallback:function(a,b){var c=this._getUrl(a,!0);!1===c?(b=new e,b.reject({message:"Could not load text from "+a})):(b=this.postMessage({action:"add-callback",url:c,cbName:b||
"main"}),b.then(g.hitch(this,function(a){a.target=this;this.emit("callback-added",a)})));return b},importScripts:function(a){Array.isArray(a)||(a=[a]);a=a.map(function(a){a=this._getUrl(a,!0);this._useProxy&&!f.hasSameOrigin(a,location.href)&&(a=f.getProxyUrl(a).path+"?"+encodeURI(a));return a},this);a=this.postMessage({action:"import-script",url:a});a.then(g.hitch(this,function(a){a.target=this;this.emit("scripts-imported",a)}));return a},_acceptMessage:function(a){var b=a.data,c=b.msgId;if(b.status&&
"debug"==b.status)console[b.showAs||"debug"](b);else if(c&&c in this._queue){var d=this._queue[c];"progress"==b.status?d.progress(a.data):("error"==b.status?d.reject(a.data):d.resolve(a.data),delete this._queue[c])}this.emit("message",{message:a.data,event:a,target:this})},_errorMessage:function(a){this.onerror||this.onError?this.onerror?this.onerror(a):this.onError(a):console.log("Worker Error: "+a.message+"\nIn "+a.filename+" on "+a.lineno)},_getUrl:function(a,b){if(!a)return console.error("can not resolve empty path"),
!1;a.match(/\.js$/)||(a+=".js");a=d.toUrl(a);return b?f.getAbsoluteUrl(a):a},_getRemoteText:function(a,b){(a=this._getUrl(a))&&c.get(a,{sync:!1,handleAs:"text",headers:{"X-Requested-With":"","Content-Type":"text/plain"}}).then(function(a){b(a)})},_startBlobWorker:function(){var a=this._xdSource;a||(a=this._getUrl("./mutableWorker"),a=new n(["if(!self._mutable){importScripts('"+a+"');}"],{type:"text/javascript"}),a=this._xdSource=m.createObjectURL(a));try{return new Worker(a)}catch(p){return console.log(p.message),
!1}}});b("extend-esri")&&g.setObject("workers.WorkerClient",k,a);return k})},"esri/dijit/geoenrichment/utils/GeometryUtil_base":function(){(function(k){function h(a,b){var c=a.length;if(3>c)return 0;b||(b=a[0]);var d=b[0];b=b[1];for(var e=a[c-1],c=e[0]-d,f=e[1]-b,g=0,h=0,k=a.length;h<k;h++)var e=a[h],u=e[0]-d,e=e[1]-b,g=g+(u*f-c*e),c=u,f=e;return g/2}var e={};e.calculateRingArea=h;e.calculateRingCentroid=function(a,b){var c=a.length;if(!c)return null;b||(b=a[0]);var d=b[0];b=b[1];var e=0,f=0,g=0;
if(2<c)for(var h=a[c-1],c=h[0]-d,k=h[1]-b,u=0,t=a.length;u<t;u++)var h=a[u],z=h[0]-d,h=h[1]-b,w=z*k-c*h,e=e+w,f=f+(c+z)*w,g=g+(k+h)*w,c=z,k=h;0==e?f=g=0:(f/=3*e,g/=3*e);return[d+f,b+g]};e.INTERIOR=1;e.EXTERIOR=-1;e.BOUNDARY=0;e.createRingInfo=function(a,c){return new b(a,c)};e.createSegmentCoordinates=function(b){return new a(null,0,0,b)};var g=function(a){return function(){for(var b in a){var c=a[b];this[b]="function"===typeof c?c.bind(this):c}a.ctr.bind(this).apply(this,arguments)}},c=g({xmin:null,
ymin:null,xmax:null,ymax:null,spatialReference:null,ctr:function(a,b,c,e,g){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=e;this.spatialReference=g},printOut:function(){console.log([this.xmin,this.xmax,this.ymin,this.ymax].join(" "))}}),b=g({ring:null,origin:null,area:0,clockwise:!1,extent:null,_coords:null,ctr:function(a,b){this.ring=a;this.origin=b;a=this.ring.length-1;if(!(0>a)){if(!a)a++;else if(this.ring[a][0]!=this.ring[0][0]||this.ring[a][1]!=this.ring[0][1])a++,this.ring.push(this.ring[0].slice());
var d=0,e=0;b=!b;this.extent=new c(this.ring[0][0],this.ring[0][1],this.ring[0][0],this.ring[0][1]);for(var f=0;f<a;f++){var g=this.ring[f],k=g[0];b&&(d+=k);k<this.extent.xmin?this.extent.xmin=k:k>this.extent.xmax&&(this.extent.xmax=k);k=g[1];b&&(e+=k);k<this.extent.ymin?this.extent.ymin=k:k>this.extent.ymax&&(this.extent.ymax=k)}b&&(this.origin=[d/a,e/a]);this.area=h(this.ring,this.origin);0>=this.area?this.area=-this.area:this.clockwise=!0}},setDirection:function(a){this.clockwise==!a&&(this.ring.reverse(),
this.clockwise=!this.clockwise,this._coords=null)},testPoint:function(a,b){a=this.getRingCoordinates(b).testPoint(a[0]-this.origin[0],a[1]-this.origin[1]);return this.clockwise?a:-a},generalize:function(a,b,c){function d(c,d,e){z=c;w=d;if(e||B<t)t=a,C=z-n,A=w-n,B=Math.sqrt(C*C+A*A),B>a*b?(C/=B,A/=B):B=0;t*=b}function e(){if(!B)return!0;var a=f.dx,b=f.dy,c=Math.sqrt(a*a+b*b);return c-a*C-b*A>=.9*c}b=b||.75;var f=this.getRingCoordinates(a),g=f.xs,k=f.ys,n=g[0],u=k[0],t,z,w,C,A,B=0,y=g.length-1;d(g[y],
k[y],!0);for(var D=this,F=this.clockwise?function(a){D.ring.splice(a,1)}:function(a){D.ring.splice(-a-1,1)};0<y--&&4<g.length;){var E=g[y],G=k[y];f.setSegment(n,u,E,G)&&f.testPointOnTouch(z,w,t)&&e()?(g.splice(y+1,1),k.splice(y+1,1),F(y+1),d(E,G)):(n=z,u=w,d(E,G,!0))}this._coords=null;c&&(this.area=h(this.ring,this.origin),this.clockwise||(this.area=-this.area))},getRingCoordinates:function(b,c){if(c)return new a(this.ring,c[0],c[1],b,this.extent,this.clockwise);this._coords&&this._coords.eps==b||
(this._coords=new a(this.ring,this.origin[0],this.origin[1],b,this.extent,this.clockwise));return this._coords}});e.RingInfo=b;var a=g({xs:null,ys:null,extent:null,eps:NaN,dx:null,dy:null,_sx:null,_sy:null,ctr:function(a,b,e,g,h,k){this.xs=[];this.ys=[];a||(a=[]);void 0===b&&(b=0);void 0===e&&(e=0);void 0===g&&(g=0);this.eps=Math.max(g,0);h&&(g=this.eps/2,this.extent=new c(h.xmin-b-g,h.ymin-e-g,h.xmax-b+g,h.ymax-e+g));var d=a.length-1;if(!(0>d))for(h=d?a[d][0]==a[0][0]&&a[d][1]==a[0][1]?d:d+1:1,g=
k?1:-1,k=k?0:d;h--;k+=g)d=a[k],this.xs.push(d[0]-b),this.ys.push(d[1]-e)},testPoint:function(a,b){if(!this._pointBelongsToExtent(a,b))return-1;var c=this.xs.length,d=!1;this.dy=this.ys[0]-this.ys[c-1];if(0==this.dy){for(d=c;1<d--&&(this.dy=this.ys[d]-this.ys[d-1],0==this.dy););if(0==this.dy)return 0}for(var d=0<this.dy,e=0,f=this.xs[0],g=this.ys[0],h,k,u=1;u<=c;u++,f=h,g=k)if(k=u==c?0:u,h=this.xs[k],k=this.ys[k],this.setSegment(f,g,h,k)){var t=g-b,z=k-b,w=!1;0>t&&(t=-t,z=-z,w=!0);if(!(t>this.eps&&
z>this.eps)){if(this.testPointOnTouch(a,b,this.eps))return 0;0==t?0!==z&&(0>z&&(d=!d),a<f&&d&&e++):0==z?d=w:0>z&&a<f+this.dx/this.dy*(b-g)&&e++}}return 0!=e%2?1:-1},testPointOnTouch:function(a,b,c){var d=this.findIntersectionDelta(a,b,a-this.dy,b+this.dx);a=this._sx+d*this.dx-a;b=this._sy+d*this.dy-b;return a*a+b*b<=c*c},_pointBelongsToExtent:function(a,b){return a>=this.extent.xmin&&a<=this.extent.xmax&&b>=this.extent.ymin&&b<=this.extent.ymax},setSegment:function(a,b,c,e){this._sx=a;this.dx=c-a;
this._sy=b;this.dy=e-b;return 0!=this.dx||0!=this.dy},findIntersectionDelta:function(a,b,c,e,g){void 0===g&&(g=!0);c-=a;e-=b;var d=this.dy*c-this.dx*e;if(0==d)return 0;var f=a-this._sx,h=b-this._sy,k=h*c-f*e,f=g?0:h*this.dx-f*this.dy;0>d&&(d=-d,k=-k,f=-f);return g||(f=0>f?0:f<d?f/d:1,this.testPointOnTouch(a+f*c,b+f*e,this.eps))?0>=k?0:k<d?k/d:1:-1},addPointOfSegmentAt:function(a){this.xs.push(this._sx+a*this.dx);this.ys.push(this._sy+a*this.dy)}});e.RingCoordinates=a;k.document?define(function(){return e}):
k.GeometryUtil_base=e})(this)},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/DefaultAttachmentsStore":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/when","./WebMapAttachmentStore"],function(k,h,e,g){return k(null,{supportsMultipleAreas:!0,_analysisAreas:null,_currentAreaIndex:-1,_webMapStores:null,constructor:function(c){this._analysisAreas=c},initialize:function(){var c=this;this._webMapStores={};return h(this._analysisAreas.map(function(b,
a){if(b=b.feature||b.location||b.additionalFeatures&&b.additionalFeatures[0])return(c._webMapStores[a]=new g(b)).initialize()})).then(function(){return c})},_callStoreMethod:function(c){var b=this._webMapStores[this._currentAreaIndex];return b?e(b[c](),function(a){return a?a.slice():[]}):[]},getAttachments:function(){return this._callStoreMethod("getAttachments")},getAttributes:function(){return this._callStoreMethod("getAttributes")},getNotes:function(){return this._callStoreMethod("getNotes")},
setCurrentAnalysisAreaIndex:function(c){this._currentAreaIndex=c}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/WebMapAttachmentStore":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttributesUtil esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/ImageUtil ./AttachmentsUtil".split(" "),function(k,h,e,g,c,b,a){var f=
{_cache:{},getThumbnail:function(a){this._cache[a.url]||(this._cache[a.url]=this._getDataURL(a));return this._cache[a.url]},_getDataURL:function(a){return 0===a.url.indexOf("data:")?a.url:c.request(a.url).then(function(c){return c&&c.Attachment&&b.base64DataToDataURL(c.Attachment,a.contentType)}).otherwise(function(){return null})}};return k(null,{_attachmentInfos:null,_feature:null,_fieldInfos:null,_attributes:null,constructor:function(a,b){this._feature=a;this._attachmentInfos=b},initialize:function(){this._tryGetFieldInfosAndAttributes();
return e(this._attachmentInfos||this._tryGetAttachmentInfos()).always(function(){return!!this._attachmentInfos}.bind(this))},_tryGetFieldInfosAndAttributes:function(){var a=this._feature.getLayer();this._fieldInfos=(a=this._feature.infoTemplate||a&&a.infoTemplate)&&a.info.fieldInfos||[];this._attributes=h.mixin({},this._feature.attributes)},_tryGetAttachmentInfos:function(){return e(a.getFeatureAttachmentInfos(this._feature),function(a){this._attachmentInfos=a}.bind(this))},getAttachments:function(){return this._attachmentInfos?
this._attachmentInfos.map(function(a){return{getThumbnail:function(){return f.getThumbnail(a)},getAttachmentUrl:function(){return a.url}}}):[]},getAttributes:function(){return g.composeAttributesFromFieldInfos(this._fieldInfos,this._attributes)},getNotes:function(){return[]}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttributesUtil":function(){define(["dojo/_base/lang","esri/layers/CodedValueDomain","esri/dijit/geoenrichment/utils/DateUtil","esri/dijit/geoenrichment/utils/ObjectUtil"],
function(k,h,e,g){return{composeAttributesFromFieldInfos:function(c,b){return c&&c.filter(function(a){return a.visible}).map(function(a){var c=a.fieldName,d=a.label,e=a.format&&a.format.places,g=a.format&&a.format.digitSeparator,h=a.format&&a.format.dateFormat,k=b[a.fieldName];a=(a=a.format)&&a.dateFormat?"esriFieldTypeDate":a&&void 0!==a.places?0<a.places?"esriFieldTypeDouble":"esriFieldTypeInteger":"esriFieldTypeString";return{name:c,alias:d,places:e,digitSeparator:g,dateFormat:h,value:k,type:a,
domain:null,length:void 0}})},formatAttributeValue:function(c,b){b=b||{};var a=b.hasOwnProperty("unavailableDataValue")?b.unavailableDataValue:"";if(!c||null===c.value||void 0===c.value)return a;if(!b.skipFormattedValue&&c.formattedValue&&c.formattedValue!==a)return c.formattedValue;var f=c.domain&&"codedValue"===c.domain.type?new h(c.domain):null;f?(b=f.getName(c.value))||(b=c.value+""):"esriFieldTypeString"===c.type?b=c.value:"esriFieldTypeDate"===c.type?(b=new Date,b.setTime(c.value),b=e.formatDateShort(b)):
(b=b.format,b=g.formatNumber(c.value,{places:b&&void 0!==b.decimals?b.decimals:c.places,noSeparator:b&&void 0!==b.useThousandsSeparator?!b.useThousandsSeparator:!1===c.digitSeparator}));return null===b||void 0===b?a:b},attributeToJson:function(c){return{name:c.name,alias:c.alias,type:c.type,value:c.value,domain:c.domain&&(c.domain.toJson?c.domain.toJson():k.clone(c.domain)),places:c.places,digitSeparator:c.digitSeparator,dateFormat:c.dateFormat,length:c.length}},attributeFromJson:function(c){return{name:c.name,
alias:c.alias,type:c.type,value:c.value,domain:c.domain,places:c.places,digitSeparator:c.digitSeparator,dateFormat:c.dateFormat,length:c.length}}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttachmentsUtil":function(){define([],function(){return{getFeatureAttachmentInfos:function(k){var h=k.getLayer();if(h&&h.hasAttachments&&h.queryAttachmentInfos&&h.objectIdField)return h.queryAttachmentInfos(k.attributes[h.objectIdField])}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/CustomAttachmentsStore":function(){define(["dojo/_base/declare"],
function(k){var h={fromJson:function(e){return{getAttachmentsForAreaAt:function(g){g=e.supportsMultipleAreas?g:0;return(e.areaAttachements[g]&&e.areaAttachements[g].attachments||[]).map(function(c){return{description:c.description,getThumbnail:function(){return c.thumbnail},getAttachmentUrl:function(){return c.url}}})},getAttributesForAreaAt:function(g){g=e.supportsMultipleAreas?g:0;return e.areaAttachements[g]&&e.areaAttachements[g].attributes||[]},getNotesForAreaAt:function(g){g=e.supportsMultipleAreas?
g:0;return e.areaAttachements[g]&&e.areaAttachements[g].notes||[]}}}};return k(null,{supportsMultipleAreas:!1,_currentAreaIndex:0,_provider:null,constructor:function(e){this._provider=e.getAttachmentsForAreaAt||e.getAttributesForAreaAt||e.getNotesForAreaAt?e:h.fromJson(e);this.supportsMultipleAreas=e.supportsMultipleAreas},initialize:function(){},getAttachments:function(){return this._provider.getAttachmentsForAreaAt?this._provider.getAttachmentsForAreaAt(this._currentAreaIndex):[]},getAttributes:function(){return this._provider.getAttributesForAreaAt?
this._provider.getAttributesForAreaAt(this._currentAreaIndex):[]},getNotes:function(){return this._provider.getNotesForAreaAt?this._provider.getNotesForAreaAt(this._currentAreaIndex):[]},setCurrentAnalysisAreaIndex:function(e){this._currentAreaIndex=e}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/commands/mapToImage/MapToURLUtil":function(){define("require dojo/_base/declare esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojo/dom-style esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/utils/ImageInfoUtil".split(" "),
function(k,h,e,g,c,b,a,f){function d(){var a=new e;k("esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/layers/GraphicsLayer ./DotDensityToImageUtil ./LegendToLayerUtil".split(" "),function(b,c,d,e,f,g){m=c;l=d;p=e;q=f;v=g;n=h(b,{_getPrintDefinition:function(a,b){var c=this.inherited(arguments);console.log(c);return c},_createOperationalLayers:function(a,b){var c=this.inherited(arguments);if(b.__legendLayerId){var d=c.filter(function(a){return a.id===b.__legendLayerId})[0];
c.splice(c.indexOf(d),1);c.push(d)}return c}});a.resolve()});return a.promise}var n,m,l,p,q,v,r,u={setPrintMapTaskUrl:function(b){r=b;a.registerCORS(b)},mapToURL:function(a,b,c){var f=u._getUrlForMap(a);if(f)return f;f=d().then(function(){return u._replaceDotDensityLayersWithPictureMarkers(a).then(function(d){return g(b&&v.legendToGraphicsLayer(b,a,c),function(b){b&&a.addLayer(b);return g(u._runPrintTask(a,c,b),function(c){b&&a.removeLayer(b);u._rollbackReplacing(a,d);var f=new e;setTimeout(function(){f.resolve(c.url)},
100);return f.promise})})})});u._putUrlToCache(a,f);return f},_replaceDotDensityLayersWithPictureMarkers:function(a){var b=[];for(i=0;i<a.graphicsLayerIds.length;i++)layer=a.getLayer(a.graphicsLayerIds[i]),layer.loaded&&layer.visible&&q.isDotDensity(layer)&&b.push(u._createGraphicsLayerFromDotDensityLayer(i,layer,a));return c(b)},_createGraphicsLayerFromDotDensityLayer:function(a,b,c){return q.createPictureMarkersFromDotDensityLayer(b,c.extent,c).then(function(d){if(!d)return null;var e=new p;d.map(function(a){e.add(a)});
c.addLayer(e,a);b.visible=!1;return{addedLayer:e,hiddenLayer:b}}).otherwise(function(a){console.log(a);return null})},_runPrintTask:function(a,c,d){function e(){var e=new n(r),f=new m;f.map=a;var g=new l;g.exportOptions={width:3.125*b.get(c,"width"),height:3.125*b.get(c,"height"),dpi:300};g.format="png32";g.showAttribution=!1;g.__legendLayerId=d&&d.id;f.template=g;return e.execute(f)}return g(e(),function(a){return a},function(a){console.log(a);return g(e(),function(a){return a},function(a){console.log(a);
return e()})})},_rollbackReplacing:function(a,b){b.forEach(function(b){b&&b.addedLayer&&a.removeLayer(b.addedLayer);b&&b.hiddenLayer&&(b.hiddenLayer.visible=!0)})},urlToSrc:function(a,b){return b.saveImagesAsDataUrl?f.getRemoteImageDataUrl(a,{sizeLimit:1500}):a}},t,z=0;u.enableCaching=function(){t={}};u.clearCaching=function(){t=null};u._putUrlToCache=function(a,b){t&&b&&(a.__mapToImageUtilKey=z++,t[a.__mapToImageUtilKey]=b)};u._getUrlForMap=function(a){return t&&t[a.__mapToImageUtilKey]};return u})},
"widgets/BusinessAnalyst/utils/ReportUtil":function(){define("dojo/Deferred dojo/promise/all dojo/when dojo/_base/array esri/request jimu/portalUtils dojo/i18n!../nls/strings".split(" "),function(k,h,e,g,c,b,a){STANDARD_INFOGRAPHIC_TYPEKEYWORD="esriReportPlayerStandardInfographic";var f=[];f.US=["LANDSCAPESUMMARYREPORT"];return{_ownedCachedCustomReports:null,_sharedCachedCustomReports:null,_cachedCountryClassicReports:[],_cachedInfographicReports:null,_countryInitDfds:[],getAvailableClassicReports:function(b,
c){var d=this,h=[],n=new k,q;c&&g.forEach(c.countryConfig,function(a){b==a.countryID&&(q=a)});q||(q={countryID:b,allowEsriReports:!0,allowEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,disabledReports:[],disabledInfographics:[]});var v=null,r=null,u=null;q.allowEsriReports&&(v=h.length,h.push({value:"esriReports",label:a.esriReports,children:[]}));q.allowMyReports&&(r=h.length,h.push({value:"myReports",label:a.myReports,children:[]}));
q.allowSharedReports&&(u=h.length,h.push({value:"sharedReports",label:a.sharedReports,children:[]}));e(this._initReports(b),function(){q.allowEsriReports&&d._cachedCountryClassicReports[b]&&0<d._cachedCountryClassicReports[b].length&&g.forEach(d._cachedCountryClassicReports[b],function(a){q.disabledReports.includes(a.reportID)||f[b]&&f[b].includes(a.reportID.toUpperCase())||h[v].children.push(d._formatClassicReportsForDropDown(a))});var a=["esriWebInfographicReport","esriWebSingleInfographic","esriWebBlankInfographic",
"esriWebHiddenInfographic","esriWebComparisonReport"];q.allowMyReports&&g.forEach(d._ownedCachedCustomReports,function(c){c.properties.countries.includes(b)&&!q.disabledReports.includes(c.id)&&(c.typeKeywords.some(function(b){return 0<=a.indexOf(b)})||h[r].children.push(d._formatClassicReportsForDropDown(c)))});q.allowSharedReports&&g.forEach(d._sharedCachedCustomReports,function(c){c.properties.countries.includes(b)&&!q.disabledReports.includes(c.id)&&(c.typeKeywords.some(function(b){return 0<=a.indexOf(b)})||
h[u].children.push(d._formatClassicReportsForDropDown(c)))});var c=function(a,b){a=a.label.toUpperCase();b=b.label.toUpperCase();var c=0;a>b?c=1:a<b&&(c=-1);return c};0<h.length&&h[0].children.sort(c);1<h.length&&h[1].children.sort(c);2<h.length&&h[2].children.sort(c);n.resolve(h)});return n},_formatClassicReportsForDropDown:function(a){return a.metadata?{label:a.metadata.title,value:a.reportID,reportType:a.metadata.type}:{label:a.title,value:a.id,reportType:a.properties.type,item:{itemid:a.id,url:portalUrl,
token:esri.id.credentials[0].token}}},getAvailableInfographicReports:function(b,c){var d=this,f=[],h=new k,n;c&&g.forEach(c.countryConfig,function(a){b==a.countryID&&(n=a)});n||(n={countryID:b,allowEsriReports:!0,allowEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,disabledReports:[],disabledInfographics:[]});var v=null,r=null,u=null;n.allowEsriInfographics&&(v=f.length,f.push({value:"esriReports",label:a.esriInfographics,children:[]}));
n.allowMyInfographics&&(r=f.length,f.push({value:"myReports",label:a.myInfographics,children:[]}));n.allowSharedInfographics&&(u=f.length,f.push({value:"sharedReports",label:a.sharedInfographics,children:[]}));e(this._initReports(b),function(){n.allowEsriInfographics&&g.forEach(d._cachedInfographicReports,function(a){a.properties.countries.includes(b)&&!n.disabledInfographics.includes(a.id)&&f[v].children.push(d._formatInfographicReportsForDropDown(a))});n.allowMyInfographics&&g.forEach(d._ownedCachedCustomReports,
function(a){a.properties.countries.includes(b)&&!n.disabledInfographics.includes(a.id)&&(a.typeKeywords.includes("esriWebInfographicReport")||d._isOldPortalInfographic(a))&&f[r].children.push(d._formatInfographicReportsForDropDown(a))});n.allowSharedInfographics&&g.forEach(d._sharedCachedCustomReports,function(a){a.properties.countries.includes(b)&&!n.disabledInfographics.includes(a.id)&&(a.typeKeywords.includes("esriWebInfographicReport")||d._isOldPortalInfographic(a))&&f[u].children.push(d._formatInfographicReportsForDropDown(a))});
var a=function(a,b){a=a.label.toUpperCase();b=b.label.toUpperCase();var c=0;a>b?c=1:a<b&&(c=-1);return c};0<f.length&&f[0].children.sort(a);1<f.length&&f[1].children.sort(a);2<f.length&&f[2].children.sort(a);h.resolve(f)});return h},_isOldPortalInfographic:function(a){return a.properties&&a.properties.isHidden&&"true"==a.properties.isHidden?!1:a.properties&&a.properties.isGraphicReport&&"true"==a.properties.isGraphicReport?!0:!1},_formatInfographicReportsForDropDown:function(a){return{label:a.title,
value:a.id}},_initReports:function(a){var d=[],e=this;if(this._countryInitDfds[a])return this._countryInitDfds[a];this._countryInitDfds[a]=new k;b.getPortal(portalUrl).loadSelfInfo().then(function(b){b=b&&b.helperServices&&b.helperServices.geoenrichment&&b.helperServices.geoenrichment.url?b.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";e._cachedCountryClassicReports[a]||d.push(c({url:b+"/Geoenrichment/reports/"+a,content:{appID:"webappbuilder",
f:"json",langCode:"en-us"}}).then(function(b){e._cachedCountryClassicReports[a]=b.reports},function(a){alert(a)}));e._cachedInfographicReports||(e._cachedInfographicReports=[],d.push(c({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:"typekeywords:(esriReportPlayerStandardInfographic jsapiVersion3.29)"}}).then(function(a){g.forEach(a.results,function(a){e._cachedInfographicReports.push(a)})},function(a){alert(a)})));
e._ownedCachedCustomReports||(e._ownedCachedCustomReports=[],d.push(c({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) owner:'+esri.id.credentials[0].userId}}).then(function(a){g.forEach(a.results,function(a){e._ownedCachedCustomReports.push(a)})},function(a){alert(a)})));e._sharedCachedCustomReports||(e._sharedCachedCustomReports=[],
d.push(c({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:shared type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId}}).then(function(a){g.forEach(a.results,function(a){e._sharedCachedCustomReports.push(a)})},function(a){alert(a)})),d.push(c({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",
sortOrder:"desc",q:'access:org type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId}}).then(function(a){g.forEach(a.results,function(a){e._sharedCachedCustomReports.push(a)})},function(a){alert(a)})));0===d.length?e._countryInitDfds[a].resolve():h(d).then(function(){e._countryInitDfds[a].resolve()})});return this._countryInitDfds[a]}}})},"widgets/BusinessAnalyst/esriAnalystX/widgets/Selects/FilteringSelectTree":function(){define(["dojo/_base/declare",
"./FilteringSelect","esri/dijit/geoenrichment/SelectableTree","../../widgets/SelectableTreeGrid/SelectableTreeGrid","xstyle/css!./css/FilteringSelect.css"],function(k,h,e,g){function c(a,b){var c=[];a.forEach(function(a){a.children.forEach(function(a){var d={};d[b.idProperty]=a[b.idProperty];d[b.labelProperty]=a[b.labelProperty];d.__item=a;c.push(d)})});return c}function b(a,b,c){var d={};b.forEach(function(a){d[a[c.idProperty]]=a});var e=[];a.forEach(function(a){var b=a.children.filter(function(a){return d[a[c.idProperty]]});
if(b.length){var f={};f[c.idProperty]=a[c.idProperty];f[c.labelProperty]=a[c.labelProperty];f.children=b.map(function(a){var b={};b[c.idProperty]=a[c.idProperty];b[c.labelProperty]=a[c.labelProperty];return b});e.push(f)}});return{treeData:e,idsHash:d}}g=k(g,{showRootCheckbox:!1,showCheckboxColumn:!1,enableRowSelection:!0,expandOnNodeClick:!0,baseTree:null,hostWidget:null,defaultExpand:null,_firstTimeExpand:!0,getLabel:function(a,b){return a[this.labelProperty]},onRowsSelected:function(a,b){a=a&&
a[0];b=b&&b[0];a&&!a.children&&(b.setAttribute("item",a[this.idProperty]),this.onChange(b))},createOptions:function(a,c,d){a=b(this.baseTree.data,a,this);this.items=a.idsHash;this.tree.clear();if(this._firstTimeExpand){this._firstTimeExpand=!1;var e;if(this.defaultExpand)e=Object.assign({},this.defaultExpand);else{e={};var f=this;a.treeData.forEach(function(a){e[a[f.idProperty]]=!0})}this.grid._expanded=e}this.tree.addNodes(a.treeData);this.refresh()},getHighlightedOption:function(){},highlightFirstOption:function(){},
highlightLastOption:function(){},clearResultList:function(){this.tree.clear()},onChange:function(a){}});k=k(h,{dropDownClass:g,tree:null,autoComplete:!1,defaultExpand:null,postCreate:function(){this.inherited(arguments);this.tree&&this.setItems(this._getStoreItemsFromTree())},_setTreeAttr:function(a){this.tree=a;this._isCreated&&this.setItems(this._getStoreItemsFromTree());this.dropDown&&(this.dropDown.baseTree=this.tree)},_getStoreItemsFromTree:function(){return c(this.tree.data,this)},_startSearch:function(a){if(!this.dropDown){var b=
this.id+"_popup";this.dropDown=new this.dropDownClass({gridClass:"esriMapsAnalystXSelectableTreeGrid esriMapsAnalystXFilteringSelect_treeGrid",onChange:function(){return this._selectOption.apply(this,arguments)}.bind(this),id:b,dir:this.dir,textDir:this.textDir,tree:new e([],{idProperty:this.idProperty}),idProperty:this.idProperty,labelProperty:this.labelProperty,baseTree:this.tree,hostWidget:this,defaultExpand:this.defaultExpand})}this.inherited(arguments)},_openResultList:function(){this.inherited(arguments);
this.dropDown&&this.dropDown.refresh()},getSelectedItem:function(){var a=this.inherited(arguments);return a&&a.__item}});k.NONE_ID=h.NONE_ID;return k})},"widgets/BusinessAnalyst/esriAnalystX/widgets/Selects/FilteringSelect":function(){define("dojo/_base/declare dojo/store/Memory dojo/query dojo/dom-class dojo/dom-style dojo/dom-geometry dijit/form/FilteringSelect dijit/form/_ComboBoxMenu ../../dijit/tooltips/TooltipUtil dojo/i18n!../../../nls/strings xstyle/css!./css/FilteringSelect.css".split(" "),
function(k,h,e,g,c,b,a,f,d,n){var m=k(h,{filtered:!1,noneItem:null,get:function(a){return"None"==a?this.noneItem:this.inherited(arguments)},query:function(a,b){var c=this.inherited(arguments);this.filtered=c.length!=this.data.length;return c}});h=k(f,{baseClass:"dijitComboBoxMenu",idProperty:"value",postCreate:function(){this.inherited(arguments);d.autoTooltip(this.domNode)},_createMenuItem:function(){var a=this.inherited(arguments);a.className+=" TrimWithEllipses";return a},selectItem:function(a){if(this.items){for(var b=
-1,c=0;c<this.items.length;c++)if(this.items[c][this.idProperty]==a){b=c;break}if(!(0>b))for(a=this.containerNode.children,c=0;c<a.length;c++){var d=a[c];if("none"!=d.style.display&&d.getAttribute("item")==b){this.selectLastNode();this.set("selected",d,!0);break}}}}});k=k(a,{forceWidth:!1,autoWidth:!1,selectOnClick:!0,idProperty:"value",labelProperty:"label",placeHolder:null,dropDownClass:h,options:null,_assignedStore:null,_isCreated:!1,postMixInProperties:function(){this.searchAttr=this.labelAttr=
this.labelProperty;var a={};a[this.idProperty]="None";a[this.labelAttr]=this.placeHolder||n.None;this.set("store",new m({idProperty:this.idProperty,noneItem:a}));this.inherited(arguments)},_startSearch:function(){this.inherited(arguments);this.dropDown.idProperty=this.idProperty;this.dropDown.labelProperty=this.labelProperty},postCreate:function(){this.inherited(arguments);d.autoTooltip(this.domNode);(this.options||this._assignedStore)&&this.setItems(this.options||this._assignedStore.data);g.add(this.domNode,
"esriMapsAnalystXFilteringSelect");this._isCreated=!0},_onFocus:function(){this._updateTrimWithEllipses(!0);this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this._updateTrimWithEllipses(!1)},_updateTrimWithEllipses:function(a){var b=e(".dijitInputInner",this.domNode)[0];if(b)g[a?"remove":"add"](b,"TrimWithEllipses")},_setStoreAttr:function(a){a instanceof m?(this.store=a,this.inherited(arguments)):(this._assignedStore=a,this._isCreated&&this.setItems(this._assignedStore.data))},
_setOptionsAttr:function(a){this.options=a;this._isCreated&&this.setItems(this.options)},setItems:function(a,b){this.store.setData(a);this.closeDropDown();this.dropDown&&this.dropDown.clearResultList();a=this.get("value");b=b||"None";this.set("value",b);b==a&&this.emit("Change");this._updateTrimWithEllipses(this.get("focused"))},_openResultList:function(a,d,e){var f=b.getContentBox(this.domNode).w;c.set(this.dropDown.domNode,"width",f+"px");this.inherited(arguments);this.store.filtered||this.dropDown.selectItem&&
this.dropDown.selectItem(this.get("value"))},_setBlurValue:function(){var a=this.get("displayedValue");"undefined"==typeof this.item&&(this.item=null,this.set("displayedValue",a));this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0);this._refreshState();this.focusNode.removeAttribute("aria-activedescendant")},getSelectedItem:function(){var a=this;return this.store.data.filter(function(b){return b[a.idProperty]==a.get("value")})[0]}});k.NONE_ID="None";return k})},"widgets/BusinessAnalyst/esriAnalystX/dijit/tooltips/TooltipUtil":function(){define("dojo/dom-construct dojo/dom-style dojo/dom-geometry dojo/dom-class dojo/query dojo/on dojox/gfx dojo/sniff dojo/aspect dojox/uuid/generateRandomUuid dijit/Tooltip ../utils/DomUtil ../utils/MouseUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/domReady!".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q){function v(){B&&(B.isMultilineContainer?w.hideTooltipForNode(B):(clearInterval(B.__autoTooltipInLayoutCheckHandle),delete B.__autoTooltipInLayoutCheckHandle,m.hide(B)),B=null)}function r(a,b){b=b||"";var c=k.create("div",{class:"esriMapsAnalystXValidationTooltip"+b},document.body);!b&&k.create("div",{class:"esriMapsAnalystXValidationTooltipTip"+b},c);k.create("div",{innerHTML:a,class:"esriMapsAnalystXValidationTooltipBody"+b},c);h.set(c,"position","fixed");return c}
function u(a,c){function d(){a&&(document.body.removeChild(a),k.forEach(function(a){a.remove()}),a=k=null)}c=c.textbox||c;var f=e.getMarginBox(a),g=e.position(c);"rtl"===document.dir?h.set(a,{left:g.x-f.w+"px",top:g.y+g.h/2-f.h/2+"px"}):h.set(a,{left:g.x+g.w+"px",top:g.y+g.h/2-f.h/2+"px"});var k=[b(document.body,"mousedown, keydown",d),b(c,"blur",d)];return{remove:d}}function t(a,b,c){function d(){var a=k.create("div",{class:"esriMapsAnalystXClosableTooltipTip"},f);g.add(a,"right"===c?"esriMapsAnalystXClosableTooltipTipRight":
"esriMapsAnalystXClosableTooltipTipLeft")}function e(){l=k.create("div",{class:"esriMapsAnalystXClosableTooltipBody"},f);k.create("div",{innerHTML:a,class:"esriMapsAnalystXClosableTooltipLabel"},l);m=k.create("div",{class:"esriMapsAnalystXClosableTooltipCloseButton esriMapsAnalystXCloseWindow esriMapsAnalystXCloseWindowWhite"},l)}b={class:"esriMapsAnalystXClosableTooltip "+(b||"")};b.id=n();var f=k.create("div",b,document.body),l,m;"right"!==c?(e(),d()):(d(),e());h.set(f,"position","fixed");return{tooltip:f,
body:l,closeButton:m}}function z(a,c,d,f){var g=e.getMarginBox(a.tooltip),k=e.position(c);"rtl"===document.dir&&"right"!==f||"rtl"!==document.dir&&"right"===f?h.set(a.tooltip,{left:k.x+k.w+"px",top:k.y+k.h/2-g.h/2+"px"}):h.set(a.tooltip,{left:k.x-g.w+"px",top:k.y+k.h/2-g.h/2+"px"});var m,n,p,q=function(){m&&clearTimeout(m);n&&clearInterval(n);p&&p.remove();a.tooltip.parentNode===document.body&&document.body.removeChild(a.tooltip)};n=setInterval(function(){l.isNodeInLayout(c)||q();l.isNodeVisible(c)?
l.show(a.tooltip):l.hide(a.tooltip)},300);d&&(m=setTimeout(q,d));p=b(a.closeButton,"click",function(){q()});a.tooltip._removeFunc=q;return a.tooltip}var w={},C={};w.hideTooltipForNode=q.hideTooltipForNode;w.setTooltipToNode=q.setTooltipToNode;w.createTooltip=function(a,c,d){var f={orientation:e.isBodyLtr(document)?"right":"left",offset:{x:15,y:0}};c&&(f.innerHTML=c);d&&(f=Object.assign(f,d));f.id=n();f.toMouseCursor&&(f.mouseEvent=p.getCursorPosition(),delete f.toMouseCursor);c=f.mouseEvent;delete f.mouseEvent;
d=f.htmlFragment;delete f.htmlFragment;var g=f.widget;delete f.widget;var l=f.orientation;delete f.orientation;var m=f.offset;delete f.offset;var q=f.horizontalOffset;delete f.horizontalOffset;var D=k.create("div",f,a?a.container:document.body);d?k.place(d,D):g&&g.placeAt(D);h.set(D,"position","fixed");var r=e.getMarginBox(D),v=function(a,b){var c=a.touches?event.touches[0].clientX:a.clientX;a=a.touches?event.touches[0].clientY:a.clientY;var d,e,f=m.x,g=m.y;"left"===l?0>c-r.w-f&&(d="right"):c+r.w+
f>document.body.clientWidth&&(d="left");a+r.h+g>document.body.clientHeight&&(e="above");d=d||l;h.set(D,{left:b?b+"px":c+("left"===d?-r.w-f:f)+"px",top:a+("above"===e?-r.h-g:g)+"px"});D.style.display=""};c&&v(c,q);f=[];f.push(b(a?a:document.body,a?"mouse-move, mousemove":"mousemove, touchmove",function(a){v(a,q)}));f.push(b(a?a:document.body,a?"mouse-out, mouseout":"mouseout, touchend",function(a){D.style.display="none"}));a={};a.handlers=f;a.tooltip=D;C[D.id]=a;return D};w.removeTooltip=function(a){if(a){a=
"string"===typeof a?a:a.id;var b=C[a];delete C[a];b&&(b.handlers.forEach(function(a){a.remove()}),k.destroy(b.tooltip))}};var A={};w.registerTooltipForSlider=function(a,c,f,g){var l={offsetX:0,offsetY:0,class:"esriMapsAnalystXTooltip"};c&&(l=Object.assign(l,c));l.id=n();var m=k.create("div",l,document.body);m.style.display="none";h.set(m,"position","fixed");var p=!1,q=function(c,f){if(!p){p=!0;m.style.display="";m.innerHTML=f();var g=e.getMarginBox(m),k=e.position(c);h.set(m,{left:k.x+k.w/2-g.w/2+
l.offsetX+"px",top:k.y-g.h-5+l.offsetY+"px"});var n=[];n.push(d.after(a,"onChange",function(){m.innerHTML=f();k=e.position(c);h.set(m,{left:k.x+k.w/2-g.w/2+"px",top:k.y-g.h-5+"px"})}));var q=function(){m.style.display="none";n.forEach(function(a){a.remove()});p=!1},r=!1;n.push(b(c,"mousedown, mouseDown, mouse-down",function(){r=!0;n.push(b(document,"mouseup, mouseUp, mouse-up",function(){q()}))}));n.push(b(c,"mouseout, mouseOut, mouse-out",function(){r||q()}))}};c=[];c.push(b(a.sliderHandle,"mouseover, mouseOver, mouse-over",
function(){g&&a.isSliderDisabled&&a.isSliderDisabled()||q(a.sliderHandle,function(){var b=g?a.get("value")[0]:a.get("value");return f?f(b):b})}));g&&c.push(b(a.sliderHandleMax,"mouseover, mouseOver, mouse-over",function(){a.isSliderDisabled&&a.isSliderDisabled()||q(a.sliderHandleMax,function(){return f?f(a.get("value")[1]):a.get("value")[1]})}));c.push(d.before(a,"destroy",function(){w.unregisterTooltipForSlider(a)}));a.tooltipId=m.id;var r={};r.tooltip=m;r.handlers=c;A[m.id]=r};w.unregisterTooltipForSlider=
function(a){var b=A[a.tooltipId];b&&(b.handlers.forEach(function(a){a.remove()}),k.destroy(b.tooltip));delete A[a.tooltipId];delete a.tooltipId};var B=null;w.autoTooltip=function(a,c,d){"string"===typeof c&&(c=c.split(" ").filter(function(a){return a&&!!a.trim().length}));c=c||[];c.push("TrimWithEllipses");d=d||[];d.push("esriMapsAnalystXInfoIcon");for(var e=0;e<c.length;e++)b(a,"."+c[e]+":mouseover, "+c[e]+":touchstart, ",function(a){this!==B&&this.offsetWidth<this.scrollWidth&&!this.noAutoTooltip&&
(a=getComputedStyle(this).width,a=Number(a.substr(0,a.length-2)),0>a-Math.round(a)&&this.offsetWidth==this.scrollWidth-1||(v(),B=this,a=B.autoTooltip||B.textContent||B.value,B.title&&(a+=" ("+B.title+")"),a&&m.show(a,B,["above","below"]),b.once(B,"mouseout, touchstart, touchout",function(){v()}),B.__autoTooltipInLayoutCheckHandle=setInterval(function(){l.isNodeInLayout(B)||v()},500)))});if(f("touch"))for(e=0;e<d.length;e++)b(a,"."+d[e]+":touchstart ",function(a){this!==B&&(B=this,B.title&&(m.show(B.title,
B,["above","below"]),b.once(B,"touchstart, touchout",function(){m.hide(B);B=null})))})};w.addAutoTooltipsToTabContainer=function(a){c(".tabLabel",a.domNode).forEach(function(a){g.add(a,"TrimWithEllipses")});w.autoTooltip(a)};w.setMultilineText=function(a,b,c,d){c=c||2;b=b.trim();d=d||["above","below"];g.remove(a,"TrimWithEllipses");a.style.overflow="hidden";a.innerHTML="";for(var e=b,f=!1;e;){c--;var h=k.create("div",null,a);h.style.overflow="hidden";h.style.whiteSpace="nowrap";for(var l=e;l;)if(h.textContent=
l,h.offsetWidth<h.scrollWidth-1)l=(l=l.match(/^(.*[^\s]+)\s+[^\s]+$/))&&l[1]||"";else break;!l||!c&&l!==e?(h.textContent=e,e="",h.style.textOverflow="ellipsis",f=!0):e=e.substr(l.length).trim()}f&&w.setTooltipToNode(a,function(){v();B=a;B.isMultilineContainer=!0;return b},{position:d})};w.showErrorTip=function(a,b){return u(r(b),a.domNode||a)};w.showNewStyleErrorTip=function(a,b,c){return u(r(b,"NewStyle"+(c?" esriMapsAnalystXWarningStyle":"")),a.domNode||a)};w.showAlertTooltip=function(a){a&&a.node&&
a.message&&(m.show(a.message,a.node,a.position||["above","below"]),setTimeout(function(){m.hide(a.node)},a.timeout||5E3))};w.showClosableTooltip=function(a){var b=t(a.message,a.tooltipClass,a.position);return z(b,a.component,a.timeout,a.position)};w.removeClosableTooltip=function(a){a&&a._removeFunc&&a._removeFunc()};w.showClosableTooltipOnVerticalBracket=function(c){var d=c.below||c.above,f=e.position(c.above,!0),g=e.position(d,!0),m="rtl"!==document.dir?"start"===c.direction:"end"===c.direction,
n=f.x+f.w*(m?0:1),f=f.y,p=g.y+g.h,q=k.create("div",{class:"esriMapsAnalystFlexibleTooltip_tooltip esriMapsAnalystXNonSelectable"},document.body),r=k.create("div",{class:"esriMapsAnalystFlexibleTooltip_surfaceContainer"},q),g={},n={top:f-2,left:n+(m?-3:3),height:p-f+4,width:10},v;for(v in n)g[v]=n[v]+"px";h.set(q,g);var u=a.createSurface(r,n.width,n.height);u.clear();u.createPolyline([{x:m?n.width:0,y:0},{x:m?0:n.width,y:0},{x:m?0:n.width,y:n.height},{x:m?n.width:0,y:n.height}]).setStroke({color:"#6E6E6E",
width:6});c.component=q;var m=t(c.message,c.tooltipClass,c.position),y=function(){clickHandler&&clickHandler.remove();w&&clearInterval(w);u&&u.clear();k.destroy(r);k.destroy(q)},w=setInterval(function(){l.isNodeInLayout(d)||y();l.isNodeVisible(d)?h.set(q,"visibility","visible"):h.set(q,"visibility","hidden")},300);c.timeout&&setTimeout(y,c.timeout);clickHandler=b(m.closeButton,"click",y);tooltip=z(m,c.component,c.timeout,c.position);var A=tooltip._removeFunc;tooltip._removeFunc=function(){A();y()};
return tooltip};return w})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/DomUtil":function(){define("dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/dom-class dojo/on ../../utils/ObjectUtil esri/dijit/geoenrichment/utils/DomUtil".split(" "),function(k,h,e,g,c,b,a){var f=Object.assign({},a);f.select=function(a){return f.addTag(a,"selected")};f.unselect=function(a){return f.removeTag(a,"selected")};f.floatStart=function(a){return f.addTag(a,"esriMapsAnalystXFloatStart")};f.floatEnd=function(a){return f.addTag(a,
"esriMapsAnalystXFloatEnd")};f.addSpacer=function(a,b){a=k.create("div",{"class":"esriMapsAnalystXSpacer",innerHTML:"\x26nbsp;"},a);if(b)f[b](a);return a};f.getAndUpdateNumber=function(a,c){if(!a)return NaN;var d=a.get&&a.set;void 0===c&&(c=0);var e=b.parseNumber(d?a.get("value"):a.value,c);isNaN(e)||(d?a.set("value",b.formatNumber(e,c)):a.value=b.formatNumber(e,c));return e};f.getAndUpdateString=function(a){if(!a)return null;if(a.get&&a.set){var b=a.get("value").trim();a.set("value",b)}else b=a.value.trim(),
a.value=b;return b};f.getScreenScaleFactor=function(){return f.getTextBox("",{style:"width: 72pt; height: 72pt"}).w/96};f.positionAtCenter=function(a,b){if(a&&b){var c=h.position(a);b=h.position(b);c.w&&c.h&&b.w&&b.h&&e.set(a,{left:(b.w-c.w)/2+"px",top:(b.h-c.h)/2+"px"})}};f.showAroundOverlay=function(a,b){b=b||{};f.removeAroundOverlay(a);var d={w:"width",h:"height",l:"left",t:"top",r:"right",b:"bottom"},g=h.position(a);if(b.viewPortContainer){var n=h.position(b.viewPortContainer),q=g.x,v=g.y;g.x=
Math.max(g.x,n.x);g.w-=g.x-q;g.y=Math.max(g.y,n.y);g.h-=g.y-v;g.w=Math.min(g.w,n.x+n.w-g.x);g.h=Math.min(g.h,n.y+n.h-g.y)}a.__aroundOverlays=(b.placeInNode?[{l:0,t:-g.y,w:g.w,h:g.y},{l:g.w,t:-g.y,w:document.body.clientWidth-(g.x+g.w),h:document.body.clientHeight},{l:0,t:g.h,w:g.w,h:document.body.clientHeight-(g.y+g.h)},{l:-g.x,t:-g.y,w:g.x,h:document.body.clientHeight}]:[{l:g.x,t:0,w:g.w,h:g.y},{w:document.body.clientWidth-(g.x+g.w),r:0,t:0,b:0},{l:g.x,h:document.body.clientHeight-(g.y+g.h),w:g.w,
b:0},{l:0,t:0,w:g.x,b:0}]).map(function(c){var f=k.create("div",{"class":b.overlayClass||"esriMapsAnalystXNodeAroundOverlay"},b.placeInNode?a:document.body),g={position:"absolute"},h;for(h in d)void 0!==c[h]&&(g[d[h]]=Math.round(c[h])+"px");e.set(f,g);return f});g=function(){f.removeAroundOverlay(a)};b.removeOnClick&&(a.__aroundOverlaysRemoveHandle=c.once(document.body,"click",g));a.__aroundOverlaysResizeHandle=c(window,"resize",function(){f.showAroundOverlay(a,b)});var r;a.__aroundOverlaysSetIntervalHandle=
setInterval(function(){if(r){var c=h.position(a);c.x==r.x&&c.y==r.y&&c.w==r.w&&c.h==r.h||f.showAroundOverlay(a,b)}else r=h.position(a)},50);return{remove:g}};f.removeAroundOverlay=function(a){a.__aroundOverlays&&a.__aroundOverlays.forEach(function(a){k.destroy(a)});delete a.__aroundOverlays;a.__aroundOverlaysRemoveHandle&&a.__aroundOverlaysRemoveHandle.remove();delete a.__aroundOverlaysRemoveHandle;a.__aroundOverlaysResizeHandle&&a.__aroundOverlaysResizeHandle.remove();delete a.__aroundOverlaysResizeHandle;
clearInterval(a.__aroundOverlaysSetIntervalHandle);delete a.__aroundOverlaysSetIntervalHandle};f.getDocumentStyleDeclaration=function(a){function b(c){var d;try{d=c.rules||c.cssRules}catch(r){d=null}if(d)for(c=0;c<d.length;c++){var e=d[c];if(e.styleSheet){if(e=b(e.styleSheet))return e}else if(e.selectorText==a)return e.style}}for(var c=0;c<document.styleSheets.length;c++){var d=b(document.styleSheets[c]);if(d)return d}return null};f.getNodeFontFamily=function(a){return(a=e.get(a,"fontFamily")||e.getComputedStyle(a)["font-family"])?
a.replace(/'|"/g,"").split(",")[0]:a};f.getNodeFontSize=function(a){return e.toPixelValue(a,e.get(a,"fontSize"))};f.listenToNodeAdded=function(a,b,c){if(f.isNodeInLayout(a))b();else{a.__listenToNodeAddedHandle&&a.__listenToNodeAddedHandle.remove();var d=setInterval(function(){f.isNodeInLayout(a)&&(a.__listenToNodeAddedHandle&&a.__listenToNodeAddedHandle.remove(),b())},c||100);a.__listenToNodeAddedHandle={remove:function(){clearInterval(d);delete a.__listenToNodeAddedHandle}};return a.__listenToNodeAddedHandle}};
f.isNodeVisible=function(a){return f.isChildOf(a,document.body,function(a){return!g.contains(a,"dijitHidden")&&"hidden"!=e.get(a,"visibility")})};f.enableHyperlink=function(a,b){b?g.replace(a,"esriMapsAnalystXLink","esriMapsAnalystXLinkDisabled"):g.replace(a,"esriMapsAnalystXLinkDisabled","esriMapsAnalystXLink")};return f})},"widgets/BusinessAnalyst/esriAnalystX/utils/ObjectUtil":function(){define(["../../baUtil/ObjectUtil","esri/dijit/geoenrichment/utils/ObjectUtil","esri/dijit/geoenrichment/utils/SortUtil"],
function(k,h,e){var g=Object.assign({},k,h,e);g.getPrototypeOf=function(c){try{return Object.getPrototypeOf?Object.getPrototypeOf(c):c.__proto__||c.constructor&&c.constructor.prototype}catch(b){return null}};g.isJson=function(c){return"object"===typeof c&&g.getPrototypeOf(c)===Object.prototype};g.copyJson=function(c){return void 0===c||null===c?null:JSON.parse(JSON.stringify({object:c})).object};g.convert=function(c,b,a){var e=b||function(){};b=e(c);if("undefined"!==typeof b)return b;if(Array.isArray(c)){var d=
[];c.forEach(function(b){d.push(g.convert(b,e,a))},this);return d}if(!g.isJson(c))return c;b={};for(var h in c){var k=c[h],l=a?e(h):h;"undefined"==typeof l&&(l=h);b[l]=g.convert(k,e,a)}return b};g.getDeepCopy=function(c){return g.convert(c)};g.getRange=function(c,b,a){b="function"===typeof b?b.bind(null==a?null:a):null;var e,d,g;for(g in c)a=c[g],a=Number(null===b?a:b(a,g)),isNaN(a)||(void 0===e?e=d=a:(e=Math.min(e,a),d=Math.max(d,a)));return void 0===e?{}:{min:e,max:d}};g.removeEmptyObjects=function(c){function b(c){c&&
"object"===typeof c&&Object.keys(c).forEach(function(d){var e=c[d];!e||"object"!==typeof e||Array.isArray(e)||Object.keys(e).length?b(e):(a=!0,delete c[d])})}for(var a=!0;a;)a=!1,b(c);return c};g.removeValues=function(c,b){function a(c){c&&"object"===typeof c&&Object.keys(c).forEach(function(d){b(d,c[d])?a(c[d]):delete c[d]})}a(c);return c};g.isEqual=function(c,b){if(null===c||"object"!==typeof c||null===b||"object"!==typeof b)return c===b;if(Object.keys(c).length!=Object.keys(b).length)return!1;
var a={},e;for(e in c)a[e]=!0;for(e in b)if(void 0!==a[e])delete a[e];else return!1;for(e in c)if(!g.isEqual(c[e],b[e]))return!1;return!0};g.getObject=function(c,b){if(!b)return c;b=b.split(".");for(var a=0;a<b.length;a++)c=c&&c[b[a]];return c};g.formatNumber=function(c,b){b="number"===typeof b?{places:b}:b||{};if(null==b.places||0>b.places)b.places=g.getPlaces(c,!0),b.maxPlaces&&b.places>b.maxPlaces&&(b.places=b.maxPlaces);return h.formatNumber(c,b)};g.getPlaces=function(c,b){function a(a,b){var f=
c.indexOf(a,e);if(0>f)return d;a=c.charAt(f+a.length);return!a||0>b.indexOf(a)?d:f-e}c=+c;if(isNaN(c))return-1;c+="";var e=c.indexOf(".")+1,d=e?c.length-e:0;if(2>=d||!b)return d;b=0;if(!+c.substr(0,e-1))for(;"0"===c.charAt(e);)e++,b++,d--;for(var g=d-1;2<=g;g--){var h=Math.min(a("000000000000000".substr(0,g),"01234"),a("999999999999999".substr(0,g),"56789"));if(h!==d){d=h;break}}return d+b};return g})},"widgets/BusinessAnalyst/baUtil/ObjectUtil":function(){define(["require","exports"],function(k,
h){function e(g,c){for(var b=0,a=Object.keys(c);b<a.length;b++){var f=a[b];"object"!==typeof g[f]||null===g[f]||"object"!==typeof c[f]||null===c[f]?g[f]=c[f]:Array.isArray(g[f])?Array.isArray(c[f])?g[f].concat(c[f]):g[f]=c[f]:Array.isArray(c[f])?g[f]=c[f]:e(g[f],c[f])}}return{map:function(e,c,b){void 0!==b&&(c=c.bind(b));if("object"!==typeof e)throw Error("Object or array expected");if(Array.isArray(e)){b=[];for(var a=0,f=e.length;a<f;a++)b.push(c(e[a],a));return b}b={};a=0;for(f=Object.keys(e);a<
f.length;a++){var d=f[a];Object.hasOwnProperty.call(e,d)&&(b[d]=c(e[d],d))}return b},deepAssign:function(g){for(var c=[],b=1;b<arguments.length;b++)c[b-1]=arguments[b];for(b=0;b<c.length;b++)e(g,c[b]);return g}}})},"esri/dijit/geoenrichment/utils/SortUtil":function(){define([],function(){function k(c,b,a,e){c=void 0===c||null===c;return c!=(void 0===b||null===b)?(b=c?-1:1,(void 0===e?a:e)?-b:b):c?0:null}function h(c){var b=/^(.+)\s([1-9]\d*)$/.exec(c);return b?{base:b[1],number:b[2]}:/^[1-9]\d*$/.test(c)?
{base:"",number:+c}:{base:c,number:0}}var e={NEWEST:"newest",OLDEST:"oldest",ALPHABETICAL:"alphabetical",UNALPHABETICAL:"unalphabetical",compareNumeric:function(c,b,a,e){e=k(c,b,a,e);if(null!==e)return e;c=Number(c);b=Number(b);e=c>b?1:c<b?-1:0;return a?-e:e},compareString:function(c,b,a,e){e=k(c,b,a,e);if(null!==e)return e;c=String(c);b=String(b);e=c.localeCompare(b);return a?-e:e}},g=/^(.+)\s([1-9]\d*)(\D*)$/;e.compareNames=function(c,b,a,f){var d=h("string"===typeof c?c.toLowerCase():c),k=h("string"===
typeof b?b.toLowerCase():b),m=null;if(d.base===k.base)m=e.compareNumeric(d.number,k.number,a,f);else{var l=g.exec(d.base);if(l){var p=g.exec(k.base);p&&l[1]===p[1]&&l[3]===p[3]&&(m=e.compareNumeric(l[2],p[2],a,f))}null===m&&(m=e.compareString(d.base,k.base,a,f))}return m||e.compareString(c,b,a,f)};e.compare=function(c,b,a,f){var d=k(c,b,a,f);if(null!==d)return d;d=typeof c;typeof b!=d&&(d="");switch(d){case "number":case "boolean":break;case "object":c=c.valueOf();b=b.valueOf();break;default:return e.compareString(c,
b,a,f)}d=c>b?1:c<b?-1:0;return a?-d:d};return e})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/MouseUtil":function(){define(["dojo/dom-geometry","esri/dijit/geoenrichment/utils/MouseUtil"],function(k,h){var e;h.unitTesting_setCursorOverNode=function(e){e=k.position(e);h.unitTesting_setCursorPosition(e.x+e.w/2,e.y+e.h/2)};h.unitTesting_setCursorPosition=function(e,c){h._latestEvent={clientX:e,pageX:e,clientY:c,pageY:c}};h.unitTesting_lockPosition=function(g){e=g};h.unitTesting_shiftMousePosition=
function(e,c){h.unitTesting_setCursorPosition(h._latestEvent.clientX+(e||0),h._latestEvent.clientY+(c||0))};h._setLatestEvent=function(g){e||(h._latestEvent=g)};return h})},"widgets/BusinessAnalyst/esriAnalystX/widgets/SelectableTreeGrid/SelectableTreeGrid":function(){define("dojo/_base/declare dojo/aspect dojo/Evented dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on dojo/query dijit/Tooltip dijit/_WidgetBase ../../dijit/_TemplatedMixin dgrid/OnDemandGrid dgrid/tree esri/dijit/geoenrichment/utils/KeyboardUtil esri/dijit/geoenrichment/TriStateItem ../../dijit/utils/DgridUtil ../../dijit/utils/DomUtil ../../dijit/utils/MouseUtil ../../dijit/tooltips/TooltipUtil dojo/text!./templates/SelectableTreeGrid.html xstyle/css!./css/SelectableTreeGrid.css".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v,r,u,t,z,w){var C=k(null,{_selectedRowInfos:null,_lastSelectedRowInfo:null,_outsideHandler:null,_isSelectionFrozen:!1,keepSelectionOnOutsideClick:!1,_previouslySelectedRowsByNode:null,constructor:function(){this._previouslySelectedRowsByNode=new WeakMap},buildRendering:function B(){this._selectedRowInfos={};this.inherited(B,arguments)},postCreate:function y(){this.inherited(y,arguments);g.add(this.domNode,"esriMapsAnalystXNonSelectable")},_reselectSingleNode:function(a){this.selectSingleRow(this._previouslySelectedRowsByNode.get(a),
a)},selectSingleRow:function(a,b){this.unselectAllRows();this._selectRow(a,b)},_selectRow:function(b,c){g.add(b,this.selectedRowClass);g.add(b,"row-level-"+this._getNodeLevel(c));var d=this.tree.getIdentity(c),e={row:b,node:c,nodeId:d,index:c.parent&&c.parent.children.indexOf(c)};this._lastSelectedRowInfo=this._selectedRowInfos[d]=e;this._previouslySelectedRowsByNode.set(c,b);var f=this;this._outsideHandler=this._outsideHandler||a(document.body,"click",function(){t.isMouseOver(f.domNode)||f._isSelectionFrozen||
f.keepSelectionOnOutsideClick||f.unselectAllRows()})},_unselectRow:function(a,b){delete this._selectedRowInfos[this.tree.getIdentity(b)];g.remove(a,this.selectedRowClass)},unselectAllRows:function(){for(var a in this._selectedRowInfos)g.remove(this._selectedRowInfos[a].row,this.selectedRowClass);this._selectedRowInfos={};this._lastSelectedRowInfo=null;this._outsideHandler&&this._outsideHandler.remove();this._outsideHandler=null},getSelectedRowNodes:function(){return this._getSelectedNodesRows().nodes},
selectRowNodes:function(a){var b=this;a&&a.forEach(function(a){var c=b.grid.row(a);c&&c.element&&b._selectRow(c.element,a)})},freezeRowSelection:function(){this._isSelectionFrozen=!0},unfreezeRowSelection:function(){this._isSelectionFrozen=!1},_getSelectedNodesRows:function(){var a=[],b=[],c=[],d;for(d in this._selectedRowInfos)c.push(this._selectedRowInfos[d]);c.sort(function(a,b){return a.index-b.index});c.forEach(function(c){a.push(c.node);b.push(c.row)});return{nodes:a,rows:b}},_emitSelectedRowsEvent:function(){var a=
this._getSelectedNodesRows();if(a.nodes.length)this.onRowsSelected(a.nodes,a.rows)}});return k([n,m,e,C],{templateString:w,tree:null,grid:null,gridClass:"",highlightSelected:!0,firstColumns:null,additionalColumns:null,showRootCheckbox:!0,showCheckboxColumn:!0,showHeader:!0,labelColumnField:"label",gridParams:null,keepContentUnderScroll:void 0,hideInvisibleExpandoIcons:!1,expandOnNodeClick:!1,checkLimit:0,checkLimitMessage:null,checkLimitMessageTimeout:5E3,handleMultipleCheck:!1,enableRowSelection:!1,
enableMultipleRowSelection:!1,allowSelectionFromManyParents:!1,selectedRowFilter:null,selectedRowClass:"row-selected",enableHeaderLabelToggleClick:!0,defaultExpand:null,fitParentSize:!1,renderAllRows:!1,rowPostProcessor:null,_rootCheckbox:null,_checkboxes:null,_lastCheckedNode:null,updateSelectionCountDiv:function(a,b){},getLabel:function(a,b){return a.label},postCreate:function D(){this.inherited(D,arguments);this._createGrid()},resize:function(){this.grid.resize();this._updateCheckboxState(this._rootCheckbox);
for(var a in this._checkboxes)this._updateCheckboxState(this._checkboxes[a]);this._emitSelectionChanged()},setWidth:function(a){this.grid&&this.grid.domNode&&b.set(this.grid.domNode,"width",a+"px")},setHeight:function(a){this.grid&&this.grid.domNode&&b.set(this.grid.domNode,"height",a+"px")},row:function(a){return this.grid.row(a)},cell:function(a){return this.grid.cell(a)},_labelColumn:null,_createGrid:function(){var b=this;this._checkboxes={};var c={label:this.getLabel(this.tree.root,!0),sortable:!1,
field:this.labelColumnField,renderCell:this._renderLabel.bind(this),renderHeaderCell:this._renderLabelHeader.bind(this,this.tree.root)},d;if(this.additionalColumns&&this.additionalColumns.length&&(d=this.additionalColumns.filter(function(a){return a.field===b.labelColumnField})[0])){for(var e in c)void 0===d[e]&&(d[e]=c[e]);c=d}c.indentWidth=c.indentWidth||16;this._labelColumn=c=this._prepareTreeColumn(c);e=[];this.firstColumns&&(e=e.concat(this.firstColumns));this.showCheckboxColumn&&e.push({label:"",
field:"checkbox",sortable:!1,renderCell:this._renderCheckboxForColumn.bind(this),renderHeaderCell:this._renderCheckboxForColumn.bind(this,this.tree.root)});d||e.push(c);this.additionalColumns&&(e=e.concat(this.additionalColumns));c=["esriMapsAnalystXSelectableTreeGrid"];this.gridClass&&c.push(this.gridClass);this.fitParentSize&&c.push("fitParentSize");c=Object.assign({class:c.join(" "),keepScrollPosition:!0,store:this.tree,columns:e},this.gridParams);this.grid=this._createGridObject(c,this.gridContainer);
this.own(this.grid);this.grid._expanded=this.defaultExpand||this.grid._expanded||{};r.oddEvenFix(this.grid);this.own(a(this.tree,"updated",this._onStoreUpdated.bind(this)));this._addKeepScrollHandlers();this._addGridHandlers();this.renderAllRows&&(this.grid.minRowsPerPage=1E4,this.grid.maxRowsPerPage=10250);this.grid.startup();z.autoTooltip(this.domNode);this.showHeader||g.add(this.domNode,"esriMapsAnalystXGridNoHeader");a(this.grid.domNode,".dgrid-expando-icon:click,.dgrid-content .dgrid-column-labelColumn:dblclick,.dgrid-content .dgrid-column-labelColumn:keydown",
function(a){(a=b.grid.row(a))&&b.onExpandChangedUser(a.data)})},_createGridObject:function(a,b){return new l(a,b)},onRowInserted:function(a,b){},_addGridHandlers:function(){function b(b,d){c.enableRowSelection&&d.parent&&(!c.selectedRowFilter||c.selectedRowFilter(d))&&(g.add(b,"esriMapsAnalystXClickable"),a(b,"click",function(a){setTimeout(function(){if(!c._isSelectionFrozen){if(a.shiftKey&&c.enableMultipleRowSelection){if(c._lastSelectedRowInfo&&c._lastSelectedRowInfo.row.parentNode&&c._lastSelectedRowInfo.node.parent===
d.parent){var e=u.getChildIndex(c._lastSelectedRowInfo.row.parentNode,c._lastSelectedRowInfo.row),f=u.getChildIndex(b.parentNode,b),g=e<=f?c._lastSelectedRowInfo.row:b,e=e<=f?b:c._lastSelectedRowInfo.row,f=g;if(g.id!==e.id){do{g=c.grid.row(f).data;c._selectRow(f,g);if(f.id===e.id)break;f=f.nextSibling}while(f)}}else c.selectSingleRow(b,d);u.stealFocus()}else q.isCtrl(a)&&c.enableMultipleRowSelection?c._lastSelectedRowInfo&&c._lastSelectedRowInfo.row.parentNode&&c._lastSelectedRowInfo.node.parent===
d.parent||c.allowSelectionFromManyParents?c._selectedRowInfos[d.id]?c._unselectRow(b,d):c._selectRow(b,d):c.selectSingleRow(b,d):c.selectSingleRow(b,d);c._emitSelectedRowsEvent()}})}))}var c=this;this.own(h.after(this.grid,"insertRow",function(a){var d=a&&c.grid._rowIdToObject[a.id];if(a){if(d&&c.hideInvisibleExpandoIcons&&(!d.children||!d.children.length)){var e=f(".dgrid-expando-icon",a)[0];e&&(e.style.width="0")}u[d&&!1===d.visible?"hide":"show"](a);b(a,d)}d&&(c._updateRowHighlighting(d,a),c.onRowInserted(a,
d));c.rowPostProcessor&&c.rowPostProcessor(a,d);return a}))},_addKeepScrollHandlers:function(){function a(a){if(!b.grid.contentNode)return a;if(b.fitParentSize){var c=u.hasScrollbars(b.grid.bodyNode);b.grid.headerNode.style[b.isLeftToRight()?"right":"left"]=c.w?"":"0px";b._lastContentWidth=b.grid.contentNode.style.width||b._lastContentWidth||"";b.grid.contentNode.style.width=c.h?b._lastContentWidth:""}else b.keepContentUnderScroll?b.grid.contentNode.style.width=b.grid.headerNode.firstChild.offsetWidth+
"px":!1===b.keepContentUnderScroll&&(b.grid.contentNode.style.width="");return a}var b=this;if(this.fitParentSize||void 0!==this.keepContentUnderScroll)h.before(this.grid,"refresh",function(){b.hideCheckLimitMessage();b._lastCheckedNode=null}),h.after(this.grid,"resize",a),h.after(this.grid,"refresh",a)},_getNodeLevel:function(a){var b=-1;for(a=a&&a.parent;a;)b++,a=a.parent;return b},_prepareTreeColumn:function(a){return this._wrapTreeColumn(p(a))},_wrapTreeColumn:function(a){return a},_onStoreUpdated:function(){this._checkboxes=
{};this._refreshGrid();this._rootCheckbox&&this._updateCheckboxState(this._rootCheckbox);this._emitSelectionChanged()},_emitSelectionChanged:function(a){var b=this.tree.root.selectCount;this.updateSelectionCountDiv(this.selectionCounter,b);this.emit("SelectionChanged",{selected:b,toggledTreeNode:a})},refresh:function(){this._refreshGrid();this.refreshCheckboxes()},_isRefreshSuspended:!1,setRefreshSuspended:function(a){this._isRefreshSuspended=a},_refreshGrid:function(){if(!this._isRefreshSuspended){var a=
this.grid.getScrollPosition();this.grid.refresh();this.grid.scrollTo(a);for(var b in this._selectedRowInfos)this.grid.row(this._selectedRowInfos[b].node).element&&this._selectRow(this.grid.row(this._selectedRowInfos[b].node).element,this._selectedRowInfos[b].node)}},getScrollPosition:function(){return this.grid&&this.grid.getScrollPosition()},setScrollPosition:function(a){return this.grid&&this.grid.scrollTo(a)},_renderCheckbox:function(a){if(!a.leafCount&&a!==this.tree.root||!this.showCheckboxColumn||
!1===a.selectable&&void 0===a.indepSelection)return document.createTextNode("");var b=new v(null,{class:"esriStyleInTable"});b.autoToggle=!1;b.node=a;this._updateCheckboxState(b,a);!1===a.enabled&&b.set("disabled",!0);a===this.tree.root?(this._rootCheckbox=b,u[this.showRootCheckbox?"show":"hide"](b.domNode)):this._checkboxes[this.tree.getIdentity(a)]=b;b.onClick=this._onCheckboxClick.bind(this,a,b);return b},_renderCheckboxForColumn:function(a){return(a=this._renderCheckbox(a))&&a.domNode},refreshCheckboxes:function(){this._rootCheckbox&&
this._updateCheckboxState(this._rootCheckbox);for(var a in this._checkboxes)this._updateCheckboxState(this._checkboxes[a])},clearLastCheckInfo:function(){this._lastCheckedNode=null},_onCheckboxClick:function(a,b,c){c.stopPropagation();this.hideCheckLimitMessage();var d=this.handleMultipleCheck&&("function"!==typeof this.handleMultipleCheck||this.handleMultipleCheck(a));d&&c.shiftKey&&this._tryToggleMultipleNodes(this._lastCheckedNode,a,b||c)?this._lastCheckedNode=a:(this._lastCheckedNode=d?a:null,
this._toggleNodeSelection(a,b||c),this.refreshCheckboxes())},_tryToggleMultipleNodes:function(a,b,c){if(!a||a===b||a.parent!==b.parent)return!1;var d=b.parent.children,e=d.indexOf(a);b=d.indexOf(b);a=e<b?1:-1;for(var f=[],g=[],e=e+a;;e+=a){var h=d[e];((void 0===h.indepSelection?h.selected:h.indepSelection)?f:g).push(h);if(e===b)break}f.forEach(function(a){this._toggleNodeSelection(a,c)},this);g.every(function(a){return this._toggleNodeSelection(a,c)},this);this.refreshCheckboxes();return!0},_toggleNodeSelection:function(a,
b){var c=void 0===a.indepSelection?!a.selected:!a.indepSelection;if(c&&this.checkLimit){var d=this.getSelectedNodes().length,e="function"===typeof this.checkLimit?this.checkLimit(this.tree,d):this.checkLimit;if(d>=e)if(void 0===a.indepSelection&&a.children&&!1!==this.tree.getSelectionState(a))c=!1;else return this.showCheckLimitMessage(b),!1}d=!0;void 0===a.indepSelection?(d=this.tree.changeSelect(a,c,e),!d&&this.showCheckLimitMessage(b)):a.indepSelection=c;this._emitSelectionChanged(a);return d},
_checkLimitHandler:null,showCheckLimitMessage:function(a){if(this.checkLimitMessage){var b=a&&(a.domNode||a.target);b&&(d.show(this.checkLimitMessage,b,["above","below"]),a=function(){b&&d.hide(b);b=null},setTimeout(a,this.checkLimitMessageTimeout),this._checkLimitHandler=a,this.onCheckLimitReached(a))}},hideCheckLimitMessage:function(){this._checkLimitHandler&&this._checkLimitHandler();this._checkLimitHandler=null},onCheckLimitReached:function(a){},_updateCheckboxState:function(a){if(a){var b=this._getNodeSelection(a.node);
a.set("checked",b);this._updateRowHighlighting(a.node,null,b)}},_getNodeSelection:function(a){return void 0!==a.indepSelection?a.indepSelection:this.tree.getSelectionState(a)},_updateRowHighlighting:function(a,b,c){this.highlightSelected&&a&&(c=void 0!==c?c:this._getNodeSelection(a),(b=b||this.grid&&this.row(a).element)&&(!0!==c||void 0===a.indepSelection&&!1===a.selectable?g.remove(b,"selected"):g.add(b,"selected")))},_renderLabel:function(a,b,c){b=this._renderLabelNode(a);this._provideLabelClickAction(b,
c,a);return b},_provideLabelClickAction:function(b,c,d){var e=this.expandOnNodeClick&&d.children?d.children.length&&(b=c,function(){this.toggleExpand(d);this.onExpandChangedUser(d)}.bind(this)):!1!==d.enabled&&this.showCheckboxColumn?this._onCheckboxClick.bind(this,d,null):null;e&&(g.add(b,"esriMapsAnalystXClickable"),a(b,"click",function(a){a.stopPropagation();e(a)}))},_renderLabelNode:function(a){return c.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(a)})},
_renderLabelHeader:function(b){var d=c.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(b)||this._labelColumn&&this._labelColumn.label||""});this.enableHeaderLabelToggleClick&&this.showRootCheckbox&&(g.add(d,"esriMapsAnalystXClickable"),a(d,"click",this._onCheckboxClick.bind(this,b,null)));return d},onRowsSelected:function(a,b){},isNodeSelected:function(a){return a&&(a.selected||a.indepSelection)},getSelectedNodes:function(){var a=this.tree.getSelectedNodes(!1),
b=this._getIndepSelectedNodes();return a.concat(b)},_getIndepSelectedNodes:function(){function a(c){c&&(c.indepSelection&&b.push(c),c.children&&c.children.forEach(a))}var b=[];a(this.tree.root);return b},getSelectedState:function(){if(!this.tree)return null;var a={normalSelection:{},indepSelection:{}},b=this.tree.getSelectedNodes(!1);b&&b.forEach(function(b){a.normalSelection[b.id]=!0});(b=this._getIndepSelectedNodes())&&b.forEach(function(b){a.indepSelection[b.id]=!0});return a},setSelectedState:function(a){if(this.tree){this.tree.changeSelect(this.tree.root,
!1);if(a){for(var b in a.normalSelection){var c=this.tree.get(b);c&&this.tree.changeSelect(c,!0)}for(b in a.indepSelection)if(c=this.tree.get(b))c.indepSelection=!0}this.refreshCheckboxes()}},setNodeSelected:function(a,b,c){a&&(void 0!==a.indepSelection?a.indepSelection=b:this.tree.changeSelect(a,b),!1!==c&&this.refreshCheckboxes())},isExpanded:function(a){a="string"===typeof a?a:a[this.tree.idProperty];return this.grid._expanded&&this.grid._expanded[a]},setExpanded:function(a,b,c){a="string"==typeof a?
a:a[this.tree.idProperty];void 0!==a&&(!1!==c?(c=this.grid.row(a))&&c.element&&this.grid.expand(a,b):this.grid._expanded[a]=b)},toggleExpand:function(a){this.setExpanded(a,!this.isExpanded(a))},getExpandedState:function(){return Object.assign({},this.grid._expanded)},setExpandedState:function(a){this.grid._expanded=a||{}},onExpandChangedUser:function(a){},destroy:function(){this.unselectAllRows();this.inherited(arguments)}})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/_TemplatedMixin":function(){define(["dojo/_base/declare",
"dijit/_TemplatedMixin","./_EscapeValueMixin"],function(k,h,e){return k([h,e],{})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/_EscapeValueMixin":function(){define(["dojo/_base/declare"],function(k){return k(null,{_escapeValue:function(h){return h.replace(/"/g,"\x26quot;")}})})},"dgrid/tree":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/Deferred dojo/_base/lang dojo/query dojo/on dojo/aspect ./util/has-css3 ./Grid dojo/has!touch?./util/touch put-selector/put".split(" "),function(k,
h,e,g,c,b,a,f,d,n,m){function l(a,b,c,d){d=this.grid.isRTL?"right":"left";var e=".dgrid-expando-icon";b&&(e+=".ui-icon.ui-icon-triangle-1-"+(c?"se":"e"));a=m("div"+e+"[style\x3dmargin-"+d+": "+a*(this.indentWidth||9)+"px; float: "+d+"]");a.innerHTML="\x26nbsp;";return a}function p(a){var b=this,c=this.style.height;c&&(this.style.display="0px"==c?"none":"block");a&&(m(this,".dgrid-tree-resetting"),setTimeout(function(){m(b,"!dgrid-tree-resetting")}));this.style.height=""}function q(g){var k=g.renderCell||
d.defaultRenderCell,q,t;g||(g={});g.shouldExpand=g.shouldExpand||function(a,b,c){return c};a.after(g,"init",function(){var d=g.grid,k=".dgrid-content .dgrid-column-"+g.id,r=[];d.cleanEmptyObservers=!1;if(!d.store)throw Error("dgrid tree column plugin requires a store to operate.");g.renderExpando||(g.renderExpando=l);r.push(d.on(g.expandOn||".dgrid-expando-icon:click,"+k+":dblclick,"+k+":keydown",function(a){var b=d.row(a);d.store.mayHaveChildren&&!d.store.mayHaveChildren(b.data)||"keydown"==a.type&&
32!=a.keyCode||"dblclick"==a.type&&t&&1<t.count&&b.id==t.id&&-1<a.target.className.indexOf("dgrid-expando-icon")||d.expand(b);-1<a.target.className.indexOf("dgrid-expando-icon")&&(t&&t.id==d.row(a).id?t.count++:t={id:d.row(a).id,count:1})}));f("touch")&&r.push(d.on(n.selector(k,n.dbltap),function(){d.expand(this)}));d._expanded||(d._expanded={});r.push(a.after(d,"insertRow",function(a){var b=this.row(a);g.shouldExpand(b,q,this._expanded[b.id])&&this.expand(a,!0,!0);return a}));r.push(a.before(d,"removeRow",
function(a,b){if(a=a.connected)c("\x3e.dgrid-row",a).forEach(function(a){d.removeRow(a,!0)}),b||m(a,"!")}));g.collapseOnRefresh&&r.push(a.after(d,"cleanup",function(){this._expanded={}}));d._calcRowHeight=function(a){var b=a.connected;return a.offsetHeight+(b?b.offsetHeight:0)};d.expand=function(a,h,k){var l=a.element?a:d.row(a),n=f("transitionend");a=new e;var q=a.promise;a.resolve();a=l.element;a=-1<a.className.indexOf("dgrid-expando-icon")?a:c(".dgrid-expando-icon",a)[0];k=k||!1===g.enableTransitions;
if(a&&a.mayHaveChildren&&(k||h!==!!this._expanded[l.id])){var r=void 0===h?!this._expanded[l.id]:h;m(a,".ui-icon-triangle-1-"+(r?"se":"e")+"!ui-icon-triangle-1-"+(r?"e":"se"));h=l.element;var t=h.connected,v,u,w={originalQuery:this.query};if(!t){var t=w.container=h.connected=m(h,"+div.dgrid-tree-container"),y=function(a){return d.store.getChildren(l.data,a)};g.allowDuplicates&&(w.parentId=l.id);"level"in a&&(y.level=a.level);q=q.then(function(){if(d.renderQuery)return d.renderQuery(y,w);var a=m(t,
"div"),b=d.renderArray(y(w),a,"level"in y?{queryLevel:y.level}:{});e.when(b,function(){m(a,"!")});return b});n?b(t,n,p):p.call(t)}t.hidden=!r;v=t.style;!n||k?(v.display=r?"block":"none",v.height=""):(r?(v.display="block",u=t.scrollHeight,v.height="0px"):(m(t,".dgrid-tree-resetting"),v.height=t.scrollHeight+"px"),setTimeout(function(){m(t,"!dgrid-tree-resetting");v.height=r?u?u+"px":"auto":"0px"}));r?this._expanded[l.id]=!0:delete this._expanded[l.id]}return q};a.after(g,"destroy",function(){h.forEach(r,
function(a){a.remove()});delete d.expand;delete d._calcRowHeight})});g.renderCell=function(a,b,c,d){var e=g.grid,f=Number(d&&d.queryLevel)+1,h=!e.store.mayHaveChildren||e.store.mayHaveChildren(a),l=d.parentId,f=q=isNaN(f)?0:f,e=g.renderExpando(f,h,e._expanded[(l?l+"-":"")+e.store.getIdentity(a)],a);e.level=f;e.mayHaveChildren=h;(a=k.call(g,a,b,c,d))&&a.nodeType?(m(c,e),m(c,a)):c.insertBefore(e,c.firstChild)};return g}q.defaultRenderExpando=l;g.getObject("dgrid.tree",!0);return dgrid.tree=q})},"dgrid/util/has-css3":function(){define(["dojo/has"],
function(k){function h(g,c){g=g.style;var b;if(c in g)return!0;c=c.slice(0,1).toUpperCase()+c.slice(1);for(b=e.length;b--;)if(e[b]+c in g)return e[b];return!1}var e=["ms","O","Moz","Webkit"];k.add("css-transitions",function(e,c,b){return h(b,"transitionProperty")});k.add("css-transforms",function(e,c,b){return h(b,"transform")});k.add("css-transforms3d",function(e,c,b){return h(b,"perspective")});k.add("transitionend",function(){var e=k("css-transitions");return e?!0===e?"transitionend":{ms:"MSTransitionEnd",
O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[e]:!1});return k})},"esri/dijit/geoenrichment/TriStateItem":function(){define("dojo/_base/declare dojo/_base/event dojo/_base/lang dojo/Stateful dojo/on dojo/dom-construct dojo/dom-class ./utils/DeviceUtil".split(" "),function(k,h,e,g,c,b,a,f){return k(g,{domNode:null,checkboxNode:null,checked:!1,disabled:!1,autoToggle:!0,_currentClass:null,_lastChecked:!1,constructor:function(d,g,h){var k=f.isMobileDevice()?"touchstart":"click";
g=g||{};var m=g["class"];g["class"]=(m?m+" ":"")+"esriTriStateCheckBoxIcon";if(m=g.label){if(d instanceof HTMLLabelElement)d.innerHTML="\x26nbsp;"+m;else{var n=g.labelAttrs||{};n.innerHTML="\x26nbsp;"+m;n=b.create("label",n);d&&b.place(n,d);d=n}g=e.mixin({},g);delete g.label;delete g.labelAttrs}this.checkboxNode=b.create("div",g,d,d instanceof HTMLLabelElement?"first":h);this._currentClass=this._composeClass();a.add(this.checkboxNode,this._currentClass);d instanceof HTMLLabelElement?(c(d,k,e.hitch(this,
this._onClick)),a.add(d,"esriTriStateCheckBoxLabel")):c(this.checkboxNode,k,e.hitch(this,this._onClick));this.domNode=m?d:this.checkboxNode},postscript:function(){},_onClick:function(a){this.disabled||(this.autoToggle&&this.toggle(),a.checked=this.checked,this.onClick(h.fix(a)))},onClick:function(a){},toggle:function(){this.set("checked",!this._lastChecked);return this.checked},_checkedSetter:function(a){a!==this.checked&&(this.checked="mixed"===a?a:this._lastChecked=!!a,this._updateClass())},_disabledSetter:function(a){this.disabled=
!!a;this._updateClass()},_updateClass:function(){var b=this._composeClass();b!==this._currentClass&&(a.replace(this.checkboxNode,b,this._currentClass),this._currentClass=b)},_composeClass:function(){var a="esriTriStateCheckBox"+("mixed"==this.checked?"Mixed":this.checked?"Checked":"");return this.disabled?a+"Disabled":a}})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/DgridUtil":function(){define(["dojo/aspect","dojo/dom-class","dojo/query","../../utils/ArrayUtil"],function(k,h,e,g){function c(a,
b,c){if(void 0===c){var d=a._rowIdToObject[b.id];d&&(c=(a=a.store)&&a.isOdd&&a.isOdd(d))}0!==c&&1!==c||h.replace(b,f[c],f[1-c])}function b(a,b,e){var d=a.store;if(d&&d.updateExpand){e=d.updateExpand(b.data,e,!0,a.getSortingFunction());for(var f in e)b=a.row(d.get(f)),b.element&&c(a,b.element,e[f])}}var a=["ui-icon-triangle-1-e","ui-icon-triangle-1-se"],f=["dgrid-row-even","dgrid-row-odd"];return{createExpando:function(b){h.add(b,"dgrid-expando-icon ui-icon ui-icon-triangle-1-e esriMapsAnalystXClickable");
return{expando:b,update:function(c){c=c?1:0;h.replace(b,a[c],a[1-c])}}},oddEvenFix:function(a){a.expand&&(a.getSortingFunction=function(){var a=this.get("sort");return a&&a.length?g.getSorting(a):null},k.after(a,"insertRow",function(b){c(a,b);return b}),k.before(a,"refresh",function(){var b=a.store;b&&b.updateExpandedNodes&&b.updateExpandedNodes(a._expanded,a.getSortingFunction())}),k.around(a,"expand",function(c){return function(d,e){var f=d.element?d:a.row(d);void 0===e&&(e=!a._expanded[f.id]);
!0===e&&b(a,f,!0);var g=c.apply(this,arguments);!1===e&&b(a,f,!1);return g}}),k.around(a,"adjustRowIndices",function(b){return function(){var c=a.store;c&&c.updateExpandedNodes&&c.updateExpand&&c.isOdd||b.apply(this,arguments)}}))},makeContentNeverGoUnderScroll:function(a){function b(){var b=a.headerNode.firstChild,c=a.contentNode;c&&b&&b.offsetWidth!==c.offsetWidth&&(c.style.width="",b.style.width="",b.style.width=c.offsetWidth+"px")}k.after(a,"resize",b);k.after(a,"refresh",b);k.after(a,"expand",
function(a){setTimeout(b,100);setTimeout(b,300);return a})},inlineSortArrow:function(a,b,c){b=g.arrayToObject(g.listToArray(b));k.after(a,"updateSortArrow",function(d,f){if((f=d[0]&&d[0].attribute)&&b[f]){var g=(f=a._sortNode||a._findSortArrowParent(f))&&e(".dgrid-sort-arrow",f)[0];d=d[0].descending;if(g){g.remove();h.remove(f,"dgrid-sort-down dgrid-sort-up");var k=c?e(c,f)[0]:f.lastChild.append?f.lastChild:f;k.append||(k=f);h.add(k,d?"dgrid-sort-down":"dgrid-sort-up");k.append(g)}}},!0)}}})},"widgets/BusinessAnalyst/esriAnalystX/utils/ArrayUtil":function(){define("require exports ../../baUtil/array dojo/store/util/SimpleQueryEngine ./ObjectUtil esri/dijit/geoenrichment/utils/ArrayUtil".split(" "),
function(k,h,e,g,c,b){function a(a,b){a.some(function(c,d){b.func(c,d,b,a);if(b.stop)return!0});return b}function f(a){var b=a.split(" "),d=b[1];a={};switch(b[0]){case "max":a.result=-Infinity;b=function(a,b,e){e.result=Math.max(e.result,c.getObject(a,d))};break;case "min":a.result=Infinity;b=function(a,b,e){e.result=Math.min(e.result,c.getObject(a,d))};break;case "sum":a.result=0;b=function(a,b,e){e.result+=c.getObject(a,d)};break;case "random":a.result=void 0;b=function(a,b,c,d){c.result=d[Math.round((d.length-
1)*Math.random())];c.stop=!0};break;default:throw Error("Unsupported query.");}a.func=b;return a}var d={getSorting:function(a,b){if(!a)return c.compare;if("function"===typeof a)return a;var d;d=Array.isArray(a)?a:a.sort||[a];var e={};"string"===typeof b&&(b=[b]);Array.isArray(b)?b.forEach(function(a){e[a]=c.compareNames}):b&&(e=b);return function(a,b){for(var f=void 0,g=0;f=d[g];g++){var h=a[f.attribute],k=b[f.attribute];if(h=(e[f.attribute]||(e["*"]?e["*"].bind(null,f.attribute):c.compare))(h,k,
!1,!1,a,b))return f.descending?-h:h}return 0}},sort:function(a,b,c){return a.sort(d.getSorting(b,c))},sortIndices:function(a,b,c){a=e.map(a,function(a,b){return{value:a,index:b}});var f=d.getSorting(b,c);a.sort(function(a,b){return f(a.value,b.value)});return e.map(a,function(a){return a.index})},getQueryEngine:function(a,b){return function(c,e){e&&e.sort&&(e=Object.assign({},e),e.sort=d.getSorting(e.sort,a));return(b||g)(c,e)}},objectToArray:function(a,b){void 0===b&&(b=null);var c=[],d=b?function(c){return a[c]?
a[c][b]:void 0}:function(b){return a[b]},e;for(e in a){var f=d(e);"undefined"!==typeof f&&c.push(f)}return c},arrayToObject:function(a,c){var d={},f=b.composeIdentityFunction(c);e.forEach(a,function(a){d[f(a)]=a});return d},composeIdentityFunction:b.composeIdentityFunction,removeDuplicates:b.removeDuplicates,splitArrayToBunches:b.splitArrayToBunches,contains:function(a,b){return-1!==e.indexOfLoose(a,b)},remove:function(a,b){b=e.indexOfLoose(a,b);-1!==b&&a.splice(b,1);return-1!==b},merge:function(a,
b){a=a||[];null!=b&&Array.prototype.push.apply(a,b);return a},listToArray:function(a,b){if(null==a)return[];void 0===b&&(b=",");a="string"===typeof a?a.split(b):a.slice();for(b=0;b<a.length;b++)"string"===typeof a[b]&&(a[b]=a[b].trim());return a},reorderArray:function(a,b){var c=a.length,d=0,e=Array(c),f={},g={},h;for(h in b){var k=Math.round(h);if(0<=k&&k<c&&!f[k]){var m=Math.round(b[h]);0<=m&&m<c&&!g[m]&&(e[m]=a[k],f[k]=1,g[m]=1,d++)}}d!==c&&(e=e.filter(function(a,b){return g[b]}),a.forEach(function(a,
b){!f[b]&&e.push(a)}));return e},mapIndices:function(a,b,c,d){d=null==d?null:d;if(1===a)c.call(d,0,Math.floor(b/2));else{b=(b-1)/(a-1);for(var e=0;e<a;e++)c.call(d,e,Math.floor(.5+e*b))}},moveElement:function(a,b,c,d){var e=Array.isArray(b)?b:[b];if(-1!==e.indexOf(c))return a.slice();var f=[];a.forEach(function(a){-1===e.indexOf(a)&&(a==c?"before"===d?(e.forEach(function(a){f.push(a)}),f.push(c)):"after"===d&&(f.push(c),e.forEach(function(a){f.push(a)})):f.push(a))});return f},min:function(a,b){var c=
a.length;switch(c){case 0:return null;case 1:return a[0];default:for(var d=a[0],e=b(d),f=0,g=1;g<c;g++){var h=b(a[g]);e>h&&(d=a[g],e=h,f=g)}return{key:f,value:d,comparisonValue:e}}},max:function(a,b){var c=a.length;switch(c){case 0:return null;case 1:return a[0];default:for(var d=a[0],e=b(d),f=0,g=1;g<c;g++){var h=b(a[g]);e<h&&(d=a[g],e=h,f=g)}return{key:f,value:d,comparisonValue:e}}},query:function(b,c){if("object"===typeof c)return a(b,c);if("string"===typeof c)return c=f(c),a(b,c).result},everyEqualProperty:function(a,
b){if(2>a.length)return!0;var c;return!a.some(function(a,d){if(0===d)c=a[b];else if(c!==a[b])return!0})}};return d})},"widgets/BusinessAnalyst/baUtil/array":function(){define(["require","exports"],function(k,h){var e=Array.prototype,g={every:function(c,b,a){return null==c?!0:"string"===typeof c?e.every.call(c.split(""),b,a):e.every.call(c,b,a)},some:function(c,b,a){return null==c?!1:"string"===typeof c?e.some.call(c.split(""),b,a):e.some.call(c,b,a)},forEach:function(c,b,a){if(null!=c)return"string"===
typeof c?e.forEach.call(c.split(""),b,a):e.forEach.call(c,b,a)},map:function(c,b,a){return null==c?[]:"string"===typeof c?e.map.call(c.split(""),b,a):e.map.call(c,b,a)},filter:function(c,b,a){return null==c?[]:"string"===typeof c?e.filter.call(c.split(""),b,a):e.filter.call(c,b,a)},indexOf:function(c,b){return null==c?-1:"string"===typeof c?e.indexOf.call(c.split(""),b):e.indexOf.call(c,b)},indexOfLoose:function(c,b){if(null==c||void 0===c.length)return-1;if("string"===typeof c)return g.indexOfLoose(c.split(""),
b);for(var a=0,e=c.length;a<e;a++)if(c[a]==b)return a;return-1},lastIndexOf:function(c,b){return null==c?-1:"string"===typeof c?e.lastIndexOf.call(c.split(""),b):e.lastIndexOf.call(c,b)},lastIndexOfLoose:function(c,b){if(null==c||void 0===c.length)return-1;if("string"===typeof c)return g.lastIndexOfLoose(c.split(""),b);for(var a=c.length-1;0<=a;a--)if(c[a]==b)return a;return-1}};return g})},"widgets/BusinessAnalyst/SelectPointPolygonPage":function(){define("dojo/_base/declare dojo/dom-class dojo/on dojo/when dijit/_TemplatedMixin dijit/_WidgetBase esri/dijit/Search esri/dijit/geoenrichment/_WizardPage esri/geometry/webMercatorUtils esri/graphic esri/symbols/PictureMarkerSymbol dojo/text!./SelectPointPolygonPage.html ./utils/GeocodeUtil".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p){return k([b,c,f],{templateString:l,postCreate:function(){this.inherited(arguments);var b=this;this.search=(new a({map:this.map})).placeAt(this.searchContainer);this.search.activeSource.outFields.push("country");this.own(e(this.search,"select-result",function(){b._loadSearchResult()}));this.own(e(this.activatePinButton,"click",function(){b._onActivatePinButtonClick()}))},startup:function(){this._started||h.add(this.layoutGrid.domNode,"business-analyst-search-suggestions-overflow")},
_loadSearchResult:function(){this.wizard.selectedPoint.geometry=this.search.selectedResult.feature.geometry;this.wizard.selectedPoint.locationName=this.search.selectedResult.name;var a=d.xyToLngLat(this.search.selectedResult.feature.geometry.x,this.search.selectedResult.feature.geometry.y);this.wizard.selectedPoint.long=a[0].toFixed(5);this.wizard.selectedPoint.lat=a[1].toFixed(5);this.wizard.setSelectedCountry(this.search.selectedResult.feature.attributes.country);this.onNext()},_onActivatePinButtonClick:function(){this._executeHandler?
this._deactivate():this._setActive()},_setActive:function(){this._executeHandler||(h.add(this.activatePinButton,"esriBusinessAnalystPinPressedButton"),this.map.setMapCursor("default"),this.map.disablePan(),this._executeHandler=e(this.map,"click",this._addPoint.bind(this)))},_deactivate:function(){this._executeHandler&&(h.remove(this.activatePinButton,"esriBusinessAnalystPinPressedButton"),this.map.enablePan(),this._executeHandler.remove(),this._executeHandler=null)},_addPoint:function(a){if(this._executeHandler){this._deactivate();
var b=d.xyToLngLat(a.mapPoint.x,a.mapPoint.y),c=this;g(p.reverseGeocode({x:b[0],y:b[1]}),function(d){var e=new m("https://js.arcgis.com/3.28/esri/dijit/Search/images/search-pointer.png",36,36);c.wizard.selectedPoint.pointGraphic=new n(a.mapPoint,e);c.map.graphics.add(c.wizard.selectedPoint.pointGraphic);c.map.centerAndZoom(a.mapPoint,12);c.wizard.selectedPoint.geometry=a.mapPoint;c.wizard.selectedPoint.locationName=d&&d.address&&d.address.LongLabel?d.address.LongLabel:"";c.wizard.setSelectedCountry(d.address.CountryCode);
c.wizard.selectedPoint.long=b[0].toFixed(5);c.wizard.selectedPoint.lat=b[1].toFixed(5);c.onNext()})}}})})},"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(k,h,e,g,c,b,a,f,d,n,m,l,p,q,v,r,u,t,z,w,C,A,B,y,D,F,E,G,H,I,J,N,K,P,L,M,Q,T,R,U,X,V,W,Y){function O(a,b){a&&b&&(a._layer=b,a._sourceLayer=b)}h=h([w,C,A,c],{declaredClass:"esri.dijit.Search",templateString:z,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(a,b){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",
searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",
showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",
searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new X("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type",
"Match_addr","StAddr","City"],name:t.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:t.widgets.Search.main.placeholder,highlightSymbol:(new J(k.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,
enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new L).setColor(new W([181,56,46,.9])).setFont(new M("14px",M.STYLE_NORMAL,M.VARIANT_NORMAL,M.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new F(t.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:1,enableSearchingAll:!0};a=e.mixin({},this.options,a);this.set(a);this._updateActiveSource();this._i18n=t;this._defaultSR=new G(4326);this.domNode=b},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(e.hitch(this,this._init))},postCreate:function(){var a=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(f(this.submitNode,B,e.hitch(this,this._searchButton)));this.own(f(this.sourcesBtnNode,B,e.hitch(this,this._toggleSourcesMenu)));this.own(f(this.inputNode,B,e.hitch(this,this._inputClick)));this.own(f(this.clearNode,B,e.hitch(this,this._clearButton)));this.own(f(this.formNode,"submit",e.hitch(this,function(a){a.preventDefault();this._cancelSuggest();this.search()})));this.own(f(this.inputNode,"keyup",e.hitch(this,function(a){this._inputKey(a)})));
this.own(f(this.sourcesBtnNode,"keyup",e.hitch(this,function(a){this._sourceBtnKey(a)})));this.own(f(this.suggestionsNode,"li:click, li:keyup",function(b){a._suggestionsEvent(b,this)}));this.own(f(this.sourcesNode,"li:click, li:keyup",function(b){a._sourcesEvent(b,this)}));this.own(f(this.inputNode,"input, paste",e.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(f(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",e.hitch(this,function(a){this._showMoreResultsClick(a)}))),this.own(f(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",e.hitch(this,function(a){this._moreResultsClick(a)}))),this.own(f(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",e.hitch(this,function(a){this._switchCoordinatesClick(a)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();r.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();p.get(this.inputNode,"value")&&p.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);q.remove(this.containerNode,this.css.hasValue);p.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){v.set(this.domNode,"display","block")},hide:function(){v.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(q.add(this.containerNode,this.css.searchExpanded),q.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(q.remove(this.containerNode,this.css.searchExpanded),q.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(a){this.enableButtonMode&&("undefined"===typeof a&&(a=!this.expanded),a?this.expand():this.collapse())},search:function(a){var c=new b;this._mapLoaded().then(e.hitch(this,function(){this._searchDeferred(a).then(e.hitch(this,function(a){var b=a.results;this.set("searchResults",b);0===a.numResults&&(this._noResults(a.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",a);this._selectFirstResult(b,
a.activeSourceIndex);c.resolve(b)}),e.hitch(this,function(a){c.reject(a)}))}));return c.promise},suggest:function(a){var c=new b;this._mapLoaded().then(e.hitch(this,function(){this._suggestDeferred(a).then(e.hitch(this,function(a){if(a){var b=a.results;this.set("suggestResults",b);this._insertSuggestions(b,a.value);this.emit("suggest-results",a);c.resolve(b)}}),e.hitch(this,function(a){c.reject(a)}))}));return c.promise},select:function(a){var b=this._getDefaultSymbol(a),c=this.labelSymbol,d,f=this.sources,
g=this.activeSourceIndex,h=this.enableHighlight,k=this.enableLabel,l=this.autoNavigate,m=this.showInfoWindowOnSelect,S=this.enableInfoWindow,n=this.infoTemplate,p=a.feature?new H(a.feature.toJson()):null,q=p?a.feature._sourceLayer:null;O(p,q);if(g===this._allIndex){var r=this._getSourceIndexOfResult(a);null!==r&&(d=f[r],g=r)}else d=f[g];d&&(d.hasOwnProperty("highlightSymbol")&&(b=d.highlightSymbol),d.hasOwnProperty("labelSymbol")&&(c=d.labelSymbol),d.hasOwnProperty("enableHighlight")&&(h=d.enableHighlight),
d.hasOwnProperty("enableLabel")&&(k=d.enableLabel),d.hasOwnProperty("autoNavigate")&&(l=d.autoNavigate),d.hasOwnProperty("showInfoWindowOnSelect")&&(m=d.showInfoWindowOnSelect),d.hasOwnProperty("enableInfoWindow")&&(S=d.enableInfoWindow),d.hasOwnProperty("infoTemplate")?n=d.infoTemplate:d.featureLayer&&d.featureLayer.infoTemplate&&(n=d.featureLayer.infoTemplate));this._hideMenus();this._hideLoading();if(p){var f=this.highlightGraphic,t=this.graphicsLayer,r=this.labelGraphic,u=e.mixin({},p.attributes,
{searchTheme:this.theme,searchResult:this._searchResultHTML(a),searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(a)}),v=null;S&&(v=n);r?(r.setGeometry(p.geometry),r.setAttributes(u),r.setSymbol(c),c&&"textsymbol"===c.type&&r.symbol.setText(a.name)):(r=new H(p.geometry,c,u),O(r,q),c&&"textsymbol"===c.type&&r.symbol.setText(a.name),k&&(t?t.add(r):this.map&&this.map.graphics&&
this.map.graphics.add(r)));f?(f.setGeometry(p.geometry),f.setAttributes(u),f.setInfoTemplate(v),f.setSymbol(b)):(f=new H(p.geometry,b,u,v),O(f,q),h&&(t?t.add(f):this.map&&this.map.graphics&&this.map.graphics.add(f)));f&&f.symbol&&"textsymbol"===f.symbol.type&&f.symbol.setText(a.name);this.map&&this.map.infoWindow&&S&&m&&(this.map.infoWindow.setFeatures([f]),b=this._getPointFromGeometry(f.geometry),this.map.infoWindow.show(b));this.map&&l&&a&&a.hasOwnProperty("extent")&&"function"===typeof this.map.setExtent&&
this.map.setExtent(a.extent,!0);this.set("highlightGraphic",f);this.set("labelGraphic",r)}this.set("selectedResult",a);this.emit("select-result",{result:a,source:d,sourceIndex:g})},focus:function(){y.focus(this.inputNode)},blur:function(){this.inputNode.blur();y.curNode&&y.curNode.blur()},clearGraphics:function(){var a=this.highlightGraphic,b=this.graphicsLayer,c=this.labelGraphic;a&&(b?b.remove(a):this.map&&this.map.graphics&&this.map.graphics.remove(a));c&&(b?b.remove(c):this.map&&this.map.graphics&&
this.map.graphics.remove(c));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var a=new b;if(this.map)if(this.map.loaded)a.resolve();else f.once(this.map,"load",e.hitch(this,function(){a.resolve()}));else a.resolve();return a.promise},_init:function(){this._getMapLayers().then(e.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();y.focus(this.inputNode)},_error:function(a){return Error(this.declaredClass+" "+
a)},_searchDeferred:function(a){var c=new b,d=this.value,f=this.activeSourceIndex;a&&a.hasOwnProperty("index")&&(f=a.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var g={magicKey:this.magicKey,text:d};a?"string"===typeof a?(g.text=a,a=this._searchQueries(g)):a="object"===typeof a&&a.hasOwnProperty("magicKey")?this._searchQueries(a):"object"===typeof a&&a.hasOwnProperty("geometry")?this._searchQueries({geometry:a}):"object"===typeof a&&a.hasOwnProperty(this._objectIdIdentifier)?
this._searchQueries(a):"object"===typeof a&&"point"===a.type?this._searchQueries({point:a}):a instanceof Array&&2===a.length?this._searchQueries({latlon:a}):this._searchQueries(g):a=this._searchQueries(g);a.always(e.hitch(this,function(a){a=this._formatResults(a,f,d);c.resolve(a)}));return c.promise},_suggestDeferred:function(a){var c=new b;this._deferreds.push(c);a||(a=this.value);var d=this.activeSourceIndex;this._suggestQueries({text:a}).always(e.hitch(this,function(b){var e;if(b)for(var f=0;f<
b.length;f++)b[f]&&(e=!0);e?(b=this._formatResults(b,d,a),c.resolve(b)):c.resolve()}));return c.promise},_getDefaultSymbol:function(a){var b,c,d,e;this.map&&(e=this.map.getBasemap());e||(e="topo");a&&a.feature&&a.feature.geometry&&(d=a.feature.geometry.type);"polyline"===d?d="line":"circle"===d||"extent"===d?d="polygon":"multipoint"===d&&(d="point");if(d){if(a=Y.getSchemes({theme:"default",basemap:e,geometryType:d}))c=a.primaryScheme;if(c){c.color&&c.hasOwnProperty("opacity")&&(c.color.a=c.opacity);
b=c;a=c.color;c=c.size;var f;switch(d){case "point":f=new N;f.setColor(a);f.setSize(null!==c?c:b.size);d=new K;d.setColor(b.outline.color);d.setWidth(b.outline.width);f.setOutline(d);break;case "line":f=new K;f.setColor(a);f.setWidth(null!==c?c:b.width);break;case "polygon":f=new P,f.setColor(a),d=new K,d.setColor(b.outline.color),d.setWidth(b.outline.width),f.setOutline(d)}b=f}}return b},_selectFirstResult:function(a,b){if(this.autoSelect&&a){var c;b===this._allIndex?c=this._getFirstResult(a):a[b]&&
a[b][0]&&(c=a[b][0]);c&&this.select(c)}},_getSourceIndexOfResult:function(a){var b=this.searchResults;if(b)for(var c in b)if(b[c]&&b[c].length)for(var d=0;d<b[c].length;d++)if(b[c][d]===a)return parseInt(c,10);return null},_getFirstResult:function(a){if(a)for(var b in a)if(a[b]&&a[b][0])return a[b][0];return!1},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();
this.map&&"function"===typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var a=new b;if(this.addLayersFromMap&&this.map){var c=[],d=this.map.graphicsLayerIds;if(d&&d.length){for(var f=0;f<d.length;f++){var g=this.map.getLayer(d[f]);g&&c.push(this._featureLayerLoaded(g))}I(c).always(e.hitch(this,function(b){for(var c,d=this.sources,e=0;e<b.length;e++)b[e]&&
b[e].loaded&&"Feature Layer"===b[e].type&&(d.push({featureLayer:b[e],enableSuggestions:!0}),c=!0);c&&this.set("sources",d);a.resolve()}))}else a.resolve()}else a.resolve();return a.promise},_switchCoordinatesClick:function(a){a.preventDefault();if(a=p.get(a.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",a),this.search()},_moreResultsClick:function(a){a.preventDefault();var b=a.target;a=parseInt(p.get(b,"data-source-index"),10);var b=parseInt(p.get(b,"data-index"),10),c=this.searchResults;
c&&c[a]&&(a=c[a][b])&&this.select(a)},_showMoreResultsClick:function(a){a.preventDefault();if(a=l.byId(this._moreResultsId)){q.toggle(a,this.css.searchShowMoreResults);var b=l.byId(this._moreResultsId+"_show");b&&(q.contains(a,this.css.searchShowMoreResults)?p.set(b,"textContent",t.widgets.Search.main.hideMoreResults):p.set(b,"textContent",t.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(a){var c=new b;if(a.loaded)c.resolve(a);else if(a.loadError)c.reject(this._error("Layer failed to load."));
else{var d,g;d=f.once(a,"load",e.hitch(this,function(){g.remove();c.resolve(a)}));g=f.once(a,"error",e.hitch(this,function(){d.remove();c.reject(this._error("Layer could not be loaded."))}))}return c.promise},_getObjectSize:function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b},_sourcesEvent:function(b,c){var e=p.get(c,"data-index"),f=d("li",this.sourcesNode);c=g.indexOf(f,c);e!==this._allIndex&&(e=parseInt(e,10));"click"===b.type||b.keyCode===a.ENTER?(this.set("activeSourceIndex",e),
y.focus(this.inputNode),this._hideSourcesMenu()):b.keyCode===a.UP_ARROW?(b.stopPropagation(),b.preventDefault(),b=c-1,0>b?y.focus(this.sourcesBtnNode):y.focus(f[b])):b.keyCode===a.DOWN_ARROW?(b.stopPropagation(),b.preventDefault(),b=c+1,b>=f.length?y.focus(this.sourcesBtnNode):y.focus(f[b])):b.keyCode===a.ESCAPE&&(this._hideSourcesMenu(),y.focus(this.inputNode))},_suggestionsEvent:function(b,c){var e=p.get(c,"data-source-index"),f=parseInt(p.get(c,"data-index"),10),h=d("li",this.suggestionsNode),
k=this.sources;c=g.indexOf(h,c);e!==this._allIndex&&(e=parseInt(e,10));var l;this._clearQueryTimeout();"click"===b.type||b.keyCode===a.ENTER?((h=this.suggestResults)&&h[e]&&h[e][f]&&(l=h[e][f]),l&&(l.index=e,k[e].featureLayer?(e=k[e].featureLayer.objectIdField,l[this._objectIdIdentifier]=l.feature.attributes[e],this.set("value",this._getSuggestionName(l)),this.set("selectedFeatureId",l.feature.attributes[e])):l.magicKey&&l.text&&(this.set("value",l.text),this.set("magicKey",l.magicKey)),this.search(l),
y.focus(this.inputNode))):b.keyCode===a.BACKSPACE||b.keyCode===a.DELETE?y.focus(this.inputNode):b.keyCode===a.UP_ARROW?(b.stopPropagation(),b.preventDefault(),l=c-1,0>l?y.focus(this.inputNode):y.focus(h[l])):b.keyCode===a.DOWN_ARROW?(b.stopPropagation(),b.preventDefault(),l=c+1,l>=h.length?y.focus(this.inputNode):y.focus(h[l])):b.keyCode===a.ESCAPE&&(this._hideMenus(),y.focus(this.inputNode))},_getResultName:function(a){var b;a.hasOwnProperty("name")&&null!==a.name&&(b=a.name.toString());b||(b=t.widgets.Search.main.untitledResult);
return b},_getSuggestionName:function(a){var b;a.hasOwnProperty("name")&&null!==a.name&&(b=a.name.toString());a=a.text||b;a||(a=t.widgets.Search.main.untitledResult);return a},_searchResultHTML:function(a){var b="";if(a.feature&&a.feature.attributes&&a.feature.attributes.Addr_type&&"LatLong"===a.feature.attributes.Addr_type){var c=a.name.split(" "),d,e;2===c.length&&(d=c[0],e=c[1]);e&&d?(a=parseFloat(d),e=parseFloat(e),c=e+", "+a,b+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',b+='\x3cdiv class\x3d"'+
this.css.latLonHeader+'"\x3e'+t.widgets.Search.main.lonlat+"\x3c/div\x3e",b=b+(a+", "+e)+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),a===e||90<a||-90>a||180<e||-180>e||(b+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+t.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",b=b+('\x3ca data-switch-coordinates\x3d"'+c+'" tabindex\x3d"0" href\x3d"#"\x3e'+c+"\x3c/a\x3e")+"\x3c/div\x3e")):b=a.name}else b=a.name;return b},_moreResultsHTML:function(a){var b="",c="",
d=this.searchResults,e=this.sources,f=0;if(d){var c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),c=c+('\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+t.widgets.Search.main.showMoreResults+"\x3c/a\x3e"),c=c+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsList+'"\x3e'),c=c+('\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e'),g;for(g in d)if(d[g]){var h=d[g].length;if(h){var k=1===h&&d[g][0]===a;if(1<this._getObjectSize(d)&&!k)var l=this._getSourceName(g),
c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+l+"\x3c/div\x3e");if(h&&!k){c+="\x3cul\x3e";l=e[g].maxResults||this.maxResults;for(k=0;k<h&&k<l;++k)if(d[g][k]!==a){var m=this._getResultName(d[g][k]),c=c+('\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+k+'" data-source-index\x3d"'+g+'" href\x3d"#"\x3e'+m+"\x3c/a\x3e\x3c/li\x3e");f++}c+="\x3c/ul\x3e"}}}c+="\x3c/div\x3e\x3c/div\x3e"}f&&(b+=c);return b},_validField:function(a,b){return a.getField(b)},_validFields:function(a,b){if(a&&
b&&b.length){for(var c=0;c<b.length;c++)if(!this._validField(a,b[c]))return!1;return!0}return!1},_getCodedName:function(a,b){if(a&&a.length)for(var c=0,d=a.length;c<d;c++){var e=a[c];if(e.code===b)return e.name}},_getCodedValue:function(a,b,c){if(a&&a.length)for(var d=0,e=a.length;d<e;d++){var f=a[d],g=f.name,h=b;c||(g=g.toLowerCase(),h=h.toLowerCase());if(g===h)return f.code}return!1},_whereClause:function(a,b,c,d){var e=null;if(a){var f="";this.reHostedFS.test(b.url)&&this._containsNonLatinCharacter(a)&&
(f="N");if(c&&c.length)for(var g=0,h=c.length;g<h;g++){var k="",l=a.replace(/\'/g,"''"),k=c[g],m=b.getField(k),n=b.getDomain(k);n&&"codedValue"===n.type&&(l=this._getCodedValue(n.codedValues,l,d));!1!==l&&(m=m.type,"esriFieldTypeString"===m||"esriFieldTypeDate"===m?k=d?k+" \x3d "+f+"'"+l+"'":"UPPER("+k+") LIKE "+f+"'%"+l.toUpperCase()+"%'":"esriFieldTypeOID"===m||"esriFieldTypeSmallInteger"===m||"esriFieldTypeInteger"===m||"esriFieldTypeSingle"===m||"esriFieldTypeDouble"===m?(l=parseFloat(l),k=isNaN(l)?
!1:k+" \x3d "+l):k=k+" \x3d "+l,k&&(e=e?e+" or ":"",e+=k))}}return e},_suggest:function(a){a||(a={index:this.activeSourceIndex,text:this.value});var c=new b,d=a.index,f=this.sources[d],h=this.enableSuggestions;f.hasOwnProperty("enableSuggestions")&&(h=f.enableSuggestions);var k=0,l;a.hasOwnProperty("text")&&a.text&&(l=e.trim(a.text),k=a.text.length);a=f.minCharacters||this.minCharacters;if(h&&l&&k>=a&&this._supportsPagination(f)){var m="";f.prefix&&(m+=f.prefix);m+=l;f.suffix&&(m+=f.suffix);var n=
this._defaultSR;this.map&&(n=this.map.spatialReference);h={};f.locator?(f.categories&&(h.categories=f.categories),f.locator.outSpatialReference=n,this.map&&f.localSearchOptions&&f.localSearchOptions.hasOwnProperty("distance")&&f.localSearchOptions.hasOwnProperty("minScale")&&(k=this._getScale(),!f.localSearchOptions.minScale||k&&k<=parseFloat(f.localSearchOptions.minScale))&&(h.location=this.map.extent.getCenter(),h.distance=f.localSearchOptions.distance),h.text=m,f.useMapExtent&&this.map&&this.map.extent&&
(h.searchExtent=this.map.extent),f.searchExtent&&(h.searchExtent=f.searchExtent),h.maxSuggestions=f.maxSuggestions||this.maxSuggestions,f.sourceCountry&&(h.countryCode=f.sourceCountry),f.countryCode&&(h.countryCode=f.countryCode),f.locator.suggestLocations(h).then(e.hitch(this,function(a){c.resolve(a)}),e.hitch(this,function(a){a||(a=this._error("Locator suggestLocations could not be performed."));c.reject(a)}))):f.featureLayer?this._featureLayerLoaded(f.featureLayer).then(e.hitch(this,function(){var a=
this._getDisplayField(f),b=f.searchFields||[a],h=[];f.suggestionTemplate?f.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(a,b){h.push(b)}):h=[a];-1===g.indexOf(h,f.featureLayer.objectIdField)&&h.push(f.featureLayer.objectIdField);var a=this._validField(f.featureLayer,a),k=this._validFields(f.featureLayer,h),l=this._validFields(f.featureLayer,b);if(a&&k&&l){a=new V;f.hasOwnProperty("suggestQueryParams")&&e.mixin(a,f.suggestQueryParams);a.outSpatialReference=n;a.returnGeometry=!1;a.num=f.maxSuggestions||
this.maxSuggestions;a.outFields=h;f.useMapExtent&&this.map&&this.map.extent&&(a.geometry=this.map.extent);f.searchExtent&&(a.geometry=f.searchExtent);var p;if(b=this._whereClause(m,f.featureLayer,b,!1))a.where=b,p=!0;p?f.featureLayer.queryFeatures(a,e.hitch(this,function(a){var b;(a=a.features)&&(b=this._hydrateResults(a,d,!0));c.resolve(b)}),e.hitch(this,function(a){a||(a=this._error("FeatureLayer queryFeatures errored with suggestions"));c.reject(a)})):c.resolve()}else c.reject(this._error("Invalid FeatureLayer field"))})):
c.reject(this._error("Invalid source"))}else c.resolve();return c.promise},_supportsPagination:function(a){var b;a.locator?b=!0:a.featureLayer&&a.featureLayer.advancedQueryCapabilities&&a.featureLayer.advancedQueryCapabilities.supportsPagination&&(b=!0);return b},_suggestQueries:function(a){var b=this.sources,c=this.activeSourceIndex,d=[],e;if(c===this._allIndex)for(c=0;c<b.length;c++)e=a,e.index=c,e=this._suggest(e),d.push(e);else a.index=c,e=this._suggest(a),d.push(e);return I(d)},_getPointFromGeometry:function(a){var b;
switch(a.type){case "extent":b=a.getCenter();break;case "multipoint":b=a.getPoint(0);break;case "point":b=a;break;case "polygon":b=a.getCentroid();break;case "polyline":b=a.getPoint(0,0)}return b},_searchQueries:function(a){a.hasOwnProperty("index")||(a.index=this.activeSourceIndex);var b=[],c;if(a.index===this._allIndex)for(var d=this.sources,e=0;e<d.length;e++)c=a,c.index=e,c=this._search(c),b.push(c);else a=this._search(a),b.push(a);return I(b)},_searchButton:function(){this.enableButtonMode&&
!this.expanded?(this.expand(),y.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(a){a||(a={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(a.text=null,a[this._objectIdIdentifier]=this.selectedFeatureId);var c,d=new b,f=a.index,g=this.sources[f],h;a.hasOwnProperty("text")&&a.text&&(h=e.trim(a.text));if(g){var k="";g.prefix&&!a.magicKey&&(k+=g.prefix);k+=h;g.suffix&&!a.magicKey&&(k+=g.suffix);var l=
this._defaultSR;this.map&&(l=this.map.spatialReference);if(g.locator)if(a.hasOwnProperty("text")&&h){var m={};g.categories&&(m.categories=g.categories);g.locationType&&(m.locationType=g.locationType);l&&(g.locator.outSpatialReference=l);if(this.map&&g.localSearchOptions&&g.localSearchOptions.hasOwnProperty("distance")&&g.localSearchOptions.hasOwnProperty("minScale")){var n=this._getScale();if(!g.localSearchOptions.minScale||n&&n<=parseFloat(g.localSearchOptions.minScale))m.location=this.map.extent.getCenter(),
m.distance=g.localSearchOptions.distance}m.address={};m.maxLocations=g.maxResults||this.maxResults;g.useMapExtent&&this.map&&this.map.extent&&(m.searchExtent=this.map.extent);g.searchExtent&&(m.searchExtent=g.searchExtent);g.sourceCountry&&(m.countryCode=g.sourceCountry);g.countryCode&&(m.countryCode=g.countryCode);a.magicKey&&(m.magicKey=a.magicKey);g.singleLineFieldName?m.address[g.singleLineFieldName]=k:m.address["Single Line Input"]=k;g.outFields&&(m.outFields=g.outFields);g.locator.addressToLocations(m).then(e.hitch(this,
function(a){a=this._hydrateResults(a,f,!1);d.resolve(a)}),e.hitch(this,function(a){a||(a=this._error("Locator addressToLocations could not be performed"));d.reject(a)}))}else a.geometry?(c=this._getPointFromGeometry(a.geometry.geometry))?this._reverseGeocodePoint(f,c).then(function(a){d.resolve(a)},function(a){d.reject(a)}):d.reject(this._error("Invalid point to reverse geocode")):a.point?this._reverseGeocodePoint(f,a.point).then(function(a){d.resolve(a)},function(a){d.reject(a)}):a.latlon?(m=new Q(a.latlon,
this._defaultSR),this._reverseGeocodePoint(f,m).then(function(a){d.resolve(a)},function(a){d.reject(a)})):a.hasOwnProperty("text")&&!h?d.resolve([]):d.reject(this._error("Invalid query type for Locator"));else g.featureLayer?this._featureLayerLoaded(g.featureLayer).then(e.hitch(this,function(){var b=this._getDisplayField(g),m=g.searchFields||[b],b=this._validField(g.featureLayer,b),n=this._validFields(g.featureLayer,m);if(b&&n){b=new V;g.hasOwnProperty("searchQueryParams")&&e.mixin(b,g.searchQueryParams);
l&&(b.outSpatialReference=l,n=this.map&&this.map.getMaxResolution()||1/U.getUnitValueForSR(l))&&(b.maxAllowableOffset=n);b.returnGeometry=!0;g.outFields&&(b.outFields=g.outFields);var p;a.hasOwnProperty(this._objectIdIdentifier)||(this._supportsPagination(g)&&(b.num=g.maxResults||this.maxResults),g.useMapExtent&&this.map&&this.map.extent&&(b.geometry=this.map.extent),g.searchExtent&&(b.geometry=g.searchExtent),p=g.exactMatch);a.hasOwnProperty("text")&&h?(m=this._whereClause(k,g.featureLayer,m,p))?
(b.where=m,m=!0):m=!1:a.hasOwnProperty(this._objectIdIdentifier)?(b.objectIds=[a[this._objectIdIdentifier]],m=!0):a.geometry?(b.geometry=a.geometry,m=!0):a.point?(b.geometry=a.point,m=!0):a.latlon?(c=new Q(a.latlon,this._defaultSR),b.geometry=c,m=!0):(a.hasOwnProperty("text")&&!h?d.resolve([]):d.reject(this._error("Invalid query type for FeatureLayer")),m=!1);m?g.featureLayer.queryFeatures(b,e.hitch(this,function(a){a=a.features;var b;a&&(b=this._hydrateResults(a,f,!1));d.resolve(b)}),e.hitch(this,
function(a){a||(a=this._error("FeatureLayer queryFeatures could not be performed"));d.reject(a)})):d.resolve()}else d.reject(this._error("Invalid FeatureLayer field"))})):d.reject(this._error("Invalid source"))}else d.reject(this._error("Source is undefined"));return d.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(a,b,c){c={activeSourceIndex:b,value:c,numResults:0,numErrors:0,errors:null,results:null};var d={},e={};if(a)if(b===this._allIndex)for(b=
0;b<a.length;b++)a[b]&&(a[b]instanceof Error?(d[b]=a[b],c.numErrors++):(e[b]=a[b],c.numResults+=a[b].length));else a[0]&&(a[0]instanceof Error?(d[b]=a[0],c.numErrors++):(e[b]=a[0],c.numResults+=a[0].length));c.numErrors&&(c.errors=d);c.numResults&&(c.results=e);return c},_reverseGeocodePoint:function(a,c){var d=new b,f=this.sources[a];if(c&&f){var g=f.locationToAddressDistance||this.locationToAddressDistance;f.locator.outSpatialReference=this._defaultSR;this.map&&(f.locator.outSpatialReference=this.map.spatialReference);
f.locator.locationToAddress(c,g,e.hitch(this,function(b){b=this._hydrateResults([b],a,!1);d.resolve(b)}),e.hitch(this,function(a){a||(a=this._error("Locator locationToAddress could not be performed"));d.reject(a)}))}else d.reject(this._error("No point or source defined for reverse geocoding"));return d.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var a=0;a<this._deferreds.length;a++)this._deferreds[a].cancel(this.declaredClass+" cancelling request");this._deferreds=
[]},_sourceBtnKey:function(b){if(b){var c=d("li",this.sourcesNode);b.keyCode===a.UP_ARROW?(b.stopPropagation(),b.preventDefault(),this._showSourcesMenu(),(b=c.length)&&y.focus(c[b-1])):b.keyCode===a.DOWN_ARROW&&(b.stopPropagation(),b.preventDefault(),this._showSourcesMenu(),c[0]&&y.focus(c[0]))}},_inputKey:function(b){if(b){var c=d("li",this.suggestionsNode),e=this.suggestResults;if(b.keyCode===a.TAB||b.keyCode===a.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(b.keyCode===a.UP_ARROW)b.stopPropagation(),
b.preventDefault(),this._cancelSuggest(),e&&this._showSuggestionsMenu(),(b=c.length)&&y.focus(c[b-1]);else if(b.keyCode===a.DOWN_ARROW)b.stopPropagation(),b.preventDefault(),this._cancelSuggest(),e&&this._showSuggestionsMenu(),c[0]&&y.focus(c[0]);else{if(b.ctrlKey||b.metaKey||b.keyCode===a.copyKey||b.keyCode===a.LEFT_ARROW||b.keyCode===a.RIGHT_ARROW||b.keyCode===a.ENTER)return b;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();
this._changeValue();this._queryTimer=setTimeout(e.hitch(this,function(){this.suggest()}),this.suggestionDelay)},_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(a){return this._sourceNames[a]},_loadSources:function(a){a=g.filter(a,function(a){return!!a.featureLayer});a=g.map(a,function(a){return this._featureLayerLoaded(a.featureLayer)},
this);return I(a)},_createSourceNameMap:function(a){return this._loadSources(a).then(e.hitch(this,function(){var b=g.map(a,function(a){return a.name||a.featureLayer&&a.featureLayer.name||t.widgets.Search.main.untitledSource});this._preventDuplicateSourceNames(a,b);return b}))},_getDuplicateSourceNameIndexes:function(a){var b={},c=[];g.forEach(a,function(d,e){b.hasOwnProperty(d)?(-1===c.indexOf(b[d])&&c.push(b[d]),c.push(e)):a.lastIndexOf(d)!==e&&(b[d]=e)});return c},_preventDuplicateSourceNames:function(a,
b){if(b&&1<b.length){var c=this._getDuplicateSourceNameIndexes(b);g.forEach(c,function(c){b[c]+=this._getFieldsString(a[c])},this)}},_getFieldsString:function(a){var b="",c=a.featureLayer;if(c){a=a.searchFields||[this._getDisplayField(a)];for(var d=0;d<a.length;d++)var b=0===d?b+": ":b+", ",e=a[d],f=c.getFieldLabel(e),b=b+(f||e)}return b},_splitResult:function(a,b){b=m.escapeString(b);return a.replace(new RegExp("(^|)("+b+")(|$)","ig"),"$1|$2|$3").split("|")},_insertSuggestions:function(a,b){if(this.enableSuggestionsMenu&&
this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var c,d=this.sources;if(a){c=r.create("div");for(var e in a)if(a[e]&&a[e].length){var f=this._getSourceName(e);1<d.length&&this.activeSourceIndex===this._allIndex&&r.create("div",{className:this.css.searchMenuHeader,textContent:f},c);for(var f=r.create("ul",{role:"menu"},c),g=d[e].maxSuggestions||this.maxSuggestions,h=0;h<a[e].length&&h<g;++h)for(var k=r.create("li",{"data-index":h,"data-source-index":e,role:"menuitem",tabindex:0},
f),l=this._getSuggestionName(a[e][h]),l=this._splitResult(l,b),m=l.length,n=0;n<m;n++){var p=l[n];p.toLowerCase()===b.toLowerCase()?r.create("strong",{textContent:p},k):(p=document.createTextNode(p),r.place(p,k))}}}c?(r.place(c,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(r.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(a){if(this.enableSourcesMenu&&a&&1<a.length){var b,c,d=this.activeSourceIndex,e=r.create("ul",{role:"menu"});this.enableSearchingAll&&
(b="",d===this._allIndex&&(b="active"),r.create("li",{"data-index":this._allIndex,role:"menuitem",className:b,tabIndex:0,textContent:t.widgets.Search.main.all},e));for(c=0;c<a.length;c++){b="";c===d&&(b=this.css.activeSource);var f=this._getSourceName(c);r.create("li",{"data-index":c,role:"menuitem",className:b,tabIndex:0,textContent:f},e)}q.add(this.containerNode,this.css.hasMultipleSources);r.place(e,this.sourcesNode,"only")}else q.remove(this.containerNode,this.css.hasMultipleSources),r.empty(this.sourcesNode)},
_showLoading:function(){q.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){q.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(q.add(this.containerNode,this.css.hasValue),p.set(this.clearNode,"title",t.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(a){var b;a&&(b=e.trim(a));var c=r.create("div",{className:this.css.searchNoResultsBody});
a&&b?(r.create("div",{className:this.css.searchNoResultsHeader,textContent:t.widgets.Search.main.noResults},c),r.create("div",{className:this.css.searchNoResultsText,textContent:D.substitute({value:'"'+a+'"'},t.widgets.Search.main.noResultsFound)},c)):(a=r.create("div",{},c),r.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},a),r.create("span",{className:this.css.searchNoValueText,textContent:t.widgets.Search.main.emptyValue},a));r.place(c,this.noResultsMenuNode,"only")},
_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){q.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();q.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){q.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){q.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();
this._hideNoResultsMenu();q.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();q.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();q.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(a){if(a&&(a=a.fields)&&a.length)for(var b=0;b<a.length;b++){var c=a[b];if("esriFieldTypeString"===c.type)return c.name}return""},
_getDisplayField:function(a){return a.displayField||a.featureLayer.displayField||this._getFirstStringField(a.featureLayer)},_validLocation:function(a){return a&&"number"===typeof a.x&&"number"===typeof a.y},_validExtent:function(a){return a&&"number"===typeof a.xmin&&"number"===typeof a.ymin&&"number"===typeof a.xmax&&"number"===typeof a.ymax},_hydrateResult:function(a,b,c){var d={},f=this._defaultSR,g;b=this.sources[b];this.map&&(f=this.map.spatialReference);if(a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;
if(a.hasOwnProperty("geometry"))g=new H(a.toJson()),d.feature=g,(g=d.feature.geometry)&&g.setSpatialReference(f);else if(a.hasOwnProperty("location")&&this._validLocation(a.location)){var h=new Q(a.location.x,a.location.y,f);g={};a.hasOwnProperty("attributes")&&(g=a.attributes);a.hasOwnProperty("address")&&"object"===typeof a.address&&e.mixin(g,a.address);a.hasOwnProperty("score")&&(g.score=a.score);d.feature=new H(h,null,g,null)}!d.feature&&c&&(g={},a.hasOwnProperty("attributes")&&(g=a.attributes),
a.hasOwnProperty("score")&&(g.score=a.score),d.feature=new H(null,null,g,null));if(d.feature){if(a.hasOwnProperty("extent")&&this._validExtent(a.extent))d.extent=new T(a.extent),d.extent.setSpatialReference(f);else if(d.feature&&d.feature.geometry)switch(d.feature.geometry.type){case "extent":d.extent=d.feature.geometry;break;case "multipoint":d.extent=R.getDenormalizedExtent(d.feature.geometry);break;case "polygon":d.extent=R.getDenormalizedExtent(d.feature.geometry);break;case "polyline":d.extent=
R.getDenormalizedExtent(d.feature.geometry);break;case "point":this.map?(f=this.zoomScale,b&&b.zoomScale&&(f=b.zoomScale),this._getScale()>f?d.extent=U.getExtentForScale(this.map,f).centerAt(d.feature.geometry):d.extent=this.map.extent.centerAt(d.feature.geometry)):d.extent=new T({xmin:d.feature.geometry.x-.25,ymin:d.feature.geometry.y-.25,xmax:d.feature.geometry.x+.25,ymax:d.feature.geometry.y+.25,spatialReference:this._defaultSR})}else d.extent=null;d.name="";b.featureLayer?b.suggestionTemplate&&
c?d.name=D.substitute(a.attributes,b.suggestionTemplate):b.searchTemplate?d.name=D.substitute(a.attributes,b.searchTemplate):(g=this._getDisplayField(b),c=b.featureLayer.getField(g),f=b.featureLayer.getDomain(g),g&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(g)&&(a=a.attributes[g],f&&"codedValue"===f.type?d.name=this._getCodedName(f.codedValues,a):c&&"esriFieldTypeDate"===c.type&&!isNaN(a)?d.name=u.format(new Date(a)):d.name=a)):a.address&&b.searchTemplate?d.name=D.substitute(a.address,
b.searchTemplate):a.hasOwnProperty("name")?d.name=a.name:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.LongLabel?d.name=a.attributes.LongLabel:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.Match_addr?(d.name=a.attributes.Match_addr,a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.StAddr&&a.attributes.City?d.name+=" - "+a.attributes.StAddr+", "+a.attributes.City:a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&
a.attributes.City&&(d.name+=" - "+a.attributes.City)):a.hasOwnProperty("address")&&"string"===typeof a.address?d.name=a.address:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Address")?a.address.hasOwnProperty("Match_addr")?d.name=a.address.Match_addr:a.address.hasOwnProperty("Address")&&(d.name=a.address.Address):d.feature&&d.feature.geometry&&(d.name=d.feature.geometry.x+","+d.feature.geometry.y);b.featureLayer&&d.feature&&O(d.feature,b.featureLayer);return d}},
_getScale:function(){var a;this.map&&"function"===typeof this.map.getScale&&(a=this.map.getScale());return a},_hydrateResults:function(a,b,c,d){d=[];var e=0;if(a&&a.length)for(e;e<a.length;e++){var f=this._hydrateResult(a[e],b,c);f&&d.push(f)}return d},_containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1},_setPlaceholder:function(a){var b="",c=this.sources[a];a===this._allIndex?b=this.allPlaceholder||t.widgets.Search.main.allPlaceholder:c&&c.placeholder&&
(b=c.placeholder);var d=t.widgets.Search.main.all;c&&(d=this._getSourceName(a));p.set(this.sourceNameNode,"textContent",d);p.set(this.inputNode,"placeholder",b);p.set(this.inputNode,"title",b)},_updateActiveSource:function(){var a=this.sources,b=this.activeSourceIndex,c;a&&a[b]&&(c=a[b]);c?this.set("activeSource",c):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(a){a?(q.toggle(this.containerNode,this.css.searchExpanded,this.expanded),
q.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),q.add(this.containerNode,this.css.hasButtonMode)):(q.remove(this.containerNode,this.css.searchExpanded),q.remove(this.containerNode,this.css.searchCollapsed),q.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(a){a&&1===a.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(a){this._set("enableSourcesMenu",
a);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(a){this._set("enableSearchingAll",a);this._created&&(this._setDefaultActiveSourceIndex(this.sources),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(a){this._createSourceNameMap(a).then(e.hitch(this,function(b){this._sourceNames=b;this._created&&(this._setDefaultActiveSourceIndex(a),this._hideMenus(),this._insertSources(a))}));this._set("sources",a)},_setAllPlaceholderAttr:function(a){this._set("allPlaceholder",
a);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(a){this._set("activeSourceIndex",a);this._updateActiveSource();this._created&&(this._setPlaceholder(a),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(a){this._set("maxLength",a);this._created&&p.set(this.inputNode,"maxLength",a)},_setValueAttr:function(a){this.set("magicKey",null);this.set("selectedFeatureId",null);this._set("value",a);this._created&&(p.set(this.inputNode,
"value",a),this._checkStatus())},_setVisibleAttr:function(a){this._set("visible",a);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(a){this._set("enableButtonMode",a);this._created&&this._updateButtonMode(a)},_setThemeAttr:function(a){this._created&&(q.remove(this.domNode,this.theme),q.add(this.domNode,a));this._set("theme",a)}});n("extend-esri")&&e.setObject("dijit.Search",h,E);return h})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has",
"../kernel","../Color"],function(k,h,e,g,c){function b(a,b){var d;if(a)switch(d={},d.color=new c(a.color),d.opacity=a.opacity||1,b){case "point":d.outline={color:new c(a.outline.color),width:a.outline.width};d.size=a.size;break;case "line":d.width=a.width;break;case "polygon":d.outline={color:new c(a.outline.color),width:a.outline.width}}return d}function a(a){if("esriGeometryPoint"===a||"esriGeometryMultipoint"===a)a="point";else if("esriGeometryPolyline"===a)a="line";else if("esriGeometryPolygon"===
a||"esriGeometryMultiPatch"===a)a="polygon";return a}var f={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,
255,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,.25],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[92,92,92,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,178,178,.25],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,
119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]},dark:{primary:{color:[227,139,79,1],outline:{color:[92,
92,92,.25],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]}}}},d={};(function(){var a,b,c,e,g,h,k,n;for(a in f)for(e in b=f[a],c=b.basemapGroups,g=d[a]={basemaps:[].concat(c.light).concat(c.dark),point:{},line:{},polygon:{}},c)for(h=c[e],k=0;k<h.length;k++)n=h[k],b.pointSchemes&&(g.point[n]=b.pointSchemes[e]),b.lineSchemes&&(g.line[n]=b.lineSchemes[e]),b.polygonSchemes&&
(g.polygon[n]=b.polygonSchemes[e])})();var n={getAvailableThemes:function(a){var b=[],c,e,g;for(c in f)e=f[c],g=d[c],a&&-1===k.indexOf(g.basemaps,a)||b.push({name:e.name,label:e.label,description:e.description,basemaps:g.basemaps.slice(0)});return b},getSchemes:function(c){var e=c.theme,f=c.basemap,g=a(c.geometryType);c=d[e];var h;(c=(c=c&&c[g])&&c[f])&&(h={primaryScheme:b(c.primary,g),secondarySchemes:k.map(c.secondary,function(a){return b(a,g)})});return h},cloneScheme:function(a){var b;a&&(b=h.mixin({},
a),b.color&&(b.color=new c(b.color)),b.outline&&(b.outline={color:b.outline.color&&new c(b.outline.color),width:b.outline.width}));return b}};e("extend-esri")&&h.setObject("styles.basic",n,g);return n})},"widgets/BusinessAnalyst/utils/GeocodeUtil":function(){define(["esri/request","jimu/portalUtils"],function(k,h){return{reverseGeocode:function(e){return h.getPortal(portalUrl).loadSelfInfo().then(function(g){return k({url:(g&&g.isPortal&&g.helperServices&&g.helperServices.geocode&&0<g.helperServices.geocode.length?
g.helperServices.geocode[0].url:"https://geocode.arcgis.com//arcgis/rest/services/World/GeocodeServer")+"/reverseGeocode",content:{appID:"webappbuilder",f:"json",langCode:"en-us",location:JSON.stringify({x:e.x,y:e.y}),distance:250},handleAs:"json"})})}}})},"widgets/BusinessAnalyst/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:esri/dijit/geoenrichment/templates/_WizardPage.html":'\x3cdiv style\x3d"width: 100%; height: 100%;"\x3e\r\n    \x3cdiv data-dojo-type\x3d"esri/dijit/geoenrichment/Grid" data-dojo-attach-point\x3d"layoutGrid"  class\x3d"Grid"\x3e\r\n        ${content}\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/CreateBuffersPage.html":'\x3cdiv\x3e\r\n\t\x3cdiv\x3e${nls.addRingsDtWt}\x3c/div\x3e\r\n\t\x3cbr\x3e\r\n    \x3cdiv style\x3d"width: 350 px; height: 110px"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"ringDtWtTabContainer" style\x3d"width: 100%; height: 110px;"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"ringsContentPane" title\x3d"${nls.rings}" style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t${nls.radius}\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 1" data-dojo-attach-point\x3d"ringsBufferRadii1"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 3" data-dojo-attach-point\x3d"ringsBufferRadii2"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 5" data-dojo-attach-point\x3d"ringsBufferRadii3"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"ringsBufferUnits"\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriMiles" selected\x3d"selected"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"ringValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont" style\x3d"position: absolute; right: 0px; top: 94px;"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"driveTimeContentPane" title\x3d"${nls.driveTime}" style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t${nls.time}\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 5" data-dojo-attach-point\x3d"driveTimeBufferRadii1"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 10" data-dojo-attach-point\x3d"driveTimeBufferRadii2"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 15" data-dojo-attach-point\x3d"driveTimeBufferRadii3"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"driveTimeBufferUnits"\x3e\r\n\t\t\t\t\t\x3coption value\x3d"Minutes" selected\x3d"selected"\x3e${nls.minutes}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"driveTimeValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont" style\x3d"position: absolute; right: 0px; top: 94px;"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"walkTimeContentPane" title\x3d"${nls.walkTime}" style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t${nls.time}\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 5" data-dojo-attach-point\x3d"walkTimeBufferRadii1"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 10" data-dojo-attach-point\x3d"walkTimeBufferRadii2"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 15" data-dojo-attach-point\x3d"walkTimeBufferRadii3"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"walkTimeBufferUnits"\x3e\r\n\t\t\t\t\t\x3coption value\x3d"Minutes" selected\x3d"selected"\x3e${nls.minutes}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"walkTimeValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont" style\x3d"position: absolute; right: 0px; top: 94px;"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv style\x3d"margin-top: 10px;" class\x3d"jimu-btn jimu-btn-vacation"  data-dojo-attach-point\x3d"backBtn" data-dojo-attach-event\x3d"onclick:backOnClick"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3cdiv style\x3d"margin-top: 10px;" class\x3d"jimu-btn"  data-dojo-attach-point\x3d"createBufferBtn" data-dojo-attach-event\x3d"onclick:applyBuffer"\x3e${nls.apply}\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/NoPermissionsPage.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"permissionsDiv"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:esri/dijit/geoenrichment/templates/OnDemandSelect.html":'\x3cdiv class\x3d"esriGEOnDemandSelect"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"openButton" class\x3d"onDemandSelect_openButton"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"arrow" class\x3d"onDemandSelect_arrow"\x3e\x26nbsp;\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"selectedLabel" class\x3d"onDemandSelect_selectedLabel TrimWithEllipses"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"selectedItemHolder" class\x3d"onDemandSelect_selectedItem TrimWithEllipses"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/geoenrichment/ReportPlayer/templates/PlayerToolbarHolder.html":'\x3cdiv class\x3d"esriGEPlayerToolbar"\x3e\r\n\r\n    \x3c!--left--\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"infographicsSelectDiv" class\x3d"dijitInline playerToolbar_infographicsSelectDiv"\x3e\x3c/div\x3e\r\n    \r\n    \x3c!--center--\x3e\r\n    \r\n    \x3cdiv data-dojo-attach-point\x3d"areaTitleDiv" class\x3d"dijitInline playerToolbar_areaTitleDiv"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"areaTitleInnerDiv" class\x3d"dijitInline playerToolbar_areaTitleInnerDiv TrimWithEllipses"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"areasSelectDiv" class\x3d"dijitInline playerToolbar_areasSelectDiv"\x3e\x3c/div\x3e\r\n\r\n    \x3c!--right--\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"rightSideControlsBlock" class\x3d"dijitInline playerToolbar_rightSideControlsBlock"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"zoomSelectDiv" class\x3d"dijitInline dijitInline playerToolbar_zoomSelectDiv"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"pageSelectDiv" class\x3d"dijitInline dijitInline playerToolbar_pageSelectDiv"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"commandButtonsContainer" class\x3d"dijitInline playerToolbar_commandButtonsContainer"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/geoenrichment/ReportPlayer/templates/ReportPlayer.html":'\x3cdiv class\x3d"esriGEReportPlayer esriGENonSelectable"\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"printBackgroundView" class\x3d"esriGEAbsoluteStretched"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"normalViewDiv"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"playerToolbarDiv"\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"printableDivContainer" class\x3d"reportPalyer_printableDivContainer"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"printableDiv" class\x3d"reportPalyer_printableDiv"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"reportContainerDiv"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"reportPlayer_sidePageNavigator" data-dojo-attach-point\x3d"sidePageNavigator"\x3e\r\n            \x3cdiv class\x3d"reportPlayer_paginationArrowUp" data-dojo-attach-point\x3d"prevPageButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"reportPlayer_paginationArrowDown" data-dojo-attach-point\x3d"nextPageButton"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"playerAfterToolbarDiv" class\x3d"reportPlayer_playerAfterToolbarDiv"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"errorViewDiv" class\x3d"esriGEReportPlayerErrorMessage"\x3e\r\n        ${nls.cantPlayReportError}\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/esriAnalystX/widgets/SelectableTreeGrid/templates/SelectableTreeGrid.html":'\x3cdiv class\x3d"esriMapsAnalystXNonSelectable"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"gridContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"selectionCounter" class\x3d"esriMapsAnalystXSelectableTreeCounter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/BusinessAnalyst/RunReportsPage.html":'\x3cdiv\x3e\r\n\t\x3cdiv style\x3d"width: 350 px; height: 150px"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"runReportTabContainer" style\x3d"width: 100%; height: 155px;"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"infographicsContentPane" title\x3d"${nls.infographics}" style\x3d"overflow-y: hidden"\x3e\r\n\t\t\t\t\x3cdiv style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t\t\x3cdiv style\x3d"height: 40px;" data-dojo-attach-point\x3d"infographicDropDownContainer"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cbr /\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-btn runReportButton jimu-state-disabled" data-dojo-attach-point\x3d"runInfographicBtn" data-dojo-attach-event\x3d"onclick:runInfographic"\x3e${nls.runInfographic}\x3c/div\x3e\r\n\t\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"reportsContentPane" title\x3d"${nls.reports}" style\x3d"overflow-y: hidden"\x3e\r\n\t\t\t\t\x3cdiv style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t\t\x3cdiv style\x3d"height: 40px;" data-dojo-attach-point\x3d"reportFilteringSelectDropDownContainer"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cbr /\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-btn runReportButton jimu-state-disabled" data-dojo-attach-point\x3d"runReportBtn" data-dojo-attach-event\x3d"onclick:runReport"\x3e${nls.runReport}\x3c/div\x3e\r\n\t\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cbr\x3e\r\n\t\x3cdiv class\x3d"jimu-btn jimu-btn-vacation" data-dojo-attach-point\x3d"backBtn" data-dojo-attach-event\x3d"onclick:backOnClick"\x3e${nls.back}\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/SelectPointPolygonPage.html":'\x3cdiv\x3e\r\n    \x3cbr\x3e\r\n    \x3cdiv\x3e${nls.widgetDescription}\x3c/div\x3e\r\n    \x3cbr\x3e\r\n    \x3cdiv\x3e${nls.selectPointOrPolygon}\x3c/div\x3e\r\n    \x3cbr\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"searchContainer" class\x3d"esriBusinessAnalystSearchContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"activatePinButton" title\x3d"${nls.addPoint}" class\x3d"esriBusinessAnalystPinButton" data-blur-on-click\x3d"true" \x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"wizardContainer"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/BusinessAnalyst/css/style.css":'.esriBusinessAnalystPinButton {background: #fff; border: 1px solid #c5c5c5; color: #555; -webkit-border-radius: 3px; -moz-border-radius: 3px; -ms-border-radius: 3px; -o-border-radius: 3px; border-radius: 3px; font-size: 12px; line-height: 12px; -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.125); -moz-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.125); box-shadow: 0 1px 2px rgba(0, 0, 0, 0.125); -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-user-select: none; -moz-user-select: none; user-select: none; -webkit-transition: all .05s linear; -moz-transition: all .05s linear; -o-transition: all .05s linear; transition: all .05s linear; padding: 5px 10px; text-align: center; text-transform: uppercase; cursor: pointer; letter-spacing: 1px; position: relative; -webkit-font-smoothing: antialiased; width: 34px; height: 34px; background-repeat: no-repeat; background-position: center; margin-left: 1px; background-image: url("../../../jimu.js/css/images/grey_pin.png");}.esriBusinessAnalystPinButton {top: 42px;}.esriBusinessAnalystPinPressedButton{box-shadow: inset 0px 1px 1px rgba(0, 0, 0, 0.2);}.esriBusinessAnalystPinPressedButton,.esriBusinessAnalystPinPressedButton:hover {background-color: #DDE8F2;}.esriBusinessAnalystSearchContainer {width: 255px; float:left;}.esriGETooltip {box-sizing: initial !important;}.esriGEPlayerToolbar.playerThemeDark {background-color: inherit !important;}.runReportButton {display: block; margin-top: 15px; width: max-content;}.jimu-btn.runReportButton.jimu-state-disabled {cursor: default;}.jimu-widget-business-analyst .tabs {font-family: "Avenir Light"; color: #000000; height: 100%;} .jimu-widget-business-analyst .tabs .tab-description {margin: 10px 0;} .jimu-widget-business-analyst .jimu-tab3\x3e.control\x3e.tab{background-color: #fff; border-top: 0; border-left: 0; border-right: 0; border-bottom: 1px solid #dedede; color:#898989; font-family: "Avenir Medium"; font-size: 14px;} .jimu-widget-business-analyst .jimu-tab3 .tab-item-td.jimu-state-active {border-bottom: 3px solid #24b5cc; font-family: "Avenir Heavy"; color: #000000;} .DashboardTheme .jimu-widget-business-analyst .jimu-tab3 .tab-item-td.jimu-state-active {color: #FFFFFF;} .DashboardTheme.light .jimu-widget-business-analyst .jimu-tab3 .tab-item-td.jimu-state-active {color: #000000;} .jimu-widget-business-analyst .tabs .titles {font-weight: bold; font-family: "Avenir Medium"; font-size: 14px; margin: 20px 0 10px 0;} .jimu-widget-business-analyst .tabs .hide{display: none;} .jimu-widget-business-analyst .tabs .indent{margin-left: 20px; margin-top: 10px;} .jimu-widget-business-analyst .tabs .unit-item{margin: 15px 5px 5px 5px; line-height: 18px; height: 18px; vertical-align: middle;} .jimu-widget-business-analyst .tabs .clearFix {*overflow: hidden; *zoom: 1;} .jimu-widget-business-analyst .tabs .clearFix:after {display: table; content: ""; width: 0; clear: both;} .jimu-widget-business-analyst .tabs .view{height: 100%; overflow-y: auto;} .jimu-widget-business-analyst .tabs .jimu-tab3\x3e.jimu-viewstack{padding-bottom: 30px;} .claro .jimu-widget-business-analyst .dijitTextBox, .claro .esriGEReportPlayer .esriGEPlayerToolbar .dijitTextBox {height: 30px;} .claro .jimu-widget-business-analyst .ui-icon {background-image: inherit;} .business-analyst-search-suggestions-overflow {overflow: visible !important;} .claro .jimu-widget-business-analyst .arcgisSearch .searchClear {top: 2px;} .jimu-widget-business-analyst .validationErrorMessage {color: #FF0000; margin-top: 10px;} .jimu-widget-business-analyst .validationErrorMessage.hidden {display: none;} .jimu-widget-business-analyst .invalidValue {outline: 3px solid #FF0000;}',
"*now":function(k){k(['dojo/i18n!*preload*widgets/BusinessAnalyst/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define(["dojo/_base/declare","dojo/dom-class","dojo/query","jimu/BaseWidget","./BAWizard"],function(k,h,e,g,c){return k([g],{name:"BusinessAnalyst",baseClass:"jimu-widget-business-analyst",reportDropDown:null,infographicDropDown:null,tradeAreaGraphics:[],selectedPoint:{tradeAreas:[]},postCreate:function(){this.inherited(arguments);this.baWizard=(new c({map:this.map,nls:this.nls,config:this.config})).placeAt(this.wizardContainer)},startup:function(){h.add(e(".jimu-widget-business-analyst").parents(".jimu-widget-frame.jimu-container")[0],
"business-analyst-search-suggestions-overflow");h.add(e(".jimu-widget-business-analyst").parents(".jimu-panel.jimu-on-screen-widget-panel")[0],"business-analyst-search-suggestions-overflow")},onClose:function(){this.baWizard._featureUnselected()},onOpen:function(){this.baWizard.refreshPage()}})});