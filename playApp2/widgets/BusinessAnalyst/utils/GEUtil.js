// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define(["dojo/_base/array","esri/request","esri/dijit/geoenrichment/utils/FileUtil","jimu/portalUtils"],function(f,e,g,d){return{getAvailableCountries:function(){return d.getPortal(portalUrl).loadSelfInfo().then(function(a){return e({url:(a&&a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Countries",content:{appID:"webappbuilder",f:"json",
langCode:"en-us"},handleAs:"json"})})},createRingOrDriveTimes:function(a){return d.getPortal(portalUrl).loadSelfInfo().then(function(b){return e({url:(b&&b.helperServices&&b.helperServices.geoenrichment&&b.helperServices.geoenrichment.url?b.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Enrich",content:{appID:"webappbuilder",f:"json",langCode:"en-us",useData:JSON.stringify({sourceCountry:a.sourceCountry}),studyAreasOptions:JSON.stringify(a.studyAreasOptions),
dataCollections:JSON.stringify(["GlobalIntersect"]),returnGeometry:!0,outSR:JSON.stringify({wkid:102100}),studyAreas:JSON.stringify([{geometry:a.geometry}]),token:esri.id.credentials[0].token},handleAs:"json"})})},createReport:function(a){var b={appID:"webappbuilder",langCode:"en-us",report:"string"===typeof a.report?a.report:JSON.stringify(a.report),format:"pdf",f:"bin",token:esri.id.credentials[0].token,useData:JSON.stringify({sourceCountry:a.sourceCountry}),studyAreas:JSON.stringify(a.studyAreas),
reportFields:JSON.stringify({locationname:a.locationName,latitude:a.lat,longitude:a.long,subtitle:"Prepared by Esri",areadesc2:a.areadesc2})};return d.getPortal(portalUrl).loadSelfInfo().then(function(c){return e({url:(c&&c.helperServices&&c.helperServices.geoenrichment&&c.helperServices.geoenrichment.url?c.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/createReport",content:b,handleAs:"blob"}).then(function(b){return g.saveAs(b,
a.reportDownloadName)}).otherwise(function(a){alert("Error: "+a)})})},hasGEPrivilege:function(){return d.getPortal(portalUrl).loadSelfInfo().then(function(a){var b=!1,c=!1;f.forEach(a&&a.user&&a.user.privileges,function(a){"premium:user:geoenrichment"==a?b=!0:"premium:user:networkanalysis"==a&&(c=!0)});return b&&c})}}});