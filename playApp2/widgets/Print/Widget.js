// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Print/Print":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/request esri/lang esri/arcgis/utils esri/SpatialReference dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom-style dojo/dom-construct dojo/dom-class dojo/promise/all dojo/Deferred jimu/portalUrlUtils dojo/text!./templates/Print.html dojo/text!./templates/PrintResult.html dojo/aspect dojo/query jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator jimu/dijit/Message jimu/utils jimu/SpatialReference/srUtils dojo/on dijit/popup dijit/form/ValidationTextBox dijit/form/Form dijit/form/Select dijit/form/NumberTextBox dijit/form/Button dijit/form/CheckBox dijit/ProgressBar dijit/form/DropDownButton dijit/TooltipDialog dijit/form/RadioButton dijit/form/SimpleTextarea esri/IdentityManager dojo/store/Memory".split(" "),
function(c,q,r,t,w,g,m,n,e,b,u,f,a,z,k,B,C,y,L,D,G,F,H,I,A,O,K,h,J,E,N,P,M){F=c([q,r,t],{widgetsInTemplate:!0,templateString:F,map:null,count:1,results:[],authorText:null,copyrightText:null,copyrightEditable:!0,defaultTitle:null,defaultFormat:null,defaultLayout:null,baseClass:"gis_PrintDijit",pdfIcon:require.toUrl("./widgets/Print/images/pdf.png"),imageIcon:require.toUrl("./widgets/Print/images/image.png"),printTaskURL:null,printTask:null,async:!1,_showSettings:!1,_currentTemplateInfo:null,postCreate:function(){this.inherited(arguments);
this.printTask=new w(this.printTaskURL,{async:this.async});this.printparams=new g;this.printparams.map=this.map;this.shelter=new K({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this.titleNode.set("value",this.defaultTitle);this.authorNode.set("value",this.defaultAuthor);this.copyrightNode.set("value",this.defaultCopyright);this.copyrightNode.set("readOnly",!this.copyrightEditable);E.loadResource().then(a.hitch(this,function(){var d;E.isValidWkid(this.map.spatialReference.wkid)?
(this.wkidInput.set("value",this.map.spatialReference.wkid),d=E.getSRLabel(this.map.spatialReference.wkid),this.wkidLabel.innerHTML=d,this.wkidLabel.title=d):(this.wkidInput.set("value",""),this.wkidLabel.innerHTML="",this.wkidLabel.title="");this.wkidInput.set("invalidMessage",this.nls.invalidWkid);this.wkidInput.validator=function(d){return!d||""===d.trim()||E.isValidWkid(+d)}}));var d=G.setHttpProtocol(this.printTaskURL),l=G.getNewPrintUrl(this.appConfig.portalUrl);this._isNewPrintUrl=d===l||/sharing\/tools\/newPrint$/.test(d);
d=A("input",this.printWidgetMapScale.domNode)[0];l=A("input",this.printWidgetMapExtent.domNode)[0];J.combineRadioCheckBoxWithLabel(d,this.printWidgetMapScaleLabel);J.combineRadioCheckBoxWithLabel(l,this.printWidgetMapExtentLabel);"MAP_ONLY"===this.defaultLayout?k.setStyle(this.titleTr,"display","none"):k.setStyle(this.titleTr,"display","");this._hasLabelLayer()?(k.setStyle(this.labelsFormDijit.domNode,"display",""),k.setStyle(this.labelsTitleNode,"display","")):(k.setStyle(this.labelsFormDijit.domNode,
"display","none"),k.setStyle(this.labelsTitleNode,"display","none"));O.getInstance(this.map,this.map.itemInfo).then(a.hitch(this,function(d){this.layerInfosObj=d;return L([this._getPrintTaskInfo(),this._getLayerTemplatesInfo()]).then(a.hitch(this,function(d){var l=d[0];(d=d[1])&&!d.error?(d=d&&d.results)&&0<d.length&&(z.some(d,a.hitch(this,function(d){return d&&"Output_JSON"===d.paramName?this.templateInfos=d.value:!1})),this.templateInfos&&0<this.templateInfos.length&&(this.templateNames=z.map(this.templateInfos,
function(d){return d.layoutTemplate}))):console.warn("Get Layout Templates Info Error",d&&d.error);!e.isDefined(l)||l&&l.error?this._handleError(l.error):this._handlePrintInfo(l)}))})).always(a.hitch(this,function(){this.shelter.hide()}));this.printTask._getPrintDefinition&&I.after(this.printTask,"_getPrintDefinition",a.hitch(this,"printDefInspector"),!1);this.printTask._createOperationalLayers&&(I.after(this.printTask,"_createOperationalLayers",a.hitch(this,"_fixInvalidSymbol")),I.after(this.printTask,
"_createOperationalLayers",a.hitch(this,"_excludeInvalidLegend")))},_onOutputSRChange:function(d){E.isValidWkid(+d)?(d=E.getSRLabel(+d),this.wkidLabel.innerHTML=d,this.wkidLabel.title=d):(this.wkidLabel.innerHTML="",this.wkidLabel.title="")},_hasLabelLayer:function(){return z.some(this.map.graphicsLayerIds,function(d){return(d=this.map.getLayer(d))&&"esri.layers.LabelLayer"===d.declaredClass},this)},_getPrintTaskInfo:function(){var d=new D;this._isNewPrintUrl?d.resolve({isGPPrint:!1}):n({url:this.printTaskURL,
content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4}).then(a.hitch(this,function(l){d.resolve({isGPPrint:!0,data:l})}),a.hitch(this,function(l){d.resolve({error:l})}));return d},_getLayerTemplatesInfo:function(){var d=new D,l=this.printTaskURL.split("/"),v=l.indexOf("GPServer");if(-1<v){var h=null,h=/Utilities\/PrintingTools\/GPServer/.test(this.printTaskURL)?l.slice(0,v+1).join("/")+"/"+encodeURIComponent("Get Layout Templates Info Task")+"/execute":l.slice(0,v+1).join("/")+
"/"+encodeURIComponent("Get Layout Templates Info")+"/execute";n({url:h,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4}).then(a.hitch(this,function(l){d.resolve(l)}),a.hitch(this,function(l){d.resolve({error:l})}))}else d.resolve(null);return d},_fixInvalidSymbol:function(d){z.forEach(d,function(d){"map_graphics"===d.id&&(d=a.getObject("featureCollection.layers",!1,d))&&0<d.length&&z.forEach(d,function(d){d&&d.featureSet&&"esriGeometryPoint"===d.featureSet.geometryType&&
z.forEach(d.featureSet.features,function(d){d&&d.symbol&&!d.symbol.style&&(d.symbol.style="esriSMSSquare")})})},this);return d},_excludeInvalidLegend:function(d){function l(d){return z.filter(d.subLayerIds,a.hitch(this,function(l){return(l=this.layerInfosObj.getLayerInfoById(d.id+"_"+l))&&l.getShowLegendOfWebmap()}))}if(this.printTask.allLayerslegend){for(var v=b.getLegendLayers({map:this.map,itemInfo:this.map.itemInfo}),v=z.map(v,function(d){return{id:d.layer.id}}),h=this.printTask.allLayerslegend,
A=[],e=0;e<h.length;e++){var k=h[e],f=this.map.getLayer(k.id),E=this.layerInfosObj.getLayerInfoById(k.id),J=f&&f.declaredClass&&"esri.layers.GraphicsLayer"!==f.declaredClass,f=!f.renderer||f.renderer&&!f.renderer.hasVisualVariables(),E=E&&E.getShowLegendOfWebmap();J&&f&&E&&(k.subLayerIds&&(k.subLayerIds=a.hitch(this,l,k)()),A.push(k))}z.forEach(v,a.hitch(this,function(d){var l=z.some(A,a.hitch(this,function(l){return l.id===d.id})),v=this.layerInfosObj.getLayerInfoById(d.id),v=v&&v.getShowLegendOfWebmap()&&
v.isShowInMap();!l&&v&&A.push(d)}));this.printTask.allLayerslegend=A}return d},printDefInspector:function(d){"force"===this.preserve.preserveScale&&(d.mapOptions.scale=this.preserve.forcedScale);return d},_handleError:function(d){console.log("print widget load error: ",d);new h({message:d.message||d})},onLayoutChange:function(d){var l=this.templateNames&&this.templateNames.indexOf(d);if(-1<l){k.empty(this.customTextElementsTable);d=this._currentTemplateInfo=this.templateInfos[l];if((l=a.getObject("layoutOptions.customTextElements",
!1,d))&&0<l.length){var v=[];z.forEach(l,a.hitch(this,function(d){for(var l in d)if(0>v.indexOf(l)){var a=this.customTextElementsTable.insertRow(-1);a.insertCell(-1).appendChild(k.toDom(l+": "));a.insertCell(-1).appendChild((new M({name:l,trim:!0,required:!1,value:d[l],style:"width:100%"})).domNode);v.push(l)}}))}a.getObject("layoutOptions.hasAuthorText",!1,d)?k.setStyle(this.authorTr,"display",""):k.setStyle(this.authorTr,"display","none");a.getObject("layoutOptions.hasCopyrightText",!1,d)?k.setStyle(this.copyrightTr,
"display",""):k.setStyle(this.copyrightTr,"display","none");a.getObject("layoutOptions.hasTitleText",!1,d)?k.setStyle(this.titleTr,"display",""):k.setStyle(this.titleTr,"display","none");a.getObject("layoutOptions.hasLegend",!1,d)?k.setStyle(this.legendTr,"display",""):k.setStyle(this.legendTr,"display","none")}else"MAP_ONLY"===d?(k.setStyle(this.authorTr,"display","none"),k.setStyle(this.copyrightTr,"display","none"),k.setStyle(this.titleTr,"display","none"),k.setStyle(this.legendTr,"display","none"),
this._currentTemplateInfo={layoutOptions:{hasTitleText:!1,hasCopyrightText:!1,hasAuthorText:!1,hasLegend:!1}}):(k.setStyle(this.authorTr,"display",""),k.setStyle(this.copyrightTr,"display",""),k.setStyle(this.titleTr,"display",""),k.setStyle(this.legendTr,"display",""),this._currentTemplateInfo={layoutOptions:{hasTitleText:!0,hasCopyrightText:!0,hasAuthorText:!0,hasLegend:!0}})},_getMapAttribution:function(){var d=this.map.attribution;return d&&d.domNode?k.getProp(d.domNode,"textContent"):""},closeSettings:function(){P.close(this.settingsDialog);
this._showSettings=!1},showSettings:function(d){d.preventDefault();d.stopPropagation();this._showSettings?(P.close(this.settingsDialog),this._showSettings=!1):(P.open({popup:this.settingsDialog,around:this.advancedButtonDijit}),this._showSettings=!0)},_handlePrintInfo:function(d){if(d.isGPPrint){d=d.data;B.set(this.layoutDijit.domNode.parentNode.parentNode,"display","");B.set(this.formatDijit.domNode.parentNode.parentNode,"display","");B.set(this.advancedButtonDijit,"display","");this.own(N(document.body,
"click",a.hitch(this,function(d){if(this._showSettings){d=d.target||d.srcElement;var l=this.settingsDialog.domNode;d===l||k.isDescendant(d,l)||(P.close(this.settingsDialog),this._showSettings=!1)}})));var l=z.filter(d.parameters,function(d){return"Layout_Template"===d.name});if(0===l.length)console.log('print service parameters name for templates must be "Layout_Template"');else{var v=z.map(l[0].choiceList,function(d){return{label:d,value:d}});v.sort(function(d,l){return d.label>l.label?1:l.label>
d.label?-1:0});0<v.length?(this.layoutDijit.addOption(v),this.defaultLayout?this.layoutDijit.set("value",this.defaultLayout):this.layoutDijit.set("value",l[0].defaultValue)):this.defaultLayout&&(this.layoutDijit.addOption([{label:this.defaultLayout,value:this.defaultLayout}]),this.layoutDijit.set("value",this.defaultLayout));d=z.filter(d.parameters,function(d){return"Format"===d.name});0===d.length?console.log('print service parameters name for format must be "Format"'):(l=z.map(d[0].choiceList,function(d){return{label:d,
value:d}}),l.sort(function(d,l){return d.label>l.label?1:l.label>d.label?-1:0}),0<l.length?(this.formatDijit.addOption(l),this.defaultFormat?this.formatDijit.set("value",this.defaultFormat):this.formatDijit.set("value",d[0].defaultValue)):this.defaultFormat&&(this.formatDijit.addOption([{label:this.defaultFormat,value:this.defaultFormat}]),this.formatDijit.set("value",this.defaultFormat)))}}else B.set(this.layoutDijit.domNode.parentNode.parentNode,"display","none"),B.set(this.formatDijit.domNode.parentNode.parentNode,
"display","none"),B.set(this.advancedButtonDijit,"display","none")},print:function(){if(this.printSettingsFormDijit.isValid()){var d=this.printSettingsFormDijit.get("value");a.mixin(d,this.layoutMetadataDijit.get("value"));a.mixin(d,this.forceAttributesFormDijit.get("value"));a.mixin(d,this.labelsFormDijit.get("value"));this.preserve=this.preserveFormDijit.get("value");a.mixin(d,this.preserve);this.layoutForm=this.layoutFormDijit.get("value");var l=this.mapQualityFormDijit.get("value"),h=this.mapOnlyFormDijit.get("value");
a.mixin(h,l);var b=this.customTextElementsDijit.get("value"),l=[],A=!1,e=f.locale||"en",k;for(k in b){var J={};"Date"===k&&(A=!0);J[k]=b[k];l.push(J)}A||l.push({Date:(new Date).toLocaleString(e)});A=this._currentTemplateInfo;k=a.getObject("layoutOptions.hasAuthorText",!1,A);b=a.getObject("layoutOptions.hasCopyrightText",!1,A);A=a.getObject("layoutOptions.hasTitleText",!1,A);e=new m;e.format=d.format;e.layout=d.layout;e.preserveScale="true"===d.preserveScale||"force"===d.preserveScale;e.forceFeatureAttributes=
d.forceFeatureAttributes&&d.forceFeatureAttributes[0];e.label=d.title;e.exportOptions=h;e.showLabels=d.showLabels&&d.showLabels[0];e.layoutOptions={authorText:k?d.author:"",copyrightText:b?d.copyright||this._getMapAttribution():"",legendLayers:this._getLegendLayers(),titleText:A?d.title:"",customTextElements:l,scalebarUnit:this.layoutForm.scalebarUnit};this.printparams.template=e;this.printparams.extraParameters={printFlag:!0};this.printparams.outSpatialReference=void 0;h=+this.wkidInput.get("value");
E.isValidWkid(h)&&h!==this.map.spatialReference.wkid&&(this.printparams.outSpatialReference=new u(h));h=this.printTask.execute(this.printparams);(new v({count:this.count.toString(),icon:"PDF"===d.format?this.pdfIcon:this.imageIcon,docName:d.title,title:d.title+", "+d.format+", "+d.layout,fileHandle:h,nls:this.nls})).placeAt(this.printResultsNode,"last").startup();B.set(this.clearActionBarNode,"display","block");this.count++}else this.printSettingsFormDijit.validate()},_getLegendLayers:function(){var d=
a.getObject("layoutOptions.hasLegend",!1,this._currentTemplateInfo),l=0<this.layoutForm.legend.length&&this.layoutForm.legend[0];if(this.printTask&&!this.printTask._createOperationalLayers){var v=[];d&&l&&(d=b.getLegendLayers({map:this.map,itemInfo:this.map.itemInfo}),v=z.map(d,function(d){return{layerId:d.layer.id}}));return v}return d&&l?null:[]},clearResults:function(){C.empty(this.printResultsNode);B.set(this.clearActionBarNode,"display","none");this.count=1},updateAuthor:function(d){(d=d||"")&&
this.authorTB&&this.authorTB.set("value",d)},getCurrentMapScale:function(){this.forceScaleNTB.set("value",this.map.getScale())}});var v=c([q,r,t],{widgetsInTemplate:!0,templateString:H,url:null,postCreate:function(){this.inherited(arguments);this.progressBar.set("label",this.nls.creatingPrint);this.fileHandle.then(a.hitch(this,"_onPrintComplete"),a.hitch(this,"_onPrintError"))},_onPrintComplete:function(d){d.url?(this.url=d.url,k.setStyle(this.progressBar.domNode,"display","none"),k.setStyle(this.successNode,
"display","inline-block"),y.add(this.resultNode,"printResultHover")):this._onPrintError(this.nls.printError)},_onPrintError:function(d){console.log(d);k.setStyle(this.progressBar.domNode,"display","none");k.setStyle(this.errNode,"display","block");y.add(this.resultNode,"printResultError");k.setAttr(this.domNode,"title",d.details||d.message||"")},_openPrint:function(){null!==this.url&&window.open(this.url)}});return F})},"esri/tasks/PrintTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../lang ../layerUtils ../deferredUtils ../Color ../request ../urlUtils ../geometry/Polygon ../renderers/SimpleRenderer ../symbols/FillSymbol ./Geoprocessor ./PrintTemplate ./Task dojo/dom-attr dojo/dom-construct dojox/gfx/_base dojox/gfx/canvas dojox/json/query dojo/has!extend-esri?./PrintParameters dojo/has!extend-esri?./LegendLayer".split(" "),
function(c,q,r,t,w,g,m,n,e,b,u,f,a,z,k,B,C,y,L,D,G,F,H,I){c=c(L,{declaredClass:"esri.tasks.PrintTask",constructor:function(a,e){this.url=a;this.printGp=new C(this.url);this._handler=q.hitch(this,this._handler);e&&e.async&&(this.async=!0);this._colorEvaluator=I("$..color")},async:!1,_vtlExtent:null,_cimVersion:null,_is11xService:!1,_loadGpServerMetadata:!0,execute:function(a,e,k){if(!this._loadGpServerMetadata)return this._execute(a,e,k);var h=new w(b._dfdCanceller),A=this._url.path,E=A.lastIndexOf("/GPServer/");
0<E&&(A=A.slice(0,E+9));h._pendingDfd=f({url:A,callbackParamName:"callback",content:q.mixin({},this._url.query,{f:"json"})}).then(q.hitch(this,function(e){this._loadGpServerMetadata=!1;this.async="esriExecutionTypeAsynchronous"===e.executionType;this._cimVersion=e.cimVersion;this._is11xService=!!this._cimVersion;h._pendingDfd=this._execute(a);return h._pendingDfd})).then(q.hitch(this,function(a){this._successHandler([a],null,e,h)})).otherwise(function(a){k&&k(a);h.errback(a)});return h},_handler:function(a,
e,b,h,k){try{var A;this.async?"esriJobSucceeded"===a.jobStatus?this.printGp.getResultData(a.jobId,"Output_File",q.hitch(this,function(a){A=a.value;this._successHandler([A],"onComplete",b,k)})):this._errorHandler(Error(a.jobStatus),h,k):(A=a[0].value,this._successHandler([A],"onComplete",b,k))}catch(N){this._errorHandler(N,h,k)}},_execute:function(a,e,k){var h=this._handler,A=this._errorHandler,f=a.template||new y;f.hasOwnProperty("showLabels")||(f.showLabels=!0);var m=f.exportOptions,c;m&&(c={outputSize:[m.width,
m.height],dpi:m.dpi});var m=f.layoutOptions,g,v=[];if(m){this.legendAll=!1;m.legendLayers?r.forEach(m.legendLayers,function(d){var l={};l.id=d.layerId;d.subLayerIds&&(l.subLayerIds=d.subLayerIds);v.push(l)}):this.legendAll=!0;var d,l;if("Miles"===m.scalebarUnit||"Kilometers"===m.scalebarUnit)d="esriKilometers",l="esriMiles";else if("Meters"===m.scalebarUnit||"Feet"===m.scalebarUnit)d="esriMeters",l="esriFeet";g={esriMiles:"mi",esriKilometers:"km",esriFeet:"ft",esriMeters:"m"};g={titleText:m.titleText,
authorText:m.authorText,copyrightText:m.copyrightText,customTextElements:m.customTextElements,scaleBarOptions:{metricUnit:d,metricLabel:g[d],nonMetricUnit:l,nonMetricLabel:g[l]},legendOptions:{operationalLayers:v}}}d=this._getPrintDefinition(a.map,f);a.outSpatialReference&&(d.mapOptions.spatialReference=a.outSpatialReference.toJson());a.template&&n.isDefined(a.template.showAttribution)&&(d.mapOptions.showAttribution=a.template.showAttribution);q.mixin(d,{exportOptions:c,layoutOptions:g});this.allLayerslegend&&
q.mixin(d.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}});if(d.operationalLayers){c=d.operationalLayers;var x,u=function(d){return n.fixJson(q.mixin(d,{type:"esriSLS",cap:void 0,join:void 0,meterLimit:void 0}))},z=/[\u4E00-\u9FFF\u0E00-\u0E7F\u0900-\u097F\u3040-\u309F\u30A0-\u30FF\u31F0-\u31FF]/,O=/[\u0600-\u06FF]/,B=function(d){var l=d.text,a=(d=d.font)&&d.family&&d.family.toLowerCase();l&&d&&("arial"===a||"arial unicode ms"===a)&&(d.family=z.test(l)?"Arial Unicode MS":"Arial",
"normal"!==d.style&&O.test(l)&&(d.family="Arial Unicode MS"))};for(g=0;g<c.length;g++)if(c[g].featureCollection&&c[g].featureCollection.layers)for(l=0;l<c[g].featureCollection.layers.length;l++){var K=c[g].featureCollection.layers[l];K.layerDefinition&&K.layerDefinition.drawingInfo&&K.layerDefinition.drawingInfo.renderer&&K.layerDefinition.drawingInfo.renderer.symbol&&(x=K.layerDefinition.drawingInfo.renderer,"esriCLS"===x.symbol.type?x.symbol=u(x.symbol):"esriTS"===x.symbol.type?B(x.symbol):x.symbol.outline&&
"esriCLS"===x.symbol.outline.type&&(x.symbol.outline=u(x.symbol.outline)));if(K.featureSet&&K.featureSet.features)for(m=0;m<K.featureSet.features.length;m++)x=K.featureSet.features[m],x.symbol&&("esriCLS"===x.symbol.type?x.symbol=u(x.symbol):"esriTS"===x.symbol.type?B(x.symbol):x.symbol.outline&&"esriCLS"===x.symbol.outline.type&&(x.symbol.outline=u(x.symbol.outline)))}}f={Web_Map_as_JSON:t.toJson(n.fixJson(d)),Format:f.format,Layout_Template:f.layout};a.extraParameters&&(f=q.mixin(f,a.extraParameters));
var I=new w(b._dfdCanceller);a=function(d,l){h(d,l,e,k,I)};d=function(d){A(d,k,I)};I._pendingDfd=this.async?this.printGp.submitJob(f,a,null,d):this.printGp.execute(f,a,d);return I},onComplete:function(){},_createMultipointLayer:function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}},_createPolygonLayer:function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",
drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}},_createPointLayer:function(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},_createPolylineLayer:function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},_convertSvgSymbol:function(a){if(!(8>=
g("ie")||!a.path&&"image/svg+xml"!==a.contentType)){var e,b=H.createSurface(G.create("div"),1024,1024);e="image/svg+xml"===a.contentType?b.createObject(H.Image,{src:"data:image/svg+xml;base64,"+a.imageData,width:F.pt2px(a.width),height:F.pt2px(a.height),x:0,y:0}):b.createObject(H.Path,a.path).setFill(a.color).setStroke(a.outline);"pendingRender"in b&&b._render(!0);var h=b.rawNode.getContext("2d"),k=Math.ceil(e.getBoundingBox().width),f=Math.ceil(e.getBoundingBox().height);e=h.getImageData(e.getBoundingBox().x,
e.getBoundingBox().y,k,f);h.canvas.width=k;h.canvas.height=f;h.putImageData(e,0,0);h=h.canvas.toDataURL("image/png");a={type:"esriPMS",imageData:h.substr(22,h.length),angle:a.angle,contentType:"image/png",height:a.size?a.size:F.px2pt(f),width:a.size?k/f*a.size:F.px2pt(k),xoffset:a.xoffset,yoffset:a.yoffset};b.destroy();return a}},_convertSvgRenderer:function(a){"simple"===a.type&&a.symbol&&(a.symbol.path||"image/svg+xml"===a.symbol.contentType)?a.symbol=this._convertSvgSymbol(a.symbol):"uniqueValue"===
a.type?(a.defaultSymbol&&(a.defaultSymbol.path||"image/svg+xml"===a.defaultSymbol.contentType)&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),a.uniqueValueInfos&&r.forEach(a.uniqueValueInfos,function(a){if(a.symbol.path||"image/svg+xml"===a.symbol.contentType)a.symbol=this._convertSvgSymbol(a.symbol)},this)):"classBreaks"===a.type&&(a.defaultSymbol&&(a.defaultSymbol.path||"image/svg+xml"===a.defaultSymbol.contentType)&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),a.classBreakInfos&&
r.forEach(a.classBreakInfos,function(a){if(a.symbol.path||"image/svg+xml"===a.symbol.contentType)a.symbol=this._convertSvgSymbol(a.symbol)},this))},_createFeatureCollection:function(a,e,b,h){var k=this._createPolygonLayer(),f=this._createPolylineLayer(),m=this._createPointLayer(),n=this._createMultipointLayer(),g=this._createPointLayer();g.layerDefinition.name="textLayer";delete g.layerDefinition.drawingInfo;if("esri.layers.FeatureLayer"===a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass)k.layerDefinition.name=
f.layerDefinition.name=m.layerDefinition.name=n.layerDefinition.name=q.getObject("arcgisProps.title",!1,a)||a.name||a.id;var v=a.renderer&&"esri.renderer.SimpleRenderer"===a.renderer.declaredClass;if(!a.renderer||a.renderer.valueExpression||q.isFunction(a.renderer.attributeField))delete k.layerDefinition.drawingInfo,delete f.layerDefinition.drawingInfo,delete m.layerDefinition.drawingInfo,delete n.layerDefinition.drawingInfo;else{var d=a.renderer.toJson({useLegacyRotationProperties:!0});if("temporal"===
d.type){var d={latestObservationRenderer:d.latestObservationRenderer,trackLinesRenderer:d.trackRenderer,observationAger:d.observationAger,renderer:d.observationRenderer},l={};a._trackIdField&&(l.trackIdField=a._trackIdField);a._startTimeField&&(l.startTimeField=a._startTimeField);a._endTimeField&&(l.endTimeField=a._endTimeField);k.layerDefinition.drawingInfo=d;k.layerDefinition.timeInfo=l;f.layerDefinition.drawingInfo=d;f.layerDefinition.timeInfo=l;m.layerDefinition.drawingInfo=d;m.layerDefinition.timeInfo=
l;n.layerDefinition.drawingInfo=d;n.layerDefinition.timeInfo=l}else k.layerDefinition.drawingInfo.renderer=d,f.layerDefinition.drawingInfo.renderer=d,m.layerDefinition.drawingInfo.renderer=d,n.layerDefinition.drawingInfo.renderer=d}d=a.fields;d||!a.renderer||a.renderer.valueExpression||q.isFunction(a.renderer.attributeField)||("esri.renderer.ClassBreaksRenderer"===a.renderer.declaredClass?(d=[{name:a.renderer.attributeField,type:"esriFieldTypeDouble"}],a.renderer.normalizationField&&d.push({name:a.renderer.normalizationField,
type:"esriFieldTypeDouble"})):"esri.renderer.UniqueValueRenderer"===a.renderer.declaredClass&&(d=[{name:a.renderer.attributeField,type:"esriFieldTypeString"}],a.renderer.attributeField2&&d.push({name:a.renderer.attributeField2,type:"esriFieldTypeString"}),a.renderer.attributeField3&&d.push({name:a.renderer.attributeField3,type:"esriFieldTypeString"})));d&&(k.layerDefinition.fields=d,f.layerDefinition.fields=d,m.layerDefinition.fields=d,n.layerDefinition.fields=d);d=a.graphics;a.isFeatureReductionActive&&
a.isFeatureReductionActive()&&(d=a.getSingleGraphics());var l=d.length,x,c;for(c=0;c<l;c++){var u=d[c];if(!1!==u.visible&&u.geometry){x=u.toJson();x.symbol&&x.symbol.outline&&x.symbol.outline.color&&x.symbol.outline.color[3]&&!this._is11xService&&(x.symbol.outline.color[3]=255);if(a.renderer&&!x.symbol&&(q.isFunction(a.renderer.attributeField)||a.renderer.valueExpression||this._isFeatureCollectionRequired(a.renderer,a)||"esri.renderer.DotDensityRenderer"===a.renderer.declaredClass||b)){b=b||a.renderer;
var A=null;try{A=b.getSymbol(u)}catch(Q){}if(!A)continue;x.symbol=A.toJson();this._isFeatureCollectionRequired(b,a)&&this._applyVisualVariables(x.symbol,{renderer:b,graphic:u,symbol:A,mapResolution:e&&e.getResolutionInMeters(),mapScale:e&&e.getScale()})}x.symbol&&(x.symbol.path||"image/svg+xml"===x.symbol.contentType?x.symbol=this._convertSvgSymbol(x.symbol):x.symbol.text&&delete x.attributes);switch(u.geometry.type){case "polygon":k.featureSet.features.push(x);break;case "polyline":f.featureSet.features.push(x);
break;case "point":x.symbol&&x.symbol.text?g.featureSet.features.push(x):m.featureSet.features.push(x);break;case "multipoint":n.featureSet.features.push(x);break;case "extent":x.geometry=z.fromExtent(u.geometry).toJson(),k.featureSet.features.push(x)}}}e=[];0<k.featureSet.features.length&&e.push(k);0<f.featureSet.features.length&&e.push(f);0<n.featureSet.features.length&&e.push(n);0<m.featureSet.features.length&&e.push(m);0<g.featureSet.features.length&&e.push(g);if(!e.length)return null;r.forEach(e,
function(d){var a=r.every(d.featureSet.features,function(d){return d.symbol});if(v||a)h&&h.forceFeatureAttributes||r.forEach(d.featureSet.features,function(d){delete d.attributes}),h.forceFeatureAttributes||delete d.layerDefinition.fields;a&&delete d.layerDefinition.drawingInfo});r.forEach(e,function(d){d.layerDefinition.drawingInfo&&d.layerDefinition.drawingInfo.renderer&&this._convertSvgRenderer(d.layerDefinition.drawingInfo.renderer)},this);return{id:a.id,opacity:a.opacity,minScale:a.minScale||
0,maxScale:a.maxScale||0,featureCollection:{layers:e}}},_getPrintDefinition:function(a,e){var k={operationalLayers:this._createOperationalLayers(a,e)},h=this._vtlExtent||a.extent,b=a.spatialReference;this._vtlExtent=null;a.spatialReference._isWrappable()&&(h=h._normalize(!0),b=h.spatialReference);h={mapOptions:{showAttribution:a.showAttribution,extent:h.toJson(),spatialReference:b.toJson()}};e.preserveScale&&q.mixin(h.mapOptions,{scale:e.outScale||a.getScale()});a.timeExtent&&q.mixin(h.mapOptions,
{time:[a.timeExtent.startTime.getTime(),a.timeExtent.endTime.getTime()]});a={};q.mixin(a,h,k);return a},_createOperationalLayers:function(b,f){var n,h,g,c,u=[],z=0;f.preserveScale&&(z=f.outScale||b.getScale());this.allLayerslegend=this.legendAll?[]:null;this._vtlExtent=null;var A=r.map(b.layerIds,b.getLayer,b);b._mapImageLyr&&A.push(b._mapImageLyr);for(n=0;n<A.length;n++)if(h=A[n],h.loaded&&h.visible&&(!z||h.isVisibleAtScale(z)))switch(g=h.declaredClass,c={id:h.id,title:q.getObject("arcgisProps.title",
!1,h)||h.id,opacity:h.opacity,minScale:h.minScale||0,maxScale:h.maxScale||0},c=q.mixin(c,this._getUrlAndToken(h)),h.getNode()&&D.get(h.getNode(),"data-reference")&&(c._isRefLayer=!0),g){case "esri.layers.ArcGISDynamicMapServiceLayer":var v=[];g=!!h._params.layers;if(h._params.dynamicLayers)g=f.outScale?h._getDynLayerObjs(f.outScale):t.fromJson(h._params.dynamicLayers),r.forEach(g,function(d){v.push({id:d.id,name:d.name,layerDefinition:d});delete d.id;delete d.name;delete d.maxScale;delete d.minScale}),
0===v.length&&(c.visibleLayers=[-1]);else if(h.supportsDynamicLayers){if(g||h.layerDefinitions||h.layerTimeOptions){var d=h.createDynamicLayerInfosFromLayerInfos(),l=null;g&&(l=h.visibleLayers);var l=e._getVisibleLayers(d,l),x=e._getLayersForScale(f.outScale||b.getScale(),d);r.forEach(d,function(d){if(!d.subLayerIds){var a=d.id;-1<r.indexOf(l,a)&&-1<r.indexOf(x,a)&&(d={source:d.source.toJson()},h.layerDefinitions&&h.layerDefinitions[a]&&(d.definitionExpression=h.layerDefinitions[a]),h.layerTimeOptions&&
h.layerTimeOptions[a]&&(d.layerTimeOptions=h.layerTimeOptions[a].toJson()),v.push({id:a,layerDefinition:d}))}});0===v.length&&(c.visibleLayers=[-1])}}else r.forEach(h.layerInfos,function(d){var a={id:d.id,layerDefinition:{}};h.layerDefinitions&&h.layerDefinitions[d.id]&&(a.layerDefinition.definitionExpression=h.layerDefinitions[d.id]);h.layerTimeOptions&&h.layerTimeOptions[d.id]&&(a.layerDefinition.layerTimeOptions=h.layerTimeOptions[d.id].toJson());(a.layerDefinition.definitionExpression||a.layerDefinition.layerTimeOptions)&&
v.push(a)}),g&&(c.visibleLayers=h.visibleLayers.length?h.visibleLayers:[-1]);v.length&&(c.layers=v);u.push(c);this.allLayerslegend&&this.allLayerslegend.push({id:h.id,subLayerIds:h.visibleLayers});break;case "esri.layers.ArcGISImageServiceLayer":c=q.mixin(c,{url:h.url,bandIds:h.bandIds,compressionQuality:h.compressionQuality,format:h.format,interpolation:h.interpolation});h.mosaicRule&&q.mixin(c,{mosaicRule:h.mosaicRule.toJson()});if(h.renderingRule||h.renderer)this._is11xService?(h.renderingRule&&
(c.renderingRule=h.renderingRule.toJson()),h.renderer&&(c.layerDefinition=c.layerDefinition||{},c.layerDefinition.drawingInfo=c.layerDefinition.drawingInfo||{},c.layerDefinition.drawingInfo.renderer=h.renderer.toJson())):(g=h.getExportImageRenderingRule())&&q.mixin(c,{renderingRule:g.toJson()});u.push(c);this.allLayerslegend&&this.allLayerslegend.push({id:h.id});break;case "esri.layers.WMSLayer":c=q.mixin(c,{url:h.url,title:h.title,type:"wms",version:h.version,transparentBackground:h.imageTransparency,
visibleLayers:h.visibleLayers});u.push(c);this.allLayerslegend&&this.allLayerslegend.push({id:h.id,subLayerIds:h.visibleLayers});break;case "esri.virtualearth.VETiledLayer":g=h.mapStyle;"roadOnDemand"===g?g="Road":"aerialWithLabelsOnDemand"===g&&(g="Hybrid");c=q.mixin(c,{visibility:h.visible,type:"BingMaps"+g,culture:h.culture,key:h.bingMapsKey});u.push(c);break;case "esri.layers.OpenStreetMapLayer":c=q.mixin(c,{credits:h.copyright,type:"OpenStreetMap",url:a.getAbsoluteUrl(h.tileServers[0])});u.push(c);
break;case "esri.layers.WMTSLayer":c=q.mixin(c,{url:h.url,type:"wmts",layer:h._identifier,style:h._style,format:h.format,tileMatrixSet:h._tileMatrixSetId});u.push(c);break;case "esri.layers.MapImageLayer":g=h.getImages();r.forEach(g,function(d,a){d.visible&&d.href&&(c={id:h.id+"_image"+a,type:"image",title:h.id,minScale:h.minScale||0,maxScale:h.maxScale||0,opacity:h.opacity*d.opacity,extent:d.extent.toJson()},"data:image/png;base64,"===d.href.substr(0,22)?c.imageData=d.href.substr(22):c.url=d.href,
u.push(c))});break;case "esri.layers.VectorTileLayer":delete c.url;delete c.token;if(this._is11xService&&h.currentStyleInfo.serviceUrl&&h.currentStyleInfo.styleUrl&&(g=m.id&&m.id.findCredential(h.currentStyleInfo.styleUrl),d=m.id&&m.id.findCredential(h.currentStyleInfo.serviceUrl),!g&&!d||"2.1.0"!==this._cimVersion)){c.type="VectorTileLayer";c.styleUrl=h.currentStyleInfo.styleUrl;g&&(c.token=g.token);d&&d.token!==c.token&&(c.additionalTokens=[{url:h.currentStyleInfo.serviceUrl,token:d.token}]);u.push(c);
break}c.type="image";g=this._vtlExtent||b.extent.offset(0,0);var B=f.exportOptions&&f.exportOptions.dpi||96,d={format:"png",pixelRatio:B/96};"MAP_ONLY"!==f.layout||!f.preserveScale||f.outScale&&f.outScale!==b.getScale()||96!==B||!f.exportOptions||f.exportOptions.width%2===b.width%2&&f.exportOptions.height%2===b.height%2||(d.area={x:0,y:0,width:b.width,height:b.height},f.exportOptions.width%2!==b.width%2&&--d.area.width,f.exportOptions.height%2!==b.height%2&&--d.area.height,this._vtlExtent||(B=b.toMap({x:d.area.width,
y:d.area.height}),g.update(g.xmin,B.y,B.x,g.ymax,g.spatialReference),this._vtlExtent=g));c.extent=g._normalize(!0).toJson();g=h.takeScreenshot(d);g.isResolved()?g.then(function(d){"data:image/png;base64,"===d.dataURL.substr(0,22)&&(c.imageData=d.dataURL.substr(22))}):console.error("PrintTask: VectorTileLayer.takeScreenshot() returned an unresolved Promise");c.imageData&&u.push(c);break;case "esri.layers.WebTiledLayer":g=h.url.replace(/\$\{/g,"{");c=q.mixin(c,{type:"WebTiledLayer",urlTemplate:g,credits:h.copyright});
h.subDomains&&0<h.subDomains.length&&(c.subDomains=h.subDomains);h._wmtsInfo&&(c.wmtsInfo=h._wmtsInfo);delete c.url;u.push(c);break;default:if(h.getTileUrl||h.getImageUrl)c=q.mixin(c,{url:h.url}),u.push(c)}A=r.map(b.graphicsLayerIds,b.getLayer,b);for(n=0;n<A.length;n++)h=A[n],h.isFeatureReductionActive&&h.isFeatureReductionActive()&&(h.getSingleGraphics().length?A.splice(++n,0,h.getFeatureReductionLayer()):A[n]=h.getFeatureReductionLayer());for(n=0;n<A.length;n++)if(h=A[n],h.loaded&&h.visible&&(!z||
h.isVisibleAtScale(z)))switch(g=h.declaredClass,g){case "esri.layers.CSVLayer":if(this._is11xService){c={id:h.id,url:h.url,title:h.title,opacity:h.opacity,minScale:h.minScale||0,maxScale:h.maxScale||0,type:"CSV",locationInfo:{latitudeFieldName:h.latitudeFieldName,longitudeFieldName:h.longitudeFieldName},layerDefinition:{drawingInfo:{renderer:h.renderer&&h.renderer.toJson({useLegacyRotationProperties:!0})}}};u.push(c);break}case "esri.layers.FeatureLayer":case "esri.layers.LabelLayer":case "esri.layers.StreamLayer":if("esri.layers.LabelLayer"===
g&&!f.showLabels||h.renderer&&"esri.renderer.HeatmapRenderer"===h.renderer.declaredClass)continue;g=null;h.url&&h.renderer&&("esri.renderer.ScaleDependentRenderer"===h.renderer.declaredClass?"scale"===h.renderer.rangeType?g=h.renderer.getRendererInfoByScale(b.getScale())&&h.renderer.getRendererInfoByScale(b.getScale()).renderer:"zoom"===h.renderer.rangeType&&(g=h.renderer.getRendererInfoByZoom(b.getZoom())&&h.renderer.getRendererInfoByZoom(b.getZoom()).renderer):g=h.renderer);d=g&&"esri.layers.CSVLayer"!==
h.declaredClass&&!this._isFeatureCollectionRequired(g,h)&&!g.valueExpression;B=h.isFeatureReductionActive&&h.isFeatureReductionActive();if(g&&!B&&"esri.renderer.DotDensityRenderer"!==g.declaredClass&&"esri.layers.StreamLayer"!==h.declaredClass&&(this._is11xService||d)&&("esri.renderer.SimpleRenderer"===g.declaredClass||"esri.renderer.TemporalRenderer"===g.declaredClass||null==g.attributeField||q.isString(g.attributeField)&&h._getField(g.attributeField,!0)))if(c={id:h.id,title:q.getObject("arcgisProps.title",
!1,h)||h.id,opacity:h.opacity,minScale:h.minScale||0,maxScale:h.maxScale||0,layerDefinition:{drawingInfo:{renderer:g.toJson({useLegacyRotationProperties:!0})}}},c=q.mixin(c,this._getUrlAndToken(h)),"esri.renderer.TemporalRenderer"===g.declaredClass&&(d=c.layerDefinition.drawingInfo,d.latestObservationRenderer=d.renderer.latestObservationRenderer,d.trackLinesRenderer=d.renderer.trackRenderer,d.observationAger=d.renderer.observationAger,d.renderer=d.renderer.observationRenderer,h._trackIdField&&(c.layerDefinition.timeInfo=
{trackIdField:h._trackIdField})),this._convertSvgRenderer(c.layerDefinition.drawingInfo.renderer),this._is11xService||1>h.opacity||"esri.renderer.TemporalRenderer"===g.declaredClass||this._updateLayerOpacity(c))if(h._params.source&&(g=h._params.source.toJson(),q.mixin(c.layerDefinition,{source:g})),h.getDefinitionExpression()&&q.mixin(c.layerDefinition,{definitionExpression:h.getDefinitionExpression()}),2!==h.mode)0<h.getSelectedFeatures().length&&(g=r.map(h.getSelectedFeatures(),function(d){return d.attributes[h.objectIdField]}),
0<g.length&&h.getSelectionSymbol()&&q.mixin(c,{selectionObjectIds:g,selectionSymbol:h.getSelectionSymbol().toJson()}));else{g=r.map(h.getSelectedFeatures(),function(d){return d.attributes[h.objectIdField]});if(0===g.length||!h._params.drawMode)break;q.mixin(c.layerDefinition,{objectIds:g});g=null;h.getSelectionSymbol()&&(g=new k(h.getSelectionSymbol()));q.mixin(c.layerDefinition.drawingInfo,{renderer:g&&g.toJson()})}else c=this._createFeatureCollection(h,b,null,f);else c=g&&(g.valueExpression||this._isFeatureCollectionRequired(g,
h)||"esri.renderer.DotDensityRenderer"===g.declaredClass)?this._createFeatureCollection(h,b,g,f):this._createFeatureCollection(h,b,null,f);if(!c)continue;u.push(c);this.allLayerslegend&&this.allLayerslegend.push({id:h.id});break;case "esri.layers._GraphicsLayer":case "esri.layers.GraphicsLayer":case "esri.layers.WFSLayer":c=this._createFeatureCollection(h,b,null,f);if(!c)continue;u.push(c);this.allLayerslegend&&this.allLayerslegend.push({id:h.id});break;case "esri.layers.ArcGISImageServiceVectorLayer":c=
{id:h.id,title:q.getObject("arcgisProps.title",!1,h)||h.id,opacity:h.opacity,minScale:h.minScale||0,maxScale:h.maxScale||0,visibility:h.visible,symbolTileSize:h.symbolTileSize,layerDefinition:{drawingInfo:{renderer:h.renderer.toJson({useLegacyRotationProperties:!0})}}},c=q.mixin(c,this._getUrlAndToken(h)),h.mosaicRule&&q.mixin(c,{mosaicRule:h.mosaicRule.toJson()}),u.push(c),this.allLayerslegend&&this.allLayerslegend.push({id:h.id})}z&&r.forEach(u,function(d){d.minScale=0;d.maxScale=0});b.graphics&&
0<b.graphics.graphics.length&&(c=this._createFeatureCollection(b.graphics,b,null,f))&&u.push(c);b._labels&&f.showLabels&&(c=this._createFeatureCollection(b._labels,b,null,f))&&u.push(c);r.forEach(u,function(d,a,l){d._isRefLayer&&(delete d._isRefLayer,l.splice(a,1),l.push(d))});return u},_getUrlAndToken:function(a){return{token:a._getToken(),url:a._url?a._url.path:null}},_updateLayerOpacity:function(a){var b=this._colorEvaluator(a),b=r.filter(b,function(a){return q.isArray(a)&&4===a.length}),e=!0;
if(b.length){var h=b[0][3],k;for(k=1;k<b.length;k++)if(h!==b[k][3]){e=!1;break}if(e)for(a.opacity=h/255,k=0;k<b.length;k++)b[k][3]=255}return e},_isFeatureCollectionRequired:function(a,b){if(b&&b.isFeatureReductionActive&&b.isFeatureReductionActive())return!0;var e=!1;if(b=this._getVariable(a,"rotationInfo",!1))e=(e=b.field)&&q.isFunction(e)||b.valueExpression;return a.hasVisualVariables("sizeInfo")||a.hasVisualVariables("colorInfo")||a.hasVisualVariables("opacityInfo")||e},_getVariable:function(a,
b,e){var h;a&&(h=(a=a.getVisualVariablesForType(b,e))&&a[0]);return h},_applyVisualVariables:function(a,b){var e=b.renderer,h=b.graphic,k=b.symbol,f=b.mapResolution,c=b.mapScale,g=k.type;if("textsymbol"!==g&&"shieldlabelsymbol"!==g){var m=this._getVariable(e,"sizeInfo",!1),v=this._getVariable(e,"colorInfo",!1),d=this._getVariable(e,"opacityInfo",!1);b=this._getVariable(e,"rotationInfo",!1);k instanceof B&&(m=this._getVariable(e,"sizeInfo","outline")||m);f=m?e.getSize(h,{sizeInfo:m,shape:"simplemarkersymbol"===
g?k.style:null,resolution:f,scale:c}):h.size;null!=f&&("simplemarkersymbol"===g?a.size=F.px2pt(f):"picturemarkersymbol"===g?(c=k.width/k.height*f,a.width=F.px2pt(c),a.height=F.px2pt(f),0!==k.xoffset&&(a.xoffset=F.px2pt(k.xoffset/k.width*c)),0!==k.yoffset&&(a.yoffset=F.px2pt(k.yoffset/k.height*f))):"simplelinesymbol"===g?a.width=F.px2pt(f):a.outline&&(a.outline.width=F.px2pt(f)));v&&(!(k=e.getColor(h,{colorInfo:v}))||"simplemarkersymbol"!==g&&"simplelinesymbol"!==g&&"simplefillsymbol"!==g||(a.color=
u.toJsonColor(k)));d&&(k=e.getOpacity(h,{opacityInfo:d}),null!=k&&a.color&&(a.color[3]=Math.round(255*k)));b&&(e=e.getRotationAngle(h,{rotationInfo:b}))&&(a.angle=-e)}}});g("extend-esri")&&q.setObject("tasks.PrintTask",c,m);return c})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(c,q,r,t,w,g,m,n,e,b,u,f,a,z,k,B,C,y,L,D,G,F,H){c=c(f,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(a){this._jobUpdateHandler=q.hitch(this,this._jobUpdateHandler);this._getJobStatus=q.hitch(this,this._getJobStatus);this._getResultDataHandler=
q.hitch(this,this._getResultDataHandler);this._getResultImageHandler=q.hitch(this,this._getResultImageHandler);this._executeHandler=q.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(a){this.updateDelay=a},setProcessSpatialReference:function(a){this.processSpatialReference=a},setOutputSpatialReference:function(a){this._setOutSR(a)},setOutSpatialReference:function(a){this._setOutSR(a)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(a){this.outSpatialReference=this.outputSpatialReference=a},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(a,b,e){for(var k in a){var h=a[k];q.isArray(h)?a[k]=w.toJson(r.map(h,function(a){return this._gpEncode({item:a},!0).item},this)):h instanceof Date&&(a[k]=h.getTime())}return this._encode(a,b,e)},_decode:function(b){var e=b.dataType,
k=new D(b);if(-1!==r.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],e))return k;if("GPLinearUnit"===e)k.value=new B(k.value);else if("GPFeatureRecordSetLayer"===e||"GPRecordSet"===e)k.value=new a(k.value);else if("GPDataFile"===e)k.value=new C(k.value);else if("GPDate"===e)b=k.value,q.isString(b)?k.value=new L({date:b}):k.value=new Date(b);else if("GPRasterData"===e||"GPRasterDataLayer"===e)b=b.value.mapImage,k.value=b?new H(b):new y(k.value);else if(-1!==e.indexOf("GPMultiValue:")){var f=e.split(":")[1];
b=k.value;k.value=r.map(b,function(a){return this._decode({paramName:"_name",dataType:f,value:a}).value},this)}else console.log(this.declaredClass+" : GP Data type not handled. : "+k.dataType),k=null;return k},submitJob:function(a,b,k,f,h){var c=this._getOutSR(),g=h.assembly;a=this._gpEncode(q.mixin({},this._url.query,{f:"json","env:outSR":c?c.wkid||w.toJson(c.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||w.toJson(this.processSpatialReference.toJson()):
null},a),null,g&&g[0]);var m=this._jobUpdateHandler,n=this._errorHandler;return e({url:this._url.path+"/submitJob",content:a,callbackParamName:"callback",load:function(a,v){m(a,v,!1,b,k,h.dfd)},error:function(a){n(a,f,h.dfd)}})},_jobUpdateHandler:function(a,b,e,k,h,f){var c=a.jobId;b=new z(a);this._successHandler([b],"onStatusUpdate",h,e&&f);if(!e)switch(clearTimeout(this._updateTimers[c]),this._updateTimers[c]=null,f&&f.progress(b),a.jobStatus){case z.STATUS_SUBMITTED:case z.STATUS_EXECUTING:case z.STATUS_WAITING:case z.STATUS_NEW:var g=
this._getJobStatus;this._updateTimers[c]=setTimeout(function(){g(c,e,k,h,f)},this.updateDelay);break;default:this._successHandler([b],"onJobComplete",k,f)}},_getJobStatus:function(a,b,k,f,h){var c=this._jobUpdateHandler;e({url:this._url.path+"/jobs/"+a,content:q.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,e){c(a,e,b,k,f,h)},error:this._errorHandler})},_getResultDataHandler:function(a,b,e,k,f){try{var h=this._decode(a);this._successHandler([h],"onGetResultDataComplete",
e,f)}catch(E){this._errorHandler(E,k,f)}},getResultData:function(a,k,f,c){var h=this._getResultDataHandler,g=this._errorHandler,m=new t(b._dfdCanceller);m._pendingDfd=e({url:this._url.path+"/jobs/"+a+"/results/"+k,content:q.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(a,b){h(a,b,f,c,m)},error:function(a){g(a,c,m)}});return m},checkJobStatus:function(a,k,f){var c=this._jobUpdateHandler,h=this._errorHandler,g=new t(b._dfdCanceller);g._pendingDfd=
e({url:this._url.path+"/jobs/"+a,content:q.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,b){c(a,b,!0,null,k,g)},error:function(a){h(a,f,g)}});return g},cancelJob:function(a,k,f){var c=this._errorHandler,h=new t(b._dfdCanceller);h._pendingDfd=e({url:this._url.path+"/jobs/"+a+"/cancel",content:q.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:q.hitch(this,function(a,b){this._successHandler([a],"onJobCancel",k,h)}),error:function(a){c(a,f,h)}});
return h},execute:function(a,b,k,f){var h=this._getOutSR(),c=f.assembly;a=this._gpEncode(q.mixin({},this._url.query,{f:"json","env:outSR":h?h.wkid||w.toJson(h.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||w.toJson(this.processSpatialReference.toJson()):null},a),null,c&&c[0]);var g=this._executeHandler,m=this._errorHandler;return e({url:this._url.path+"/execute",content:a,callbackParamName:"callback",load:function(a,e){g(a,e,b,k,f.dfd)},error:function(a){m(a,
k,f.dfd)}})},_executeHandler:function(a,b,e,f,h){try{var c=a.results,g,m,n=a.messages;g=0;for(m=c.length;g<m;g++)c[g]=this._decode(c[g]);g=0;for(m=n.length;g<m;g++)n[g]=new k(n[g]);this._successHandler([c,n],"onExecuteComplete",e,h)}catch(M){this._errorHandler(M,f,h)}},_getResultImageHandler:function(a,b,e,k,f){try{var c=this._decode(a);this._successHandler([c],"onGetResultImageComplete",e,f)}catch(E){this._errorHandler(E,k,f)}},getResultImage:function(a,k,f,c,h){var g=this._getResultImageHandler,
m=this._errorHandler;f=this._gpEncode(q.mixin({},this._url.query,{f:"json"},f.toJson()));var n=new t(b._dfdCanceller);n._pendingDfd=e({url:this._url.path+"/jobs/"+a+"/results/"+k,content:f,callbackParamName:"callback",load:function(a,b){g(a,b,c,h,n)},error:function(a){m(a,h,n)}});return n},cancelJobStatusUpdates:function(a){clearTimeout(this._updateTimers[a]);this._updateTimers[a]=null},getResultImageLayer:function(a,b,k,e){if(null==b){var f=this._url.path.indexOf("/GPServer/");a=this._url.path.substring(0,
f)+"/MapServer/jobs/"+a}else a=this._url.path+"/jobs/"+a+"/results/"+b;this._url.query&&(a+="?"+m.objectToQuery(this._url.query));b=null==b?new F(a,{imageParameters:k}):new G(a,{imageParameters:k},!0);this.onGetResultImageLayerComplete(b);e&&e(b);return b},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});u._createWrappers(c);
g("extend-esri")&&q.setObject("tasks.Geoprocessor",c,n);return c})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(c,q,r,t,w){c=c(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(c){this.messages=[];q.mixin(this,c);c=this.messages;var g,n=c.length;for(g=0;g<n;g++)c[g]=new w(c[g])},jobId:"",jobStatus:""});q.mixin(c,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",
STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"});r("extend-esri")&&q.setObject("tasks.JobInfo",c,t);return c})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,q,r,t){c=c(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(c){q.mixin(this,
c)}});q.mixin(c,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"});r("extend-esri")&&q.setObject("tasks.GPMessage",c,t);return c})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(c,q,r,t){c=c(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(c){c&&q.mixin(this,c)},distance:0,units:null,toJson:function(){var c={};this.distance&&(c.distance=this.distance);this.units&&(c.units=this.units);return c}});r("extend-esri")&&q.setObject("tasks.LinearUnit",c,t);return c})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,q,r,t){c=c(null,{declaredClass:"esri.tasks.DataFile",
constructor:function(c){c&&q.mixin(this,c)},url:null,itemID:null,toJson:function(){var c={};this.url&&(c.url=this.url);this.itemID&&(c.itemID=this.itemID);return c}});r("extend-esri")&&q.setObject("tasks.DataFile",c,t);return c})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,q,r,t){c=c(null,{declaredClass:"esri.tasks.RasterData",constructor:function(c){c&&q.mixin(this,c)},url:null,format:null,itemID:null,toJson:function(){var c=
{};this.url&&(c.url=this.url);this.format&&(c.format=this.format);this.itemID&&(c.itemID=this.itemID);return c}});r("extend-esri")&&q.setObject("tasks.RasterData",c,t);return c})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(c,q,r,t,w){c=c(null,{declaredClass:"esri.tasks.Date",constructor:function(c){c&&(c.format&&(this.format=c.format),this.date=r.parse(c.date,{selector:"date",datePattern:this.format}))},date:new Date,
format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:r.format(this.date,{selector:"date",datePattern:this.format}),format:this.format}}});t("extend-esri")&&q.setObject("tasks.Date",c,w);return c})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,q,r,t){c=c(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(c){q.mixin(this,c)}});r("extend-esri")&&q.setObject("tasks.ParameterValue",c,t);return c})},
"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),function(c,q,r,t,w,g,m){c=c(m,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(c,e){e&&e.imageParameters&&e.imageParameters.extent&&(this.initialExtent=this.fullExtent=e.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=q.hitch(this,this.getImageUrl);
this.loaded=!0;this.onLoad(this)},getImageUrl:function(c,e,b,g){var f=c.spatialReference.wkid;g(this._url.path+"?"+w.objectToQuery(q.mixin(this._params,{f:"image",bbox:r.toJson(c.toJson()),bboxSR:f,imageSR:f,size:e+","+b})))}});t("extend-esri")&&q.setObject("tasks._GPResultImageLayer",c,g);return c})},"esri/tasks/PrintTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,q,r,t){c=c(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,
height:1100,dpi:96},layoutOptions:null,format:"PNG32",layout:"MAP_ONLY",outScale:0,preserveScale:!0,forceFeatureAttributes:!1,showAttribution:null,showLabels:!0});r("extend-esri")&&q.setObject("tasks.PrintTemplate",c,t);return c})},"dojox/gfx/canvas":function(){define("./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(c,q,r,t,w,g,m,n,e,b,u,f,a){function z(a,d,l,b,k,e,
c,f,h,g){var v,m,x=d.length,n=0;g?(m=g.l/k,n=g.i):m=d[0]/k;for(;e<c;)e+m>c&&(v={l:(e+m-c)*k,i:n},m=c-e),n%2||(a.beginPath(),a.arc(l,b,k,e,e+m,f),h&&a.stroke()),e+=m,++n,m=d[n%x]/k;return v}function k(b,d,l,e){var v=0,k=0,c,f=0;e?(c=e.l,f=e.i):c=d[0];for(;1>k;)k=a.tAtLength(b,c),1==k&&(v=a.computeLength(b),v={l:c-v,i:f}),b=a.splitBezierAtT(b,k),f%2||l.push(b[0]),b=b[1],++f,c=d[f%d.length];return v}function B(a,d,l,b){var v=[d.last.x,d.last.y].concat(l),e=!(a instanceof Array);l=4===l.length?"quadraticCurveTo":
"bezierCurveTo";var c=[];d=k(v,d.canvasDash,c,b);for(b=0;b<c.length;++b)v=c[b],e?(a.moveTo(v[0],v[1]),a[l].apply(a,v.slice(2))):(a.push("moveTo",[v[0],v[1]]),a.push(l,v.slice(2)));return d}function C(b,d,l,e,k,c,f){var v=0,g=0,h=0,m=a.distance(l,e,k,c),n=0;d=d.canvasDash;var x=l,u=e,z,q=!(b instanceof Array);f?(h=f.l,n=f.i):h+=d[0];for(;.01<Math.abs(1-g);)h>m&&(v={l:h-m,i:n},h=m),g=h/m,f=l+(k-l)*g,z=e+(c-e)*g,n++%2||(q?(b.moveTo(x,u),b.lineTo(f,z)):(b.push("moveTo",[x,u]),b.push("lineTo",[f,z]))),
x=f,u=z,h+=d[n%d.length];return v}var y=c.canvas={},L=null,D=u.multiplyPoint,G=Math.PI,F=2*G,H=G/2;f=q.extend;if(w.global.CanvasRenderingContext2D){w=w.doc.createElement("canvas").getContext("2d");var I="function"==typeof w.setLineDash,A="function"==typeof w.fillText}var O={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};y.Shape=t("dojox.gfx.canvas.Shape",
n.Shape,{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,!0);a.restore()},_renderClip:function(a){this.canvasClip&&(this.canvasClip.render(a),a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var d=this.canvasTransform;a.translate(d.dx,d.dy);a.rotate(d.angle2);a.scale(d.sx,d.sy);a.rotate(d.angle1)}},_renderShape:function(a){},_renderFill:function(a,d){if("canvasFill"in this){var l=this.fillStyle;
if("canvasFillImage"in this){var b=l.width,e=l.height,k=this.canvasFillImage.width,c=this.canvasFillImage.height,v=Math.min(b==k?1:b/k,e==c?1:e/c),f=(b-v*k)/2,h=(e-v*c)/2;L.width=b;L.height=e;var g=L.getContext("2d");g.clearRect(0,0,b,e);g.drawImage(this.canvasFillImage,0,0,k,c,f,h,v*k,v*c);this.canvasFill=a.createPattern(L,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;d&&("pattern"!==l.type||0===l.x&&0===l.y||a.translate(l.x,l.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},
_renderStroke:function(a,d){var l=this.strokeStyle;l?(a.strokeStyle=l.color.toString(),a.lineWidth=l.width,a.lineCap=l.cap,"number"==typeof l.join?(a.lineJoin="miter",a.miterLimit=l.join):a.lineJoin=l.join,this.canvasDash?I?(a.setLineDash(this.canvasDash),d&&a.stroke()):this._renderDashedStroke(a,d):d&&a.stroke()):d||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,d){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,
setClip:function(a){this.inherited(arguments);var d=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!d)return this;this.canvasClip=a?K(d,a):null;this.parent&&this.parent._makeDirty();return this}});var K=function(a,d){switch(a){case "ellipse":return{canvasEllipse:N({shape:d}),render:function(a){return y.Ellipse.prototype._renderShape.call(this,a)}};case "rect":return{shape:q.delegate(d,{r:0}),render:function(a){return y.Rect.prototype._renderShape.call(this,
a)}};case "path":return{canvasPath:h(d),render:function(a){this.canvasPath._renderShape(a)}};case "polyline":return{canvasPolyline:d.points,render:function(a){return y.Polyline.prototype._renderShape.call(this,a)}}}return null},h=function(a){var d=new dojox.gfx.canvas.Path;d.canvasPath=[];d._setPath(a.d);return d},J=function(a,d,l){var b=a.prototype[d];a.prototype[d]=l?function(){this.parent&&this.parent._makeDirty();b.apply(this,arguments);l.call(this);return this}:function(){this.parent&&this.parent._makeDirty();
return b.apply(this,arguments)}};J(y.Shape,"setTransform",function(){this.matrix?this.canvasTransform=c.decompose(this.matrix):delete this.canvasTransform});J(y.Shape,"setFill",function(){var a=this.fillStyle,d;if(a){if("object"==typeof a&&"type"in a){var l=this.surface.rawNode.getContext("2d");switch(a.type){case "linear":case "radial":d="linear"==a.type?l.createLinearGradient(a.x1,a.y1,a.x2,a.y2):l.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.r);r.forEach(a.colors,function(a){d.addColorStop(a.offset,
c.normalizeColor(a.color).toString())});break;case "pattern":L||(L=document.createElement("canvas")),l=new Image,this.surface.downloadImage(l,a.src),this.canvasFillImage=l}}else d=a.toString();this.canvasFill=d}else delete this.canvasFill});J(y.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var d=this.strokeStyle.style.toLowerCase();d in O&&(d=O[d]);if(d instanceof Array){this.canvasDash=d=d.slice();var l;for(l=0;l<d.length;++l)d[l]*=a.width;if("butt"!=a.cap){for(l=0;l<d.length;l+=2)d[l]-=
a.width,1>d[l]&&(d[l]=1);for(l=1;l<d.length;l+=2)d[l]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!I&&!!this.canvasDash});J(y.Shape,"setShape");y.Group=t("dojox.gfx.canvas.Group",y.Shape,{constructor:function(){n.Container._init.call(this)},_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var d=0;d<this.children.length;++d)this.children[d]._render(a);a.restore()},destroy:function(){n.Container.clear.call(this,!0);y.Shape.prototype.destroy.apply(this,
arguments)}});y.Rect=t("dojox.gfx.canvas.Rect",[y.Shape,n.Rect],{_renderShape:function(a){var d=this.shape,l=Math.min(d.r,d.height/2,d.width/2),b=d.x,e=b+d.width,k=d.y,d=k+d.height,c=b+l,f=e-l,h=k+l,g=d-l;a.beginPath();a.moveTo(c,k);l?(a.arc(f,h,l,-H,0,!1),a.arc(f,g,l,0,H,!1),a.arc(c,g,l,H,G,!1),a.arc(c,h,l,G,G+H,!1)):(a.lineTo(f,k),a.lineTo(e,g),a.lineTo(c,d),a.lineTo(b,h));a.closePath()},_renderDashedStroke:function(a,d){var l=this.shape,b=Math.min(l.r,l.height/2,l.width/2),e=l.x,k=e+l.width,c=
l.y,f=c+l.height,h=e+b,g=k-b,v=c+b,m=f-b;b?(a.beginPath(),l=C(a,this,h,c,g,c),d&&a.stroke(),l=z(a,this.canvasDash,g,v,b,-H,0,!1,d,l),a.beginPath(),l=C(a,this,k,v,k,m,l),d&&a.stroke(),l=z(a,this.canvasDash,g,m,b,0,H,!1,d,l),a.beginPath(),l=C(a,this,g,f,h,f,l),d&&a.stroke(),l=z(a,this.canvasDash,h,m,b,H,G,!1,d,l),a.beginPath(),l=C(a,this,e,m,e,v,l),d&&a.stroke(),z(a,this.canvasDash,h,v,b,G,G+H,!1,d,l)):(a.beginPath(),l=C(a,this,h,c,g,c),l=C(a,this,g,c,k,m,l),l=C(a,this,k,m,h,f,l),C(a,this,h,f,e,v,l),
d&&a.stroke())}});var E=[];(function(){var a=b.curvePI4;E.push(a.s,a.c1,a.c2,a.e);for(var d=45;360>d;d+=45){var l=u.rotateg(d);E.push(D(l,a.c1),D(l,a.c2),D(l,a.e))}})();var N=function(a){var d,b,e,c=[],f=a.shape,h=u.normalize([u.translate(f.cx,f.cy),u.scale(f.rx,f.ry)]);d=D(h,E[0]);c.push([d.x,d.y]);for(f=1;f<E.length;f+=3)b=D(h,E[f]),e=D(h,E[f+1]),d=D(h,E[f+2]),c.push([b.x,b.y,e.x,e.y,d.x,d.y]);if(a._needsDash){d=[];b=c[0];for(f=1;f<c.length;++f)e=[],k(b.concat(c[f]),a.canvasDash,e),b=[c[f][4],c[f][5]],
d.push(e);a._dashedPoints=d}return c};y.Ellipse=t("dojox.gfx.canvas.Ellipse",[y.Shape,n.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=N(this);return this},setStroke:function(){this.inherited(arguments);I||(this.canvasEllipse=N(this));return this},_renderShape:function(a){var d=this.canvasEllipse,b;a.beginPath();a.moveTo.apply(a,d[0]);for(b=1;b<d.length;++b)a.bezierCurveTo.apply(a,d[b]);a.closePath()},_renderDashedStroke:function(a,d){var b=this._dashedPoints;a.beginPath();
for(var e=0;e<b.length;++e)for(var c=b[e],k=0;k<c.length;++k){var f=c[k];a.moveTo(f[0],f[1]);a.bezierCurveTo(f[2],f[3],f[4],f[5],f[6],f[7])}d&&a.stroke()}});y.Circle=t("dojox.gfx.canvas.Circle",[y.Shape,n.Circle],{_renderShape:function(a){var d=this.shape;a.beginPath();a.arc(d.cx,d.cy,d.r,0,F,1)},_renderDashedStroke:function(a,d){var b=this.shape,e=0,c,k=this.canvasDash.length;for(i=0;e<F;)c=this.canvasDash[i%k]/b.r,i%2||(a.beginPath(),a.arc(b.cx,b.cy,b.r,e,e+c,0),d&&a.stroke()),e+=c,++i}});y.Line=
t("dojox.gfx.canvas.Line",[y.Shape,n.Line],{_renderShape:function(a){var d=this.shape;a.beginPath();a.moveTo(d.x1,d.y1);a.lineTo(d.x2,d.y2)},_renderDashedStroke:function(a,d){var b=this.shape;a.beginPath();C(a,this,b.x1,b.y1,b.x2,b.y2);d&&a.stroke()}});y.Polyline=t("dojox.gfx.canvas.Polyline",[y.Shape,n.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,d=a[0],b,e;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof d)d=a;else for(d=[],e=0;e<a.length;++e)b=
a[e],d.push(b.x,b.y);else d=[];this.canvasPolyline=d;return this},_renderShape:function(a){var d=this.canvasPolyline;if(d.length){a.beginPath();a.moveTo(d[0],d[1]);for(var b=2;b<d.length;b+=2)a.lineTo(d[b],d[b+1])}},_renderDashedStroke:function(a,d){var b=this.canvasPolyline,e=0;a.beginPath();for(var c=0;c<b.length;c+=2)e=C(a,this,b[c],b[c+1],b[c+2],b[c+3],e);d&&a.stroke()}});y.Image=t("dojox.gfx.canvas.Image",[y.Shape,n.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,
this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var d=this.shape;a.drawImage(this.canvasImage,d.x,d.y,d.width,d.height)}});y.Text=t("dojox.gfx.canvas.Text",[y.Shape,n.Text],{_setFont:function(){this.fontStyle?this.canvasFont=c.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var a=this.shape,d=0,b;a.text&&(b=this.surface.rawNode.getContext("2d"),b.save(),this._renderTransform(b),this._renderFill(b,!1),this._renderStroke(b,!1),this.canvasFont&&
(b.font=this.canvasFont),d=b.measureText(a.text).width,b.restore());return d},_render:function(a){a.save();this._renderTransform(a);this._renderFill(a,!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var d=this.shape;d.text&&(a.textAlign="middle"===d.align?"center":d.align,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(d.text,d.x,d.y),this.strokeStyle&&(a.beginPath(),a.strokeText(d.text,d.x,d.y),a.closePath()))}});J(y.Text,"setFont");A||
y.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var P={M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};y.Path=t("dojox.gfx.canvas.Path",[y.Shape,e.Path],{constructor:function(){this.lastControl=
{}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);I||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var d=q.clone(this.last);this[P[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=d;this.inherited(arguments)},_renderShape:function(a){var d=this.canvasPath;
a.beginPath();for(var b=0;b<d.length;b+=2)a[d[b]].apply(a,d[b+1])},_renderDashedStroke:I?function(){}:function(a,d){var b=this._dashedPath;a.beginPath();for(var e=0;e<b.length;e+=2)a[b[e]].apply(a,b[e+1]);d&&a.stroke()},_moveToA:function(a,d,b,e){a.push("moveTo",[b[0],b[1]]);e&&e.push("moveTo",[b[0],b[1]]);for(d=2;d<b.length;d+=2)a.push("lineTo",[b[d],b[d+1]]),e&&(this._dashResidue=C(e,this,b[d-2],b[d-1],b[d],b[d+1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl=
{}},_moveToR:function(a,d,b,e){d="x"in this.last?[this.last.x+=b[0],this.last.y+=b[1]]:[this.last.x=b[0],this.last.y=b[1]];a.push("moveTo",d);e&&e.push("moveTo",d);for(d=2;d<b.length;d+=2)a.push("lineTo",[this.last.x+=b[d],this.last.y+=b[d+1]]),e&&(this._dashResidue=C(e,this,e[e.length-1][0],e[e.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,d,b,e){for(d=0;d<b.length;d+=2)e&&(this._dashResidue=C(e,this,this.last.x,this.last.y,b[d],b[d+1],this._dashResidue)),
a.push("lineTo",[b[d],b[d+1]]);this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl={}},_lineToR:function(a,d,b,e){for(d=0;d<b.length;d+=2)a.push("lineTo",[this.last.x+=b[d],this.last.y+=b[d+1]]),e&&(this._dashResidue=C(e,this,e[e.length-1][0],e[e.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(a,d,b,e){for(d=0;d<b.length;++d)a.push("lineTo",[b[d],this.last.y]),e&&(this._dashResidue=C(e,this,e[e.length-1][0],e[e.length-1][1],b[d],this.last.y,
this._dashResidue));this.last.x=b[b.length-1];this.lastControl={}},_hLineToR:function(a,d,b,e){for(d=0;d<b.length;++d)a.push("lineTo",[this.last.x+=b[d],this.last.y]),e&&(this._dashResidue=C(e,this,e[e.length-1][0],e[e.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(a,d,b,e){for(d=0;d<b.length;++d)a.push("lineTo",[this.last.x,b[d]]),e&&(this._dashResidue=C(e,this,e[e.length-1][0],e[e.length-1][1],this.last.x,b[d],this._dashResidue));this.last.y=b[b.length-
1];this.lastControl={}},_vLineToR:function(a,d,b,e){for(d=0;d<b.length;++d)a.push("lineTo",[this.last.x,this.last.y+=b[d]]),e&&(this._dashResidue=C(e,this,e[e.length-1][0],e[e.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,d,b,e){for(d=0;d<b.length;d+=6)a.push("bezierCurveTo",b.slice(d,d+6)),e&&(this._dashResidue=B(e,this,a[a.length-1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl.x=b[b.length-4];this.lastControl.y=
b[b.length-3];this.lastControl.type="C"},_curveToR:function(a,d,b,e){for(d=0;d<b.length;d+=6)a.push("bezierCurveTo",[this.last.x+b[d],this.last.y+b[d+1],this.lastControl.x=this.last.x+b[d+2],this.lastControl.y=this.last.y+b[d+3],this.last.x+b[d+4],this.last.y+b[d+5]]),e&&(this._dashResidue=B(e,this,a[a.length-1],this._dashResidue)),this.last.x+=b[d+4],this.last.y+=b[d+5];this.lastControl.type="C"},_smoothCurveToA:function(a,d,b,e){for(d=0;d<b.length;d+=4){var c="C"==this.lastControl.type;a.push("bezierCurveTo",
[c?2*this.last.x-this.lastControl.x:this.last.x,c?2*this.last.y-this.lastControl.y:this.last.y,b[d],b[d+1],b[d+2],b[d+3]]);e&&(this._dashResidue=B(e,this,a[a.length-1],this._dashResidue));this.lastControl.x=b[d];this.lastControl.y=b[d+1];this.lastControl.type="C"}this.last.x=b[b.length-2];this.last.y=b[b.length-1]},_smoothCurveToR:function(a,d,b,e){for(d=0;d<b.length;d+=4){var c="C"==this.lastControl.type;a.push("bezierCurveTo",[c?2*this.last.x-this.lastControl.x:this.last.x,c?2*this.last.y-this.lastControl.y:
this.last.y,this.last.x+b[d],this.last.y+b[d+1],this.last.x+b[d+2],this.last.y+b[d+3]]);e&&(this._dashResidue=B(e,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+b[d];this.lastControl.y=this.last.y+b[d+1];this.lastControl.type="C";this.last.x+=b[d+2];this.last.y+=b[d+3]}},_qCurveToA:function(a,d,b,e){for(d=0;d<b.length;d+=4)a.push("quadraticCurveTo",b.slice(d,d+4));e&&(this._dashResidue=B(e,this,a[a.length-1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-
1];this.lastControl.x=b[b.length-4];this.lastControl.y=b[b.length-3];this.lastControl.type="Q"},_qCurveToR:function(a,d,b,e){for(d=0;d<b.length;d+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+b[d],this.lastControl.y=this.last.y+b[d+1],this.last.x+b[d+2],this.last.y+b[d+3]]),e&&(this._dashResidue=B(e,this,a[a.length-1],this._dashResidue)),this.last.x+=b[d+2],this.last.y+=b[d+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,d,b,e){for(d=0;d<b.length;d+=2){var c="Q"==this.lastControl.type;
a.push("quadraticCurveTo",[this.lastControl.x=c?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=c?2*this.last.y-this.lastControl.y:this.last.y,b[d],b[d+1]]);e&&(this._dashResidue=B(e,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=b[b.length-2];this.last.y=b[b.length-1]},_qSmoothCurveToR:function(a,d,b,e){for(d=0;d<b.length;d+=2){var c="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=c?2*this.last.x-this.lastControl.x:this.last.x,
this.lastControl.y=c?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+b[d],this.last.y+b[d+1]]);e&&(this._dashResidue=B(e,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=b[d];this.last.y+=b[d+1]}},_arcTo:function(a,d,e,c){d="a"==d;for(var k=0;k<e.length;k+=7){var f=e[k+5],h=e[k+6];d&&(f+=this.last.x,h+=this.last.y);var g=b.arcAsBezier(this.last,e[k],e[k+1],e[k+2],e[k+3]?1:0,e[k+4]?1:0,f,h);r.forEach(g,function(d){a.push("bezierCurveTo",d)});c&&(this._dashResidue=
B(c,this,p,this._dashResidue));this.last.x=f;this.last.y=h}this.lastControl={}},_closePath:function(a,d,b,e){a.push("closePath",[]);e&&(this._dashResidue=C(e,this,this.last.x,this.last.y,e[1][0],e[1][1],this._dashResidue));this.lastControl={}}});r.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(a){J(y.Path,a)});y.TextPath=t("dojox.gfx.canvas.TextPath",[y.Shape,e.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});
y.Surface=t("dojox.gfx.canvas.Surface",n.Surface,{constructor:function(){n.Container._init.call(this);this.pendingImageCount=0;this.makeDirty()},destroy:function(){n.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,d){this.width=c.normalizedLength(a);this.height=c.normalizedLength(d);if(!this.rawNode)return this;a=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,a=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,a=!0);a&&this.makeDirty();
return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:null},_render:function(a){!this.rawNode||!a&&this.pendingImageCount||(a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender))},render:function(a){a.save();for(var d=0;d<this.children.length;++d)this.children[d]._render(a);a.restore()},makeDirty:function(){this.pendingImagesCount||
"pendingRender"in this||this._batch||(this.pendingRender=setTimeout(q.hitch(this,this._render),0))},downloadImage:function(a,d){var b=q.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=b;a.onerror=b;a.onabort=b;a.src=d},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},
on:function(){}});y.createSurface=function(a,d,b){if(!d&&!b){var e=g.position(a);d=d||e.w;b=b||e.h}"number"==typeof d&&(d+="px");"number"==typeof b&&(b+="px");e=new y.Surface;a=m.byId(a);var k=a.ownerDocument.createElement("canvas");k.width=c.normalizedLength(d);k.height=c.normalizedLength(b);a.appendChild(k);e.rawNode=k;e._parent=a;return e.surface=e};var M=n.Container;t={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();
return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();return M.add.apply(this,arguments)},remove:function(a,d){this._makeDirty();return M.remove.apply(this,arguments)},clear:function(){this._makeDirty();return M.clear.apply(this,arguments)},getBoundingBox:M.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return M._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return M._moveChildToBack.apply(this,
arguments)}};e={createObject:function(a,d){a=new a;a.surface=this.surface;a.setShape(d);this.add(a);return a}};f(y.Group,t);f(y.Group,n.Creator);f(y.Group,e);f(y.Surface,t);f(y.Surface,n.Creator);f(y.Surface,e);y.fixTarget=function(a,d){return!0};return y})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(c,q,r,t,w,g,m,n,e,b){function u(a,b){for(var e=
a.length-1;b<e;)a[b]=a[++b];a.length=e}var f=c.shape={};f.Shape=r("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(w("gfxRegistry")){var a=f.register(this);this.getUID=function(){return a}}},destroy:function(){w("gfxRegistry")&&f.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},
getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var e=this._getRealMatrix();return[b.multiplyPoint(e,a.x,a.y),b.multiplyPoint(e,a.x+a.width,a.y),b.multiplyPoint(e,a.x+a.width,a.y+a.height),b.multiplyPoint(e,a.x,
a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=c.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=c.makeParameters(c.defaultLinearGradient,a);break;case "radial":b=c.makeParameters(c.defaultRadialGradient,a);break;case "pattern":b=c.makeParameters(c.defaultPattern,
a)}else b=c.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||q.isArray(a)||a instanceof e)a={color:a};a=this.strokeStyle=c.makeParameters(c.defaultStroke,a);a.color=c.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=b.clone(a?b.normalize(a):b.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),
this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},
_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=a?b.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,e=this.parent;e;)e.matrix&&(a=b.multiply(e.matrix,a)),e=e.parent;return a}});f._eventsProcessing={on:function(a,b){return g(this.getEventSource(),a,f.fixCallback(this,c.fixTarget,b))},connect:function(a,b,e){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,e?q.hitch(b,
e):b)},disconnect:function(a){return a.remove()}};f.fixCallback=function(a,b,e,c){c||(c=e,e=null);if(q.isString(c)){e=e||t.global;if(!e[c])throw['dojox.gfx.shape.fixCallback: scope["',c,'"] is null (scope\x3d"',e,'")'].join("");return function(k){return b(k,a)?e[c].apply(e,arguments||[]):void 0}}return e?function(k){return b(k,a)?c.apply(e,arguments||[]):void 0}:function(k){return b(k,a)?c.apply(e,arguments):void 0}};q.extend(f.Shape,f._eventsProcessing);f.Container={_init:function(){this.children=
[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var e=0;e<this.children.length;++e)if(this.children[e]==a){b||(a.parent=null,a.parentMatrix=null);u(this.children,e);break}return this},clear:function(a){for(var b,e=0;e<this.children.length;++e)b=this.children[e],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=
[];return this},getBoundingBox:function(){if(this.children){var a=null;m.forEach(this.children,function(e){var c=e.getBoundingBox();c&&((e=e.getTransform())&&(c=b.multiplyRectangle(e,c)),a?(a.x=Math.min(a.x,c.x),a.y=Math.min(a.y,c.y),a.endX=Math.max(a.endX,c.x+c.width),a.endY=Math.max(a.endY,c.y+c.height)):a={x:c.x,y:c.y,endX:c.x+c.width,endY:c.y+c.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==
a){u(this.children,b);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){u(this.children,b);this.children.unshift(a);break}return this}};f.Surface=r("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){m.forEach(this._nodes,n.destroy);this._nodes=[];m.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;
if(w("ie"))for(;this._parent.lastChild;)n.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var e=q.hitch(a,b);if(this.isLoaded)e(this);else g.once(this,"load",function(a){e(a)})}});q.extend(f.Surface,f._eventsProcessing);f.Rect=r("dojox.gfx.shape.Rect",f.Shape,{constructor:function(a){this.shape=c.getDefault("Rect");this.rawNode=
a},getBoundingBox:function(){return this.shape}});f.Ellipse=r("dojox.gfx.shape.Ellipse",f.Shape,{constructor:function(a){this.shape=c.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});f.Circle=r("dojox.gfx.shape.Circle",f.Shape,{constructor:function(a){this.shape=c.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-
a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});f.Line=r("dojox.gfx.shape.Line",f.Shape,{constructor:function(a){this.shape=c.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});f.Polyline=r("dojox.gfx.shape.Polyline",f.Shape,{constructor:function(a){this.shape=c.getDefault("Polyline");this.rawNode=a},setShape:function(a,
b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var e=[],c=0;c<b;c+=2)e.push({x:a[c],y:a[c+1]});this.shape.points=e}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,e=a[0],c=e.x,f=e.y,g=e.x,m=e.y,n=1;n<b;++n)e=
a[n],c>e.x&&(c=e.x),g<e.x&&(g=e.x),f>e.y&&(f=e.y),m<e.y&&(m=e.y);this.bbox={x:c,y:f,width:g-c,height:m-f}}return this.bbox}});f.Image=r("dojox.gfx.shape.Image",f.Shape,{constructor:function(a){this.shape=c.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});f.Text=r(f.Shape,{constructor:function(a){this.fontStyle=null;this.shape=c.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},
setFont:function(a){this.fontStyle="string"==typeof a?c.splitFontString(a):c.makeParameters(c.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=c._base._computeTextBoundingBox(this));return a}});f.Creator={createShape:function(a){switch(a.type){case c.defaultPath.type:return this.createPath(a);case c.defaultRect.type:return this.createRect(a);case c.defaultCircle.type:return this.createCircle(a);case c.defaultEllipse.type:return this.createEllipse(a);
case c.defaultLine.type:return this.createLine(a);case c.defaultPolyline.type:return this.createPolyline(a);case c.defaultImage.type:return this.createImage(a);case c.defaultText.type:return this.createText(a);case c.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(c.Group)},createRect:function(a){return this.createObject(c.Rect,a)},createEllipse:function(a){return this.createObject(c.Ellipse,a)},createCircle:function(a){return this.createObject(c.Circle,
a)},createLine:function(a){return this.createObject(c.Line,a)},createPolyline:function(a){return this.createObject(c.Polyline,a)},createImage:function(a){return this.createObject(c.Image,a)},createText:function(a){return this.createObject(c.Text,a)},createPath:function(a){return this.createObject(c.Path,a)},createTextPath:function(a){return this.createObject(c.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return f})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang",
"dojo/_base/declare","./matrix","./shape"],function(c,q,r,t,w){w=r("dojox.gfx.path.Path",w.Shape,{constructor:function(g){this.shape=q.clone(c.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=g;this.segmented=!1},setAbsoluteMode:function(c){this._confirmSegmented();this.absolute="string"==typeof c?"absolute"==c:c;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&
"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var c=this.bbox,m=this._getRealMatrix();this.bbox=null;for(var n=0,e=this.segments.length;n<e;++n)this._updateWithSegment(this.segments[n],m);m=this.bbox;this.bbox=c;return this.tbbox=m?[{x:m.l,y:m.t},{x:m.r,y:m.t},{x:m.r,y:m.b},{x:m.l,y:m.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in
this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(c,m,n){n&&(m=t.multiplyPoint(n,c,m),c=m.x,m=m.y);this.bbox&&"l"in this.bbox?(this.bbox.l>c&&(this.bbox.l=c),this.bbox.r<c&&(this.bbox.r=c),this.bbox.t>m&&(this.bbox.t=m),this.bbox.b<m&&(this.bbox.b=m)):this.bbox={l:c,b:m,r:c,t:m}},_updateWithSegment:function(g,m){var n=g.args,e=n.length,b;switch(g.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(b=0;b<e;b+=2)this._updateBBox(n[b],
n[b+1],m);this.last.x=n[e-2];this.last.y=n[e-1];this.absolute=!0;break;case "H":for(b=0;b<e;++b)this._updateBBox(n[b],this.last.y,m);this.last.x=n[e-1];this.absolute=!0;break;case "V":for(b=0;b<e;++b)this._updateBBox(this.last.x,n[b],m);this.last.y=n[e-1];this.absolute=!0;break;case "m":b=0;"x"in this.last||(this._updateBBox(this.last.x=n[0],this.last.y=n[1],m),b=2);for(;b<e;b+=2)this._updateBBox(this.last.x+=n[b],this.last.y+=n[b+1],m);this.absolute=!1;break;case "l":case "t":for(b=0;b<e;b+=2)this._updateBBox(this.last.x+=
n[b],this.last.y+=n[b+1],m);this.absolute=!1;break;case "h":for(b=0;b<e;++b)this._updateBBox(this.last.x+=n[b],this.last.y,m);this.absolute=!1;break;case "v":for(b=0;b<e;++b)this._updateBBox(this.last.x,this.last.y+=n[b],m);this.absolute=!1;break;case "c":for(b=0;b<e;b+=6)this._updateBBox(this.last.x+n[b],this.last.y+n[b+1],m),this._updateBBox(this.last.x+n[b+2],this.last.y+n[b+3],m),this._updateBBox(this.last.x+=n[b+4],this.last.y+=n[b+5],m);this.absolute=!1;break;case "s":case "q":for(b=0;b<e;b+=
4)this._updateBBox(this.last.x+n[b],this.last.y+n[b+1],m),this._updateBBox(this.last.x+=n[b+2],this.last.y+=n[b+3],m);this.absolute=!1;break;case "A":for(b=0;b<e;b+=7)this._updateBBox(n[b+5],n[b+6],m);this.last.x=n[e-2];this.last.y=n[e-1];this.absolute=!0;break;case "a":for(b=0;b<e;b+=7)this._updateBBox(this.last.x+=n[b+5],this.last.y+=n[b+6],m);this.absolute=!1}g=[g.action];for(b=0;b<e;++b)g.push(c.formatNumber(n[b],!0));if("string"==typeof this.shape.path)this.shape.path+=g.join("");else for(b=
0,e=g.length;b<e;++b)this.shape.path.push(g[b])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(c,m){this.tbbox=null;var g=this._validSegments[c.toLowerCase()];"number"==typeof g&&(g?m.length>=g&&(c={action:c,args:m.slice(0,m.length-m.length%g)},this.segments.push(c),this._updateWithSegment(c)):(c={action:c,args:[]},this.segments.push(c),this._updateWithSegment(c)))},_collectArgs:function(c,m){for(var g=0;g<m.length;++g){var e=m[g];"boolean"==typeof e?c.push(e?1:0):
"number"==typeof e?c.push(e):e instanceof Array?this._collectArgs(c,e):"x"in e&&"y"in e&&c.push(e.x,e.y)}},moveTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"M":"m",c);return this},lineTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"L":"l",c);return this},hLineTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?
"H":"h",c);return this},vLineTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"V":"v",c);return this},curveTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"C":"c",c);return this},smoothCurveTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"S":"s",c);return this},qCurveTo:function(){this._confirmSegmented();var c=
[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"Q":"q",c);return this},qSmoothCurveTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"T":"t",c);return this},arcTo:function(){this._confirmSegmented();var c=[];this._collectArgs(c,arguments);this._pushSegment(this.absolute?"A":"a",c);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var c=
this.shape.path;this.shape.path=[];this._setPath(c);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(g){g=q.isArray(g)?g:g.match(c.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(g){for(var m="",n=[],e=g.length,b=0;b<e;++b){var u=g[b],f=parseFloat(u);isNaN(f)?(m&&this._pushSegment(m,n),n=[],m=u):n.push(f)}this._pushSegment(m,n)}},setShape:function(g){this.inherited(arguments,["string"==typeof g?{path:g}:g]);this.segmented=!1;this.segments=
[];c.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});r=r("dojox.gfx.path.TextPath",w,{constructor:function(g){"text"in this||(this.text=q.clone(c.defaultTextPath));"fontStyle"in this||(this.fontStyle=q.clone(c.defaultFont))},getText:function(){return this.text},setText:function(g){this.text=c.makeParameters(this.text,"string"==typeof g?{text:g}:g);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(g){this.fontStyle="string"==typeof g?
c.splitFontString(g):c.makeParameters(c.defaultFont,g);this._setFont();return this}});return c.path={Path:w,TextPath:r}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],function(c,q,r){function t(b){var e=Math.cos(b);b=Math.sin(b);var c={x:e+4/3*(1-e),y:b-4/3*e*(1-e)/b};return{s:{x:e,y:-b},c1:{x:c.x,y:-c.y},c2:c,e:{x:e,y:b}}}var w=2*Math.PI,g=Math.PI/4,m=Math.PI/8,n=g+m,e=t(m);return c.arc={unitArcAsBezier:t,curvePI4:e,arcAsBezier:function(b,c,f,a,q,k,B,C){q=!!q;k=!!k;
var u=r._degToRad(a);a=c*c;var z=f*f,D=r.multiplyPoint(r.rotate(-u),{x:(b.x-B)/2,y:(b.y-C)/2}),G=D.x*D.x,F=D.y*D.y;a=Math.sqrt((a*z-a*F-z*G)/(a*F+z*G));isNaN(a)&&(a=0);a={x:a*c*D.y/f,y:-a*f*D.x/c};q==k&&(a={x:-a.x,y:-a.y});a=r.multiplyPoint([r.translate((b.x+B)/2,(b.y+C)/2),r.rotate(u)],a);c=r.normalize([r.translate(a.x,a.y),r.rotate(u),r.scale(c,f)]);a=r.invert(c);b=r.multiplyPoint(a,b);C=r.multiplyPoint(a,B,C);B=Math.atan2(b.y,b.x);a=B-Math.atan2(C.y,C.x);k&&(a=-a);0>a?a+=w:a>w&&(a-=w);f=m;C=e;
f=k?f:-f;b=[];for(q=a;0<q;q-=g)q<n&&(f=q/2,C=t(f),f=k?f:-f,q=0),D=r.normalize([c,r.rotate(B+f)]),k?(a=r.multiplyPoint(D,C.c1),u=r.multiplyPoint(D,C.c2),D=r.multiplyPoint(D,C.e)):(a=r.multiplyPoint(D,C.c2),u=r.multiplyPoint(D,C.c1),D=r.multiplyPoint(D,C.s)),b.push([a.x,a.y,u.x,u.y,D.x,D.y]),B+=2*f;return b}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(c,q,r){function t(e,b){return Math.abs(e-b)<=1E-6*(Math.abs(e)+Math.abs(b))}function w(e,b,c,f){if(!isFinite(e))return c;
if(!isFinite(c))return e;b=Math.abs(b);f=Math.abs(f);return(b*e+f*c)/(b+f)}function g(e){e=r.normalize(e);var b=-e.xx-e.yy,c=e.xx*e.yy-e.xy*e.yx,f=Math.sqrt(b*b-4*c),b=-(b+(0>b?-f:f))/2,c=c/b,f=e.xy/(b-e.xx),a=1,g=e.xy/(c-e.xx),k=1;t(b,c)&&(f=1,g=a=0,k=1);isFinite(f)||(f=1,a=(b-e.xx)/e.xy,isFinite(a)||(f=(b-e.yy)/e.yx,a=1,isFinite(f)||(f=1,a=e.yx/(b-e.yy))));isFinite(g)||(g=1,k=(c-e.xx)/e.xy,isFinite(k)||(g=(c-e.yy)/e.yx,k=1,isFinite(g)||(g=1,k=e.yx/(c-e.yy))));e=Math.sqrt(f*f+a*a);var m=Math.sqrt(g*
g+k*k);isFinite(f/=e)||(f=0);isFinite(a/=e)||(a=0);isFinite(g/=m)||(g=0);isFinite(k/=m)||(k=0);return{value1:b,value2:c,vector1:{x:f,y:a},vector2:{x:g,y:k}}}function m(e,b){var c=0>e.xx*e.yy||0<e.xy*e.yx?-1:1,f=b.angle1=(Math.atan2(e.yx,e.yy)+Math.atan2(-c*e.xy,c*e.xx))/2,c=Math.cos(f),f=Math.sin(f);b.sx=w(e.xx/c,c,-e.xy/f,f);b.sy=w(e.yy/c,c,e.yx/f,f);return b}function n(e,b){var c=0>e.xx*e.yy||0<e.xy*e.yx?-1:1,f=b.angle2=(Math.atan2(c*e.yx,c*e.xx)+Math.atan2(-e.xy,e.yy))/2,c=Math.cos(f),f=Math.sin(f);
b.sx=w(e.xx/c,c,e.yx/f,f);b.sy=w(e.yy/c,c,-e.xy/f,f);return b}return c.decompose=function(e){var b=r.normalize(e);e={dx:b.dx,dy:b.dy,sx:1,sy:1,angle1:0,angle2:0};if(t(b.xy,0)&&t(b.yx,0))return q.mixin(e,{sx:b.xx,sy:b.yy});if(t(b.xx*b.yx,-b.xy*b.yy))return m(b,e);if(t(b.xx*b.xy,-b.yx*b.yy))return n(b,e);var c,f=new r.Matrix2D(b);c=q.mixin(f,{dx:0,dy:0,xy:f.yx,yx:f.xy});f=g([b,c]);c=g([c,b]);f=new r.Matrix2D({xx:f.vector1.x,xy:f.vector2.x,yx:f.vector1.y,yy:f.vector2.y});c=new r.Matrix2D({xx:c.vector1.x,
xy:c.vector1.y,yx:c.vector2.x,yy:c.vector2.y});b=new r.Matrix2D([r.invert(f),b,r.invert(c)]);m(c,e);b.xx*=e.sx;b.yy*=e.sy;n(f,e);b.xx*=e.sx;b.yy*=e.sy;return q.mixin(e,{sx:b.xx,sy:b.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(c){c=c.bezierutils={};c.tAtLength=function(c,n){var e=0,b=6==c.length,m=0,f=0,a=b?t:g,q=function(k,g){for(var u=0,t=0;t<k.length-2;t+=2)u+=r(k[t],k[t+1],k[t+2],k[t+3]);t=b?r(c[0],c[1],c[4],c[5]):r(c[0],c[1],c[6],c[7]);u-t>g||m+u>n+g?(++f,k=a(k,.5),
q(k[0],g),Math.abs(m-n)<=g||q(k[1],g)):(m+=u,e+=1/(1<<f))};n&&q(c,.5);return e};var q=c.computeLength=function(c){for(var g=6==c.length,e=0,b=0;b<c.length-2;b+=2)e+=r(c[b],c[b+1],c[b+2],c[b+3]);b=g?r(c[0],c[1],c[4],c[5]):r(c[0],c[1],c[6],c[7]);.1<e-b&&(c=g?t(c,.5):w(c,.5),e=q(c[0],g),e+=q(c[1],g));return e},r=c.distance=function(c,g,e,b){return Math.sqrt((e-c)*(e-c)+(b-g)*(b-g))},t=function(c,g){var e=1-g,b=e*e,m=g*g,f=c[0],a=c[1],n=c[2],k=c[3],q=c[4];c=c[5];var r=b*f+2*e*g*n+m*q,b=b*a+2*e*g*k+m*
c;return[[f,a,e*f+g*n,e*a+g*k,r,b],[r,b,e*n+g*q,e*k+g*c,q,c]]},w=function(c,g){var e=1-g,b=e*e,m=b*e,f=g*g,a=f*g,n=c[0],k=c[1],q=c[2],r=c[3],t=c[4],w=c[5],D=c[6];c=c[7];var G=m*n+3*b*g*q+3*e*f*t+a*D,m=m*k+3*b*g*r+3*e*f*w+a*c;return[[n,k,e*n+g*q,e*k+g*r,b*n+2*e*g*q+f*t,b*k+2*e*g*r+f*w,G,m],[G,m,b*q+2*e*g*t+f*D,b*r+2*e*g*w+f*c,e*t+g*D,e*w+g*c,D,c]]},g=c.splitBezierAtT=function(c,g){return 6==c.length?t(c,g):w(c,g)};return c})},"dojox/json/query":function(){define(["dojo/_base/kernel","dojo/_base/lang",
"dojox","dojo/_base/array"],function(c,q,r){q.getObject("json",!0,r);r.json._slice=function(c,q,g,m){var n=c.length,e=[];g=g||n;q=0>q?Math.max(0,q+n):Math.min(n,q);for(g=0>g?Math.max(0,g+n):Math.min(n,g);q<g;q+=m)e.push(c[q]);return e};r.json._find=function(c,q){function g(c){q&&(!0!==q||c instanceof Array?c[q]&&m.push(c[q]):m.push(c));for(var b in c){var e=c[b];q?e&&"object"==typeof e&&g(e):m.push(e)}}var m=[];if(q instanceof Array){if(1==q.length)return c[q[0]];for(var n=0;n<q.length;n++)m.push(c[q[n]])}else g(c);
return m};r.json._distinctFilter=function(c,q){for(var g=[],m={},n=0,e=c.length;n<e;++n){var b=c[n];q(b,n,c)&&("object"==typeof b&&b?b.__included||(b.__included=!0,g.push(b)):m[b+typeof b]||(m[b+typeof b]=!0,g.push(b)))}n=0;for(e=g.length;n<e;++n)g[n]&&delete g[n].__included;return g};return r.json.query=function(c,q){function g(b,a,c,e,g,m,q,r){return n[r].match(/[\*\?]/)||"~"==q?"/^"+n[r].substring(1,n[r].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+
("~"==q?"$/i":"$/")+".test("+a+")":b}var m=0,n=[];c=c.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(b){m+="["==b?1:"]"==b?-1:0;return"]"==b&&0<m?"`]":'"'==b.charAt(0)||"'"==b.charAt(0)?"`"+(n.push(b)-1):b});var e="";c.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw Error("Unsafe function call");});c=c.replace(/([^<>=]=)([^=])/g,"$1\x3d$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(b){return"."==b.charAt(0)?b:"@"==b?"$obj":(b.match(/:|^(\$|Math|true|false|null)$/)?
"":"$obj.")+b}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(b,a,c){return(a=b.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/))?(c="",b.match(/^\./)&&(e="dojox.json._find("+e,c=",true)"),e=(a[1].match(/\=/)?"dojo.map":a[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter")+"("+e,c+",function($obj){return "+a[2]+"})"):(a=b.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+a[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(a,b,c){return"var av\x3d "+c.replace(/\$obj/,
"a")+",bv\x3d "+c.replace(/\$obj/,"b")+";if(av\x3ebv||bv\x3d\x3dnull){return "+("/"==b?1:-1)+";}\nif(bv\x3eav||av\x3d\x3dnull){return "+("/"==b?-1:1)+";}\n"})+"return 0;})":(a=b.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/))?(e="dojox.json._slice("+e,","+(a[1]||0)+","+(a[2]||0)+","+(a[3]||1)+")"):b.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(e="dojox.json._find("+e,("."==b.charAt(1)?",'"+c+"'":b.match(/,/)?","+b:"")+")"):b}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,
g).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(b,a,c,e,m,n,q,r){return g(b,e,m,n,q,r,c,a)});c=e+("$"==c.charAt(0)?"":"$")+c.replace(/`([0-9]+|\])/g,function(b,a){return"]"==a?"]":n[a]});for(var b=eval("1\x26\x26function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj\x3d$;return "+c+"}"),r=0;r<arguments.length-1;r++)arguments[r]=arguments[r+1];return q?b.apply(this,arguments):b}})},"esri/tasks/PrintParameters":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel"],function(c,q,r,t){c=c(null,{declaredClass:"esri.tasks.PrintParameters",map:null,template:null,outSpatialReference:null,extraParameters:null});r("extend-esri")&&q.setObject("tasks.PrintParameters",c,t);return c})},"jimu/SpatialReference/srUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all dojo/request esri/SpatialReference ./unitUtils".split(" "),function(c,q,r,t,w,g,m,n){var e=null,b=null,u=!1,f=c(null,function(){});
c=require.toUrl("jimu");var a=g(c+"/SpatialReference/cs.json",{handleAs:"json"}),z=g(c+"/SpatialReference/transform.json",{handleAs:"json"});f.loadResource=function(){var c=new t;if(e&&b)return c.resolve(),c;w([a,z]).then(function(a){e=a[0];b=a[1];u=!0;c.resolve()},function(a){console.error(a);u=!1;c.reject(a)});return c};f.getAllCSUnits=function(){if(u){var a=[];r.forEach(e.wkids,q.hitch(this,function(b){b=this.getCSUnit(b);-1===r.indexOf(a,b)&&a.push(b)}));return a}};f.convertUnit=function(a,b,
c){if(u)return n.convertUnit(a,b,c)};f.getUnitRate=function(a,b){if(u)return n.getUnitRate(a,b)};f.isProjectUnit=function(a){if(u)return n.isProjectUnit(a)};f.isGeographicUnit=function(a){if(u)return n.isGeographicUnit(a)};f.getGeographicUnits=function(){if(u)return n.getGeographicUnits()};f.getProjectUnits=function(){if(u)return n.getProjectUnits()};f.getCSUnit=function(a){if(u)return a=r.indexOf(e.wkids,a),e.units[a]};f.isSameSR=function(a,b){if(u)return a=this.indexOfWkid(a),b=this.indexOfWkid(b),
e.labels[a]===e.labels[b]};f.isValidWkid=function(a){if(u)return-1<this.indexOfWkid(a)};f.getSRLabel=function(a){if(u&&this.isValidWkid(a))return a=this.indexOfWkid(a),e.labels[a]};f.indexOfWkid=function(a){if(u)return r.indexOf(e.wkids,a)};f.isWebMercator=function(a){return m.prototype._isWebMercator?m.prototype._isWebMercator.apply({wkid:parseInt(a,10)},[]):(new m(parseInt(a,10))).isWebMercator()};f.standardizeWkid=function(a){return this.isWebMercator(a)?3857:parseInt(a,10)};f.isValidTfWkid=function(a){if(u)return-1<
this.indexOfTfWkid(a)};f.getTransformationLabel=function(a){if(u)return this.isValidTfWkid(a)?(a=this.indexOfTfWkid(a),b.labels[a]):""};f.indexOfTfWkid=function(a){if(u)return r.indexOf(b.tfWkids,a)};f.isGeographicCS=function(a){if(u)return this.isValidWkid(a)?(a=this.indexOfWkid(a),!e.projSR[a]):!1};f.isProjectedCS=function(a){if(u)return this.isValidWkid(a)?(a=this.indexOfWkid(a),e.projSR[a]):!1};f.getGeoCSByProj=function(a){if(u&&this.isProjectedCS(a))return a=this.indexOfWkid(a),e.spheroids[a]};
f.getSpheroidStr=function(a){if(u)return this.isGeographicCS(a)?e.labels[this.indexOfWkid(a)]:this.isProjectedCS(a)?(a=f.getGeoCSByProj(a),e.labels[this.indexOfWkid(a)]):null};f.isSameSpheroid=function(a,b){if(u)return a=this.getSpheroidStr(a),b=this.getSpheroidStr(b),a&&b&&a===b?!0:!1};return f})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),function(c,q,
r,t,w,g,m,n){return q("dijit.ProgressBar",[g,m],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:n,_indeterminateHighContrastImagePath:c.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());
this.update()},_setDirAttr:function(c){var b="rtl"==c.toLowerCase();r.toggle(this.domNode,"dijitProgressBarRtl",b);r.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&b);this.inherited(arguments)},update:function(c){t.mixin(this,c||{});c=this.internalProgress;var b=this.domNode,e=1;this.indeterminate?b.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(e=Math.min(parseFloat(this.progress)/100,1),this.progress=e*this.maximum):(this.progress=Math.min(this.progress,
this.maximum),e=this.maximum?this.progress/this.maximum:0),b.setAttribute("aria-valuenow",this.progress));b.setAttribute("aria-labelledby",this.labelNode.id);b.setAttribute("aria-valuemin",0);b.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(e);r.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);r.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());c.style.width=100*e+"%";this.onChange()},_setValueAttr:function(c){this._set("value",
c);Infinity==c?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:c})},_setLabelAttr:function(c){this._set("label",c);this.update()},_setIndeterminateAttr:function(c){this._set("indeterminate",c);this.update()},report:function(c){return this.label?this.label:this.indeterminate?"\x26#160;":w.format(c,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"widgets/Print/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css",
"dojo/i18n!./nls/strings"],function(){})},"url:widgets/Print/templates/Print.html":'\x3cdiv class\x3d"gis_PrintDijit"\x3e\r\n    \x3cdiv class\x3d"formContainer"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"printSettingsFormDijit"\x3e\r\n            \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                \x3ctr data-dojo-attach-point\x3d"titleTr"\x3e\r\n                    \x3ctd style\x3d"width:65px;"\x3e\r\n                        ${nls.title}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"text" data-dojo-attach-point\x3d"titleNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'title\',trim:true,required:true,style:\'width:100%;\'" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.layout}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'layout\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"layoutDijit" data-dojo-attach-event\x3d"Change:onLayoutChange"/\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.format}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'format\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"formatDijit" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"buttonActionBar jimu-align-trailing"\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"advancedButtonDijit" style\x3d"display: none"\r\n            data-dojo-attach-event\x3d"onclick:showSettings"\x3e\x3cdiv class\x3d"btn-icon settingsIcon"\x3e\x3c/div\x3e${nls.settings}\x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"settingsDialog"\r\n            style\x3d"display: none" class\x3d"gis_PrintDijit"\x3e\r\n            \x3cdiv style\x3d"width:250px;"\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapScaleExtent}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"preserveFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                ${nls.preserve}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"printWidgetMapScale" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',checked:true,value:\'true\'"\r\n                                /\x3e\x3clabel data-dojo-attach-point\x3d"printWidgetMapScaleLabel"\x3e${nls.mapScale}\x3c/label\x3e\r\n                                \x3cbr /\x3e\r\n                                \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"printWidgetMapExtent" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'false\'"\r\n                                /\x3e\x3clabel data-dojo-attach-point\x3d"printWidgetMapExtentLabel"\x3e${nls.mapExtent}\x3c/label\x3e\r\n                            \x3c/td\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd style\x3d"vertical-align: top; padding-top: 7px;"\x3e\r\n                                    ${nls.forceScale}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cdiv style\x3d"display: flex;"\x3e\r\n                                        \x3cinput type\x3d"radio" style\x3d"margin-top: 7px;" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'force\',checked:false"/\x3e\r\n                                        \x3cdiv style\x3d"display: flex; flex-direction: column;"\x3e\r\n                                            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'forcedScale\',required:false,style:\'width:100px;\'" data-dojo-attach-point\x3d"forceScaleNTB"/\x3e\r\n                                            \x3ca href\x3d"#" data-dojo-attach-event\x3d"click:getCurrentMapScale"\x3e${nls.getCurrentScale}\x3c/a\x3e\r\n                                        \x3c/div\x3e\r\n                                    \x3c/div\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold; margin-bottom: 5px"\x3e\r\n                    \x3cspan\x3e${nls.outputSR}\x3c/span\x3e\r\n                    \x3ca href\x3d"https://developers.arcgis.com/javascript/jshelp/ref_coordsystems.html" target\x3d"blank"\x3eWKID\x3c/a\x3e\r\n                    \x3cspan\x3e:\x3c/span\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"margin-bottom: 5px"\x3e\r\n                    \x3cdiv\x3e\r\n                        \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"onChange:_onOutputSRChange"\r\n                            data-dojo-attach-point\x3d"wkidInput" data-dojo-props\x3d\'style:{width:"100%"}\'\r\n                            data-dojo-props\x3d"required: false"/\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"wkid-label jimu-ellipsis" data-dojo-attach-point\x3d"wkidLabel"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;" data-dojo-attach-point\x3d"labelsTitleNode"\x3e\r\n                    ${nls.labels}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"labelsFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                ${nls.showLabels}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'showLabels\',value:true,checked:true" /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapMetadata}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutMetadataDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"authorTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.author}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-attach-point\x3d"authorNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'author\',trim:true,required:false,style:\'width:100%;\'" data-dojo-attach-point\x3d"authorTB"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"copyrightTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.copyright}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3ctextarea data-dojo-attach-point\x3d"copyrightNode" name\x3d"copyright"\r\n                                    data-dojo-type\x3d"dijit/form/SimpleTextarea"\r\n                                    style\x3d"width:100%;height:60px;resize:none;"\x3e\x3c/textarea\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"customTextElementsDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5" style\x3d"width:100%;" data-dojo-attach-point\x3d"customTextElementsTable"\x3e\r\n\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"legendTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.lncludeLegend}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'legend\',value:true,checked:true"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"scalebarTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.scaleBarUnit}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'scalebarUnit\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"scalebarUnitDijit"\x3e\r\n                                    \x3coption value\x3d"Miles" selected\x3d"selected"\x3e${nls.unitsMiles}\x3c/option\x3e\r\n                                    \x3coption value\x3d"Kilometers"\x3e${nls.unitsKilometers}\x3c/option\x3e\r\n                                    \x3coption value\x3d"Meters"\x3e${nls.unitsMeters}\x3c/option\x3e\r\n                                    \x3coption value\x3d"Feet"\x3e${nls.unitsFeet}\x3c/option\x3e\r\n                                \x3c/select\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapOnlyOptions}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapOnlyFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.width}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'width\',required:true,value:670,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.height}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'height\',required:true,value:500,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.printQualityOptions}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapQualityFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.dpi}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'dpi\',required:true,value:96,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.forceFeatureAttributes}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"forceAttributesFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                ${nls.includeFeatureAttributes}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'forceFeatureAttributes\',value:true,checked:false" /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"printButtonDijit"\r\n            data-dojo-attach-event\x3d"onclick:print"\x3e\x3cdiv class\x3d"btn-icon printIcon"\x3e\x3c/div\x3e${nls.print}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- \x3chr calss\x3d"spacer"\x3e --\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"printResultsNode" class\x3d"resultsContainer"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"clearActionBarNode" class\x3d"buttonActionBar"\r\n    style\x3d"display:none;padding:0;"\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-event\x3d"onclick:clearResults"\x3e\r\n            \x3cdiv class\x3d"btn-icon clearIcon"\x3e\x3c/div\x3e${nls.clearList}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Print/templates/PrintResult.html":'\x3cdiv class\x3d"printResult" data-dojo-attach-point\x3d"resultNode" data-dojo-attach-event\x3d"onclick:_openPrint"\x3e\r\n  \x3ctable class\x3d"printResultTable"\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd width\x3d"25px"\x3e\r\n        \x3cspan class\x3d"bold"\x3e${count}.\x3c/span\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd width\x3d"30px"\x3e\r\n        \x3cimg src\x3d"${icon}"\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"nameNode"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"progressBar" data-dojo-type\x3d"dijit/ProgressBar" data-dojo-props\x3d\'value:Infinity\'\x3e\x3c/div\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"successNode" class\x3d"bold" style\x3d"display:none;"\x3e${docName}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"errNode" style\x3d"display:none;"\x3e\r\n          \x3cspan class\x3d"bold"\x3e${nls.printError}\x3c/span\x3e\r\n          \x3cdiv class\x3d"jimu-icon jimu-icon-error jimu-float-trailing"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:widgets/Print/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"printNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Print/css/style.css":".jimu-widget-print{width: 100%; height: 100%; position: relative;}.jimu-widget-print .dijitSelect{height: 20px; width: 100%;}.gis_PrintDijit {width: 100%;}.gis_PrintDijit .printResult {height: 28px; margin-bottom: -1px; width: 100%;}.gis_PrintDijit .printResult .printResultTable {width: 100%;}.gis_PrintDijit .printResult .bold {font-weight: bold;}.gis_PrintDijit .printResultError {font-weight: bold; color: red; cursor: help;}.gis_PrintDijit .printResultHover table:hover {background-color: #D4E7F8; cursor: pointer;}.gis_PrintDijit .buttonActionBar {padding: 3px 0px 2px 0px; width: 100%;}.gis_PrintDijit .formContainer {margin-bottom: -1px; width: 100%;}.gis_PrintDijit .resultsContainer {width: 100%; margin-top: 10px;}.gis_PrintDijit .btn-icon {width: 16px; height: 16px; display: inline-block; vertical-align: text-top; margin-right: 10px;}.jimu-rtl .gis_PrintDijit .btn-icon {margin-right: auto; margin-left: 10px;}.gis_PrintDijit .printIcon {background-image: url(../images/print.png);}.gis_PrintDijit .clearIcon {background-image: url(../images/clear.png);}.gis_PrintDijit .settingsIcon {background-image: url(../images/settings.png); width: 16px; height: 16px;}.gis_PrintDijit .dijitArrowButtonContainer{width: 17px;}.gis_PrintDijit .wkid-label{font-size: 12px; font-style: italic; color: #a0acbf; width: 100%;}",
"*now":function(c){c(['dojo/i18n!*preload*widgets/Print/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidget jimu/portalUtils dojo/_base/lang dojo/Deferred jimu/dijit/Message jimu/dijit/LoadingIndicator ./Print esri/request jimu/portalUrlUtils".split(" "),function(c,q,r,t,w,g,m,n,e,b){return c([q],{baseClass:"jimu-widget-print",name:"Print",className:"esri.widgets.Print",_portalPrintTaskURL:null,postCreate:function(){this.inherited(arguments);this.shelter=new m({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup()},startup:function(){this.inherited(arguments);
this.shelter.show();this._initPrinter()},destroy:function(){this.print&&this.print.closeSettings();this.inherited(arguments)},onClose:function(){this.print&&this.print.closeSettings()},_initPrinter:function(){this._getPrintTaskURL(this.appConfig.portalUrl).then(t.hitch(this,function(b){this.shelter.show();this.isAsync(b).then(t.hitch(this,function(c){this.print=new n({map:this.map,appConfig:this.appConfig,printTaskURL:b,defaultAuthor:this.config.defaultAuthor,defaultCopyright:this.config.defaultCopyright,
copyrightEditable:!1!==this.config.copyrightEditable,defaultTitle:this.config.defaultTitle,defaultFormat:this.config.defaultFormat,defaultLayout:this.config.defaultLayout,nls:this.nls,async:c});this.print.placeAt(this.printNode);this.print.startup()}),t.hitch(this,function(b){new g({message:b.message})})).always(t.hitch(this,function(){this.shelter.hide()}))}),t.hitch(this,function(b){new g({message:b});console.error(b);this.shelter.hide()}))},_getPrintTaskURL:function(b){var c=new w;if(this.config&&
this.config.serviceURL)return c.resolve(this.config.serviceURL),c;r.getPortalSelfInfo(b).then(t.hitch(this,function(a){(a=a&&a.helperServices&&a.helperServices.printTask&&a.helperServices.printTask.url)?c.resolve(a):c.reject("error")}),t.hitch(this,function(a){new g({message:this.nls.portalConnectionError});c.reject("error");console.error(a)}));return c},isAsync:function(c){var f=new w,a=b.setHttpProtocol(c),g=b.getNewPrintUrl(this.appConfig.portalUrl);a===g||/sharing\/tools\/newPrint$/.test(a)?f.resolve(!1):
e({url:c,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4,load:t.hitch(this,function(a){"esriExecutionTypeAsynchronous"===a.executionType?f.resolve(!0):f.resolve(!1)}),error:t.hitch(this,function(a){f.reject(a)})});return f},onSignIn:function(b){b=b||{};b.userId&&this.print&&this.print.updateAuthor(b.userId)}})});