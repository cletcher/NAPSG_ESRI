// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/dijit/Scalebar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/query ../kernel ../lang ../domUtils ../units ../SpatialReference ../WKIDUnitConversion ../geometry/Point ../geometry/ScreenPoint ../geometry/Polyline ../geometry/geodesicUtils ../geometry/webMercatorUtils ../geometry/screenUtils ../geometry/normalizeUtils dojo/i18n!../nls/jsapi".split(" "),function(m,
f,k,c,q,l,z,v,A,n,B,t,u,b,g,w,x,D,E,C,y,F,G,H){m=m(null,{declaredClass:"esri.dijit.Scalebar",map:null,mapUnit:null,scalebarUnit:null,unitsDictionary:[],domNode:null,screenPt1:null,screenPt2:null,localStrings:H.widgets.scalebar,constructor:function(a,b){this.metricScalebar=l.create("div",{innerHTML:"\x3cdiv class\x3d'esriScaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarLineLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLine esriScalebarMetricLine'\x3e\x3c/div\x3e"});
this.englishScalebar=l.create("div",{innerHTML:"\x3cdiv class\x3d'esriScalebarLine esriScalebarEnglishLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarLineLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e"});this.domNode=l.create("div");a=a||{};if(a.map){if(a.scalebarUnit){if("english"!==a.scalebarUnit&&"metric"!==a.scalebarUnit&&"dual"!==a.scalebarUnit){console.error("scalebar unit only accepts english or metric or dual");return}this.scalebarUnit=
a.scalebarUnit}else this.scalebarUnit="english";if(a.scalebarStyle){if("ruler"!==a.scalebarStyle&&"line"!==a.scalebarStyle){console.error("scalebar style must be ruler or line");return}this.scalebarStyle=a.scalebarStyle}else this.scalebarStyle="ruler";this.background=a.background;switch(this.scalebarUnit){case "english":"ruler"===this.scalebarStyle&&(this.englishScalebar.innerHTML="\x3cdiv class\x3d'esriScalebarRuler'\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_secondpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_secondpiece'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'scaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel' style\x3d'left: -3%'\x3e0\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarFirstNumber'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e");
this.domNode.appendChild(this.englishScalebar);break;case "metric":"ruler"===this.scalebarStyle&&(this.metricScalebar.innerHTML="\x3cdiv class\x3d'esriScalebarRuler'\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_secondpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_secondpiece'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'scaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel' style\x3d'left: -3%'\x3e0\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarFirstNumber'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e");
this.domNode.appendChild(this.metricScalebar);break;case "dual":this.domNode.appendChild(this.metricScalebar),this.domNode.appendChild(this.englishScalebar)}this.map=a.map;b?b.appendChild(this.domNode):(this.map.container.appendChild(this.domNode),a.attachTo?q.add(this.domNode,"scalebar_"+a.attachTo):q.add(this.domNode,"scalebar_bottom-left"));q.add(this.domNode,"esriScalebar");if(this.map.loaded)this._getDistance(),this._checkBingMaps();else var d=c.connect(this.map,"onLoad",this,function(){c.disconnect(d);
d=null;this._getDistance();this._checkBingMaps()});this._mapOnPan=c.connect(this.map,"onPan",this,this._getDistance);this._mapOnExtentChange=c.connect(this.map,"onExtentChange",this,this._getDistance);k.forEach(this.map.layerIds,function(a,b){"esri.virtualearth.VETiledLayer"===this.map.getLayer(a).declaredClass&&c.connect(this.map.getLayer(a),"onVisibilityChange",f.hitch(this,function(a){this._checkBingMaps()}))},this);this._mapOnLayerAdd=c.connect(this.map,"onLayerAdd",f.hitch(this,function(a){"esri.virtualearth.VETiledLayer"===
a.declaredClass&&c.connect(a,"onVisibilityChange",f.hitch(this,function(a){this._checkBingMaps()}));this._checkBingMaps()}));this._mapOnLayerRemove=c.connect(this.map,"onLayerRemove",f.hitch(this,this._checkBingMaps))}else console.error("scalebar: unable to find the 'map' property in parameters")},hide:function(){this._hidden=!0;u.hide(this.domNode)},show:function(){this._hidden=!1;u.show(this.domNode)},destroy:function(){c.disconnect(this._mapOnPan);c.disconnect(this._mapOnExtentChange);c.disconnect(this._mapOnLayerAdd);
c.disconnect(this._mapOnLayerRemove);this.hide();this.map=null;l.destroy(this.domNode)},_checkBingMaps:function(){q.contains(this.domNode,"scalebar_bottom-left")&&(v.set(this.domNode,"left","25px"),k.forEach(this.map.layerIds,function(a,b){"esri.virtualearth.VETiledLayer"===this.map.getLayer(a).declaredClass&&this.map.getLayer(a).visible&&(a="95px",this.map._mapParams.nav&&(a="115px"),v.set(this.domNode,"left",a))},this))},_getDistance:function(a){a=this.map._clip?this.map._getAvailExtent():a||this.map.extent;
var d=z.position(this.domNode,!0).y-this.map.position.y,d=d>this.map.height?this.map.height:d,d=0>d?0:d,p=new D(0,d),d=new D(this.map.width,d),h,r;this.mapUnit="esriDecimalDegrees";var e=F.toMapPoint(a,this.map.width,this.map.height,p),c=F.toMapPoint(a,this.map.width,this.map.height,d),p=new x(a.xmin,(a.ymin+a.ymax)/2,this.map.spatialReference),d=new x(a.xmax,(a.ymin+a.ymax)/2,this.map.spatialReference);this.map._clip&&(c=this.map.spatialReference._getInfo(),e=new x(c.valid[0],0,this.map.spatialReference),
c=new x(c.valid[1],0,this.map.spatialReference));if(3857===this.map.spatialReference.wkid||102100===this.map.spatialReference.wkid||102113===this.map.spatialReference.wkid||this.map.spatialReference.wkt&&-1!=this.map.spatialReference.wkt.indexOf("WGS_1984_Web_Mercator"))e=y.webMercatorToGeographic(e,!0),c=y.webMercatorToGeographic(c,!0),p=y.webMercatorToGeographic(p,!0),d=y.webMercatorToGeographic(d,!0);else if(t.isDefined(w[this.map.spatialReference.wkid])||this.map.spatialReference.wkt&&0===this.map.spatialReference.wkt.indexOf("PROJCS")){this.mapUnit=
"linearUnit";a=Math.abs(a.xmax-a.xmin);if(t.isDefined(w[this.map.spatialReference.wkid]))h=w.values[w[this.map.spatialReference.wkid]];else{h=this.map.spatialReference.wkt;r=h.lastIndexOf(",")+1;var f=h.lastIndexOf("]]");h=parseFloat(h.substring(r,f))}a*=h;r=a/1609;h=a/1E3;a/=1E3}"esriDecimalDegrees"===this.mapUnit&&(h=C.isSupported(this.map.spatialReference)?this.map.spatialReference.wkid:4326,a=new E(new g({wkid:h})),a.addPath([e,c]),e=G._straightLineDensify(a,10),a=C.geodesicLengths([e],b.KILOMETERS)[0],
e=new E(new g({wkid:h})),e.addPath([p,d]),p=G._straightLineDensify(e,10),C.geodesicLengths([p],b.KILOMETERS),r=a/1.609,h=a);"english"===this.scalebarUnit?this._getScaleBarLength(r,"mi"):"metric"===this.scalebarUnit?this._getScaleBarLength(h,"km"):"dual"===this.scalebarUnit&&(this._getScaleBarLength(r,"mi"),this._getScaleBarLength(h,"km"))},_getScaleBarLength:function(a,b){var c=this.map._getFrameWidth();a=50*a/(this.map._clip&&0<c?c:this.map.width);var c=0,g=b;.1>a&&("mi"===b?(a*=5280,g="ft"):"km"===
b&&(a*=1E3,g="m"));for(;1<=a;)a/=10,c++;var d,e;.5<a?(d=1,e=.5):.3<a?(d=.5,e=.3):.2<a?(d=.3,e=.2):.15<a?(d=.2,e=.15):.1<=a&&(d=.15,e=.1);b=d/a>=a/e?e:d;this._drawScaleBar(b/a*50,Math.pow(10,c)*b,g)},_drawScaleBar:function(a,b,c){var g=2*Math.round(a),d,e;"mi"===c||"ft"===c?(this.englishScalebar.style.width=g+"px",a=n(".esriScalebarFirstNumber",this.englishScalebar),d=n(".esriScalebarSecondNumber",this.englishScalebar),e=n(".esriScalebarMetricLineBackground",this.englishScalebar)):(this.metricScalebar.style.width=
g+"px",a=n(".esriScalebarFirstNumber",this.metricScalebar),d=n(".esriScalebarSecondNumber",this.metricScalebar),e=n(".esriScalebarMetricLineBackground",this.metricScalebar));k.forEach(e,function(a,b){a.style.width=g-2+"px"},this);k.forEach(a,function(a,c){a.innerHTML=b},this);k.forEach(d,function(a,g){a.innerHTML="esriUnknown"!==this.mapUnit?2*b+this.localStrings[c]:2*b+"Unknown Unit"},this)}});A("extend-esri")&&f.setObject("dijit.Scalebar",m,B);return m})},"widgets/Scalebar/_build-generate_module":function(){define(["dojo/text!./css/style.css",
"dojo/i18n!./nls/strings"],function(){})},"url:widgets/Scalebar/css/style.css":".jimu-rtl .jimu-widget-scalebar .scaleLabelDiv .esriScalebarLabel:first-child{right: -3% !important; left: auto !important;};.jimu-rtl .jimu-widget-scalebar .scaleLabelDiv .esriScalebarFirstNumber{right: 45% !important; left: auto;}.jimu-rtl .jimu-widget-scalebar .scaleLabelDiv .esriScalebarSecondNumber{right: 95%; left: auto;}.jimu-widget-scalebar .ruler-style {position: relative; top: -5px !important; left: 0 !important;}.jimu-widget-scalebar .esriScalebarLine.esriScalebarEnglishLine{box-shadow: inset 1px 1px #fff, inset -1px 1px #fff, 0px -1px 0px 0px #fff, -1px -1px 0px 0px #fff, 1px -1px 0px 0px #fff;}.jimu-widget-scalebar .esriScalebarLine.esriScalebarMetricLine {box-shadow: inset 1px 0px #fff, inset -1px -1px #fff, 0px 1px 0px 0px #fff, 1px 0px 0px 0px #fff, -1px 0px 0px 0px #fff;}.jimu-widget-scalebar .esriScaleLabelDiv,.jimu-widget-scalebar .scaleLabelDiv{text-shadow: -1px -1px 0px #fff, 1px -1px 0px #fff, -1px 1px 0px #fff, 1px 1px 0px #fff;}.jimu-widget-scalebar .esriScalebarRuler {box-shadow: 0px -1px 0px #fff, 1px 0px 0px #fff, 0px 1px 0px #fff, -1px 0px 0px #fff;}.jimu-widget-scalebar .scalebar-line{color:#666; height: auto;}.jimu-widget-scalebar .hide{display: none !important;}",
"*now":function(m){m(['dojo/i18n!*preload*widgets/Scalebar/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Deferred jimu/BaseWidget jimu/utils jimu/portalUtils jimu/dijit/Message esri/dijit/Scalebar dojo/on esri/geometry/scaleUtils dojo/dom-style dojo/query dojo/NodeList-dom".split(" "),function(m,f,k,c,q,l,z,v,A,n,B,t,u){return m([q],{baseClass:"jimu-widget-scalebar",name:"Scalebar",scalebar:null,moveTopOnActive:!1,startup:function(){this.inherited(arguments);var b=f.clone(this.config.scalebar);b.map=this.map;this.position&&(void 0!==this.position.top&&
void 0!==this.position.left?b.attachTo="top-left":void 0!==this.position.top&&void 0!==this.position.right?b.attachTo="top-right":void 0!==this.position.bottom&&void 0!==this.position.left?b.attachTo="bottom-left":void 0!==this.position.bottom&&void 0!==this.position.right&&(b.attachTo="bottom-right"));this._processConfig(b).then(f.hitch(this,function(b){b.scalebarStyle||(b.scalebarStyle="line");this.scalebar=new A(b);this.scalebar.show();this.domNode.appendChild(this.scalebar.domNode);this._hackForhighlight();
"ruler"===b.scalebarStyle?k.addClass(this.scalebar.domNode,"ruler-style"):k.removeClass(this.scalebar.domNode,"ruler-style");var c={left:"auto",right:"auto",top:"auto",bottom:"auto",width:"auto"};f.mixin(c,this.position);t.set(this.domNode,l.getPositionStyle(c));this._isNumberStyle()&&(this._createNumberStyleContainer(),this._showNumberScale());this._set508Label();setTimeout(f.hitch(this,function(){this.domNode&&(t.set(this.domNode,l.getPositionStyle(c)),this.own(n(this.map,"extent-change",f.hitch(this,
this.onExtentChange))))}),1E3)}),f.hitch(this,function(b){new v({message:b.message||b})}))},_processConfig:function(b){var g=new c;this._isNumberStyle()&&(b.scalebarStyle="line");b.scalebarUnit?g.resolve(b):z.getUnits(this.appConfig.portalUrl).then(f.hitch(this,function(c){b.scalebarUnit="english"===c?"english":"metric";g.resolve(b)}));return g.promise},_hackForhighlight:function(){u(".esriScalebar",this.domNode).removeClass("esriScalebar")},onClose:function(){this.scalebar.destroy()},_createNumberStyleContainer:function(){for(var b=
"top-right bottom-right top-center bottom-center bottom-left top-left".split(" "),c=0,f=b.length;c<f;c++)u(".scalebar_"+b[c],this.domNode).addClass("hide");this.numberStyleContainer=k.create("div",{"class":"number-style"},this.domNode)},_isNumberStyle:function(){return"number"===this.config.scalebar.scalebarStyle},onExtentChange:function(){this._set508Label();this._refreshTooltip();this._isNumberStyle()&&this._showNumberScale()},_getScaleString:function(){var b=B.getScale(this.map);isNaN(b)?b="":
(b=l.localizeNumberByFieldInfo(b,{format:{places:this.config.scalebar.decimalPlaces,digitSeparator:this.config.scalebar.addSeparator}}),b=window.isRTL?b+":1":"1:"+b);return b},_showNumberScale:function(){this.numberStyleContainer.innerHTML="\x3cdiv class\x3d'scaleLabelDiv scalebar-line'\x3e"+this._getScaleString()+"\x3c/div\x3e"},_set508Label:function(b){var c,f=this._getScaleString();b?c=b:f&&(c=this.nls.scale+" "+f);k.setAttr(this.domNode,"aria-label",c)},_refreshTooltip:function(){l.isInNavMode()&&
k.hasClass(document.activeElement,this.baseClass)&&(this.domNode.blur(),this.domNode.focus())}})});