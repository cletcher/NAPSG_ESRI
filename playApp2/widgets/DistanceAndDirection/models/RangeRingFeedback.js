// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/topic esri/graphic esri/toolbars/draw esri/geometry/Circle esri/geometry/Polyline esri/geometry/geometryEngine jimu/utils ./Feedback".split(" "),function(g,d,e,h,f,k,l,m,n,p,q){return g([q],{constructor:function(a){g.safeMixin(this,a);this.syncEvents();this.circlePoints=[]},syncEvents:function(){h.subscribe("manual-rangering-center-point-input",d.hitch(this,this.onCenterPointManualInputHandler));h.subscribe("clear-points",d.hitch(this,
this.clearPoints))},clearPoints:function(a){a&&(this._points=[],this.map.graphics.clear())},clearGraphics:function(){this.map.graphics.clear()},onCenterPointManualInputHandler:function(a){this._points=[];this._points.push(a.offset(0,0));this.set("startPoint",this._points[0]);this.map.centerAt(a)},_onClickHandler:function(a){var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);b=b||a.mapPoint;a=this.map;this._points.push(b.offset(0,0));1===this._points.length&&this.set("startPoint",
this._points[0]);this.circlePoints.push(b.offset(0,0));switch(this._geometryType){case k.POINT:this._drawEnd(b.offset(0,0));this._setTooltipMessage(0);break;case k.POLYLINE:b=new m({paths:[[[b.x,b.y],[b.x,b.y]]],spatialReference:a.spatialReference}),this.lgraphic=new f(b,this.lineSymbol),a.snappingManager&&a.snappingManager._setGraphic(this._graphic),1<this._points.length&&this.circleGraphic&&(a=new f(this.circleGraphic.geometry,this.fillSymbol),this.map.graphics.add(a)),0<this._points.length&&(this._onMouseMoveHandler_connect||
(this._onMouseMoveHandler_connect=e.connect(this.map,"onMouseMove",this._onMouseMoveHandler)),this._onDoubleClickHandler_connect||(this._onDoubleClickHandler_connect=e.connect(this.map,"onDblClick",d.hitch(this,this._onDoubleClickHandler))))}this._setTooltipMessage(this._points.length);1<this._points.length&&(a=this._tooltip)&&(a.innerHTML=p.sanitizeHTML(this.nls.doubleClickEllipseMesage))},_onMouseMoveHandler:function(a){var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);
var c=this._points[0];a=b||a.mapPoint;b=this.lgraphic.geometry;b.setPoint(0,0,{x:c.x,y:c.y});b.setPoint(0,1,{x:a.x,y:a.y});a=n.geodesicLength(b,9001);c=new l(c,{radius:a,geodesic:!0,numberOfPoints:360});this.circleGraphic&&this.map.graphics.remove(this.circleGraphic);c=d.mixin(c,{distanceDirectionType:"military-tools-range-rings"});this.circleGraphic=new f(c,this.fillSymbol);this.map.graphics.add(this.circleGraphic)},_onDoubleClickHandler:function(){this.disconnectOnMouseMoveHandlers();var a=d.clone(this.circlePoints);
this.cleanup();this._clear();this._setTooltipMessage(0);a=d.mixin(this.circleGraphic.geometry,{circlePoints:a});this._drawEnd(a)},disconnectOnMouseMoveHandlers:function(){e.disconnect(this._onMouseMoveHandler_connect);e.disconnect(this._onDoubleClickHandler_connect);this._onDoubleClickHandler_connect=null},cleanup:function(){for(var a=this.map.graphics.graphics.length-1;0<=a;a--)this.map.graphics.graphics[a].geometry.hasOwnProperty("distanceDirectionType")&&this.map.graphics.remove(this.map.graphics.graphics[a]);
this.circlePoints=[]}})});