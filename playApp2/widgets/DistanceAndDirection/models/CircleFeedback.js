// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/topic esri/graphic esri/toolbars/draw esri/geometry/Circle esri/geometry/Polyline esri/geometry/geometryEngine ./Feedback".split(" "),function(g,e,h,f,l,k,m,n,p,d){d=g([d],{constructor:function(a){g.safeMixin(this,a);this.syncEvents()},clearGraphics:function(){this.map.graphics.clear()},syncEvents:function(){f.subscribe("MANUAL_CIRCLE_RADIUS_INPUT",e.hitch(this,this.manualRadiusUpdate));f.subscribe("manual-circle-center-point-input",
e.hitch(this,this.onCenterPointManualInputHandler));f.subscribe("clear-points",e.hitch(this,this.clearPoints))},clearPoints:function(a){a&&(this._points=[],this.map.graphics.clear())},onCenterPointManualInputHandler:function(a){this._points=[];this._points.push(a.offset(0,0));this.set("startPoint",this._points[0]);this.map.centerAt(a)},manualRadiusUpdate:function(){this.circleGraphic&&this.map.graphics.remove(this.circleGraphic)},_onClickHandler:function(a){var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);
a=b||a.mapPoint;this._points.push(a);switch(this._geometryType){case k.POINT:this.set("startPoint",a);this._drawEnd(a.offset(0,0));this._setTooltipMessage(0);break;case k.POLYLINE:switch(this._points.length){case 1:this.set("startPoint",a);this._onMouseMoveHandlerConnect=h.connect(this.map,"onMouseMove",this._onMouseMoveHandler);break;case 2:this._onDoubleClickHandler()}this._setTooltipMessage(this._points.length)}},_onMouseMoveHandler:function(a){var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);
a=b||a.mapPoint;a=this.setCircleGeometry(this.get("startPoint"),a);this.cleanup();this.circleGraphic=new l(a,this.fillSymbol);this.map.graphics.add(this.circleGraphic)},_onDoubleClickHandler:function(){this.disconnectOnMouseMoveHandler();this.cleanup();this._clear();this._setTooltipMessage(0);this.circleGraphic&&this._drawEnd(this.circleGraphic.geometry)},disconnectOnMouseMoveHandler:function(){h.disconnect(this._onMouseMoveHandlerConnect)},cleanup:function(){this.circleGraphic&&this.map.graphics.remove(this.circleGraphic)},
setCircleGeometry:function(a,b){var c=new n(this.map.spatialReference);c.addPath([a,b]);b=p.geodesicLength(c,9001);c=this.coordTool.convertMetersToUnits(b,this.lengthUnit);this.isDiameter&&(c*=2);this.set("length",c);return new m(a,{radius:b,geodesic:!0,numberOfPoints:360})}});d.DD_CIRCLE_LENGTH_DID_CHANGE="DD_CIRCLE_LENGTH_DID_CHANGE";return d});