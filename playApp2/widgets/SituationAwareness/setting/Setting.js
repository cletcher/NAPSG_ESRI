// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/SituationAwareness/setting/FieldPicker":function(){define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dijit/form/Select dijit/form/ValidationTextBox dijit/registry dojo/dom-construct dojo/_base/array dojo/_base/lang dojo/_base/html dojo/dom-style dojo/dom-class dojo/Deferred dojo/on dojo/query jimu/BaseWidget jimu/dijit/Message jimu/utils jimu/dijit/Popup jimu/dijit/CheckBox esri/layers/FeatureLayer dojo/text!./FieldPicker.html dojo/Evented jimu/dijit/SimpleTable ./FieldOptions".split(" "),
function(k,p,l,n,f,b,d,a,c,h,m,e,q,r,v,g,u,A,w,x,F,G,D,H){return k([v,p,G],{templateString:F,baseClass:"jimu-widget-SAT-setting",advStat:{},fieldsList:null,callerLayer:null,callerTab:null,callerOpLayers:null,layerList:null,test:!1,fields:null,hasFields:!0,areaOptions:{},lengthOptions:{},constructor:function(a){this.map=a.map;a.test&&(this.test=a.test)},postMixInProperties:function(){this.inherited(arguments);this.nls.common=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.startup()},
_initCheckBoxes:function(){this.chk_count_only=this._initCheckBox(this.nls.count_checkBox,this.div_chkCountOnly);this.own(q(this.chk_count_only,"change",a.hitch(this,this.chkCountChanged)));this.chk_count=this._initCheckBox(this.nls.count_checkBox,this.div_chkCount);this.own(q(this.chk_count,"change",a.hitch(this,this.chkCountChanged)));this.chk_area=this._initCheckBox(this.nls.area_checkBox,this.div_chkArea);this.own(q(this.chk_area,"change",a.hitch(this,this.chkAreaChanged)));this.editAreaOptions=
this._initValueOptions(this.div_chkArea);this.own(q(this.editAreaOptions,"click",a.hitch(this,this.showAreaOptions)));this.chk_length=this._initCheckBox(this.nls.length_checkBox,this.div_chkLength);this.own(q(this.chk_length,"change",a.hitch(this,this.chkLengthChanged)));this.editLengthOptions=this._initValueOptions(this.div_chkLength);this.own(q(this.editLengthOptions,"click",a.hitch(this,this.showLengthOptions)))},_initCheckBox:function(a,t){var y=new w;y.setLabel(a);y.placeAt(t);return y},_initValueOptions:function(a){a=
b.create("div",{className:"float-right edit-options edit-fields"},a);a.setStatus=this._setStatus;return a},_setStatus:function(a){var t=a?"edit-fields-disabled":"edit-fields";a=a?"edit-fields":"edit-fields-disabled";m.contains(this,t)&&m.remove(this,t);m.add(this,a)},startup:function(){var b=null;this.test||(b="summary"===this.callerTab.type?[{name:"layer",title:this.nls.fieldTitle,"class":"label",type:"empty",width:"250px"},{name:"label",title:this.nls.layerLabel,"class":"label",type:"empty",width:"200px"},
{name:"type",title:this.nls.typeTitle,"class":"sumlabel",type:"empty",width:"150px"},{name:"actions",title:this.nls.actionsTitle,"class":"actions",type:"actions",actions:["up","down","edit","delete"]}]:"groupedSummary"===this.callerTab.type?[{name:"layer",title:this.nls.groupByField,"class":"label",type:"empty",width:"40%"},{name:"label",title:this.nls.layerLabel,"class":"label",type:"empty",width:"20%"},{name:"type",title:this.nls.labelType,"class":"label",type:"empty",width:"20%"}]:[{name:"layer",
title:this.nls.fieldTitle,"class":"label",type:"empty",width:"60%"},{name:"label",title:this.nls.layerLabel,"class":"label",type:"empty",width:"200px"},{name:"actions",title:this.nls.actionsTitle,"class":"actions",type:"actions",actions:["up","down","edit","delete"],width:"40%"}],this.displayFieldsTable=new D({fields:b}),this.displayFieldsTable.placeAt(this.fieldTable),c.setStyle(this.displayFieldsTable.domNode,{height:"100%"}),this.displayFieldsTable.startup(),this.operationsList=[],"summary"===
this.callerTab.type?this.operationsList.push({value:"sum",label:this.nls.sum},{value:"avg",label:this.nls.avg},{value:"min",label:this.nls.min},{value:"max",label:this.nls.max}):"groupedSummary"===this.callerTab.type&&this.operationsList.push({value:"pre",label:this.nls.prefix},{value:"suf",label:this.nls.suffix}),this._initCheckBoxes(),"summary"===this.callerTab.type?(h.set(this.chk_summary,"display","block"),h.set(this.chk_summaryLabels,"display","block"),h.set(this.chk_countOnly,"display","none"),
h.set(this.editAreaOptions,"display","block"),h.set(this.editLengthOptions,"display","block")):(h.set(this.chk_countOnly,"display","block"),h.set(this.chk_summary,"display","none"),h.set(this.chk_summaryLabels,"display","none"),h.set(this.editAreaOptions,"display","none"),h.set(this.editLengthOptions,"display","none")),this.btnCancel.innerText=this.nls.common.cancel,this.own(q(this.btnCancel,"click",a.hitch(this,function(){this.emit("cancel")}))),this.btnOk.innerText=this.nls.common.ok,this.own(q(this.btnOk,
"click",a.hitch(this,function(){if(!m.contains(this.btnOk,"jimu-state-disabled")){this.updateSummaryType();var a=!1,b;for(b in this.advStat.stats)this.advStat.stats.hasOwnProperty(b)&&(a=!0);a||(this.advStat=null);this._addFieldOrder();this.emit("ok",this.advStat)}}))),this.layerTables=[],this.summaryLayers=[],this.advStat={},this._getAllValidLayers().then(a.hitch(this,function(){"groupedSummary"===this.callerTab.type?(h.set(this.btnAddField,"display","none"),this.hasFields&&this._addTabRow()):this.hasFields&&
(this.addHandler=this.own(q(this.btnAddField,"click",a.hitch(this,this._addTabRow))),this.own(q(this.displayFieldsTable,"row-delete",a.hitch(this,this._rowDeleted))),this.own(q(this.displayFieldsTable,"actions-edit",a.hitch(this,this._rowEdit))))})))},_addFieldOrder:function(){var a=[],t=this.displayFieldsTable.getRows();d.forEach(t,function(t){t.selectTypes?a.push({fieldName:t.selectFields.value,fieldType:t.selectTypes.value}):a.push(t.selectFields.value)});1<a.length&&(this.advStat.fieldOrder=a)},
_updateGeomOptions:function(a){a&&(this.chk_area.setStatus("esriGeometryPolygon"===a),this.editAreaOptions.setStatus("esriGeometryPolygon"===a&&this.chk_area.checked),this.chk_length.setStatus("esriGeometryPolyline"===a),this.editLengthOptions.setStatus("esriGeometryPolyline"===a&&this.chk_length.checked))},_getAllValidLayers:function(b){var t=new e;d.forEach(this.callerOpLayers,a.hitch(this,function(a){0<a.newSubLayers.length?this._recurseOpLayers(a.newSubLayers):a.id===this.callerLayer&&(this.layerList=
a)}));if(this.layerList.layerObject.empty){if(this.layerList.layerObject.url){var c=new x(this.layerList.layerObject.url);q(c,"load",a.hitch(this,function(){this._completeMapLayers(c,b);t.resolve("sucess")}))}}else this._completeMapLayers(this.layerList,b),t.resolve("sucess");return t},_recurseOpLayers:function(b){d.forEach(b,a.hitch(this,function(a){0<a.newSubLayers.length?this._recurseOpLayers(a.newSubLayers):a.id===this.callerLayer&&(this.layerList=a)}))},_completeMapLayers:function(b,t){if(b){b=
"undefined"===typeof b.layerObject?b:b.layerObject;var c=b.geometryType;this.objectIdField=b.objectIdField;var e={url:b.url,stats:{}},g=a.clone(b.fields),h=this.getSkipFields(b),q=[];d.forEach(g,function(a){-1===h.indexOf(a.name)&&q.push(a)});this.fields=q;this.popUpFields=this._getPopupFields(b);this.advStat=e;if("undefined"===typeof t){this._updateGeomOptions(c);if(this.advStat.url){if("undefined"!==typeof this.callerTab.advStat&&this.callerTab.advStat){this.callerTab.advStat.stats?this._setFields(q):
this._setFields(q,!0);var y=a.clone(this.callerTab.advStat.stats);this.callerTab.advStat.stats&&this.callerTab.advStat.fieldOrder&&d.forEach(this.callerTab.advStat.fieldOrder,a.hitch(this,function(a){if(a=a&&a.hasOwnProperty("fieldName")?this._initFieldsByFieldOrder(y,a):this._initFieldsByName(y,a))this._populateTabTableRow(a.key,a.element),y[a.key].splice(a.index,1),0===y[a.key].length&&delete y[a.key]}));for(var x in y)"count"===x?(this.chk_count.setValue(!0),this.featureCountLabel.set("value",
y[x][0].label)):"area"===x?(this.chk_area.setValue(!0),this.featureAreaLabel.set("value",y[x][0].label),this.areaOptions=y[x][0]):"length"===x?(this.chk_length.setValue(!0),this.featureLengthLabel.set("value",y[x][0].label),this.lengthOptions=y[x][0]):"tabCount"===x?this.chk_count_only.setValue(y[x]):"undefined"===typeof this.callerTab.advStat.fieldOrder&&d.forEach(y[x],a.hitch(this,function(a){this._populateTabTableRow(x,a)}))}else this._setFields(q,!0);t=this.callerTab.advStat;if(!t||"undefined"!==
typeof t&&!t.hasOwnProperty("stats"))if(t=0<this.popUpFields.length,b=this.fieldsList.length,"groupedSummary"===this.callerTab.type&&(b=1,t||this._setFields(q)),0<b){c="summary"===this.callerTab.type?21:4;g=e=0;a:for(;g<b;g++){var A=!1,z=this.fieldsList[g];if(t){var B=this.popUpFields[g],r=0;b:for(;r<this.fieldsList.length;r++)if(z=this.fieldsList[r],z.value===B){A=!0;break b}}if(A)if(e+=1,e<c)this._addTabRow(z);else{m.add(this.btnAddField,"btn-add-disabled");break a}}3===e&&m.add(this.btnAddField,
"btn-add-disabled")}else m.add(this.btnAddField,"btn-add-disabled"),this.hasFields=!1}("groupedSummary"===this.callerTab.type&&0<this.popUpFields.length||"groupedSummary"!==this.callerTab.type)&&this._setFields(q)}}},_initFieldsByFieldOrder:function(a,b){return this._getFieldInfo(a,b.fieldType,b.fieldName)},_initFieldsByName:function(a,b){var t=["count","area","length","tabCount"],c;for(c in a)if(-1===t.indexOf(c))return this._getFieldInfo(a,c,b)},_getFieldInfo:function(a,b,c){a=a[b];for(var t=0;t<
a.length;t++){var e=a[t];if(e.expression&&e.expression===c)return{key:b,element:e,index:t,statGroup:a}}},_validatePopupFields:function(){var b=new e;this._getAllValidLayers(!0).then(a.hitch(this,function(){for(var a=[],c=0;c<this.popUpFields.length;c++){var e=this.popUpFields[c],d=0;a:for(;d<this.fields.length;d++){var g=this.fields[d];if(e===g.name){a.push(g);break a}}}this.callerTab.type="summary";this._setFields(a,!0);c=0<this.fieldsList.length;this._setFields(this.fields);b.resolve({layer:this.callerLayer,
hasPopupFields:0<a.length,hasFields:0<this.fields.length,hasSummaryPopupFields:c,hasSummaryFields:0<this.fieldsList.length,popUpFields:a,validSummaryFields:this.fieldsList,advStat:this.advStat})}));return b},_getPopupFields:function(a){var b=this.getSkipFields(a),c,e=[];this.objectIdField=a.objectIdField;if(a.infoTemplate)c=a.infoTemplate.info.fieldInfos;else if(a.url&&-1<a.url.indexOf("MapServer")){a=a.url.split("MapServer/")[1];var d=this.map.itemInfo.itemData.operationalLayers;c=null;for(var g=
0;g<d.length;g++){var m=d[g];if(m.layerObject&&m.layerObject.infoTemplates&&(m=m.layerObject.infoTemplates[a])){c=m.infoTemplate.info.fieldInfos;break}}}if(c)for(a=0;a<c.length;a++)(d=c[a])&&d.visible&&-1===b.indexOf(d.fieldName)&&e.push(d.fieldName);return e},checkStringWidth:function(a){var t=b.create("div",{"class":"visDivLength",id:"SA_VisDiv",innerHTML:a},this.domNode);a=220>t.clientWidth?!0:!1;b.destroy(t);var e=a,d=f.byNode(this.domNode).id;r(".validationBox").forEach(function(a){a=f.byNode(a);
d!==a.id&&(e=e?"Error"!==a.state:e)});(t=r(".field-picker-footer")[0])&&(e?c.removeClass(t.children[0],"jimu-state-disabled"):c.addClass(t.children[0],"jimu-state-disabled"));return a},_setFields:function(b,c){var e=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeDouble"];"summary"!==this.callerTab.type&&(e.push("esriFieldTypeString"),e.push("esriFieldTypeDate"));var t=[],g=[];d.forEach(b,a.hitch(this,function(a){-1<e.indexOf(a.type)&&(c&&this.popUpFields&&-1<this.popUpFields.indexOf(a.name)&&
g.push(a.name),t.push({label:a.alias,value:a.name}))}));1>t.length?(m.add(this.btnAddField,"btn-add-disabled"),this.hasFields=!1):this.test||(h.set(this.displayFieldsTable.domNode,"display","block"),h.set(this.btnAddField,"display","inline-block"));g.length!==this.popUpFields.length&&(this.popUpFields=g);this.fieldsList=a.clone(t)},_populateTabTableRow:function(a,b){var c=this.displayFieldsTable.addRow({});c.success&&c.tr&&(c=c.tr,this._addTabFields(c),this._addTabTypes(c),this._addTabLabel(c),c.selectFields.set("value",
b.expression),("summary"===this.callerTab.type||"groupedSummary"===this.callerTab.type||b.validLabel)&&c.labelText.set("value",b.label),c.selectTypes&&c.selectTypes.set("value",a),this._addFieldOptions(c,b));this._checkFields()},_addTabRow:function(a){var b=this.displayFieldsTable.getRows().length;"summary"!==this.callerTab.type&&3<=b?new g({message:this.nls.max_records}):"groupedSummary"===this.callerTab.type&&0<b||(b=this.displayFieldsTable.addRow({}),b.success&&b.tr&&(b=b.tr,this._addTabFields(b),
this._addTabTypes(b),this._addTabLabel(b),a&&b.selectFields.set("value",a.value),this._enableOk()),this._checkFields())},_checkFields:function(){"summary"!==this.callerTab.type&&"groupedSummary"!==this.callerTab.type&&3===this.displayFieldsTable.getRows().length&&m.add(this.btnAddField,"btn-add-disabled")},_addTabFields:function(b){var c=a.clone(this.fieldsList),e=r(".simple-table-cell",b)[0];e&&(c=new l({style:{height:"24px",width:"100%"},"class":"summary"===this.callerTab.type?"shortSelect":"longSelect",
options:c}),c.placeAt(e),c.startup(),b.selectFields=c)},_addTabLabel:function(a){var b=r(".simple-table-cell",a)[1],c=new n({style:{width:"100%",height:"24px"},"class":"validationBox"});c.invalidMessage=this.nls.invalid_string_width;c.placeAt(b);c.startup();c.validator=this.checkStringWidth;a.labelText=c},_addTabTypes:function(b){if("summary"===this.callerTab.type||"groupedSummary"===this.callerTab.type){var c=a.clone(this.operationsList),e=r(".simple-table-cell",b)[2];e&&(c=new l({style:{width:"100%",
height:"24px"},options:c}),c.placeAt(e),c.startup(),b.selectTypes=c)}},_addFieldOptions:function(a,b){a.modify=b.modify;a.round=b.round;a.truncate=b.truncate;a.roundPlaces=b.roundPlaces;a.truncatePlaces=b.truncatePlaces},getSkipFields:function(a){var b=[];if(a.fields)for(var c=0;c<a.fields.length;c++){var e=a.fields[c];e&&e.type&&e.name&&"esriFieldTypeGeometry"===e.type&&b.push(e.name)}a.globalIdField&&""!==a.globalIdField&&b.push(a.globalIdField);a.objectIdField&&""!==a.objectIdField&&b.push(a.objectIdField);
return b},getDefaultFields:function(b,c,e){var g={stats:{fields:[],tabCount:!1}};if("summary"!==e&&"groupedSummary"!==e){c=[];for(e=0;e<(3>b.length?b.length:3);e++){var m=b[e];c.push({value:0,expression:m.name,label:m.alias})}0<c.length&&(g.stats.outFields=c)}else"summary"===e&&c&&c.hasOwnProperty("length")&&0<c.length&&(g.stats.sum=[],d.forEach(c,a.hitch(this,function(a){g.stats.sum.push({value:0,expression:a.name||a.value,label:a.alias?a.alias:a.label?a.label:a.name||a.value})})));return g},updateSummaryType:function(){var b=
this.displayFieldsTable.getRows();if("summary"!==this.callerTab.type&&"groupedSummary"!==this.callerTab.type){var c=[];d.forEach(b,function(a){c.push({value:0,expression:a.selectFields.value,label:u.stripHTML(a.labelText.value),validLabel:!0,modify:a.modify,round:a.round,truncate:a.truncate,roundPlaces:a.roundPlaces,truncatePlaces:a.truncatePlaces})});0<c.length&&(this.advStat.stats.outFields=c);this.advStat.stats.tabCount=this.chk_count_only.getValue()}else this.advStat.stats.tabCount="groupedSummary"===
this.callerTab.type?this.chk_count_only.getValue():this.chk_count.getValue(),this.chk_count.getValue()&&(this.advStat.stats.count=[{value:0,expression:this.objectIdField,label:u.stripHTML(this.featureCountLabel.value?this.featureCountLabel.value:this.nls.count)}]),this.chk_area.getValue()&&(this.advStat.stats.area=[{value:0,expression:this.objectIdField,label:u.stripHTML(this.featureAreaLabel.value?this.featureAreaLabel.value:this.nls.area)}],this.areaOptions&&a.mixin(this.advStat.stats.area[0],this.areaOptions)),
this.chk_length.getValue()&&(this.advStat.stats.length=[{value:0,expression:this.objectIdField,label:u.stripHTML(this.featureLengthLabel.value?this.featureLengthLabel.value:this.nls.length)}],this.lengthOptions&&a.mixin(this.advStat.stats.length[0],this.lengthOptions)),d.forEach(b,a.hitch(this,function(a){"undefined"===typeof this.advStat.stats[a.selectTypes.value]&&(this.advStat.stats[a.selectTypes.value]=[]);for(var b={value:0,expression:a.selectFields.value,modify:a.modify,round:a.round,truncate:a.truncate,
roundPlaces:a.roundPlaces,truncatePlaces:a.truncatePlaces},c=0;c<a.selectFields.options.length;c++)if(a.selectFields.options[c].value===a.selectFields.value){b.label="groupedSummary"!==this.callerTab.type?a.labelText.value?a.labelText.value:a.selectFields.options[c].label:a.labelText.value;break}"undefined"===typeof b.label&&(b.label=b.expression);this.advStat.stats[a.selectTypes.value].push(b)}));console.log("ADVSTAT",this.advStat)},chkCountChanged:function(a){"summary"===this.callerTab.type&&(this.updateLabel(this.featureCountLabel,
a),a?this._enableOk():0===this.displayFieldsTable.getRows().length?this._disableOk():this._enableOk())},chkAreaChanged:function(a){this.updateLabel(this.featureAreaLabel,a);this.updateEdit(this.editAreaOptions,a)},showAreaOptions:function(){m.contains(this.editAreaOptions,"edit-fields-disabled")||this._showEditOptions("area")},chkLengthChanged:function(a){this.updateLabel(this.featureLengthLabel,a);this.updateEdit(this.editLengthOptions,a)},showLengthOptions:function(){m.contains(this.editLengthOptions,
"edit-fields-disabled")||this._showEditOptions("length")},_showEditOptions:function(a){this._initFieldOptions("area"===a?this.areaOptions:this.lengthOptions,a)},_initFieldOptions:function(b,c){var e=new H({nls:this.nls,tr:"area"===c?this.areaOptions:"length"===c?this.lengthOptions:b}),d=new A({width:445,autoHeight:!0,content:e,titleLabel:this.nls.fieldOptions,nls:this.nls});this.own(q(e,"ok",a.hitch(this,function(g){"area"===c?this.areaOptions=g:"length"===c?this.lengthOptions=g:a.mixin(b,g);e.destroy();
e=null;d.close()})));this.own(q(e,"cancel",a.hitch(this,function(){e.destroy();e=null;d.close()})))},updateLabel:function(a,b){a.set("disabled",!b);a.validator=this.checkStringWidth;a.invalidMessage=this.nls.invalid_string_width;b&&""===a.value&&(b="",a.id===this.featureCountLabel.id?b=this.nls.count:a.id===this.featureAreaLabel.id?b=this.nls.area:a.id===this.featureLengthLabel.id&&(b=this.nls.length),a.set("value",b));this.validateAll()},updateEdit:function(a,b){a.setStatus(b)},validateAll:function(){var a=
!0;r(".validationBox").forEach(function(b){b=f.byNode(b);a=a?"Error"!==b.state:a});var b=r(".field-picker-footer")[0];b&&(a?c.removeClass(b.children[0],"jimu-state-disabled"):c.addClass(b.children[0],"jimu-state-disabled"))},_rowDeleted:function(){this.validateAll();var a=this.displayFieldsTable.getRows();0===a.length?"summary"===this.callerTab.type&&this.chk_count.getValue()?this._enableOk():this._disableOk():this._enableOk();"summary"!==this.callerTab.type&&"groupedSummary"!==this.callerTab.type&&
3>a.length&&m.contains(this.btnAddField,"btn-add-disabled")&&m.remove(this.btnAddField,"btn-add-disabled")},_rowEdit:function(a){this._validateRowType(a.selectFields.value)?this._initFieldOptions(a,"",!1):new g({message:this.nls.onlyDouble})},_validateRowType:function(a){var b=["esriFieldTypeDouble","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle"],c=this.fields.filter(function(c){return c.name===a&&-1<b.indexOf(c.type)});return c&&0<c.length},_disableOk:function(){var a=r(".field-picker-footer")[0];
a&&c.addClass(a.children[0],"jimu-state-disabled")},_enableOk:function(){var a=r(".field-picker-footer")[0];a&&c.removeClass(a.children[0],"jimu-state-disabled")},destroy:function(){this.advStat=null}})})},"widgets/SituationAwareness/setting/FieldOptions":function(){define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dijit/form/ValidationTextBox dojo/_base/lang dojo/dom-class dojo/on jimu/BaseWidget dojo/text!./FieldOptions.html dojo/Evented jimu/dijit/CheckBox".split(" "),function(k,p,l,n,f,
b,d,a,c,h){return k([d,p,c],{templateString:a,baseClass:"jimu-widget-SAT-setting",_modify:!1,row:void 0,constructor:function(a){this.row=a.tr},postCreate:function(){this.inherited(arguments);this.startup()},startup:function(){this.own(b(this.btnCancel,"click",n.hitch(this,function(){this.emit("cancel")})));this.own(b(this.btnOk,"click",n.hitch(this,function(){f.contains(this.btnOk,"jimu-state-disabled")||this.emit("ok",{modify:this._modify,round:this.rdo_round.get("checked"),truncate:this.rdo_truncate.get("checked"),
roundPlaces:this.roundPlaces.textBox.value,truncatePlaces:this.truncatePlaces.textBox.value})})));this._initPopup()},_initPopup:function(){this._initRadio();this._initValidationTextBox(this.roundPlaces,"undefined"!==typeof this.row.roundPlaces?this.row.roundPlaces:2);this._initValidationTextBox(this.truncatePlaces,"undefined"!==typeof this.row.truncatePlaces?this.row.truncatePlaces:2);var a="undefined"!==typeof this.row.modify?this.row.modify:!1;this._initCheckBox(a);this.chkModifyChanged(a)},_initValidationTextBox:function(a,
b){var c=new l({style:{width:"60px",height:"30px"}});c.invalidMessage=this.nls.validatePlaces;c.placeAt(a);c.startup();c.validator=n.hitch(this,this._validatePlaces);c.set("value",b);a.textBox=c},_validatePlaces:function(a){(a=/^\d+$/.test(a))?this._enableOk():this._disableOk();return a},_initRadio:function(){this.own(b(this.rdo_round,"change",n.hitch(this,this.rdoChanged)));this.own(b(this.rdo_truncate,"change",n.hitch(this,this.rdoChanged)));this.rdo_round.set("checked","undefined"!==typeof this.row.round?
this.row.round:!0);this.rdo_truncate.set("checked","undefined"!==typeof this.row.truncate?this.row.truncate:!1)},_initCheckBox:function(a){this.chkModify=new h({label:this.nls.modifyValues});this.chkModify.placeAt(this.chkModifyDIV);this.own(b(this.chkModify,"change",n.hitch(this,this.chkModifyChanged)));this.chkModify.setValue(a)},chkModifyChanged:function(a){this._modify=a;this._toggleEnabled(this.rdo_round,a);this._toggleEnabled(this.rdo_truncate,a);a?this.rdoChanged():this._toggleNodes(a,a)},
rdoChanged:function(){this._toggleNodes(this.rdo_round.get("checked"),this.rdo_truncate.get("checked"))},_toggleNodes:function(a,b){this._toggleEnabled(this.roundPlaces.textBox,a);this._toggleEnabled(this.roundSignificantFigures,a);this._toggleEnabled(this.roundLabel,a);this._toggleEnabled(this.truncatePlaces.textBox,b);this._toggleEnabled(this.truncateSignificantFigures,b);this._toggleEnabled(this.truncateLabel,b)},_toggleEnabled:function(a,b){a.setDisabled&&a.setDisabled(!b);a.disabled=!b;a.set&&
a.set("disabled",!b);var c=b?"content-disabled":"content-enabled";f.contains(a,c)&&f.remove(a,c);f.add(a,b?"content-enabled":"content-disabled")},_disableOk:function(){f.contains(this.btnOk,"jimu-state-disabled")||f.add(this.btnOk,"jimu-state-disabled")},_enableOk:function(){f.contains(this.btnOk,"jimu-state-disabled")&&f.remove(this.btnOk,"jimu-state-disabled")}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare","dojo/Deferred","dojo/_base/html","dojo/_base/lang",
"./LayerChooserFromMap"],function(k,p,l,n,f){return k([f],{baseClass:"jimu-featurelayer-chooser-from-map",declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,ignoredFeaturelayerIds:null,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.ignoredFeaturelayerIds||(this.ignoredFeaturelayerIds=[]);this.basicFilter=n.hitch(this,this.basicFilter);this.filter=f.createFeaturelayerFilter(this.types,
this.showLayerFromFeatureSet,this.showTable,this.mustSupportStatistics);this.ignoreVirtualLayer&&(this.filter=f.andCombineFilters([this.filter,n.hitch(this,this._ignoreVirtualLayerFilter)]))},postCreate:function(){this.inherited(arguments);l.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},_ignoreVirtualLayerFilter:function(b){return b.getLayerType().then(function(b){return!("ArcGISDynamicMapServiceLayer"===b||"ArcGISTiledMapServiceLayer"===b||"GroupLayer"===b)})},basicFilter:function(b){var d=
new p;0<=this.ignoredFeaturelayerIds.indexOf(b.id)?d.resolve(!1):this.onlyShowVisible&&"Table"!==b.getLayerType()?d.resolve(b.isShowInMap()):d.resolve(!0);return d},getHandledItem:function(b){var d=this.inherited(arguments),a=b&&b.layerInfo,a=a&&a.layerObject;d.url=a&&a.url||"";return d}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(k,p,l,n,f,b,d,a,c,h,m,e,q,r,v,g,u,A){var w=l([n,f,b,p],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);q.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new A({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=e.hitch(this,this.basicFilter);this.filter=w.andCombineFilters([this.basicFilter,
this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(b){var c=new a;this.onlyShowVisible?c.resolve(b.isShowInMap()):c.resolve(!0);return c},filter:function(b){b=new a;b.resolve(!0);return b},getSelectedItems:function(){var a=this.tree.getSelectedItems();return r.map(a,e.hitch(this,function(a){return this.getHandledItem(a)}))},getAllItems:function(){var a=this.tree.getAllItems(),b=[];r.forEach(a,e.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),
b.push(a))}));return b},getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(a){this.createMapResponse=a;u.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(e.hitch(this,function(a){this.layerInfosObj=a;this.own(k(this.layerInfosObj,"layerInfosChanged",e.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(k(this.layerInfosObj,"layerInfosIsShowInMapChanged",
e.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(a){this._clear();q.setStyle(this.errorTipSection,"display","block");var b=[];this.onlyShowWebMapLayers?(b=a.getLayerInfoArrayOfWebmap(),b=b.concat(a.getTableInfoArrayOfWebmap())):(b=a.getLayerInfoArray(),
b=b.concat(a.getTableInfoArray()));0!==b.length&&(q.setStyle(this.errorTipSection,"display","none"),r.forEach(b,e.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(a){a&&a.getLayerObject().then(e.hitch(this,function(){this._addItem("root",a)}),e.hitch(this,function(a){console.error(a)}))},_clear:function(){var a=this._store.query({parent:"root"});r.forEach(a,e.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(a,b){var c=null,
g=b.getLayerType(),d=this.filter(b);m({layerType:g,valid:d}).then(e.hitch(this,function(g){if(g.valid){var d=e.hitch(this,function(e,d){this._id++;c={name:b.title||"",parent:a,layerInfo:b,type:g.layerType,layerClass:b.layerObject.declaredClass,id:this._id.toString(),isLeaf:e,hasChildren:d};this._store.add(c)}),h=b.getSubLayers(),q=0===h.length;q?d(q,!1):(h=r.map(h,e.hitch(this,function(a){return this.filter(a)})),m(h).then(e.hitch(this,function(a){(a=r.some(a,function(a){return a}))&&d(q,a)})))}}))},
_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var a=this._getRootItem(),a=new d({data:[a],getChildren:function(a){return this.query({parent:a.id})}});this._store=new c(a);a=new h({store:this._store,query:{id:"root"},mayHaveChildren:e.hitch(this,this._mayHaveChildren)});this.tree=new g({multiple:this.multiple,model:a,showRoot:!1,isLeafItem:e.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:e.hitch(this,function(a,b){"root"!==
a.id&&this._onTreeOpen(a,b)}),onClick:e.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,b,c)}),getIconStyle:e.hitch(this,function(a,b){var c=null;if(!a||"root"===a.id)return null;var e={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},d=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");if(a=this._getIconInfo(a,b).imageName)e.backgroundImage="url("+d+"/css/images/"+a+")",c=e;return c}),
getIconClass:e.hitch(this,function(a,b){return this._getIconInfo(a,b).className}),getTooltip:e.hitch(this,function(a){return this.displayTooltipForTreeNode?a.layerInfo.title:""})});q.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconInfo:function(a,b){var c="",e="";"ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type?b?(c="mapserver_open.png",e="mapservice-layer-icon open"):
(c="mapserver_close.png",e="mapservice-layer-icon close"):"GroupLayer"===a.type?b?(c="group_layer2.png",e="group-layer-icon open"):(c="group_layer1.png",e="group-layer-icon close"):"FeatureLayer"===a.type?(a=v.getTypeByGeometryType(a.layerInfo.layerObject.geometryType),"point"===a?(c="point_layer1.png",e="point-layer-icon"):"polyline"===a?(c="line_layer1.png",e="line-layer-icon"):"polygon"===a&&(c="polygon_layer1.png",e="polygon-layer-icon")):"Table"===a.type?(c="table.png",e="table-icon"):"ArcGISImageServiceLayer"===
a.type||"ArcGISImageServiceVectorLayer"===a.type?(c="image_layer.png",e="iamge-layer-icon"):b?(c="mapserver_open.png",e="mapservice-layer-icon open"):(c="mapserver_close.png",e="mapservice-layer-icon close");return{imageName:c,className:e}},_onTreeOpen:function(a,b){if("root"!==a.id){var c=[];b=[];c=a.layerInfo.getSubLayers();a.checked||(this.shelter.show(),b=r.map(c,e.hitch(this,function(a){return a.getLayerObject()})),m(b).then(e.hitch(this,function(){this.domNode&&(r.forEach(c,e.hitch(this,function(b){this._addItem(a.id,
b)})),a.checked=!0,this.shelter.hide())}),e.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});w.createFilterByLayerType=function(b){e.isArrayLike(b)||(b=[]);return function(c){var e=new a;if(0===b.length)e.resolve(!0);else{var d=[];c.traversal(function(a){d.push(a.getLayerType())});m(d).then(function(a){for(var c=0;c<
a.length;c++)for(var d=0;d<b.length;d++)if(a[c]===b[d]){e.resolve(!0);return}e.resolve(!1)},function(a){console.error(a);e.reject(a)})}return e}};w.createFeaturelayerFilter=function(a,b,c,e){var d=["point","polyline","polygon"];a&&0<a.length?(a=r.filter(a,function(a){return 0<=d.indexOf(a)}),0===a.length&&(a=d)):a=d;return function(d){var g=d.getLayerType();d=d.getLayerObject();return m({layerType:g,layerObject:d}).then(function(d){var g=d.layerType;d=d.layerObject;if("ArcGISDynamicMapServiceLayer"===
g||"ArcGISTiledMapServiceLayer"===g||"GroupLayer"===g||"FeatureCollection"===g)return!0;if("FeatureLayer"===g){var g=v.getTypeByGeometryType(d.geometryType),g=0<=r.indexOf(a,g),h=w._shouldPassStatisticsCheck(e,d);return d.url?(d=v.isFeaturelayerUrlSupportQuery(d.url,d.capabilities),g&&d&&h):b&&g}return"Table"===g?(g=v.isFeaturelayerUrlSupportQuery(d.url,d.capabilities),d=w._shouldPassStatisticsCheck(e,d),c&&g&&d):!1})}};w.createImageServiceLayerFilter=function(a,b){return function(c){var e=c.getLayerType();
c=c.getLayerObject();return m({layerType:e,layerObject:c}).then(function(c){var e=c.layerType,d=c.layerObject;return"ArcGISImageServiceLayer"===e||"ArcGISImageServiceVectorLayer"===e?a?v.isImageServiceSupportQuery(c.layerObject.capabilities)?b?w._shouldPassStatisticsCheck(b,d):!0:!1:!0:!1})}};w._shouldPassStatisticsCheck=function(a,b){return a?(a=!1,a=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:!!b.supportsStatistics):!0};w.createQueryableLayerFilter=function(a){var b=
w.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);a=w.createImageServiceLayerFilter(!0,a);return w.orCombineFilters([b,a])};w.andCombineFilters=function(a){return w._combineFilters(a,!0)};w.orCombineFilters=function(a){return w._combineFilters(a,!1)};w._combineFilters=function(b,c){return function(e){var d=new a,g=r.map(b,function(a){return a(e)});m(g).then(function(a){var b=!1,b=c?r.every(a,function(a){return a}):r.some(a,function(a){return a});d.resolve(b)},function(a){console.error(a);
d.reject(a)});return d}};return w})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(k,p,l,n,f,b,d){return l("dijit.tree.ObjectStoreModel",d,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(a){f.mixin(this,a);this.childrenCache={}},getRoot:function(a,c){if(this.root)a(this.root);else{var d=this.store.query(this.query);d.then&&this.own(d);
b(d,f.hitch(this,function(b){if(1!=b.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+b.length+" items, but must return exactly one");this.root=b[0];a(this.root);d.observe&&d.observe(f.hitch(this,function(a){this.onChange(a)}),!0)}),c)}},mayHaveChildren:function(){return!0},getChildren:function(a,c,d){var h=this.store.getIdentity(a);if(this.childrenCache[h])b(this.childrenCache[h],c,d);else{var e=this.childrenCache[h]=this.store.getChildren(a);e.then&&this.own(e);e.observe&&
this.own(e.observe(f.hitch(this,function(c,d,h){this.onChange(c);d!=h&&b(e,f.hitch(this,"onChildrenChange",a))}),!0));b(e,c,d)}},isItem:function(){return!0},getIdentity:function(a){return this.store.getIdentity(a)},getLabel:function(a){return a[this.labelAttr]},newItem:function(a,b,d,m){return this.store.put(a,{parent:b,before:m})},pasteItem:function(a,b,d,m,e,q){var c=new n;if(b===d&&!m&&!q)return c.resolve(!0),c;b&&!m?this.getChildren(b,f.hitch(this,function(e){e=[].concat(e);var g=k.indexOf(e,
a);e.splice(g,1);this.onChildrenChange(b,e);c.resolve(this.store.put(a,{overwrite:!0,parent:d,oldParent:b,before:q,isCopy:!1}))})):c.resolve(this.store.put(a,{overwrite:!0,parent:d,oldParent:b,before:q,isCopy:!0}));return c},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(k,p,l,n,f,b,d,a,c,h,m,e,q,r,v,g){var u=k([v._TreeNode,q],{templateString:n,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);b.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=b.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=b.toDom('\x3cinput type\x3d"checkbox" /\x3e');b.addClass(this.checkNode,"jimu-tree-check-node");b.place(this.checkNode,this.contentNode,
"first");this.own(m(this.checkNode,"click",f.hitch(this,this._onClick)));this.own(m(this.rowNode,"keydown",f.hitch(this,function(a,b){b.target=a;b.keyCode!==e.ENTER&&b.keyCode!==e.SPACE||this._onClick(b)},this.checkNode)));this.isLeaf?this.groupId?b.setStyle(this.checkNode,"display","none"):b.setStyle(this.checkNode,"display","inline"):b.setStyle(this.checkNode,"display","none");this.isLeaf?b.addClass(this.domNode,"jimu-tree-leaf-node"):b.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,b.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,b.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(f.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return k([v,q],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+g.getRandomString()},postCreate:function(){this.inherited(arguments);b.addClass(this.domNode,"jimu-tree");this.own(h.before(this,"onClick",f.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&b.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;b.setAttr(this.domNode,"tabindex",0)},removeItem:function(a){this.model.store.remove(a)},getAllItems:function(){var a=this.getAllTreeNodeWidgets();return d.map(a,f.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=d.filter(a,f.hitch(this,function(a){return a.checkNode.checked}));return d.map(a,
f.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var b=this.getAllTreeNodeWidgets(),b=d.map(b,f.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return d.filter(b,f.hitch(this,function(b){return a(b)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),c=0;c<b.length;c++){var e=r.byNode(b[c]);if(e.item.id.toString()===a.toString())return e}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},
unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return d.filter(a,f.hitch(this,function(a){return a.isLeaf}))},getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return d.map(a,f.hitch(this,function(a){return r.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return c(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);
this.multiple||(a.groupId=this.uniqueId);return new u(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,c,e){c.isLeaf&&(b.hasClass(e.target||e.srcElement,"jimu-tree-check-node")||(this.multiple?c.toggleSelect():this.selectNodeWidget(c)));return arguments},_onCheckNodeClick:function(b,
c,e){!this.multiple&&c&&this.unselectAllLeafNodeWidgets();a.stop(e);this.focusNode(b);setTimeout(f.hitch(this,function(){c?this.selectNodeWidget(b):b.unselect();this.onClick(b.item,b,e)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();d.forEach(a,f.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(k,p,l,n,f,b,d,a,c,h,m,e,q,r,v,g,u,A,w,x,F,G,D,H,y,t,C,I,L,M,J,N,Q,O,z){function B(a){return g.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var P=n("dijit._TreeNode",[y,t,C,I,L],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);q("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:J,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";h.set(this.domNode,
"backgroundPosition",b+" 0px");h.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);k.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(b,c,e){var d="_"+c+"Class";c+="Node";var E=this[d];this[d]=this.tree["get"+e+"Class"](b,this.isExpanded);a.replace(this[c],this[d]||"",E||"");h.set(this[c],this.tree["get"+e+"Style"](b,this.isExpanded)||{})},_updateLayout:function(){var b=this.getParent(),b=!b||!b.rowNode||"none"==b.rowNode.style.display;a.toggle(this.domNode,"dijitTreeIsRoot",b);a.toggle(this.domNode,"dijitTreeIsLast",!b&&!this.getNextSibling())},_setExpando:function(b){var c=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];b=b?0:this.isExpandable?this.isExpanded?1:2:3;a.replace(this.expandoNode,c[b],c);this.expandoNodeText.innerHTML=["*","-","+","*"][b]},expand:function(){if(this._expandDeferred)return B(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");a.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var b=e.wipeIn({node:this.containerNode,duration:H.defaultDuration}),c=this._expandDeferred=new f(function(){b.stop()});p.after(b,"onEnd",function(){c.resolve(!0)},!0);b.play();return B(c)},collapse:function(){if(this._collapseDeferred)return B(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");a.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var b=e.wipeOut({node:this.containerNode,duration:H.defaultDuration}),c=this._collapseDeferred=new f(function(){b.stop()});p.after(b,"onEnd",
function(){c.resolve(!0)},!0);b.play();return B(c)},indent:0,setChildItems:function(a){var c=this.tree,e=c.model,E=[],z=c.focusedChild,g=this.getChildren();k.forEach(g,function(a){C.prototype.removeChild.call(this,a)},this);this.defer(function(){k.forEach(g,function(a){if(!a._destroyed&&!a.getParent()){var b=function(a){var d=e.getIdentity(a.item),E=c._itemNodesMap[d];1==E.length?delete c._itemNodesMap[d]:(d=k.indexOf(E,a),-1!=d&&E.splice(d,1));k.forEach(a.getChildren(),b)};c.dndController.removeTreeNode(a);
b(a);if(c.persist){var E=k.map(a.getTreePath(),function(a){return c.model.getIdentity(a)}).join("/"),g;for(g in c._openedNodes)g.substr(0,E.length)==E&&delete c._openedNodes[g];c._saveExpandedNodes()}c.lastFocusedChild&&!d.isDescendant(c.lastFocusedChild.domNode,c.domNode)&&delete c.lastFocusedChild;z&&!d.isDescendant(z.domNode,c.domNode)&&c.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,k.forEach(a,function(a){var b=e.getIdentity(a),d=c._itemNodesMap[b],
g;if(d)for(var z=0;z<d.length;z++)if(d[z]&&!d[z].getParent()){g=d[z];g.set("indent",this.indent+1);break}g||(g=this.tree._createTreeNode({item:a,tree:c,isExpandable:e.mayHaveChildren(a),label:c.getLabel(a),labelType:c.model&&c.model.labelType||"text",tooltip:c.getTooltip(a),ownerDocument:c.ownerDocument,dir:c.dir,lang:c.lang,textDir:c.textDir,indent:this.indent+1}),d?d.push(g):c._itemNodesMap[b]=[g]);this.addChild(g);(this.tree.autoExpand||this.tree._state(g))&&E.push(c._expandNode(g))},this),k.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=b(E);this.tree._startPaint(a);return B(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());k.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(b){this.labelNode.setAttribute("aria-selected",b?"true":"false");a.toggle(this.rowNode,"dijitTreeRowSelected",b)},focus:function(){G.focus(this.focusNode)}});q("dojo-bidi")&&P.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),k.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var K=n("dijit.Tree",[y,M,t,L],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:N,persist:!1,autoExpand:!1,dndController:z,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){A.publish(this.id,g.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new f;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(u(this.containerNode,
u.selector(".dijitTreeNode",w.enter),function(b){a._onNodeMouseEnter(D.byNode(this),b)}),u(this.containerNode,u.selector(".dijitTreeNode",w.leave),function(b){a._onNodeMouseLeave(D.byNode(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow",F.press),function(b){a._onNodePress(D.getEnclosingWidget(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow",F),function(b){a._onClick(D.getEnclosingWidget(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(D.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(p.after(this.model,"onChange",g.hitch(this,"_onItemChange"),!0),p.after(this.model,"onChildrenChange",g.hitch(this,"_onItemChildrenChange"),!0),p.after(this.model,"onDelete",g.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){g.isString(this.dndController)&&(this.dndController=g.getObject(this.dndController));for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=B(this.pendingCommandsPromise);this.onLoadDeferred.then(g.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;r.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=g.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=g.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)}));this.model=new O(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(g.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(g.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),g.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=g.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(g.hitch(this,function(){var c=
k.map(a,function(a){return!a||g.isString(a)?a:b.model.getIdentity(a)}),e=[];k.forEach(c,function(a){e=e.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",e)}))},_setPathAttr:function(a){return a.length?B(this.set("paths",[a]).then(function(a){return a[0]})):B(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function c(a,b){var d=a.shift(),g=k.filter(b,function(a){return a.getIdentity()==d})[0];if(g)return a.length?e._expandNode(g).then(function(){return c(a,
g.getChildren())}):g;throw new K.PathError("Could not expand path at "+d);}var e=this;return B(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return b(k.map(a,function(a){a=k.map(a,function(a){return a&&g.isObject(a)?e.model.getIdentity(a):a});if(a.length)return c(a,[e.rootNode]);throw new K.PathError("Empty path");}))}).then(function(a){e.set("selectedNodes",a);return e.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(e){return c._expandNode(e).then(function(){var c=k.filter(e.getChildren()||[],function(a){return a.isExpandable});return b(k.map(c,a))})}var c=this;return B(a(this.rootNode))},collapseAll:function(){function a(e){var d=k.filter(e.getChildren()||[],function(a){return a.isExpandable}),d=b(k.map(d,a));return!e.isExpanded||e==c.rootNode&&!c.showRoot?d:d.then(function(){return c._collapseNode(e)})}var c=this;return B(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){(a=this._getNext(b))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a,b){if(a=b.getPreviousSibling())for(b=a;b.isExpandable&&b.isExpanded&&
b.hasChildren();)b=b.getChildren(),b=b[b.length-1];else if(a=b.getParent(),this.showRoot||a!==this.rootNode)b=a;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){b.isExpandable&&b.isExpanded?this._collapseNode(b):(a=b.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},focusLastChild:function(){var a=this._getLast();
a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,b){return d.isDescendant(a,
b.expandoNode)||d.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,c,e){var d=this.isExpandoNode(b.target,a);a.isExpandable&&(c||d)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[e](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=
a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){r.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){r.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&
delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,c=a.item,e=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new f,b.getChildren(c,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},function(b){console.error(e,": error loading "+a.label+" children: ",
b);a._loadDeferred.reject(b)}));b=a._loadDeferred.then(g.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){for(var b=[],c=this.domNode;c&&c.tagName&&"IFRAME"!==c.tagName.toUpperCase();c=c.parentNode)b.push({domNode:c.contentWindow||c,scrollLeft:c.scrollLeft||0,scrollTop:c.scrollTop||0});this.focusChild(a);this.defer(function(){for(var a=0,c=b.length;a<c;a++)b[a].domNode.scrollLeft=b[a].scrollLeft,b[a].domNode.scrollTop=
b[a].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var c=this.getLabel(a),e=this.getTooltip(a);k.forEach(b,function(b){b.set({item:a,label:c,tooltip:e});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){a=this.model.getIdentity(a);(a=this._itemNodesMap[a])&&k.forEach(a,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];
b&&(k.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!d.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!d.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=l(this.cookieName);a&&k.forEach(a.split(","),function(a){this._openedNodes[a]=
!0},this)}},_state:function(a,b){if(!this.persist)return!1;var c=k.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[c];b?this._openedNodes[c]=!0:delete this._openedNodes[c];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);l(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),
delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!g.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&c.setMarginBox(this.domNode,a);this._nodePixelIndent=c.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(g.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},
_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=g.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});x(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);
this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new P(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});q("dojo-bidi")&&K.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});K.PathError=m("TreePathError");K._TreeNode=P;return K})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(k,p,l,n){return l("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(f){n.mixin(this,f);this.connects=[];f=this.store;if(!f.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");f.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([p.after(f,
"onNew",n.hitch(this,"onNewItem"),!0),p.after(f,"onDelete",n.hitch(this,"onDeleteItem"),!0),p.after(f,"onSet",n.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var f;f=this.connects.pop();)f.remove()},getRoot:function(f,b){this.root?f(this.root):this.store.fetch({query:this.query,onComplete:n.hitch(this,function(b){if(1!=b.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+b.length+" items, but must return exactly one");this.root=b[0];f(this.root)}),onError:b})},mayHaveChildren:function(f){return k.some(this.childrenAttrs,
function(b){return this.store.hasAttribute(f,b)},this)},getChildren:function(f,b,d){var a=this.store;if(a.isItemLoaded(f)){for(var c=[],h=0;h<this.childrenAttrs.length;h++)var m=a.getValues(f,this.childrenAttrs[h]),c=c.concat(m);var e=0;this.deferItemLoadingUntilExpand||k.forEach(c,function(b){a.isItemLoaded(b)||e++});0==e?b(c):k.forEach(c,function(h,q){a.isItemLoaded(h)||a.loadItem({item:h,onItem:function(a){c[q]=a;0==--e&&b(c)},onError:d})})}else{var q=n.hitch(this,arguments.callee);a.loadItem({item:f,
onItem:function(a){q(a,b,d)},onError:d})}},isItem:function(f){return this.store.isItem(f)},fetchItemByIdentity:function(f){this.store.fetchItemByIdentity(f)},getIdentity:function(f){return this.store.getIdentity(f)},getLabel:function(f){return this.labelAttr?this.store.getValue(f,this.labelAttr):this.store.getLabel(f)},newItem:function(f,b,d){var a={parent:b,attribute:this.childrenAttrs[0]},c;this.newItemIdAttr&&f[this.newItemIdAttr]?this.fetchItemByIdentity({identity:f[this.newItemIdAttr],scope:this,
onItem:function(h){h?this.pasteItem(h,null,b,!0,d):(c=this.store.newItem(f,a))&&void 0!=d&&this.pasteItem(c,b,b,!1,d)}}):(c=this.store.newItem(f,a))&&void 0!=d&&this.pasteItem(c,b,b,!1,d)},pasteItem:function(f,b,d,a,c){var h=this.store,m=this.childrenAttrs[0];b&&k.forEach(this.childrenAttrs,function(c){if(h.containsValue(b,c,f)){if(!a){var e=k.filter(h.getValues(b,c),function(a){return a!=f});h.setValues(b,c,e)}m=c}});if(d)if("number"==typeof c){var e=h.getValues(d,m).slice();e.splice(c,0,f);h.setValues(d,
m,e)}else h.setValues(d,m,h.getValues(d,m).concat(f))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(f,b){b&&this.getChildren(b.item,n.hitch(this,function(d){this.onChildrenChange(b.item,d)}))},onDeleteItem:function(f){this.onDelete(f)},onSetItem:function(f,b){if(-1!=k.indexOf(this.childrenAttrs,b))this.getChildren(f,n.hitch(this,function(b){this.onChildrenChange(f,b)}));else this.onChange(f)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(k,p,l,n,f){return p("dijit.tree.ForestStoreModel",f,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(b){this.root={store:this,root:!0,id:b.rootId,label:b.rootLabel,children:b.rootChildren}},mayHaveChildren:function(b){return b===this.root||this.inherited(arguments)},getChildren:function(b,d,a){b===this.root?this.root.children?d(this.root.children):this.store.fetch({query:this.query,onComplete:n.hitch(this,
function(a){this.root.children=a;d(a)}),onError:a}):this.inherited(arguments)},isItem:function(b){return b===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(b){if(b.identity==this.root.id){var d=b.scope||l.global;b.onItem&&b.onItem.call(d,this.root)}else this.inherited(arguments)},getIdentity:function(b){return b===this.root?this.root.id:this.inherited(arguments)},getLabel:function(b){return b===this.root?this.root.label:this.inherited(arguments)},newItem:function(b,d,a){return d===
this.root?(this.onNewRootItem(b),this.store.newItem(b)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(b,d,a,c,h){if(d===this.root&&!c)this.onLeaveRoot(b);this.inherited(arguments,[b,d===this.root?null:d,a===this.root?null:a,c,h]);if(a===this.root)this.onAddToRoot(b)},onAddToRoot:function(b){console.log(this,": item ",b," added to root")},onLeaveRoot:function(b){console.log(this,": item ",b," removed from root")},_requeryTop:function(){var b=this.root.children||[];this.store.fetch({query:this.query,
onComplete:n.hitch(this,function(d){this.root.children=d;if(b.length!=d.length||k.some(b,function(a,b){return d[b]!=a}))this.onChildrenChange(this.root,d)})})},onNewItem:function(b,d){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(b){-1!=k.indexOf(this.root.children,b)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(b,d,a,c){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(k,p,l,n,f,b,d,a,c,h,m){return p("dijit.tree._dndSelector",m,{constructor:function(){this.selection={};this.anchor=null;this.events.push(a(this.tree.domNode,c.press,n.hitch(this,"onMouseDown")),a(this.tree.domNode,c.release,n.hitch(this,"onMouseUp")),a(this.tree.domNode,c.move,n.hitch(this,"onMouseMove")),a(this.tree.domNode,h.press,n.hitch(this,"onClickPress")),a(this.tree.domNode,h.release,n.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,
c;for(c in b)a.push(b[c]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));b&&(this.anchor=a);return a},removeTreeNode:function(a){var c=k.filter(this.getSelectedTreeNodes(),function(c){return!b.isDescendant(c.domNode,a.domNode)});this.setSelection(c);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(a){var b=this.getSelectedTreeNodes();k.forEach(this._setDifference(b,a),n.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));k.forEach(this._setDifference(a,b),n.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){k.forEach(b,function(a){a.__exclude__=!0});a=k.filter(a,function(a){return!a.__exclude__});k.forEach(b,function(a){delete a.__exclude__});
return a},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],c=[];k.forEach(a,function(a){var d=a.getTreePath();c.push(a);b.push(d)},this);a=k.map(c,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",c);this.tree._set("selectedNode",c[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,
this.current))){"mousedown"==a.type&&d.isLeft(a)&&a.preventDefault();var b="keydown"==a.type?this.tree.focusedChild:this.current;if(b){var c=f.getCopyKeyState(a),e=b.id;this.singular||a.shiftKey||!this.selection[e]?(this._doDeselect=!1,this.userSelect(b,c,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,f.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(a);a=doc.createRange();a.setStartBefore(b);return c.compareBoundaryPoints(c.END_TO_END,a)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,b,c){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(c&&this.anchor){b=this._compareNodes(this.anchor.rowNode,a.rowNode);c=this.anchor;0>b?b=c:(b=a,a=c);for(c=[];b!=a;)c.push(b),b=this.tree._getNext(b);c.push(a);this.setSelection(c)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
b){b=b||l.global;for(var c in this.selection)a.call(b,this.getItem(c),c,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(k,p,l,n,f,b){return p("dijit.tree._dndContainer",null,{constructor:function(d,a){this.tree=d;this.node=d.domNode;n.mixin(this,a);this.containerState="";l.add(this.node,"dojoDndContainer");this.events=[f(this.node,b.enter,n.hitch(this,"onOverEvent")),f(this.node,b.leave,
n.hitch(this,"onOutEvent")),k.after(this.tree,"_onNodeMouseEnter",n.hitch(this,"onMouseOver"),!0),k.after(this.tree,"_onNodeMouseLeave",n.hitch(this,"onMouseOut"),!0),f(this.node,"dragstart, selectstart",function(a){a.preventDefault()})]},destroy:function(){for(var b;b=this.events.pop();)b.remove();this.node=this.parent=null},onMouseOver:function(b){this.current=b},onMouseOut:function(){this.current=null},_changeState:function(b,a){var c="dojoDnd"+b;b=b.toLowerCase()+"State";l.replace(this.node,c+
a,c+this[b]);this[b]=a},_addItemClass:function(b,a){l.add(b,"dojoDndItem"+a)},_removeItemClass:function(b,a){l.remove(b,"dojoDndItem"+a)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/GpSource":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/GpSource.html dojo/_base/lang dojo/_base/html dojo/on dojo/Evented jimu/dijit/GpChooserFromPortal jimu/dijit/_GpServiceChooserContent jimu/portalUrlUtils dijit/form/RadioButton".split(" "),
function(k,p,l,n,f,b,d,a,c,h,m,e){var q=0;return k([p,l,n,c],{templateString:f,baseClass:"jimu-gp-source",declaredClass:"jimu.dijit.GpSource",nls:null,multiple:!1,portalUrl:null,uniqueID:null,mode:null,constructor:function(){this.inherited(arguments);this.uniqueID=++q},postMixInProperties:function(){this.nls=window.jimuNls.gpSource;this.portalUrl=e.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedItems:function(){var a=[];this.portalRadio.checked?
a=this.gpcPortal.getSelectedItems():this.urlRadio.checked&&(a=this.gpcUrl.getSelectedItems());return a},startup:function(){this._started||(this.inherited(arguments),this.gpcPortal.startup(),this.gpcUrl.startup());this._started=!0},_initSelf:function(){this._initRadios();this._createGpChooserFromPortal();this._createGpServiceChooserContent();this._onRadioClicked("url");this.own(a(this.urlRadio,"click",b.hitch(this,function(){this._onRadioClicked("url")})));this.own(a(this.portalRadio,"click",b.hitch(this,
function(){this._onRadioClicked("portal")})))},_createGpChooserFromPortal:function(){this.gpcPortal=new h({multiple:this.multiple,portalUrl:this.portalUrl,style:{width:"100%",height:"100%"}});this.gpcPortal.operationTip=this.nls.chooseItem;this.gpcPortal.placeAt(this.hflcContainer);this.own(a(this.gpcPortal,"next",b.hitch(this,function(){this.gpcPortal.operationTip=this.nls.chooseItem+" -\x3e "+this.nls.chooseTask;this._updateOperationTip()})));this.own(a(this.gpcPortal,"back",b.hitch(this,function(){this.gpcPortal.operationTip=
this.nls.chooseItem;this._updateOperationTip()})));this.own(a(this.gpcPortal,"ok",b.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(a(this.gpcPortal,"cancel",b.hitch(this,function(){this.emit("cancel")})));0<=(this.portalUrl||"").toLowerCase().indexOf(".arcgis.com")?this.portalLabel.innerHTML=this.nls.selectFromOnline:this.portalLabel.innerHTML=this.nls.selectFromPortal},_createGpServiceChooserContent:function(){this.gpcUrl=new m({multiple:this.multiple,style:{width:"100%",height:"100%"}});
this.gpcUrl.operationTip=this.nls.setServiceUrl;this.gpcUrl.placeAt(this.flscContainer);this.own(a(this.gpcUrl,"ok",b.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(a(this.gpcUrl,"cancel",b.hitch(this,function(){this.emit("cancel")})))},_initRadios:function(){var a="gpSourceRadios_"+this._getRandomString();this.portalRadio.name=a;d.setAttr(this.portalRadio,"id","portalRadio_"+this._getRandomString());d.setAttr(this.portalLabel,"for",this.portalRadio.id);this.urlRadio.name=a;
d.setAttr(this.urlRadio,"id","urlRadio_"+this._getRandomString());d.setAttr(this.urlLabel,"for",this.urlRadio.id)},_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},_onRadioClicked:function(a){this.mode!==a&&(this.mode=a,"portal"===a?(this.portalRadio.set("checked",!0),this.urlRadio.set("checked",!1),d.setStyle(this.hflcContainer,"display","block"),d.setStyle(this.flscContainer,"display","none"),this.operationTip.innerHTML=this.nls.chooseItem):"url"===a&&(this.portalRadio.set("checked",
!1),this.urlRadio.set("checked",!0),d.setStyle(this.hflcContainer,"display","none"),d.setStyle(this.flscContainer,"display","block"),this.operationTip.innerHTML=this.nls.setServiceUrl,setTimeout(b.hitch(this,function(){this.gpcUrl.focusInput()}),50)),this._updateOperationTip())},_updateOperationTip:function(){if(this.portalRadio.checked){this.operationTip.innerHTML=this.gpcPortal.operationTip;var a=this.gpcPortal.browserContainer;a.style.top=0;var b=this.operationTip.clientHeight;19<=b&&(a.style.top=
b-19+"px")}else this.urlRadio.checked&&(this.operationTip.innerHTML=this.gpcUrl.operationTip)}})})},"jimu/dijit/GpChooserFromPortal":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/GpChooserFromPortal.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented dojo/promise/all jimu/dijit/ItemSelector jimu/dijit/GpServiceBrowser jimu/portalUrlUtils esri/request".split(" "),function(k,
p,l,n,f,b,d,a,c,h,m,e,q,r,v,g,u){return k([p,l,n,e],{templateString:f,declaredClass:"jimu.dijit.GpChooserFromPortal",baseClass:"jimu-gp-chooser-from-portal",_serviceDef:null,portalUrl:null,multiple:!1,postMixInProperties:function(){this.nls=b.mixin({},window.jimuNls.common);this.portalUrl=g.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedItems:function(){return this.gpServiceBrowser.getSelectedItems()},_initSelf:function(){this.selector=
new r({portalUrl:this.portalUrl,itemTypes:["Geoprocessing Service"],onlyShowOnlineFeaturedItems:!1});this.own(c(this.selector,"item-selected",b.hitch(this,this._onItemSelected)));this.own(c(this.selector,"none-item-selected",b.hitch(this,this._onNoneItemSelected)));this.selector.placeAt(this.selectorContainer);this.selector.startup();this.gpServiceBrowser._onTreeClick=b.hitch(this,this._onBrowserClicked)},_onItemSelected:function(){d.removeClass(this.btnNext,"jimu-state-disabled")},_onNoneItemSelected:function(){d.addClass(this.btnNext,
"jimu-state-disabled")},_onBtnBackClicked:function(){this._serviceDef&&!this._serviceDef.isFulfilled()&&this._serviceDef.cancel();d.setStyle(this.btnOk,"display","none");d.setStyle(this.btnNext,"display","block");d.setStyle(this.btnBack,"display","none");d.addClass(this.btnOk,"jimu-state-disabled");d.setStyle(this.selectorContainer,"display","block");d.setStyle(this.browserContainer,"display","none");this._reset();this.emit("back")},_onBtnOkClicked:function(){var a=this.getSelectedItems();0<a.length&&
this.emit("ok",a)},_onBtnNextClicked:function(){var a=this.selector.getSelectedItem();a&&(this._reset(),d.setStyle(this.btnNext,"display","none"),d.setStyle(this.btnBack,"display","block"),d.setStyle(this.btnOk,"display","block"),d.addClass(this.btnOk,"jimu-state-disabled"),d.setStyle(this.selectorContainer,"display","none"),d.setStyle(this.browserContainer,"display","block"),this.gpServiceBrowser.setUrl(a.url||a.item).then(b.hitch(this,function(){0<this.getSelectedItems().length&&d.removeClass(this.btnOk,
"jimu-state-disabled")})),this.emit("next"))},_reset:function(){this.gpServiceBrowser.reset()},_onBrowserClicked:function(){0<this.gpServiceBrowser.getSelectedItems().length?d.removeClass(this.btnOk,"jimu-state-disabled"):d.addClass(this.btnOk,"jimu-state-disabled")},_onBtnCancelClicked:function(){this.emit("cancel")}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on dojo/dom-style jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable jimu/dijit/BindLabelPropsMixin dijit/form/RadioButton".split(" "),
function(k,p,l,n,f,b,d,a,c,h,m,e,q,r,v,g,u,A,w,x,F,G,D,H,y){return k([l,n,f,y,d],{templateString:b,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,showMyContent:!0,showMyOrganization:!0,showMyGroups:!0,showPublic:!0,showOnlyEditableGroups:!1,postMixInProperties:function(){this.portalUrl=x.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";h.forEach(this.itemTypes,a.hitch(this,function(a,b){this._itemTypes+=
'"'+a+'"';b!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";h.forEach(this.typeKeywords,a.hitch(this,function(a,b){this._typeKeywords+='"'+a+'"';b!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();
this.portal=A.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=u.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=u.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){var b={title:this.nls.myContent,content:this.mycontentTabNode},c={title:this.nls.myOrganization,content:this.organizationTabNode},
d={title:this.nls.myGroup,content:this.groupTabNode},e={title:this.nls.publicMap,content:this.publicTabNode};g.set(this.mycontentTabNode,"display","none");g.set(this.organizationTabNode,"display","none");g.set(this.groupTabNode,"display","none");g.set(this.publicTabNode,"display","none");var h=[];this.showMyContent&&(h.push(b),g.set(this.mycontentTabNode,"display","block"));this.showMyOrganization&&(h.push(c),g.set(this.organizationTabNode,"display","block"));this.showMyGroups&&(h.push(d),g.set(this.groupTabNode,
"display","block"));this.showPublic&&(h.push(e),g.set(this.publicTabNode,"display","block"));this.tab=new D({tabs:h},this.tabNode);this.own(v(this.tab,"tabChanged",a.hitch(this,function(a){m.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){m.setStyle(this.signinSection,"display","none");var a=r(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",
this.domNode);w.userHaveSignInPortal(this._getPortalUrl())?a.style("display","block"):(a.style("display","none"),this._isPublicTabShow||m.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){var a=this._getPortalUrl(),a=x.getServerByUrl(a);this.portalPublicRaido.set("disabled",!1);this.onlinePublicRaido.set("disabled",!1);this.portalPublicRaido.set("checked",!0);var b=!1;x.isArcGIScom(a)?(b=!0,this.portalPublicLabel.innerHTML="ArcGIS.com"):(this.portalPublicLabel.innerHTML=
a,b=this.showOnlineItems?!1:!0);b&&(this.onlinePublicRaido.set("disabled",!0),m.setStyle(this.onlinePublicRaido,"display","none"),m.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var b="esri_"+(c.locale&&c.locale.slice(0,2)||"en").toLowerCase(),d=h.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
a.hitch(this,function(a){return a!==b})),e="";h.forEach(d,a.hitch(this,function(a){e+=" -owner:"+a+" "}));d=" ";this.portal&&this.portal.user&&this.portal.user.orgId&&(d=" orgid:"+this.portal.user.orgId+" ");d=d+this._itemTypeQueryString+" AND access:public "+e+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:d});this._filterPublicPortalQuery=this._getQuery({q:d,basicQ:d});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(b){return a.mixin({start:1,num:16,f:"json"},b||{})},_getPortalUrl:function(){return x.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(v(this.publicPortalItemTable,"item-dom-clicked",a.hitch(this,this._onItemDomClicked)));this.own(v(this.publicOnlineItemTable,"item-dom-clicked",a.hitch(this,this._onItemDomClicked)));this.own(v(this.organizationItemTable,"item-dom-clicked",a.hitch(this,this._onItemDomClicked)));this.own(v(this.groupItemTable,"item-dom-clicked",a.hitch(this,this._onItemDomClicked)));
this.own(v(this.mycontentItemTable,"item-dom-clicked",a.hitch(this,this._onItemDomClicked)));this.own(v(this.publicPortalItemTable,"update",a.hitch(this,this._onItemTableUpdate)));this.own(v(this.publicOnlineItemTable,"update",a.hitch(this,this._onItemTableUpdate)));this.own(v(this.organizationItemTable,"update",a.hitch(this,this._onItemTableUpdate)));this.own(v(this.groupItemTable,"update",a.hitch(this,this._onItemTableUpdate)));this.own(v(this.mycontentItemTable,"update",a.hitch(this,this._onItemTableUpdate)));
var b=this._getPortalUrl();this.portalPublicRaido.get("disabled")||(this.publicPortalItemTable.set("portalUrl",b),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.get("disabled")||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",
this._filterPublicOnlineQuery))},_initPublic:function(){this.own(v(this.portalPublicRaido,"click",a.hitch(this,this._onPublicRaidoClicked)));this.own(v(this.onlinePublicRaido,"click",a.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.get("checked")?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.get("checked")&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},
_onPublicSearch:function(b){(b=b&&a.trim(b))?(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.get("checked")?(this._filterPublicPortalQuery.q=b+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.get("checked")&&(this._filterPublicOnlineQuery.q=b+" "+this._itemTypeQueryString+" AND access:public "+
this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(v(this.groupsSelect,"change",a.hitch(this,this._onGroupsSelectChange)));var b=x.getServerByUrl(this._getPortalUrl());x.isArcGIScom(b)&&(b="ArcGIS.com");w.userHaveSignInPortal(this._getPortalUrl())&&
this._onSignIn()},_onOrganizationSearch:function(b){if(b=b&&a.trim(b)){if(this._allOrganizationQuery){var c=this._allOrganizationQuery.q;c&&(this._filterOrganizationQuery.q=b+" "+c,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(b){if(b=b&&a.trim(b)){if(this._allMyContentQuery){var c=this._allMyContentQuery.q;c&&(this._filterMyContentQuery.q=b+" "+
c,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},_onGroupSearch:function(b){if(b=b&&a.trim(b)){if(this._allGroupQuery){var c=this._allGroupQuery.q;c&&(this._filterGroupQuery.q=b+" "+c,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=
!0;var b=this._getPortalUrl();A.getPortal(b).getUser().then(a.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();a=" orgid:"+a.orgId+
" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var b=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",b);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;
this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",b);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(a){this._resetGroupsSection();m.setStyle(this.groupsSection,"display","flex");a=a.getGroups();if(0<a.length){m.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();m.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var c=a[b];m.create("option",
{value:c.id,innerHTML:c.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length)},_resetGroupsSection:function(){m.setStyle(this.groupsSection,"display","none");m.empty(this.groupsSelect);m.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();m.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?m.setStyle(this.groupsSection,
"top","15px"):m.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===a)m.setStyle(this.groupSearch,"display","none"),this.groupItemTable.hide();else{m.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});
this.groupItemTable.set("portalUrl",b);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(a){var b=m.hasClass(a,"jimu-state-active");r(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");b&&m.addClass(a,"jimu-state-active");(a=this.getSelectedItem())?this.emit("item-selected",a):this.emit("none-item-selected")},getSelectedItem:function(){var b=null,c=r(".item.jimu-state-active",this.domNode);
0<c.length&&(b=a.mixin({},c[0].item));return b}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),function(k,p,l,n,f,b,d,a,c,h,m,e,q,r,v,g){return k([p,l,n,b],{templateString:f,declaredClass:"jimu.dijit.ItemTable",
baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"desktopapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=v.getStandardPortalUrl(this.portalUrl));
this.showAllItemsSection();this.searchAllItems()},show:function(){c.setStyle(this.domNode,"display","block")},hide:function(){c.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=d.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),r.getPortal(this.portalUrl).queryItems(this.query).then(d.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),
this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),d.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=d.clone(a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredItemShelter.show(),r.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(d.hitch(this,function(b){this.domNode&&
(this.showFilterItemsSection(),a&&this.clearFilteredItemsSection(),this.filteredQuery.start=b.nextStart,this._createItems(b,this.filteredItemsTbody),this._filterItemCallback())}),d.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?(c.setStyle(this.filteredItemsTableDiv,"display","block"),c.setStyle(this.searchNoneTipSection,"display","none")):(c.setStyle(this.filteredItemsTableDiv,
"display","none"),c.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){c.empty(this.allItemTbody)},clearFilteredItemsSection:function(){c.empty(this.filteredItemsTbody)},showAllItemsSection:function(){c.setStyle(this.allItemsSection,"display","block");c.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){c.setStyle(this.allItemsSection,"display","none");
c.setStyle(this.filteredItemsSection,"display","block");c.setStyle(this.filteredItemsTableDiv,"display","block");c.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&this.searchFilteredItems()},_isScrollToBottom:function(a){return q.isScrollToBottom(a)},_createItems:function(b,e){b=b.results;var g=
a.map(this.types,d.hitch(this,function(a){return a.toLowerCase()}));b=a.filter(b,d.hitch(this,function(b){b=b.type&&b.type.toLowerCase()||"";return 0<=a.indexOf(g,b)}));if(0!==b.length){var h,f=m("td.empty",e),q;if(0<f.length){var u=Math.min(b.length,f.length),k=b.splice(0,u);for(q=0;q<u;q++){var l=f[q];h=this._createItem(k[q]);c.place(h,l);c.removeClass(l,"empty")}}if(0!==b.length){f=Math.ceil(b.length/2);for(q=0;q<f;q++)for(h=c.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),
c.place(h,e),u=m("td",h),k=0;k<u.length;k++)l=u[k],(h=b[2*q+k])?(h=this._createItem(h),c.place(h,l)):c.addClass(l,"empty");this.emit("update")}}},_getItemCount:function(a){return m(".item",a).length},_createItem:function(a){var b=c.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
b.item=a;var d=m(".item-thumbnail",b)[0],e=m(".item-name",b)[0],g=m(".item-type-owner",b)[0],h=m(".item-date",b)[0],f=m(".item-details",b)[0],q=m(".none-thumbnail-tip",b)[0];if(!a.thumbnailUrl){var u=this._defaultThumbnail[a.type];u&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+u)}a.thumbnailUrl?c.setStyle(d,"backgroundImage","url("+a.thumbnailUrl+")"):q.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(h=m(".item-info",b)[0],this.onCreateItemContent(a,h)):(e.innerHTML=
a.title,e.title=e.innerHTML,g.innerHTML=a.type+" by "+a.owner,g.title=g.innerHTML,d=new Date,d.setTime(a.modified),h.innerHTML=d.toLocaleString(),h.title=h.innerHTML,f.innerHTML=this.nls.moreDetails,f.href=a.detailsPageUrl||"#");return b},_onItemsTableClicked:function(a){var b=a.target||a.srcElement;a=null;c.hasClass(b,"item-thumbnail")?a=b.parentNode:c.hasClass(b,"none-thumbnail-tip")&&(a=b.parentNode.parentNode);a&&(b=c.hasClass(a,"jimu-state-active"),m(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
b?c.removeClass(a,"jimu-state-active"):c.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var a=null,b=m(".item.jimu-state-active",this.domNode);0<b.length&&(a=d.mixin({},b[0].item));return a}})})},"jimu/dijit/GpServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(k,p,l,n,f){return k([p],{baseClass:"jimu-gp-service-browser",declaredClass:"jimu.dijit.GpServiceBrowser",
url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);this.rule=f.getGpServiceBrowserRule()},getSelectedItems:function(){var b=this.inherited(arguments);return b=n.map(b,l.hitch(this,function(b){return{name:b.name,url:b.url}}))}})})},"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/LoadingIndicator".split(" "),
function(k,p,l,n,f,b,d,a,c,h,m,e,q,r,v){return k([p,l,n,f],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);d.addClass(this.domNode,
"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},setUrl:function(a){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new c;a&&"string"===typeof a&&a.replace(/\/*$/g,"")||this._def.reject();a=a.replace(/\/*$/g,"");a=b.trim(a);var d=a.match(/^http(s?):\/\//gi);d&&0<d.length||
(a="http://"+a);if(!(0>=a.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=a))return a=this._getRootItem(),a=r.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,a):this._isUrlContainsServiceType(this._currentUrl)?this._searchServiceUrl(this._currentUrl,a):this._searchFolderServiceUrl(this._currentUrl,a),this.shelter.show(),a.then(b.hitch(this,function(a){this.domNode&&this.shelter.hide();var b=this.tree.getAllLeafTreeNodeWidgets();1===b.length&&
b[0].select();this._def.resolve(a)}),b.hitch(this,function(a){this.domNode&&this.shelter.hide();this._showRequestError();this._def.reject(a)})),this._def;this._def.reject()},_getItem:function(a){return this.rule.getItem(a)},_getSubItemUrls:function(a){return this.rule.getSubItemUrls(a)},_getSubItems:function(d){var e=new c;this._getSubItemUrls(d).then(b.hitch(this,function(c){c=a.map(c,b.hitch(this,function(a){return this._getItem(a)}));h(c).then(b.hitch(this,function(c){c=a.filter(c,b.hitch(this,
function(a){return a&&"object"===typeof a}));e.resolve(c)}),b.hitch(this,function(a){e.reject(a)}))}),b.hitch(this,function(a){e.reject(a)}));return e},_selectFirstLeafTreeNodeWidget:function(){var a=this.tree.getAllLeafTreeNodeWidgets();1===a.length&&a[0].select()},isLeafItem:function(a){return 0<=this.rule.leafTypes.indexOf(a.type)},isServiceTypeSupported:function(a){return this.rule.isServiceTypeSupported(a)},_getStringEndWith:function(a,b){var c="",d=a.indexOf(b);0<=d&&(c=a.slice(0,d+b.length));
return c},_isUrlContainsServiceType:function(a){return this.rule.isUrlContainsServiceType(a)},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(a){var b="";a=a.split("/");return b=a[a.length-1]},_searchBaseServiceUrl:function(d,e){var g=new c;this._getRestInfo(d).then(b.hitch(this,function(m){if(this.domNode){var f=[];a.map(m.folders,b.hitch(this,function(g){var h={name:g,type:"folder",url:d+"/"+g,parent:e.id};this._addItem(h);
var m=new c;this._doSearchFolderServiceUrl(h.url,h.id).then(b.hitch(this,function(c){0<c.length?a.forEach(c,b.hitch(this,function(a){a.parent=h.id;this._addItem(a)})):this._removeItem(h.id);m.resolve()}),b.hitch(this,function(a){m.reject(a)}));f.push(m);return m}));a.forEach(m.services,b.hitch(this,function(a){if(this.isServiceTypeSupported(a.type)){a=d+"/"+a.name+"/"+a.type;var g=new c;this.rule.getItem(a).then(b.hitch(this,function(a){a&&(a.parent=e.id,this._addItem(a));g.resolve()}),b.hitch(this,
function(a){console.error(a);g.reject(a)}));f.push(g)}}));h(f).then(b.hitch(this,function(){this.domNode&&g.resolve()}),b.hitch(this,function(a){console.error(a);this.domNode&&g.reject(a)}))}}),b.hitch(this,function(a){console.error(a);this.domNode&&g.reject({errorCode:"NETWORK_ERROR",error:a})}));return g},_searchFolderServiceUrl:function(d,e){var g=new c;this._doSearchFolderServiceUrl(d,e).then(b.hitch(this,function(c){this.domNode&&(a.forEach(c,b.hitch(this,function(a){a.parent=e.id;this._addItem(a)})),
g.resolve())}),b.hitch(this,function(a){console.error(a);this.domNode&&g.reject({errorCode:"NETWORK_ERROR",error:a})}));return g},_doSearchFolderServiceUrl:function(d){var e=new c,g=this._getBaseServiceUrl();this._getRestInfo(d).then(b.hitch(this,function(c){c=c.services;var d=[];c&&0<c.length&&a.forEach(c,b.hitch(this,function(a){this.isServiceTypeSupported(a.type)&&(a=this.rule.getItem(g+"/"+a.name+"/"+a.type),d.push(a))}));h(d).then(b.hitch(this,function(c){c=a.filter(c,b.hitch(this,function(a){return a}));
e.resolve(c)}),b.hitch(this,function(a){console.error(a);e.reject(a)}))}),b.hitch(this,function(a){console.error(a);e.reject(a)}));return e},_searchServiceUrl:function(d,e){var g=new c;this._getSubItems(d).then(b.hitch(this,function(c){c&&0<c.length?(a.forEach(c,b.hitch(this,function(a){a.parent=e.id;this._addItem(a)})),g.resolve()):this._getItem(d).then(b.hitch(this,function(a){a&&(a.parent=e.id,this._addItem(a));g.resolve()}),b.hitch(this,function(a){g.reject(a)}))}),b.hitch(this,function(a){g.reject(a)}));
return g},_getRestInfo:function(a){var d=new c;this.rule.getRestInfo(a).then(b.hitch(this,function(a){this.domNode&&d.resolve(a)}),b.hitch(this,function(a){this.domNode&&d.reject(a)}));return d},_clear:function(){var c=this._store.query({parent:"root"});a.forEach(c,b.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_showRequestError:function(){this.emit("error",this.nls.invalidUrlTip)},_addItem:function(a){this._id++;a.id=this._id.toString();this._store.add(a);return a},_removeItem:function(a){this._store.remove(a)},
_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var a=this._getRootItem(),a=new m({data:[a],getChildren:function(a){return this.query({parent:a.id})}});this._store=new e(a);a=new q({store:this._store,query:{id:"root"},mayHaveChildren:b.hitch(this,this._mayHaveChildren)});this.tree=new v({multiple:this.multiple,model:a,showRoot:!1,style:{width:"100%"},isLeafItem:b.hitch(this,this.isLeafItem),onOpen:b.hitch(this,function(a,b){this._onTreeOpen(a,b);
this.emit("tree-open",a,b)}),onClick:b.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,b,c)}),getIconStyle:b.hitch(this,function(a,b){var c=null;if(!a)return null;var d={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),g=this._getIconImageName(a,b);g||("folder"===a.type?g=b?"folder_open_default.png":"folder_close_default.png":this.isServiceTypeSupported(a.type)&&
(g=b?"folder_open_default.png":"folder_close_default.png"));g&&(d.backgroundImage="url("+e+"/css/images/"+g+")",c=d);return c})});d.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(a,b){var c="";"function"===typeof this.rule.getIconImageName&&(c=this.rule.getIconImageName(a,b));return c},_mayHaveChildren:function(a){return"root"===a.type?!0:!this.isLeafItem(a)},_onTreeOpen:function(c,d){"root"===c.id||0<this._store.query({parent:c.id}).length||
c.checking||c.checked||(c.checking=!0,this._getSubItems(c.url).then(b.hitch(this,function(d){a.forEach(d,b.hitch(this,function(a){a.parent=c.id;this._addItem(a)}));c.checking=!1;c.checked=!0}),b.hitch(this,function(a){console.error(a);c.checking=!1;c.checked=!0})))},_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Deferred",
"jimu/utils","jimu/ServiceBrowserRule"],function(k,p,l,n,f){var b={combineRules:function(b){var a=new f;p.forEach(b,function(b){p.forEach(b.leafTypes,function(b){0>a.leafTypes.indexOf(b)&&a.leafTypes.push(b)});p.forEach(b.serviceTypes,function(b){0>a.serviceTypes.indexOf(b)&&a.serviceTypes.push(b)})});a.getMatchedRule=function(a){var c=null;p.some(b,function(b){return b.isUrlContainsServiceType(a)?(c=b,!0):!1});return c};a.getItem=function(b){var c=null;return c=(c=a.getMatchedRule(b))?c.getItem(b):
a.defaultGetItem(b)};a.getSubItemUrls=function(b){var c=null;return c=(c=a.getMatchedRule(b))?c.getSubItemUrls(b):a.defaultGetSubItemUrls(b)};a.getIconImageName=function(b,d){var c="";if(b.url){var e=a.getMatchedRule(b.url);e&&"function"===typeof e.getIconImageName&&(c=e.getIconImageName(b,d))}return c};return a},getFeaturelayerServiceBrowserRule:function(d,a,c){d=k.clone(d);var h=["point","polyline","polygon"];k.isArrayLike(d)&&0<d.length?(d=p.filter(d,function(a){return 0<=h.indexOf(a)}),0===d.length&&
(d=h)):d=h;return b._getFeaturelayerServiceBrowserRule(d,a,c)},_getFeaturelayerServiceBrowserRule:function(b,a,c){return new f({types:b,leafTypes:["Feature Layer","Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",getItem:function(a){var b=new l;this.isUrlEndWithServiceType(a,this.serviceTypes)?b=this.defaultGetItem(a):this.getRestInfo(a).then(k.hitch(this,function(c){c=this._getItemByLayerDefinition(a,c);b.resolve(c)}),
k.hitch(this,function(a){b.reject(a)}));return b},getSubItemUrls:function(a){var b=new l;return b=this.isUrlEndWithServiceType(a)?this._getSubUrlsByServiceUrl(a):this._getSubUrlsByGroupUrl(a)},getIconImageName:function(a,b){var c="";"MapServer"===a.type||"FeatureServer"===a.type?c=b?"mapserver_open.png":"mapserver_close.png":a.type===this._groupLayerType?c=b?"group_layer2.png":"group_layer1.png":a.type===this._featureLayerType?(a=n.getTypeByGeometryType(a.definition&&a.definition.geometryType),"point"===
a?c="point_layer1.png":"polyline"===a?c="line_layer1.png":"polygon"===a&&(c="polygon_layer1.png")):a.type===this._tableType?c="table.png":"root"===a.type&&this._currentUrl&&p.some(this.serviceTypes,k.hitch(this,function(a){return n.isStringEndWith(this._currentUrl,"/"+a)}))&&(c=b?"mapserver_open.png":"mapserver_close.png");return c},_getSubUrlsByServiceUrl:function(a){var b=new l;this.getRestInfo(a).then(k.hitch(this,function(d){var e=[];p.forEach(d.layers,k.hitch(this,function(b){0<=b.parentLayerId||
e.push(a+"/"+b.id)}));c&&p.forEach(d.tables,k.hitch(this,function(b){0<=b.parentLayerId||e.push(a+"/"+b.id)}));b.resolve(e)}),k.hitch(this,function(a){b.reject(a)}));return b},_getSubUrlsByGroupUrl:function(a){var b=new l;this.getRestInfo(a).then(k.hitch(this,function(c){var d=[];if(c.type===this._groupLayerType)var e=this._getServiceUrlByLayerUrl(a),d=p.map(c.subLayers||[],k.hitch(this,function(a){return e+"/"+a.id}));b.resolve(d)}),k.hitch(this,function(a){b.reject(a)}));return b},_getItemByLayerDefinition:function(b,
c){var d=null,f=c.type;if(f===this._groupLayerType)d={name:c.name,type:f,url:b,definition:c};else if(f===this._featureLayerType||f===this._tableType){var h=!1;f===this._featureLayerType?h=this._validateEsriGeometryType(c.geometryType):f===this._tableType&&(h=!0);h&&(h=!1,(h=a?n.isFeaturelayerUrlSupportQuery(b,c.capabilities):!0)&&(d={name:c.name,type:f,url:b,definition:c}))}return d},_validateEsriGeometryType:function(a){a=n.getTypeByGeometryType(a);return 0<=this.types.indexOf(a)},_getServiceUrlByLayerUrl:function(a){for(var b=
"",c=0;c<this.serviceTypes.length;c++){var d=this.serviceTypes[c].toLowerCase(),f=a.toLowerCase().lastIndexOf("/"+d+"/");if(0<=f){b=a.slice(0,f+d.length+1);break}}return b}})},getGeocodeServiceBrowserRule:function(){return new f({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},getGpServiceBrowserRule:function(){return new f({leafTypes:["GPTask"],serviceTypes:["GPServer"],getItem:function(b){var a=new l;this.isUrlEndWithServiceType(b)?a=this.defaultGetItem(b):this.getRestInfo(b).then(k.hitch(this,
function(c){a.resolve({name:c.displayName||c.name,type:"GPTask",url:b,definition:c})}),k.hitch(this,function(b){a.reject(b)}));return a},getSubItemUrls:function(b){var a=new l;this.isUrlEndWithServiceType(b)?this.getRestInfo(b).then(k.hitch(this,function(c){c=p.map(c.tasks||[],k.hitch(this,function(a){return b+"/"+a}));a.resolve(c)}),k.hitch(this,function(b){a.reject(b)})):a.resolve([]);return a},getIconImageName:function(b,a){a="";"GPServer"===b.type?a="toolbox.png":"GPTask"===b.type&&(a="tool.png");
return a}})},getImageServiceBrowserRule:function(b){return new f({leafTypes:["ImageServer"],serviceTypes:["ImageServer"],getItem:function(a){var c=new l;this.isUrlEndWithServiceType(a)?this.defaultGetItem(a).then(k.hitch(this,function(a){b?n.isImageServiceSupportQuery(a.definition.capabilities)?c.resolve(a):c.resolve(null):c.resolve(a)}),k.hitch(this,function(a){c.reject(a)})):c.resolve(null);return c},getIconImageName:function(a,b){b="";"ImageServer"===a.type&&(b="image_layer.png");return b}})},
getQueryableServiceBrowserRule:function(){var d=b.getFeaturelayerServiceBrowserRule(["point","polyline","polygon"],!0,!0),a=b.getImageServiceBrowserRule(!0);return b.combineRules([d,a])}};return b})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request esri/IdentityManager".split(" "),function(k,p,l,n,f,b,d){return k([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(a){p.mixin(this,a);p.isArrayLike(this.leafTypes)||
(this.leafTypes=[]);p.isArrayLike(this.serviceTypes)||(this.serviceTypes=[])},getItem:function(a){return this.defaultGetItem(a)},getSubItemUrls:function(a){return this.defaultGetSubItemUrls(a)},getIconImageName:function(a,b){return""},defaultGetItem:function(a){var b=new n;a=a.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(a)){var d=a.split("/"),f=d[d.length-1],e=d[d.length-2];this.getRestInfo(a).then(p.hitch(this,function(c){b.resolve({name:e,type:f,url:a,definition:c})}),p.hitch(this,function(a){console.error(a);
b.reject({errorCode:"NETWORK_ERROR",error:a})}))}else b.resolve(null);return b},defaultGetSubItemUrls:function(a){a=new n;a.resolve([]);return a},getRestInfo:function(a){var c=new n;a=a.replace(/\/*$/g,"");var f=this._restInfoCache[a];if(f)c.resolve(f);else{var f={url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4},m=d.findCredential(a);m&&m.token&&(f.content.token=m.token);b(f).then(p.hitch(this,function(b){this._restInfoCache[a]=b;c.resolve(b)}),function(a){c.reject(a)})}return c},
isServiceTypeSupported:function(a){a=a.toLowerCase();return l.some(this.serviceTypes,p.hitch(this,function(b){return b.toLowerCase()===a}))},isUrlEndWithServiceType:function(a){return l.some(this.serviceTypes,p.hitch(this,function(b){return f.isStringEndWith(a,"/"+b)}))},isUrlContainsServiceType:function(a){a=a.toLowerCase();return l.some(this.serviceTypes,p.hitch(this,function(b){b=b.toLowerCase();return 0<=a.indexOf("/"+b)}))}})})},"jimu/dijit/_GpServiceChooserContent":function(){define(["dojo/_base/declare",
"./_BasicServiceChooserContent","./GpServiceBrowser"],function(k,p,l){return k([p],{baseClass:"jimu-gp-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/myservice/GpServer","http://sampleserver6.arcgisonline.com/arcgis/rest/services/Elevation/ESRI_Elevation_World/GPServer/Viewshed"],_createServiceBrowser:function(k){return new l(k)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),
function(k,p,l,n,f,b,d,a,c,h,m,e,q,r,v){return k([p,l,n,b],{templateString:f,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=h.mixin({},window.jimuNls.common);this.nls=h.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
a.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(a){var b=new d;(this.url=a)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),b=this._onBtnValidateClick()):b.reject();return b},focusInput:function(){this.urlInput.focus()},_initSelf:function(){this._examples&&0<this._examples.length?c.forEach(this._examples,h.hitch(this,function(b){a.create("div",{innerHTML:b,
"class":"example-url"},this.exampleTd)})):a.setStyle(this.exampleTr,"display","none");var b={multiple:this.multiple,_onTreeClick:h.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(b);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(e.after(this.urlInput,"validator",h.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url);this.own(m(this.serviceBrowser,"error",h.hitch(this,
this._onServiceBrowserError)))},_createServiceBrowser:function(a){},_validateUrl:function(a){a=a.replace(/\/*$/g,"");if((a=a.match(/\/rest\/services\/*(.*)/gi))&&0<a.length)if(a=a[0].replace(/\/rest\/services\/*/,"")){var b=a.split("/");if(1===b.length)return!0;if(2===b.length)return this.serviceBrowser.isServiceTypeSupported(b[1]);if(3<=b.length)return a=this.serviceBrowser.isServiceTypeSupported(b[1]),b=this.serviceBrowser.isServiceTypeSupported(b[2]),a||b}else return!0;else return!1},_afterUrlValidate:function(b){b&&
(b=this.urlInput.get("value"),b=this._validateUrl(b));b?a.removeClass(this.btnValidate,"jimu-state-disabled"):a.addClass(this.btnValidate,"jimu-state-disabled");return b},_onServiceBrowserError:function(a){this._showErrorMessage(a)},_showErrorMessage:function(b){b&&"string"===typeof b?(this.errorNode.innerHTML=b,a.addClass(this.errorSection,"visible")):a.removeClass(this.errorSection,"visible")},_clearErrorMessage:function(){this.errorNode.innerHTML="";a.removeClass(this.errorSection,"visible")},
_onBtnValidateClick:function(){this._clearErrorMessage();var a=new d;if(this.urlInput.validate()){var b=this.urlInput.get("value");this.serviceBrowser.setUrl(b).then(h.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.resolve()}),h.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.reject()}));this.emit("validate-click")}else a.reject();return a},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?a.removeClass(this.btnOk,"jimu-state-disabled"):
a.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),
function(k,p,l,n,f,b,d,a,c,h,m,e){return k([c,h,b],{templateString:m,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",_selectedItem:null,_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,customClass:"",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.queryableLayerSource;this.nls.customSelectLayer=this.label?this.label:this.nls.selectLayer},postCreate:function(){this.inherited(arguments);this.layerInfosObj=
e.getInstanceSync();this.layerChooser.domNode.style.zIndex=1;this.layerChooser.tree.domNode.style.borderTop="0";this.layerChooser.tree.domNode.style.maxHeight="290px";this.own(n(this.layerChooser,"tree-click",p.hitch(this,this._onTreeClick)));this.own(n(this.layerChooser,"update",p.hitch(this,this._onLayerChooserUpdate)));this.own(n(document.body,"click",p.hitch(this,this._onBodyClicked)));this.own(n(document.body,"keydown",p.hitch(this,function(a){a.keyCode===f.ENTER&&this._onBodyClicked(a)})));
this.own(n(this.layerChooser.domNode,"keydown",p.hitch(this,function(a){a.keyCode===f.ESCAPE&&this.hideLayerChooser()})))},destroy:function(){this.hideLayerChooser();this.layerChooser&&this.layerChooser.destroy();this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(a){var b=new d;if(a){var c=this.layerInfosObj.getLayerInfoById(a.id);c?this.layerChooser.filter(c).then(p.hitch(this,function(d){d?(this._onSelectNewItem({layerInfo:c,
name:c.title,url:a.url}),b.resolve(!0)):b.resolve(!1)}),p.hitch(this,function(){b.resolve(!1)})):b.resolve(!1)}else this._onSelectNewItem(null),b.resolve(!0);return b},getSelectedItem:function(){return this._selectedItem},getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(a){a=a.target||a.srcElement;a===this.domNode||l.isDescendant(a,this.domNode)||a===this.layerChooser.domNode||l.isDescendant(a,this.layerChooser.domNode)||this.hideLayerChooser()},_onDropDownClick:function(a){a.stopPropagation();
a.preventDefault();this._isLayerChooserShow?this.hideLayerChooser():(this.isActive=!0,this.showLayerChooser())},_onDropDownKeydown:function(a){a.keyCode===f.ENTER&&this._onDropDownClick(a)},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},showLayerChooser:function(){this.layerChooser.domNode.style.minWidth=this.domNode.clientWidth+2+"px";a.open({parent:this,popup:this.layerChooser,around:this.domNode});var b=this.layerChooser.domNode.parentNode;b&&(l.addClass(b,"jimu-layer-chooser-from-map-withdropbox-popup"),
this.customClass&&l.addClass(b,this.customClass),this.layerChooser.tree.domNode.focus());this._isLayerChooserShow=!0},hideLayerChooser:function(){a.close(this.layerChooser);this._isLayerChooserShow=!1;this.isActive&&(this.dropDownBtn.focus(),this.isActive=!1)},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(a){var b=p.getObject("layerInfo.id",
!1,this._selectedItem)||-1,c=p.getObject("layerInfo.id",!1,a)||-1,b=b!==c;this._selectedItem=a;this.hideLayerChooser();a=p.getObject("layerInfo.title",!1,this._selectedItem)||"";this.layerNameNode.innerHTML=a;l.setAttr(this.layerNameNode,"title",a);a=p.getObject("layerInfo.layerObject",!1,this._selectedItem);b&&this.emit("selection-change",[a])},_onTreeClick:function(){var a=this._getSelectedItems();this._onSelectNewItem(0<a.length?a[0]:null)}})})},"jimu/dijit/ColorPickerButton":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorSelector".split(" "),
function(k,p,l,n,f,b,d,a,c,h){return k([p,l],{baseClass:"jimu-color-picker-btn",declaredClass:"jimu.dijit.ColorPickerButton",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"color-node" data-dojo-attach-point\x3d"colorNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"seperator"\x3e\x3c/div\x3e\x3cdiv class\x3d"action-node" data-dojo-attach-point\x3d"actionNode"\x3e\x3c/div\x3e\x3c/div\x3e',_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,ensureMode:!1,postMixInProperties:function(){this.nls=
window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof d||(this.color=new d(this.color)):this.color=new d("#ccc");f.setStyle(this.colorNode,"backgroundColor",this.color.toHex());this.colorNode.title=this.color.toHex();this.showLabel&&this._changeLabel(this.color);this._createTooltipDialog(this.domNode);this._hideTooltipDialog();this.own(b(this.colorNode,"click",n.hitch(this,this._onNodeClick)));this.own(b(this.actionNode,"click",n.hitch(this,this._onNodeClick)));
this.own(b(document.body,"click",n.hitch(this,function(a){this.isPartOfPopup(a.target||a.srcElement)||this._hideTooltipDialog()})))},_onNodeClick:function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()},destroy:function(){c.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var b=this.tooltipDialog.domNode;return a===b||f.isDescendant(a,b)},hideTooltipDialog:function(){this._hideTooltipDialog()},
_showTooltipDialog:function(){c.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){c.close(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){var c=f.create("div");this.tooltipDialog=new a({content:c});f.addClass(this.tooltipDialog.domNode,"jimu-color-picker-dialog");this.picker=new h({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:n.hitch(this,
function(a){this.ensureMode||(a=new d(a),this.setColor(a))})});this.picker.placeAt(c);this.picker.startup();if(this.ensureMode){var e=f.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-trailing jimu-leading-margin1",title:this.nls.cancel,innerHTML:this.nls.cancel},c);this.own(b(e,"click",n.hitch(this,function(){this._hideTooltipDialog()})));e=f.create("div",{"class":"jimu-btn jimu-float-trailing jimu-leading-margin1",title:this.nls.ok,innerHTML:this.nls.ok},c);this.own(b(e,"click",n.hitch(this,
function(){var a=this.picker.get("value");this.setColor(new d(a));this._hideTooltipDialog()})));c=f.create("div",{"class":"jimu-btn jimu-float-trailing jimu-leading-margin1",title:this.nls.apply,innerHTML:this.nls.apply},c);this.own(b(c,"click",n.hitch(this,function(){var a=this.picker.get("value");this.setColor(new d(a))})))}},setColor:function(a){if(a instanceof d){var b=this.color,c="";b&&(c=b.toHex());b=a.toHex();this.color=a;f.setStyle(this.colorNode,"backgroundColor",b);c!==b&&(this.picker.set("value",
b),this.onChange(new d(b)))}},getColor:function(){return this.color},onChange:function(a){}})})},"widgets/SituationAwareness/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/SituationAwareness/setting/FieldPicker.html":'\x3cdiv class\x3d"field-picker-main"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"tableArea" class\x3d"tableArea"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"btnAddField" class\x3d"btn-add-section enable"\x3e\r\n      \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"btn-add-label" data-dojo-attach-point\x3d"divLayerTitle"\x3e${nls.addField}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"fieldTable"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row pad-top20" data-dojo-attach-point\x3d"chk_countOnly"\x3e\r\n    \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chkCountOnly"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row pad-top20" data-dojo-attach-point\x3d"chk_summary"\x3e\r\n    \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chkCount"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chkArea"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chkLength"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row pad-top20" data-dojo-attach-point\x3d"chk_summaryLabels"\x3e\r\n    \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chkCountLabel"\x3e\r\n      \x3cspan class\x3d"label"\x3e ${nls.count_label}:\x3c/span\x3e\r\n      \x3cinput class\x3d"validationBox" data-dojo-attach-point\x3d"featureCountLabel" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n             disabled\x3d"disabled" title\x3d"${nls.count_label}" /\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chkAreaLabel"\x3e\r\n      \x3cspan class\x3d"label"\x3e ${nls.area_label}:\x3c/span\x3e\r\n      \x3cinput class\x3d"validationBox" data-dojo-attach-point\x3d"featureAreaLabel" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n             disabled\x3d"disabled" title\x3d"${nls.area_label}" /\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chkLengthLabel"\x3e\r\n      \x3cspan class\x3d"label"\x3e ${nls.length_label}:\x3c/span\x3e\r\n      \x3cinput class\x3d"validationBox" data-dojo-attach-point\x3d"featureLengthLabel" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n             disabled\x3d"disabled" title\x3d"${nls.length_label}" /\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"field-picker-footer"\x3e\r\n    \x3cdiv class\x3d"jimu-btn ok" data-dojo-attach-point\x3d"btnOk"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn cancel" data-dojo-attach-point\x3d"btnCancel"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/SituationAwareness/setting/FieldOptions.html":'\x3cdiv\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-r-row" title\x3d"${nls.modifyValues}"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"chkModifyDIV"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3ctable class\x3d"field-option-table"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"rdo_round" type\x3d"radio" class\x3d"jimu-radio-btn" id\x3d"rdo-round" name\x3d"modifyOptions"\r\n              data-dojo-type\x3d"dijit/form/RadioButton"/\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"roundLabel" for\x3d"rdo-round"\x3e${nls.roundValue}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"roundPlaces"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"roundSignificantFigures"\x3e\r\n            \x3clabel\x3e${nls.significantFigures}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n  \r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"rdo_truncate" type\x3d"radio" class\x3d"jimu-radio-btn" id\x3d"rdo-truncate" name\x3d"modifyOptions"\r\n              data-dojo-type\x3d"dijit/form/RadioButton"/\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"truncateLabel" for\x3d"rdo-truncate"\x3e${nls.truncateValue}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"truncatePlaces"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"truncateSignificantFigures"\x3e\r\n            \x3clabel\x3e${nls.significantFigures}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\r\n  \x3cdiv class\x3d"field-options-footer"\x3e\r\n    \x3cdiv class\x3d"jimu-btn ok" data-dojo-attach-point\x3d"btnOk"\x3e${nls.common.ok}\x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn cancel" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.common.cancel}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/GpSource.html":'\x3cdiv\x3e\r\n  \x3cdiv style\x3d"display: flex;"\x3e\r\n    \x3cdiv\x3e\r\n      \x3cinput name\x3d"gpsource_mode" id\x3d"gpsource_fromportal_${uniqueID}" data-dojo-attach-point\x3d"portalRadio" data-dojo-type\x3d"dijit/form/RadioButton"/\x3e\r\n      \x3clabel for\x3d"gpsource_fromportal_${uniqueID}" data-dojo-attach-point\x3d"portalLabel"\x3e${nls.selectFromPortal}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"margin-left: 20px;"\x3e\r\n      \x3cinput name\x3d"gpsource_mode" id\x3d"gpsource_fromurl_${uniqueID}" data-dojo-attach-point\x3d"urlRadio" data-dojo-type\x3d"dijit/form/RadioButton"/\x3e\r\n      \x3clabel for\x3d"gpsource_fromurl_${uniqueID}" data-dojo-attach-point\x3d"urlLabel"\x3e${nls.addServiceUrl}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"source-content"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"operationTip" class\x3d"operation-tip"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"hflcContainer" class\x3d"dijit-container hflc-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"flscContainer" class\x3d"dijit-container flsc-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/GpChooserFromPortal.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"selector-container" data-dojo-attach-point\x3d"selectorContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"layers" data-dojo-attach-point\x3d"browserContainer"\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/GpServiceBrowser" data-dojo-attach-point\x3d"gpServiceBrowser"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn  jimu-float-trailing cancel" data-dojo-attach-point\x3d"btnCancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClicked"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn  jimu-float-trailing next jimu-state-disabled" data-dojo-attach-point\x3d"btnNext" data-dojo-attach-event\x3d"onclick:_onBtnNextClicked"\x3e${nls.next}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn  jimu-float-trailing ok jimu-state-disabled" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClicked"\x3e${nls.ok}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn  jimu-float-trailing back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBtnBackClicked"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/ItemSelector.html":'\r\n\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cdiv\x3e${nls.groups}:\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cfieldset id\x3d"publicSearchRaido"\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" data-dojo-type\x3d"dijit/form/RadioButton" \r\n\t\t\t\t\t\t\tdata-label-id\x3d"portalPublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" data-label-for\x3d"portalPublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" data-dojo-type\x3d"dijit/form/RadioButton"\r\n\t\t\t\t\t\t\tdata-label-id\x3d"onlinePublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" data-label-for\x3d"onlinePublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\t\x3c/fieldset\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan title\x3d"${nls.example}:"\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\t\x3cdiv class\x3d"error-section" data-dojo-attach-point\x3d"errorSection"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"error-message" data-dojo-attach-point\x3d"errorNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n\x3ctable role\x3d"listbox" aria-haspopup\x3d"true" data-dojo-attach-point\x3d"dropDownBtn" data-dojo-attach-event\x3d"onclick: _onDropDownClick,onkeydown: _onDropDownKeydown"\r\n  tabindex\x3d"0" title\x3d"${nls.customSelectLayer}" aria-label\x3d"${nls.customSelectLayer}"\x3e\r\n    \x3ccaption class\x3d"screen-readers-only-no-position"\x3e${nls.customSelectLayer}\x3c/caption\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/SituationAwareness/setting/Setting.html":'\x3cdiv class\x3d"main-section"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"tabContainer"\x3e\r\n    \x3c!--Analysis Options Tab--\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"tabOptionsTab" class\x3d"jimu-r-row"\x3e\r\n      \x3c!-- Tabs --\x3e\r\n      \x3cdiv class\x3d"jimu-r-row" style\x3d"margin-bottom: 10px;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"btnAddTab" class\x3d"btn-add-section enable"\x3e\r\n          \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n          \x3cspan class\x3d"btn-add-label"\x3e${nls.addTab}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"tabTable" data-dojo-type\x3d"jimu/dijit/SimpleTable" data-dojo-props\x3d\'fields:[{name:"layer",title:"${nls.layerName}","class":"label",type:"empty",width:"400px"},{name:"type",title:"${nls.layerType}","class":"label",type:"empty"},{name:"label",title:"${nls.layerLabel}","class":"label",type:"empty"},{name:"actions",title:"${nls.actions}","class":"actions",type:"actions",actions:["up","down","edit","delete"],width:"80px"}]\'\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- General Settings: Distances --\x3e\r\n      \x3cfieldset class\x3d"fieldSet downloadTabFieldSet"\x3e\r\n        \x3clegend class\x3d"fieldSetLegend"\x3e${nls.general_setting_Label}\x3c/legend\x3e\r\n        \x3cdiv class\x3d"settingsContainer"\x3e\r\n          \x3cdiv class\x3d"jimu-r-row"\x3e\r\n            \x3c!-- Label Settings --\x3e\r\n            \x3cdiv class\x3d"jimu-r-row"\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cspan class\x3d"label"\x3e${nls.incident_label}: \x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cspan class\x3d"label"\x3e${nls.locate_incident_label}: \x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cspan class\x3d"label"\x3e${nls.buffer_text_lbl}: \x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"jimu-r-row pad-row0"\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"incident_label" title\x3d"${nls.incident_label}"\r\n                       class\x3d"validationBox2" data-dojo-type\x3d"dijit/form/ValidationTextBox" /\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"locate_incident_label" title\x3d"${nls.locate_incident_label}"\r\n                       class\x3d"validationBox2" data-dojo-type\x3d"dijit/form/ValidationTextBox" /\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"buffer_lbl" title\x3d"${nls.buffer_text_lbl}" class\x3d"validationBox2" data-dojo-type\x3d"dijit/form/ValidationTextBox" /\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3c!-- Distance Settings --\x3e\r\n            \x3cdiv class\x3d"jimu-r-row pad-row15"\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cspan class\x3d"label"\x3e${nls.buffer_min_lbl}: \x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cspan class\x3d"label"\x3e${nls.buffer_default_lbl}: \x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cspan class\x3d"label"\x3e${nls.buffer_max_lbl}: \x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"jimu-r-row pad-row0"\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"buffer_min" title\x3d"${nls.buffer_min_lbl}" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'intermediateChanges:true,constraints: {pattern: "#####0.##########", min:0}\'/\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"buffer_default" title\x3d"${nls.buffer_default_lbl}" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'intermediateChanges:true,constraints: {pattern: "#####0.##########", min:0}\'/\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"buffer_max" title\x3d"${nls.buffer_max_lbl}" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'intermediateChanges:true,constraints: {pattern: "#####0.##########", min:0}\'/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3c!-- Units Settings --\x3e\r\n            \x3cdiv class\x3d"jimu-r-row pad-row15"\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cspan class\x3d"label"\x3e${nls.units_text_lbl}: \x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cspan class\x3d"label"\x3e${nls.maximum_distance_lbl}: \x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"jimu-r-row pad-row0"\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cselect class\x3d"select-units" data-dojo-attach-point\x3d"selectUnits" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"txt_maximumDistance" title\x3d"${nls.maximum_distance_lbl}" data-dojo-type\x3d"dijit/form/NumberTextBox" /\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chk_geodesic"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3c!-- Checkbox Settings --\x3e\r\n            \x3cdiv class\x3d"jimu-r-row pad-row15"\x3e\r\n              \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chk_routing"\x3e\x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chk_visibility"\x3e\x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chk_display"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3c!-- Selection Color Settings --\x3e\r\n            \x3cdiv class\x3d"jimu-r-row pad-row15"\x3e\r\n              \x3cdiv class\x3d"col-1-3"\x3e\r\n                \x3cdiv class\x3d"label"\x3e${nls.setSelectionColor}\x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"selectionColorPicker" data-dojo-type\x3d"jimu/dijit/ColorPickerButton"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/fieldset\x3e\r\n\r\n      \x3cdiv class\x3d"jimu-r-row hintText"\x3e\r\n        \x3cp\x3e${nls.weather_removed_message}\x3c/p\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!--Output Options Tab--\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"exportOptionsTab" class\x3d"jimu-r-row"\x3e\r\n      \x3cdiv class\x3d"jimu-r-row" style\x3d"margin-top: 10px;"\x3e\r\n        \x3cfieldset class\x3d"fieldSet downloadTabFieldSet"\x3e\r\n          \x3clegend class\x3d"fieldSetLegend"\x3e${nls.data_label}\x3c/legend\x3e\r\n          \x3cdiv class\x3d"settingsContainer"\x3e\r\n            \x3cdiv class\x3d"jimu-r-row"\x3e\r\n              \x3cdiv class\x3d"col-1-3 pad-right-10"\x3e\r\n                \x3cdiv class\x3d"jimu-r-row hintText"\x3e\r\n                  \x3cp\x3e${nls.instruction_save}\x3c/p\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"div_chk_save"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n\r\n              \x3cdiv class\x3d"chk_snapshot col-1-3"\x3e\r\n                \x3cdiv class\x3d"jimu-r-row hintText"\x3e\r\n                  \x3cp\x3e${nls.instruction_snapshot}\x3c/p\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"div_chk_snapshot"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"col-1-3 col-pad-12"\x3e\r\n                \x3cdiv class\x3d"jimu-r-row hintText"\x3e\r\n                  \x3cp\x3e${nls.instruction_all_fields}\x3c/p\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"div_chk_csv"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Save Options--\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"div_special_tab" class\x3d"jimu-r-row col-1-3"\x3e      \r\n                \x3cdiv class\x3d"jimu-r-row div_edit_options" style\x3d"padding-top: 10px;" data-dojo-attach-point\x3d"editOptions"\x3e\r\n                  \x3ctable\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd class\x3d"td-padding"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"div_chk_point_save"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd class\x3d"td-padding"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"div_selectPointSaveLayer"\x3e\r\n                          \x3cselect class\x3d"select-width" data-dojo-attach-point\x3d"selectPointSaveLayer" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n                        \x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd class\x3d"td-padding"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"div_chk_line_save"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd class\x3d"td-padding"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"div_selectLineSaveLayer"\x3e\r\n                          \x3cselect class\x3d"select-width" data-dojo-attach-point\x3d"selectLineSaveLayer" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n                        \x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd class\x3d"td-padding"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"div_chk_poly_save"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd class\x3d"td-padding"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"div_selectPolySaveLayer"\x3e\r\n                          \x3cselect class\x3d"select-width" data-dojo-attach-point\x3d"selectPolySaveLayer" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n                        \x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e  \r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/fieldset\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-r-row"\x3e\r\n        \x3c!--Report Settings--\x3e\r\n        \x3cfieldset class\x3d"fieldSet downloadTabFieldSet"\x3e\r\n          \x3clegend class\x3d"fieldSetLegend"\x3e${nls.downloadTab.reportLegend}\x3c/legend\x3e\r\n          \x3cdiv class\x3d"settingsContainer"\x3e\r\n            \x3cdiv class\x3d"jimu-r-row hintText"\x3e\r\n              \x3cp\x3e${nls.instruction_report}\x3c/p\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"chk_report" data-dojo-attach-point\x3d"div_chk_report"\x3e\x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"reportSettingsDiv"\x3e\r\n              \x3cdiv class\x3d"downloadTabInputContainer" style\x3d"padding-top: 10px;" data-dojo-attach-point\x3d"printGPServiceInputContainer"\x3e\r\n                \x3c!--Print Service url LABEL--\x3e\r\n                \x3cdiv class\x3d"downloadTabLabel"\x3e\r\n                  ${nls.downloadTab.printGPServiceLabel}\r\n                \x3c/div\x3e\r\n                \x3c!--Print Service url TEXTBOX--\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"printGPServiceTextBox" class\x3d"downloadTabTextbox" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n                     data-dojo-props\x3d\'required:true,trim:true,disabled:true\'\x3e\r\n                \x3c/div\x3e\r\n                \x3c!--Set BUTTON--\x3e\r\n                \x3cdiv class\x3d"jimu-btn jimu-float-trailing downloadTabSetButton" data-dojo-attach-point\x3d"printGPServiceSetButton"\x3e\r\n                  ${nls.downloadTab.setButtonLabel}\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3c!--Logo chooser--\x3e\r\n              \x3cdiv class\x3d"logoChooserMainContainer"\x3e\r\n                \x3cdiv class\x3d"downloadTabLabel"\x3e\r\n                  ${nls.downloadTab.logoLabel}\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"logoChooserDiv"\x3e\r\n                  \x3cdiv class\x3d"imageChooserPreviewContainer"\x3e\r\n                    \x3cimg class\x3d"imageChooserPreview" data-dojo-attach-point\x3d"imageChooserPreview"\x3e\r\n                    \x3cdiv class\x3d"logoChooser" data-dojo-attach-point\x3d"logoChooserNode"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                  \x3cdiv class\x3d"hint"\x3e\r\n                    ${nls.downloadTab.logoChooserHint}\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3c!--Footnote container--\x3e\r\n              \x3cdiv class\x3d"jimu-r-row footnoteContainer"\x3e\r\n                \x3c!--Footnote LABEL--\x3e\r\n                \x3cdiv class\x3d"downloadTabLabel"\x3e\r\n                  ${nls.downloadTab.footnoteLabel}\r\n                \x3c/div\x3e\r\n                \x3c!--Footnote TEXTAREA--\x3e\r\n                \x3ctextarea class\x3d"footnoteTextArea" data-dojo-attach-point\x3d"footnoteTextArea" rows\x3d"4"\x3e\x3c/textarea\x3e\r\n              \x3c/div\x3e\r\n\r\n              \x3c!--Text Color container--\x3e\r\n              \x3cdiv class\x3d"jimu-r-row textColorContainer"\x3e\r\n                \x3c!--Footnote LABEL--\x3e\r\n                \x3cdiv class\x3d"downloadTabLabel"\x3e\r\n                  ${nls.downloadTab.textColorLabel}\r\n                \x3c/div\x3e\r\n                \x3c!--TextColor COLORPICKER--\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"colorPicker" data-dojo-type\x3d"jimu/dijit/ColorPicker" data-dojo-props\x3d\'color:"${_highLightColor}"\' style\x3d"display:inline-block;"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/fieldset\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SituationAwareness/setting/css/style.css":".jimu-widget-SAT-setting .main-section {width: 100%; height: 100%;}.jimu-widget-SAT-setting .select-units {width: 70%;}.jimu-widget-SAT-setting .pad-row15 {padding-top: 15px;}.jimu-widget-SAT-setting .pad-row0 {padding-top: 0px;}.jimu-widget-SAT-setting .selectUnits {margin-left: 10px;}.jimu-widget-SAT-setting .chk_display {padding-top: 15px; padding-bottom: 15px;}.jimu-widget-SAT-setting .display-checkbox {padding-bottom: 15px;}.jimu-widget-SAT-setting .chk_snapshot {}.jimu-widget-SAT-setting .maximum-distance-lbl {width: 60px;}.jimu-widget-SAT-setting .btn-add-section {display: inline-block; overflow: hidden; height: 24px; margin-left: 1px; margin-bottom: 3px; cursor: pointer; font-size: 13px; color: #538ec8; margin-top: 8px;}.jimu-widget-SAT-setting .btn-add-disabled {opacity: .6; cursor: default;}.jimu-widget-SAT .validationBox {}.jimu-widget-SAT .validationBox2 {}.jimu-widget-SAT-setting .btn-add-section .btn-add-icon {height: 100%; width: 14px; background-repeat: no-repeat; background-position: center center; background-image: url(images/add.png); display: inline-block; vertical-align: top;}.jimu-widget-SAT-setting .btn-add-section .btn-add-label {height: 100%; line-height: 24px; margin-left: 7px; text-decoration: underline; display: inline-block; vertical-align: top;}.jimu-widget-SAT-setting .settingAlign{padding-top: 4px; margin-left: 80px;}.jimu-rtl .jimu-widget-SAT-setting .settingAlign{padding-top: 4px; margin-right: 80px;}.jimu-widget-SAT-setting .claro .dojoxCheckedMultiSelect .dojoxCheckedMultiSelectWrapper {border: none !important; background-color: transparent !important;}.jimu-widget-SAT-setting .footer {text-align: right;}.jimu-widget-SAT-setting .field-picker-footer {text-align: right;}.jimu-rtl .jimu-widget-SAT-setting .field-picker-footer {text-align: left;}.jimu-widget-SAT-setting .removeButtonWithIcon {background-image: url(\"../images/filterdialog_icons.png\"); background-repeat: no-repeat; background-position: -30px 0; width: 15px; height: 15px; margin: 0px 0px; display: block;}.jimu-widget-SAT-setting .upButton {background-image: url(\"../../../../jimu.js/css/images/up_enabled.png\"); background-repeat: no-repeat; width: 15px; height: 15px; margin: 0px 0px; display: block;}.jimu-widget-SAT-setting .downButton {background-image: url(\"../../../../jimu.js/css/images/down_enabled.png\"); background-repeat: no-repeat; width: 15px; height: 15px; margin: 0px 0px; display: block;}.jimu-widget-SAT-setting .colorButton {width: 15px; height: 15px; margin: 0px 0px; display: block; background-color: #00ff00;}.jimu-widget-SAT-setting .jimu-color-picker-btn .color-node {min-height: 16px;}.jimu-widget-SAT-setting .footer {padding-top: 5px; width: 100%; height: 30px;}.jimu-widget-SAT-setting .field-picker-footer {width: 100%; position: absolute; bottom: 0;}.jimu-widget-SAT-setting .jimu-simple-table .simple-table-cell{line-height: 26px;}.jimu-widget-SAT-setting .dojoxCheckedMultiSelect .dojoxCheckedMultiSelectWrapper {height: 400px;}.jimu-widget-SAT-setting .dojoxMultiSelectItem {padding-bottom: 5px; padding-top: 5px;}.jimu-widget-SAT-setting .longSelect .dijitSelectLabel {text-align: left; text-overflow: ellipsis; overflow: hidden; max-width: 390px;}.jimu-widget-SAT-setting .medSelect .dijitSelectLabel {text-align: left; text-overflow: ellipsis; overflow: hidden; max-width: 340px;}.jimu-widget-SAT-setting .shortSelect .dijitSelectLabel {text-align: left; text-overflow: ellipsis; overflow: hidden; max-width: 190px;}.jimu-widget-SAT-setting .shortTypeSelect .dijitSelectLabel {text-align: left; text-overflow: ellipsis; overflow: hidden; max-width: 155px; min-width: 155px;}.jimu-widget-SAT-setting .display-options{display: inline-block; margin-right: 30px; vertical-align: middle;}.jimu-widget-SAT-setting .display-on{display: block;}.jimu-widget-SAT-setting .display-off{display: none;}.jimu-widget-SAT-setting .visDivLength {position: absolute; visibility: hidden; width: auto;}.jimu-widget-SAT-setting .field-picker-main {height: 100%; width: 100%; overflow: auto;}.jimu-widget-SAT-setting .pad-top20 {padding-top: 20px;}.jimu-widget-SAT-setting .div_edit_options {padding-top: 5px;}.jimu-widget-SAT-setting .edit_options {padding-top: 15px;}.jimu-widget-SAT-setting .td-padding {padding-bottom: 5px; padding-left: 5px;}.jimu-rtl .jimu-widget-SAT-setting .td-padding {padding-bottom: 5px; padding-right: 5px;}.jimu-widget-SAT-setting .pad-right-10 {padding-right: 10px;}.jimu-rtl .jimu-widget-SAT-setting .pad-right-10 {padding-left: 10px;}.jimu-widget-SAT-setting .select-width {width: 250px;}.jimu-widget-SAT-setting .select-width .dijitSelectLabel {max-width: 250px; text-overflow: ellipsis; text-align: left; overflow: hidden;}.jimu-rtl .jimu-widget-SAT-setting .select-width .dijitSelectLabel {max-width: 250px; text-overflow: ellipsis; text-align: right; overflow: hidden;}.jimu-widget-SAT-setting .hintText {font-size: 12px; color: #a0acbf; font-style: oblique;}.jimu-widget-SAT-setting .fieldSet {height: auto; width: 100%; border: 1px solid #a0acbf; border-radius: 5px; font-size: 14px; color: #596679; margin-bottom: 10px; min-width: 0px;}.jimu-widget-SAT-setting .downloadTabFieldSet {padding: 15px 0px;}.jimu-widget-SAT-setting .fieldSetLegend {margin-left: 20px;}.jimu-widget-SAT-setting .col-pad-12 {padding-left: 12px;}.jimu-rtl .jimu-widget-SAT-setting .col-pad-12 {padding-right: 12px;}.jimu-widget-SAT-setting .settingsContainer {margin-left: auto; margin-right: 0px; margin-top: 0px; margin-bottom: 0px; width: 98%;}.jimu-rtl .jimu-widget-SAT-setting .settingsContainer {margin-right: auto; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; width: 98%;}.jimu-widget-SAT-setting .downloadTabInputContainer {width: 100%; float: left; margin-bottom: 15px;}.jimu-widget-SAT-setting .downloadTabLabel {width: 35%; line-height: 30px; float: left; clear: left; white-space: nowrap; text-overflow: ellipsis; overflow: hidden;}.jimu-widget-SAT-setting .downloadTabTextbox {width: 55%; float: left;}.jimu-widget-SAT-setting .downloadTabSetButton {width: 8%; float: left; margin-left: 17px; line-height: 28px;}.jimu-widget-SAT-setting .downloadTabLabel {width: 35%; line-height: 30px; float: left; clear: left; white-space: nowrap; text-overflow: ellipsis; overflow: hidden;}.jimu-widget-SAT-setting .logoChooserDiv {width: 65%; float: left;}.jimu-widget-SAT-setting .imageChooserPreviewContainer {position: relative;}.jimu-widget-SAT-setting .imageChooserPreview {position: absolute; height: 55px; background-position: center center; background-repeat: no-repeat;}.jimu-widget-SAT-setting .imageChooserContent {height: 50px !important; width: 50px !important;}.jimu-widget-SAT-setting .hint {margin: 5px 5px 10px 0px; float: left; font-size: 12px; color: #a0acbf; font-style: oblique;}.jimu-widget-SAT-setting .footnoteTextArea {width: 65% !important; padding: 5px !important; float: right; color: #596679;}.jimu-widget-SAT-setting .textColorContainer{padding-top: 10px;}.jimu-widget-SAT-setting .field-option-table {border-spacing: 20px;}.jimu-widget-SAT-setting .field-option-table {border-spacing: 20px;}.jimu-widget-SAT-setting .content-disabled {opacity: .6; cursor: default;}.jimu-widget-SAT-setting .content-enabled {}.jimu-widget-SAT-setting .field-options-footer {position: relative; float: right;}.jimu-popup .SAT-warning-icon {width: 25px; height: 25px; position: relative; background-size: contain; background-repeat: no-repeat; background-image: url('../images/warning.png'); margin-top: 8px;}.jimu-popup .SAT-warning-hint {color: #898989; font-size: 11px; margin-bottom: 10px;}.jimu-widget-SAT-setting .float-right {float: right; margin-right: 20px;}.jimu-rtl .jimu-widget-SAT-setting .float-right {float: left; margin-left: 20px;}.jimu-widget-SAT-setting .edit-options {display: block; width: 18px; height: 16px; background-repeat: no-repeat;}.jimu-widget-SAT-setting .edit-fields-disabled {background-image: url('../css/images/edit_disabled.png'); cursor: default;}.jimu-widget-SAT-setting .edit-fields {background-image: url('../css/images/edit_default.png'); cursor: pointer;}.jimu-widget-SAT-setting .edit-fields:hover {background-image: url('../css/images/edit_hover.png');}.jimu-widget-SAT-setting .margin-left {margin-left: 20px;}.jimu-rtl .jimu-widget-SAT-setting .margin-left {margin-right: 20px;}",
"*now":function(k){k(['dojo/i18n!*preload*widgets/SituationAwareness/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/Color dojo/dom-style dojo/promise/all dojo/Deferred dojo/Evented dojo/on dojo/query dojo/dom-attr dojo/string dijit/form/Select dijit/form/ValidationTextBox dijit/_WidgetsInTemplateMixin dijit/focus ./FieldPicker esri/lang jimu/dijit/FeaturelayerChooserFromMap jimu/BaseWidgetSetting jimu/dijit/Message jimu/dijit/Popup jimu/dijit/TabContainer3 jimu/dijit/GpSource jimu/LayerInfos/LayerInfos jimu/dijit/CheckBox dojo/dom-class dojo/dom-construct dojo/keys dijit/registry jimu/dijit/ImageChooser jimu/portalUtils jimu/utils jimu/dijit/LayerChooserFromMapWithDropbox jimu/dijit/RadioBtn jimu/dijit/SimpleTable jimu/dijit/ColorPicker jimu/dijit/ColorPickerButton".split(" "),function(k,
p,l,n,f,b,d,a,c,h,m,e,q,r,v,g,u,A,w,x,F,G,D,H,y,t,C,I,L,M,J,N,Q,O){return k([x,v,a],{baseClass:"jimu-widget-SAT-setting",opLayers:[],curRow:null,validFields:[],saveValid:!0,textValid:!0,bufferValid:!0,skipLayers:[],_selectedLayerIds:[],_allLayers:[],_highLightColor:"#0f96cc",postCreate:function(){this.inherited(arguments);this._initCheckBoxes();this.updateTabs();this._initTabs();this._initReport();this.nls=l.mixin(l.mixin(this.nls,window.jimuNls.units),window.jimuNls.temperature);this._initLayerChooser();
this.addSelectUnitOptions();this._getAllLayers();this.own(c(this.tabTable,"actions-edit",l.hitch(this,this._onEditLayerClicked)));this.own(c(this.tabTable,"row-delete",l.hitch(this,this._rowDeleted)));this.own(c(this.tabTable,"row-up",l.hitch(this,this._moveRow,!0)));this.own(c(this.tabTable,"row-down",l.hitch(this,this._moveRow,!1)));this.tabTable.onBeforeRowDelete=l.hitch(this,this._onBeforeDelete);this._addValidator(this.incident_label,this.checkSmallString,this.nls.invalid_string_width);this._addValidator(this.locate_incident_label,
this.checkLargeString,this.nls.invalid_string_width);this._addValidator(this.buffer_lbl,this.checkLargeString,this.nls.invalid_string_width);this._addValidator(this.buffer_min,this.checkMin,this.nls.not_less_than_max);this._addValidator(this.buffer_default,this.checkBetween,this.nls.not_between);this._addValidator(this.buffer_max,this.checkMax,this.nls.not_more_than_min);this.own(c(this.buffer_min,"keyup",l.hitch(this,this._validateBuffer)));this.own(c(this.buffer_default,"keyup",l.hitch(this,this._validateBuffer)));
this.own(c(this.buffer_max,"keyup",l.hitch(this,this._validateBuffer)));var a=function(){this.set("value",isNaN(this.value)?0:this.value)};this.own(c(this.buffer_min,"blur",a));this.own(c(this.buffer_default,"blur",a));this.own(c(this.buffer_max,"blur",a))},_initCheckBoxes:function(){this.chk_routing=this._initCheckBox(this.nls.routing_checkBox,this.div_chk_routing);this.chk_visibility=this._initCheckBox(this.nls.visibility_checkBox,this.div_chk_visibility);this.chk_display=this._initCheckBox(this.nls.display_checkbox,
this.div_chk_display);this.chk_save=this._initCheckBox(this.nls.save_checkbox,this.div_chk_save);this.chk_snapshot=this._initCheckBox(this.nls.snapshot_checkbox,this.div_chk_snapshot);this.chk_csv=this._initCheckBox(this.nls.csv_checkbox,this.div_chk_csv);this.chk_point_save=this._initCheckBox(this.nls.save_point_checkbox,this.div_chk_point_save);this.chk_line_save=this._initCheckBox(this.nls.save_line_checkbox,this.div_chk_line_save);this.chk_poly_save=this._initCheckBox(this.nls.save_poly_checkbox,
this.div_chk_poly_save);this.chk_report=this._initCheckBox(this.nls.report_checkbox,this.div_chk_report);this.chk_geodesic=this._initCheckBox(this.nls.drawGeodesic,this.div_chk_geodesic)},_initCheckBox:function(a,b){var c=new t;c.setLabel(a);c.placeAt(b);return c},_initLayerChooser:function(){this._selectedLayerIds=[];this._allLayers=[];this.layerChooserFromMap=new w({multiple:!1,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,createMapResponse:this.map.webMapResponse});this.layerChooserFromMap.startup();
var a=this.layerChooserFromMap.layerInfosObj.getLayerInfoArray(),d=[];this._getAllFilteredLayers(a,d);b(d).then(l.hitch(this,function(){0<this._allLayers.length?this.own(c(this.btnAddTab,"click",l.hitch(this,this._addTabRow))):(f.set(this.btnAddTab,"display","none"),f.set(this.tabOptionsTab,"margin-top","10px"),new F({message:this.nls.missingLayerInWebMap}),this.noValidLayers=!0)}))},_getAllFilteredLayers:function(a,b){p.forEach(a,l.hitch(this,function(a){var c;a.isLeaf()?(c=new d,this.layerChooserFromMap.filter(a).then(l.hitch(this,
function(b){b&&this._allLayers.push(a);c.resolve()})),b.push(c)):this._getAllFilteredLayers(a.newSubLayers,b)}))},updateTabs:function(){if(this.config&&this.config.tabs&&this.config.tabs.length)for(var a=this.config.tabs,b=0;b<a.length;b++){var c=a[b];c.type&&"weather"===c.type&&a.splice(b,1)}},_addValidator:function(a,b,c){a.invalidMessage=c;a.validator=l.hitch(this,b,a)},_validateBuffer:function(a){var b=[L.RIGHT_ARROW,L.LEFT_ARROW,190,110,13];if(!(a&&a.keyCode&&-1<b.indexOf(a.keyCode))){var b=
this.buffer_min.validate(),c=this.buffer_default.validate(),d=this.buffer_max.validate();this.bufferValid=b&&c&&d;if(b||c||d)!b&&d&&c&&(g.focus(this.buffer_min.domNode),this.buffer_min.domNode.blur()),!c&&d&&b&&(g.focus(this.buffer_default.domNode),this.buffer_default.domNode.blur()),!d&&b&&c&&(g.focus(this.buffer_max.domNode),this.buffer_max.domNode.blur());a&&a.target?g.focus(a.target):g.focus(this.domNode);this.textValid&&this.saveValid&&this._validateRows()&&this.bufferValid?this._enableOk():
this._disableOk()}},_initReport:function(){this.own(c(this.chk_report,"change",l.hitch(this,function(a){this._updateDisplay(this.reportSettingsDiv,a)})));this._setPrintTaskURL();this._setFootnote();this._setReportTextColor();this.own(c(this.printGPServiceSetButton,"click",l.hitch(this,function(){var a=new H({portalUrl:this.appConfig.portalUrl}),b=this._onSetButtonClick(a);this._attachPrintReportGPSourceEvents(a,b)})));this._initImageChooser()},_setPrintTaskURL:function(){if(this.reportSettings&&this.reportSettings.printTaskURL&&
""!==this.reportSettings.printTaskURL)this.printGPServiceTextBox.set("value",this.reportSettings.printTaskURL),this._printTaskURL=this.reportSettings.printTaskURL;else{var a=N.getPortal(this.appConfig.portalUrl).helperServices;a&&a.printTask.url&&(this.printGPServiceTextBox.set("value",a.printTask.url),this._printTaskURL=a.printTask.url)}},_setFootnote:function(){this.reportSettings&&this.reportSettings.footnote&&""!==this.reportSettings.footnote&&(this.footnoteTextArea.value=this.reportSettings.footnote)},
_setReportTextColor:function(){this.reportSettings&&this.reportSettings.textColor&&this.colorPicker.setColor(new n(this.reportSettings.textColor))},addSelectUnitOptions:function(){this.selectUnits.addOption([{label:this.nls.miles,value:"miles",selected:!0},{label:this.nls.kilometers,value:"kilometers",selected:!1},{label:this.nls.feet,value:"feet",selected:!1},{label:this.nls.meters,value:"meters",selected:!1},{label:this.nls.yards,value:"yards",selected:!1},{label:this.nls.nauticalMiles,value:"nauticalMiles",
selected:!1}])},startup:function(){this.inherited(arguments)},_initTabs:function(){this._tabsContainer=new D({tabs:[{title:this.nls.tab_options,content:this.tabOptionsTab},{title:this.nls.export_options,content:this.exportOptionsTab}]},this.tabContainer);this.own(c(this._tabsContainer,"tabChanged",l.hitch(this,function(){this._tabsContainer.containerNode.scrollTop=0})));this._tabsContainer.startup()},setConfig:function(a){this.config=a;this.config.distanceUnits&&this.selectUnits.setValue(this.config.distanceUnits);
this.config.maxDistance&&this.txt_maximumDistance.setValue(this.config.maxDistance);this.config.enableRouting&&this.chk_routing.setValue(!0);this.config.drawGeodesic&&this.chk_geodesic.setValue(!0);a=[];this.tabTable.clear();for(var b=0;b<this.config.tabs.length;b++){var d=this._populateTabTableRow(this.config.tabs[b]);d&&a.push(d)}this._handleMissingLayers(a);this.incident_label.set("value",this.config.incidentLabel?this.config.incidentLabel:this.nls.incident);this.locate_incident_label.set("value",
this.config.locateIncidentLabel?this.config.locateIncidentLabel:this.nls.locate_incident);this.buffer_lbl.set("value",this.config.bufferLabel?this.config.bufferLabel:this.nls.buffer_value);this.buffer_max.set("value",this.config.bufferRange.maximum);this.buffer_min.set("value",this.config.bufferRange.minimum);this.buffer_default.set("value","undefined"!==typeof this.config.bufferRange._default?this.config.bufferRange._default:this.config.bufferRange.minimum);this._validateBuffer();this.config.disableVisibilityManagement&&
this.chk_visibility.setValue(!0);this.config.saveEnabled&&"undefined"===typeof this.config.savePolys&&"undefined"===typeof this.config.saveLines&&"undefined"===typeof this.config.savePoints&&(this.config.savePolys=!0,this.config.polyEditLayer=this.config.editLayer);a=!1;a=this._updateEditUI(this.save_point_layers,this.chk_point_save,this.div_selectPointSaveLayer,this.config.savePoints,this.selectPointSaveLayer,this.config.pointEditLayer)?!0:a;a=this._updateEditUI(this.save_line_layers,this.chk_line_save,
this.div_selectLineSaveLayer,this.config.saveLines,this.selectLineSaveLayer,this.config.lineEditLayer)?!0:a;this._updateEditUI(this.save_poly_layers,this.chk_poly_save,this.div_selectPolySaveLayer,this.config.savePolys,this.selectPolySaveLayer,this.config.polyEditLayer)||a?(this.own(c(this.chk_save,"change",l.hitch(this,function(a){this._updateDisplay(this.editOptions,a)}))),this.chk_save.setValue(this.config.saveEnabled),this._updateDisplay(this.editOptions,this.config.saveEnabled),this.config.saveEnabled&&
this.config.editTemplate&&(this.selectedTemplate=this.config.editTemplate,"undefined"!==typeof this.config.selectedTemplateIndex&&(this.selectedTemplateIndex=this.config.selectedTemplateIndex))):(this.chk_save.setStatus(!1),this._updateDisplay(this.editOptions,!1));this.chk_csv.setValue(this.config.csvAllFields);this.chk_display.setValue(this.config.summaryDisplayEnabled);this.config.selectionColor?this.selectionColorPicker.setColor(new n(this.config.selectionColor)):Q.getStyleColorInTheme().then(l.hitch(this,
function(a){a&&this.selectionColorPicker.setColor(new n(a))}));this.chk_snapshot.setValue(this.config.snapshotEnabled||!1);this.chk_report.setValue(this.config.reportEnabled||!1);this._updateDisplay(this.reportSettingsDiv,this.config.reportEnabled||!1);this.reportSettings=this.config.reportSettings;this._setPrintTaskURL();this._setFootnote();this._setReportTextColor();this._createLogoPreview();this.noValidLayers&&this._disableOk()},_handleMissingLayers:function(a){if(0<a.length){var b="";p.forEach(a,
l.hitch(this,function(a){b+=A.substitute({name:a},this.nls.missingLayer)+"\x3c/br\x3e\x3c/br\x3e"}));a=I.create("div",{style:"max-height:500px;overflow:auto;"});I.create("div",{className:"SAT-warning-hint",innerHTML:this.nls.missingLayerHint},a);I.create("div",{innerHTML:b.substr(0,b.lastIndexOf("\x3c/br\x3e\x3c/br\x3e")),style:"padding-"+(window.isRTL?"right":"left")+": 10px;"},a);new F({titleLabel:"\x3cdiv class\x3d'SAT-warning-icon' style\x3d'float: "+(window.isRTL?"right; margin-left":"left; margin-right")+
": 10px;'\x3e\x3c/div\x3e"+this.nls.layerNotAvalible,message:a,maxWidth:350})}},_updateEditUI:function(a,b,c,d,e,f){var z=!1;"undefined"!==typeof a&&0<a.length?(z=!0,b.onChange=l.hitch(this,function(a){this._updateDisplay(c,a)}),e.addOption(a),a=!1,"undefined"!==typeof d&&(a=d)&&e.set("value",f),b.setValue(a),this._updateDisplay(c,a)):(b.setStatus(!1),b.setValue(!1),this._updateDisplay(c,!1));return z},_updateDisplay:function(a,b){C.contains(a,b?"display-off":"display-on")&&C.remove(a,b?"display-off":
"display-on");C.add(a,b?"display-on":"display-off");(this.saveValid=this._validateSave())&&this._validateRows()&&this.textValid&&this.bufferValid?this._enableOk():this._disableOk()},_validateRows:function(){var a=!0,b=this.tabTable.getRows();p.forEach(b,function(b){a=!1===b.isValid?b.isValid:a});return a},_validateSave:function(){var a=!1;if(this.chk_save.getValue()){if(this.chk_point_save.getValue()||this.chk_line_save.getValue()||this.chk_poly_save.getValue())a=!0}else a=!0;return a},getConfig:function(){var a=
[],b={},c=this.tabTable.getRows();p.forEach(c,l.hitch(this,function(c){var d=c.selectTypes,e=c.labelText,f=c.selectLayers.getSelectedItem();b={};b.label=e.value;b.type=d.value;b.layerTitle=f.layerInfo.title;b.layers=f.layerInfo.id;c.tabInfo&&c.tabInfo.advStat?b.advStat=c.tabInfo.advStat:c.validFields&&(e=new u({test:!0,nls:this.nls}),b.advStat=e.getDefaultFields(c.validFields.popUpFields,c.validFields.validSummaryFields,d.value));a.push(b)}));this.config.tabs=a;this.config.incidentLabel=this.incident_label.value;
this.config.locateIncidentLabel=this.locate_incident_label.value;this.config.bufferLabel=this.buffer_lbl.value;this.config.bufferRange.maximum=this.buffer_max.value;this.config.bufferRange.minimum=this.buffer_min.value;this.config.bufferRange._default=this.buffer_default.value;this.config.distanceUnits=this.selectUnits.value;this.config.disableVisibilityManagement=this.chk_visibility.getValue();this.config.enableRouting=this.chk_routing.getValue();this.config.saveEnabled=this.chk_save.getValue();
this.config.savePoints=this.chk_point_save.getValue();this.config.drawGeodesic=this.chk_geodesic.getValue();this.config.savePoints&&(this.config.pointEditLayer=this.selectPointSaveLayer.value);this.config.saveLines=this.chk_line_save.getValue();this.config.saveLines&&(this.config.lineEditLayer=this.selectLineSaveLayer.value);this.config.savePolys=this.chk_poly_save.getValue();this.config.savePolys&&(this.config.polyEditLayer=this.selectPolySaveLayer.value);this.txt_maximumDistance.value&&(this.config.maxDistance=
this.txt_maximumDistance.value);this.config.selectionColor=this.selectionColorPicker.getColor().toHex();this.config.csvAllFields=this.chk_csv.getValue();this.config.summaryDisplayEnabled=this.chk_display.getValue();this.config.snapshotEnabled=this.chk_snapshot.getValue();this.config.reportEnabled=this.chk_report.getValue();this.config.reportSettings={printTaskURL:this.getPrintReportGPServiceURL(),footnote:this.getFootnoteForReport(),logo:this.getLogo(),textColor:this.colorPicker.getColor().toHex()};
return this.config},_getAllLayers:function(){this.map.itemId&&y.getInstance(this.map,this.map.itemInfo).then(l.hitch(this,function(a){this.opLayers=a;this._setLayers();this._setTypes();this.setConfig(this.config)}))},_setLayers:function(){var a=[],b=[],c=[],d=[];this.skipLayers=[];p.forEach(this.opLayers._layerInfos,l.hitch(this,function(e){0<e.newSubLayers.length?this._recurseOpLayers(e.newSubLayers,a,b,c,d):this._checkSkipLayer(e)||(a.push({label:e.title,value:e.id}),e.layerObject&&this._updateEditOptions(e,
b,c,d))}));if(0<this.skipLayers.length){var e="";p.forEach(this.skipLayers,function(a){e+="Layer Name: "+a.name+"\r\nLayer Type: "+("collection"===a.type?"Feature Collection":a.type)+"\r\n\r\n"});new F({titleLabel:this.nls.layer_type_not_supported,message:"\x3cdiv style\x3d'max-height: 500px; overflow: auto;'\x3e"+e+"\x3c/div\x3e",maxWidth:450})}this.layer_options=l.clone(a);this.checkFields();this.save_point_layers=l.clone(b);this.save_line_layers=l.clone(c);this.save_poly_layers=l.clone(d)},checkFields:function(){this.validFields=
[];for(var a,b=0;b<this.layer_options.length;b++)a=new u({nls:this.nls,callerLayer:this.layer_options[b].value,callerOpLayers:this.opLayers._layerInfos,map:this.map,test:!0,callerTab:{type:"closest"}}),a._validatePopupFields().then(l.hitch(this,function(a){this.validFields.push(a)}))},_recurseOpLayers:function(a,b,c,d,e){p.forEach(a,l.hitch(this,function(a){0<a.newSubLayers.length?this._recurseOpLayers(a.newSubLayers,b,c,d,e):this._checkSkipLayer(a)||(b.push({label:a.title,value:a.id}),a.layerObject&&
this._updateEditOptions(a,c,d,e))}))},_checkSkipLayer:function(a){var b=["ArcGISFeatureLayer","ArcGISMapServiceLayer","Feature Layer"],c=!1;a.layerObject&&(a.layerObject.hasOwnProperty("tileInfo")&&(c=!0),a.layerObject.url&&(-1<a.layerObject.url.indexOf("ImageServer")||-1<a.layerObject.url.indexOf(".csv"))&&(c=!0),a.layerObject.type&&-1===b.indexOf(a.layerObject.type)&&(c=!0),a.layerObject.url||(c=!0));c&&this.skipLayers.push({name:a.title,type:a.originOperLayer&&a.originOperLayer.selfType?a.originOperLayer.selfType:
a.originOperLayer&&a.originOperLayer.type?a.originOperLayer.type:a.layerObject.type});return c},_updateEditOptions:function(a,b,c,d){var e=a.layerObject,f=e.capabilities,g;(f&&0<f.indexOf("Edit")||f&&0<f.indexOf("Create"))&&a.controlPopupInfo&&a.controlPopupInfo.enablePopup&&("esriGeometryPoint"===e.geometryType?g=b:"esriGeometryPolyline"===e.geometryType?g=c:"esriGeometryPolygon"===e.geometryType&&(g=d),"undefined"!==typeof g&&g.push({label:a.title,value:a.id,selected:!1}))},_setTypes:function(){this.analysis_options=
[{value:"closest",label:this.nls.closest},{value:"proximity",label:this.nls.proximity},{value:"summary",label:this.nls.summary},{value:"groupedSummary",label:this.nls.groupedSummary}]},_populateTabTableRow:function(a){var b="undefined"!==typeof a.layerTitle?a.layers:this.getLayerID(a.layers);if(b=this.opLayers.getLayerInfoById(b)){var c=this.tabTable.addRow({});if(c.success&&c.tr){var d=c.tr;d.tabInfo=a;this._addTabLayers(d);this._addTabTypes(d);this._addTabLabel(d);this.layerExists(d.selectLayers.options,
a)||d.selectLayers.invalidValues.push(a.layers);b.getLayerObject().then(l.hitch(this,function(a){d.selectLayers.setSelectedLayer(a)}));d.selectTypes.set("value",a.type,!1);d.type=a.type;d.labelText.set("value",a.label)}return!1}return a.layerTitle||a.layers},getLayerID:function(a){for(var b=0;b<this.layer_options.length;b++){var c=this.layer_options[b];if(a===c.label||a===c.value)return c.value}},_onBeforeDelete:function(a){this._selectedLayerIds.splice(a.rowIndex,1);return!0},_rowDeleted:function(a){a.selectLayers&&
a.selectLayers.destroy();var b=this.tabTable.getRows();a=!0;for(var c=0;c<b.length;c++)if(!b[c].isValid){a=!1;break}b=h(".button-container")[0];f.set(b.children[2],"display",a?"inline-block":"none");f.set(b.children[3],"display",a?"none":"inline-block")},_moveRow:function(a,b){var c=this._selectedLayerIds[b.rowIndex],d=a?b.rowIndex+1:b.rowIndex-1,e=this._selectedLayerIds[d];this._selectedLayerIds.splice(a?b.rowIndex:d,2,a?e:c,a?c:e)},_getLayerList:function(){return this._selectedLayerIds.length<this._allLayers.length?
p.filter(this._allLayers,l.hitch(this,function(a){return 0>this._selectedLayerIds.indexOf(a.id)})):this._allLayers},_addTabRow:function(){var a=this.tabTable.addRow({});if(a.success&&a.tr){var a=a.tr,b=this._getLayerList();this._addTabLayers(a,b[0]);this._addTabTypes(a);this._addTabLabel(a)}},_addTabLayers:function(a,b){var d=l.clone(this.layer_options),e=h(".simple-table-cell",a)[0];if(e){var f=new w({multiple:!1,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,createMapResponse:this.map.webMapResponse});
f.startup();d=new O({layerChooser:f,options:d,isValid:this.validateLayer,required:!0,invalidValues:[],row:a});d.placeAt(e);d.startup();a.selectLayers=d;d._missingMsg=this.nls.layer_error;this.own(c(d,"selection-change",function(a){this.emit("used-layer-change",{layer:a[0],rowIndex:this.row.rowIndex});a=this.domNode.parentNode;a.parentNode.selectTypes&&(a.parentNode.selectTypes.validate(),g.focus(a.parentNode.selectTypes.domNode),a.parentNode.selectTypes.domNode.blur());a=h(".jimu-simple-table")[0];
g.focus(a);g.focus(this.domNode)}));this.own(c(d,"used-layer-change",l.hitch(this,function(a){this._selectedLayerIds[a.rowIndex]=a.layer.id})));b&&b.getLayerObject().then(l.hitch(this,function(b){a.selectLayers.setSelectedLayer(b)}));g.focus(d.domNode);d.domNode.blur();b=h(".jimu-simple-table")[0];g.focus(b)}},_addTabTypes:function(a){var b=l.clone(this.analysis_options),c=h(".simple-table-cell",a)[1];c&&(b=new q({style:{width:"100%",height:"26px"},required:!0,isValid:this.validateType,validFields:this.validFields,
options:b,row:a,parent:this,parentTable:this.tabTable,nls:this.nls,"class":"shortTypeSelect"}),b.placeAt(c),b.startup(),b._missingMsg=this.nls.need_group_field,b.on("change",function(){this.row.type!==this.value&&this.row.tabInfo&&delete this.row.tabInfo.advStat;this.domNode.blur();var a=h(".jimu-simple-table")[0];this.row.type=this.value;g.focus(a)}),a.selectTypes=b,g.focus(b.domNode),b.domNode.blur(),a=h(".jimu-simple-table")[0],g.focus(a))},layerExists:function(a,b){var c=b.layers,d=!1;p.forEach(a,
function(a){d||(d=a.value===c)});return d},validateLayer:function(){var a=-1===this.invalidValues.indexOf(this.value),b=this.row.querySelectorAll(".jimu-icon-edit")[0];a?C.contains(b,"jimu-state-disabled")&&C.remove(b,"jimu-state-disabled"):C.add(b,"jimu-state-disabled");this.row.selectTypes&&(this.row.selectTypes.disabled=!a);return a},validateType:function(){var a=this.row,b=this.value,c=!0,d=a.tabInfo,e=!0,g;d&&a&&a.type&&d.type!==a.type&&"groupedSummary"!==d.type&&(d=void 0);d&&d.advStat&&d.advStat.stats?
g=d.advStat.stats:e=!1;for(var k=0;k<this.validFields.length;k++){var l=this.validFields[k],m=a.selectLayers.getSelectedItem();if(m&&l.layer===m.layerInfo.id){a.validFields=l;if("summary"===b)g&&(g.hasOwnProperty("min")||g.hasOwnProperty("max")||g.hasOwnProperty("avg")||g.hasOwnProperty("sum")||g.hasOwnProperty("count")||g.hasOwnProperty("area")||g.hasOwnProperty("length")||(e=!1)),e||l.hasSummaryPopupFields||(this._missingMsg=l.hasSummaryFields?this.nls.no_valid_popup_fields:this.nls.no_valid_fields,
c=!1);else if("groupedSummary"===b){if(this._missingMsg=this.nls.need_group_field,g&&!g.hasOwnProperty("pre")&&!g.hasOwnProperty("suf")||!e)c=!1}else(e=g&&g.outFields?0<g.outFields.length:!1,e||"undefined"!==typeof d||l.hasPopupFields)?e||l.hasPopupFields||(this._missingMsg=l.hasPopupFields?this.nls.no_valid_fields:this.nls.no_valid_popup_fields,c=!1):(this._missingMsg=this.nls.no_valid_popup_fields,c=!1);break}}a.isValid=c;a.isEditable=!0;a=a.querySelectorAll(".jimu-icon-edit")[0];C.contains(a,"jimu-state-disabled")&&
C.remove(a,"jimu-state-disabled");b=this.parentTable.getRows();a=!0;for(d=0;d<b.length;d++)if(!b[d].isValid){a=!1;break}b=this.parent;d=h(".button-container")[0];f.set(d.children[2],"display",a&&b.saveValid&&b.textValid&&b.bufferValid?"inline-block":"none");f.set(d.children[3],"display",a&&b.saveValid&&b.textValid&&b.bufferValid?"none":"inline-block");return c},validatePattern:function(a){return(a=/[0-9]*\.?[0-9]+/.exec(a))&&""!==a?!0:!1},checkMax:function(a,b){b=b.toString().replace(/,/g,"");b=parseFloat(b,
10);var c=parseFloat(this.buffer_min.value,10);if(isNaN(b)||isNaN(c))return a.invalidMessage=this.nls.not_valid_number,this.validatePattern();a.invalidMessage=this.nls.not_more_than_min;return c<b},checkBetween:function(a,b){var c=parseFloat(this.buffer_min.value,10);b=b.toString().replace(/,/g,"");b=parseFloat(b,10);var d=parseFloat(this.buffer_max.value,10);if(isNaN(c)||isNaN(d)||isNaN(b))return a.invalidMessage=this.nls.not_valid_number,this.validatePattern();a.invalidMessage=this.nls.not_between;
return b>=c&&b<=d},checkMin:function(a,b){b=b.toString().replace(/,/g,"");b=parseFloat(b,10);var c=parseFloat(this.buffer_max.value,10);if(isNaN(b)||isNaN(c))return a.invalidMessage=this.nls.not_valid_number,this.validatePattern();a.invalidMessage=this.nls.not_less_than_max;return b<c},checkSmallString:function(a,b){return this.checkString(a,b,180)},checkLargeString:function(a,b){return this.checkString(a,b,260)},checkString:function(a,b,c){b=I.create("div",{"class":"visDivLength",id:"SA_VisDiv",
innerHTML:b},a.domNode);c=b.clientWidth<c?!0:!1;I.destroy(b);this.textValid=c;var d=M.byNode(a.domNode).id;h(".validationBox2").forEach(l.hitch(this,function(a){a=M.byNode(a);d!==a.id&&(this.textValid=this.textValid?"Error"!==a.state:this.textValid)}));this.textValid&&this.saveValid&&this._validateRows()&&this.bufferValid?this._enableOk():this._disableOk();return c},_addTabLabel:function(a){var b=h(".simple-table-cell",a)[2],c=new r({style:{width:"100%",height:"26px"}});c.placeAt(b);c.startup();a.labelText=
c},_onEditLayerClicked:function(a){this.curRow=a;if(a.isEditable){var b=a.selectLayers.getSelectedItem(),d=a.tabInfo;d||(d={},d.label=a.labelText.value,d.type=a.selectTypes.value,d.layers=b.layerInfo.id,d.advStat={},a.tabInfo=d);var e="undefined"!==typeof d.layerTitle?d.layers:this.getLayerID(d.layers);if(d.type!==a.selectTypes.value||e!==b.layerInfo.id)d.type=a.selectTypes.value,d.layers=b.layerInfo.id,d.advStat={};var f=new u({nls:this.nls,callerLayer:b.layerInfo.id,callerTab:d,callerOpLayers:this.opLayers._layerInfos,
map:this.map}),h=new G({width:830,height:560,content:f,titleLabel:this.nls.selectFields+": "+b.layerInfo.title});this.own(c(f,"ok",l.hitch(this,function(a){this.curRow.tabInfo.advStat=a;a=this.curRow.selectTypes.domNode;this.curRow.selectTypes.validate();g.focus(a);g.focus(a.parentNode.offsetParent);this.curRow=null;f.destroy();f=null;h.close()})));this.own(c(f,"cancel",l.hitch(this,function(){this.curRow=null;f.destroy();f=null;h.close()})))}},_disableOk:function(){var a=h(".button-container")[0];
f.set(a.children[2],"display","none");f.set(a.children[3],"display","inline-block")},_enableOk:function(){var a=h(".button-container")[0];f.set(a.children[2],"display","inline-block");f.set(a.children[3],"display","none")},getLogo:function(){return this.logoChooser&&this.logoChooser.imageData?this.logoChooser.getImageData():this.reportSettings&&this.reportSettings.logo?this.reportSettings.logo:"${appPath}/widgets/SituationAwareness/images/defaultLogo.png"},_createLogoPreview:function(){var a,b;a=
this.folderUrl+"/images/defaultLogo.png";this.reportSettings&&this.reportSettings.logo&&(b=this.reportSettings.logo,-1<b.indexOf("${appPath}")?(a=this.folderUrl.slice(0,this.folderUrl.lastIndexOf("widgets")),a=e.substitute(b,{appPath:a})):a=b);m.set(this.imageChooserPreview,"src",a)},_initImageChooser:function(){this.logoChooser=new J({cropImage:!1,showSelfImg:!1,goldenWidth:50,goldenHeight:50,displayImg:this.imageChooserPreview,format:[J.GIF,J.PNG,J.JPEG]});this.logoChooser.placeAt(this.logoChooserNode);
this._createLogoPreview();C.add(this.logoChooser.domNode,"imageChooserContent")},getFootnoteForReport:function(){return this.footnoteTextArea.value?this.footnoteTextArea.value:""},getPrintReportGPServiceURL:function(){return this._printTaskURL?this._printTaskURL:""},_attachPrintReportGPSourceEvents:function(a,b){this.own(c(a,"ok",l.hitch(this,function(a){a&&0<a.length&&a[0].url?(this.printGPServiceTextBox.set("value",a[0].url),this._printTaskURL=a[0].url):(this.printGPServiceTextBox.set("value",""),
this._printTaskURL="");b.close()})));this.own(c(a,"cancel",l.hitch(this,function(){b.close()})))},_onSetButtonClick:function(a){return new G({titleLabel:this.nls.downloadTab.printGPServiceLabel,width:830,height:560,content:a})}})});