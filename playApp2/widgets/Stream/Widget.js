// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Stream/StreamControl":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-attr dojo/dom-style dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./StreamControl.html jimu/dijit/DrawBox ./FilterItem jimu/dijit/CheckBox dijit/form/RadioButton esri/symbols/jsonUtils esri/symbols/SimpleFillSymbol esri/graphic jimu/dijit/SimpleTable dijit/form/NumberSpinner jimu/dijit/LoadingShelter".split(" "),
function(f,c,k,d,h,a,g,e,m,p,q,r,l,b,n,u,w,x,y){return f([m,p,q],{baseClass:"jimu-widget-stream",templateString:r,map:null,streamLayer:null,isStreaming:!0,mapExtentChangeHandler:null,config:null,filterItems:[],postCreate:function(){this.inherited(arguments);this.spatialFilterToggle=new n({checked:!1,label:this.nls.useSpatialFilter,onChange:c.hitch(this,this._toggleSpatialFilter)});this.spatialFilterToggle.placeAt(this.spatialFilterToggleDiv);this.attrFilterToggle=new n({checked:!1,label:this.nls.useAttributeFilter,
onChange:c.hitch(this,this._toggleAttributeFilter)});this.attrFilterToggle.placeAt(this.attrFilterToggleDiv);this.config&&this._applyConfig();this.streamLayer&&this._bindEvents()},_applyConfig:function(){!0!==this.config.startStop&&a.set(this.startBtn,"display","none");!0!==this.config.clear&&a.set(this.clearBtn,"display","none");!0!==this.config.drawPrevious&&a.set(this.drawPreviousSection,"display","none");!0!==this.config.spatialFilter?(a.set(this.spatialFilterControl,"display","none"),a.set(this.spatialFilterSection,
"display","none")):this.config.mapExtentFilter&&this.config.drawExtentFilter?(this._createMapAreaFilterControl(!0),this._createDrawAreaFilterControl(!0)):this.config.mapExtentFilter?this._createMapAreaFilterControl(!1):this.config.drawExtentFilter?this._createDrawAreaFilterControl(!1):(a.set(this.spatialFilterControl,"display","none"),a.set(this.spatialFilterSection,"display","none"));if(this.config.attrFilter&&0<this.config.filterList.length){var t,v,d=!1;k.forEach(this.config.filterList,c.hitch(this,
function(a,c){v=1===this.config.filterList.length?"checkbox":"radio";var e=!0===a.inherited&&a.definitionExpression===this.streamLayer.getDefinitionExpression();t=new b({uid:this.id,config:a,type:v,streamLayer:this.streamLayer,index:c,checked:e,nls:this.nls});t.placeAt(this.attrFilterSection);this.filterItems.push(t);d=d||e}));d&&this.attrFilterToggle.setValue(!0)}else a.set(this.attrFilterControl,"display","none"),a.set(this.attrFilterSection,"display","none");this.config.spatialFilter||this.config.attrFilter&&
0!==this.config.filterList.length||a.set(this.filterLabelSection,"display","none")},_createMapAreaFilterControl:function(a){var b;b=e.create("div",{"class":"filterOption"},this.spatialFilterSection);a?(this.mapAreaControl=new u({id:this.id+"_mapAreaObservations",name:this.id+"_sf",value:"mapArea"}),this.mapAreaControl.placeAt(b),this.own(d(this.mapAreaControl,"change",c.hitch(this,this._mapAreaFilterChange))),e.create("label",{"class":"jimu-widget-normal","for":this.id+"_mapAreaObservations",innerHTML:this.nls.showMapAreaObservations},
b)):(this.mapAreaControl=new n({checked:!1,label:this.nls.showMapAreaObservations,onChange:c.hitch(this,this._mapAreaFilterChange)}),this.mapAreaControl.placeAt(b))},_createDrawAreaFilterControl:function(a){var b;b=e.create("div",{"class":"filterOption"},this.spatialFilterSection);a?(this.drawAreaControl=new u({id:this.id+"_drawAreaObservations",name:this.id+"_sf",value:"drawArea"}),this.drawAreaControl.placeAt(b),this.own(d(this.drawAreaControl,"change",c.hitch(this,this._drawAreaFilterChange))),
e.create("label",{"class":"jimu-widget-normal","for":this.id+"_drawAreaObservations",innerHTML:this.nls.showObservationsByDrawing},b)):(this.drawAreaControl=new n({checked:!1,label:this.nls.showObservationsByDrawing,onChange:c.hitch(this,this._drawAreaFilterChange)}),this.drawAreaControl.placeAt(b));this.drawToolDiv=e.create("div",{style:"display:none"},b);this.drawTool=new l({map:this.map,showClear:!0,keepOneGraphic:!0,geoTypes:["EXTENT"],types:["polygon"]});this.config.drawSymbol&&this.drawTool.setPolygonSymbol(w.fromJson(this.config.drawSymbol));
this.drawTool.placeAt(this.drawToolDiv);this.own(d(this.drawTool,"draw-end",c.hitch(this,function(a){a=new y(a.toJson());var b;a.symbol.setStyle(x.STYLE_NULL);this.drawTool.addGraphic(a);b=d(this.streamLayer,"filter-change",c.hitch(this,function(a){b.remove();a.filter.geometry&&"extent"===a.filter.geometry.type&&setTimeout(c.hitch(this,function(){this._clearOutsideGraphics(a.filter.geometry)}),100)}));this.streamLayer.setGeometryDefinition(a.geometry)})));this.own(d(this.drawTool,"clear",c.hitch(this,
function(){this.streamLayer.setGeometryDefinition(this.map.extent)})))},_mapAreaFilterChange:function(a){a?(this.streamLayer&&this.streamLayer.setGeometryDefinition(this.map.extent),this._addMapExtentChangeHandler()):this._removeMapExtentChangeHandler()},_drawAreaFilterChange:function(b){b?a.set(this.drawToolDiv,"display",""):(this.drawTool.clear(),a.set(this.drawToolDiv,"display","none"))},_bindEvents:function(){"none"!==a.get(this.startBtn,"display")&&this.own(d(this.startBtn,"click",c.hitch(this,
function(){(this.isStreaming=!this.isStreaming)?(g.add(this.startBtn,"stop"),h.set(this.startBtnLabel,"innerHTML",this.nls.stopStreaming),this.startStreaming()):(g.remove(this.startBtn,"stop"),h.set(this.startBtnLabel,"innerHTML",this.nls.startStreaming),this.stopStreaming())})));"none"!==a.get(this.clearBtn,"display")&&this.own(d(this.clearBtn,"click",c.hitch(this,function(){this.streamLayer.clear()})));if("none"!==a.get(this.drawPreviousSection,"display")){var b=this.streamLayer.maximumTrackPoints||
1;this.previousSpinner.set("value",b-1);this.streamLayer.setMaximumTrackPoints(b);this.own(d(this.previousSpinner,"change",c.hitch(this,function(a){this.streamLayer.setMaximumTrackPoints(a+1)})))}},_clearOutsideGraphics:function(a){this.streamLayer.clear()},destroy:function(){this.inherited(arguments);this._removeMapExtentChangeHandler()},stopStreaming:function(){this.streamLayer.disconnect(c.hitch(this,function(){this.streamLayer.clear()}))},startStreaming:function(){this.streamLayer.connect()},
_removeMapExtentChangeHandler:function(){this.mapExtentChangeHandler&&"function"===typeof this.mapExtentChangeHandler.remove&&(this.mapExtentChangeHandler.remove(),this.mapExtentChangeHandler=null)},_addMapExtentChangeHandler:function(){null===this.mapExtentChangeHandler&&(this.mapExtentChangeHandler=d(this.map,"extent-change",c.hitch(this,this._mapExtentChange)))},_mapExtentChange:function(a){this.streamLayer&&this.streamLayer.setGeometryDefinition(a.extent)},_toggleSpatialFilter:function(b){b?a.set(this.spatialFilterSection,
"display",""):(a.set(this.spatialFilterSection,"display","none"),a.set(this.drawToolDiv,"display","none"),this.mapAreaControl&&("jimu.dijit.CheckBox"===this.mapAreaControl.dealaredClass?this.mapAreaControl.setValue(!1):this.mapAreaControl.set("checked",!1)),this.drawAreaControl&&(this.drawTool.clear(),"jimu.dijit.CheckBox"===this.drawAreaControl.dealaredClass?this.drawAreaControl.setValue(!1):this.drawAreaControl.set("checked",!1)),this._removeMapExtentChangeHandler(),this.streamLayer&&this.streamLayer.setGeometryDefinition(null))},
_toggleAttributeFilter:function(b){b?a.set(this.attrFilterSection,"display",""):(a.set(this.attrFilterSection,"display","none"),k.forEach(this.filterItems,function(a){a.unCheck()}),this.streamLayer&&this.streamLayer.setDefinitionExpression(null))}})})},"widgets/Stream/FilterItem":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/dom-style dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./FilterItem.html jimu/dijit/CheckBox dijit/form/RadioButton jimu/dijit/FilterParameters jimu/filterUtils jimu/utils".split(" "),
function(f,c,k,d,h,a,g,e,m,p,q,r,l){return f([a,g],{baseClass:"jimu-widget-stream-filterItem",templateString:e,streamLayer:null,config:null,type:null,checked:!1,uid:"",index:0,askForValues:!0,postCreate:function(){this.inherited(arguments);this._init()},_init:function(){var a;"checkbox"===this.type?(this.control=new m({checked:this.checked,label:this.config.name,onChange:c.hitch(this,this._checkBoxChange)}),this.control.placeAt(this.controlSection)):"radio"===this.type&&(a=h.create("div",{},this.controlSection),
this.control=new p({checked:this.checked,value:this.config.name,name:this.uid+"_attFilterItem",id:this.uid+"_attFilterItem_"+this.index}),this.own(k(this.control,"change",c.hitch(this,function(a){this._checkBoxChange(a)}))),this.control.placeAt(a),h.create("label",{"class":"jimu-widget-normal",innerHTML:l.sanitizeHTML(this.config.name),"for":this.uid+"_attFilterItem_"+this.index},a));this.attrParamsDijit=new q;this.attrParamsDijit.placeAt(this.attrFilterParams);this.attrParamsDijit.startup();this.attrParamsDijit.build(this.streamLayer.url,
this.streamLayer,this.config.filterInfo);(this.askForValues=(new r).isAskForValues(this.config.filterInfo))?this.own(k(this.applyAttrFilterBtn,"click",c.hitch(this,this._applyFilter))):d.set(this.applyAttrFilterBtn,"display","none")},unCheck:function(){"checkbox"===this.type?this.control.setValue(!1):"radio"===this.type&&this.control.set("checked",!1);d.set(this.filterSection,"display","none")},_applyFilter:function(){var a=this.attrParamsDijit.getFilterExpr();a&&"string"===typeof a&&(this.streamLayer.setDefinitionExpression(a),
this.streamLayer.clear())},_checkBoxChange:function(a){a?this.askForValues?d.set(this.filterSection,"display",""):this._applyFilter():(d.set(this.filterSection,"display","none"),"checkbox"===this.type&&this.streamLayer&&this.streamLayer.setDefinitionExpression(null))}})})},"widgets/Stream/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Stream/StreamControl.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"jimu-widget-title" data-dojo-attach-point\x3d"controlLabelSection"\x3e\r\n    ${nls.streamControls}\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"controlButton stop" data-dojo-attach-point\x3d"startBtn"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading jimu-leading-margin1 runningIcon"\x3e\x3c/div\x3e\r\n    \x3clabel class\x3d"jimu-widget-normal jimu-leading-margin1 btnLabel"\r\n           data-dojo-attach-point\x3d"startBtnLabel"\x3e${nls.stopStreaming}\x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"controlButton" data-dojo-attach-point\x3d"clearBtn"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading jimu-leading-margin1 clearIcon"\x3e\x3c/div\x3e\r\n    \x3clabel class\x3d"jimu-widget-normal jimu-leading-margin1 btnLabel"\x3e${nls.clearObservation}\x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"drawPreviousSection" class\x3d"drawControl"\x3e\r\n    \x3clabel class\x3d"jimu-widget-normal btnLabel"\x3e${nls.previousObservations}\x26nbsp;\x3c/label\x3e\r\n    \x3cinput data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"height:32px;width:30%;float:right;"\r\n           data-dojo-props\x3d"smallDelta:1, intermediateChanges:true, constraints:{min:1,max:100,places:0}"\r\n           data-dojo-attach-point\x3d"previousSpinner"\r\n    /\x3e\r\n    \x3cdiv style\x3d"clear:both"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-widget-title filterLabel"\r\n      data-dojo-attach-point\x3d"filterLabelSection"\x3e\r\n    ${nls.streamFilter}\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"spatialFilterControl" class\x3d"filterControl"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"spatialFilterToggleDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"spatialFilterSection" class\x3d"filterControl" style\x3d"display:none"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"attrFilterControl" class\x3d"filterControl"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"attrFilterToggleDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"attrFilterSection" class\x3d"filterControl" style\x3d"display:none"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Stream/FilterItem.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"controlSection"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"filterSection" style\x3d"display:none"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"attrFilterParams"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"applyAttrFilterBtn"\x3e\r\n      ${nls.applyAttrFilter}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Stream/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"errorTipPanel" class\x3d"jimu-widget" style\x3d"display:none"\x3e\r\n    ${nls.noStreamLayer}\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"selectionPanel"\x3e\r\n    \x3cdiv\x3e\r\n      \x3clabel class\x3d"jimu-widget-title"\x3e${nls.selectStreamLayer}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"layerSelect"\x3e\r\n      \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"streamSelect"\r\n              style\x3d"width:100%; height:32px"\x3e\x3c/select\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"settingPanel"\x3e\r\n\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter"\r\n       data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Stream/css/style.css":".jimu-widget-stream{}.jimu-widget-stream .layerSelect{margin: 12px 0;}.jimu-widget-stream .controllerLabel{font-size: 1.2em; color: #838383; font-weight: normal; cursor: pointer;}.jimu-widget-stream .filterOption{margin-left: 20px; margin-top: 10px; margin-bottom: 5px;}.jimu-widget-stream .jimu-widget-stream-filterItem{margin-left: 20px; margin-top: 10px; margin-bottom: 5px;}.jimu-widget-stream .controlButton{width: 100%; height: 32px; margin-top: 12px; background-color: #FFFFFF; border: solid 1px #D7D7D7; cursor: pointer;}.jimu-widget-stream .controlButton:hover{background-color: #EAEAEA;}.jimu-widget-stream .drawControl{margin-top: 12px; width: 100%;}.jimu-widget-stream .filterLabel{margin-top: 12px;}.jimu-widget-stream .filterControl{margin: 12px 0; width: 100%;}.jimu-widget-stream .btnLabel{line-height: 32px; cursor: pointer;}.jimu-widget-stream .drawControl .btnLabel{line-height: 40px;}.jimu-widget-stream .controlButton .runningIcon{width: 14px; height: 14px; margin-top: 7px; background: transparent url(images/play_normal.png) center top no-repeat;}.jimu-widget-stream .controlButton:hover .runningIcon{background: url(images/play_over.png);}.jimu-widget-stream .controlButton.stop .runningIcon{width: 14px; height: 14px; margin-top: 7px; background: transparent url(images/stop_normal.png) center top no-repeat;}.jimu-widget-stream .controlButton.stop:hover .runningIcon{background: url(images/stop_over.png);}.jimu-widget-stream .controlButton .clearIcon{width: 14px; height: 14px; margin-top: 7px; background: transparent url(images/clear_normal.png) center top no-repeat;}.jimu-widget-stream .controlButton:hover .clearIcon{background: url(images/clear_over.png);}.jimu-widget-stream .jimu-checkbox .label{font-size: 12px;}",
"*now":function(f){f(['dojo/i18n!*preload*widgets/Stream/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-style dijit/_WidgetsInTemplateMixin jimu/BaseWidget jimu/dijit/ViewStack ./StreamControl dijit/form/Select jimu/dijit/LoadingShelter".split(" "),function(f,c,k,d,h,a,g,e,m){return f([g,a],{baseClass:"jimu-widget-stream",streamControls:[],postCreate:function(){this.inherited(arguments);var a,f,g=[],l=[];this.config.streamLayers&&0<this.config.streamLayers.length&&k.forEach(this.config.streamLayers,function(b,c){if(f=this.map.getLayer(b.layerId))a=
new m({nls:this.nls,id:this.id+"_"+b.layerId,map:this.map,config:b,streamLayer:this.map.getLayer(b.layerId)}),l.push(a),g.push({label:b.layerName,value:c})},this);0===l.length?(h.set(this.errorTipPanel,"display",""),h.set(this.selectionPanel,"display","none")):(this.viewStack=new e({nodeType:1,views:l}),this.viewStack.placeAt(this.settingPanel),this.streamSelect.addOption(g),this.streamSelect.set("value",0),this.own(d(this.streamSelect,"change",c.hitch(this,function(a){this.viewStack.switchView(a)}))))}})});