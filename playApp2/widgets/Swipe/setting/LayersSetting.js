// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/Swipe/setting/LayersSetting.html":'\x3cdiv class\x3d"default-layer-setting"\x3e\r\n\t\x3cdiv class\x3d"layer-section swipe-mode"\x3e\r\n\t\t\x3cspan class\x3d"layer-text sub-title"\x3e${nls.swipeMode}\x3c/span\x3e\r\n\t\t\x3cdiv class\x3d"swipe-radio"\x3e\r\n\t\t\t\x3cinput data-dojo-attach-point\x3d"singleLayerRaido" data-dojo-type\x3d"dijit/form/RadioButton" type\x3d"radio" class\x3d"jimu-radio-btn blue-radio"\r\n\t\t\t name\x3d"modeRaido" id\x3d"singleLayerRaido" /\x3e\r\n\t\t\t\x3clabel data-dojo-attach-point\x3d"singleLayerRaidoLabel" for\x3d"singleLayerRaido"\x3e${nls.singleLayer}\x3c/label\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"swipe-radio"\x3e\r\n\t\t\t\x3cinput data-dojo-attach-point\x3d"multipleLayerRaido" data-dojo-type\x3d"dijit/form/RadioButton" type\x3d"radio" class\x3d"jimu-radio-btn blue-radio"\r\n\t\t\t name\x3d"modeRaido" id\x3d"multipleLayerRaido" /\x3e\r\n\t\t\t\x3clabel data-dojo-attach-point\x3d"multipleLayerRaidoLabel" for\x3d"multipleLayerRaido"\x3e${nls.MultipleLayers}\x3c/label\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"layer-section"\x3e\r\n\t\t\x3cspan class\x3d"layer-text"\x3e${nls.layersAvailable}\x3c/span\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error hide" data-dojo-attach-point\x3d"layersChooserError"\x3e\x3c/span\x3e\r\n\t\t\x3cdiv class\x3d"layers-chooser" data-dojo-attach-point\x3d"layersChooser"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"layer-section"\x3e\r\n\t\t\x3cspan class\x3d"layer-text" data-dojo-attach-point\x3d"layerTextNode"\x3e${nls.layerText}\x3c/span\x3e\r\n\t\t\x3cdiv class\x3d"select-container default-layers-selector"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"swipeLayersContainer"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"swipeLayers"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"defaultLayersContainer" class\x3d"hide"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"defaultLayersSelectorContainer"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3clabel class\x3d"layer-hint"\x3e${nls.layerHint}\x3c/label\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/Evented dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/on dojo/_base/array dojo/_base/html jimu/LayerInfos/LayerInfos jimu/dijit/LayerChooserFromMapLite dojo/Deferred ../MultSelector/MultSelector dojo/text!./LayersSetting.html jimu/dijit/LoadingShelter jimu/dijit/CheckBox dijit/form/Select dojox/form/CheckedMultiSelect dijit/form/ValidationTextBox".split(" "),function(m,n,b,p,q,r,k,h,g,l,t,u,v,w,x){return n([p,q,r,m],{templateString:w,
postCreate:function(){this.shelter=new x({hidden:!0});this.defaultLayersSelector=new v({nls:this.nls},this.defaultLayersSelectorContainer);this.defaultLayersSelector.startup();this.shelter.show();this._getLayerInfoObj(this.map).then(b.hitch(this,function(){this._setDefaultLayerByState(this.config.layerState)}),function(a){console.log(a)}).always(b.hitch(this,function(){this.shelter.hide()}));this.own(k(this.singleLayerRaido,"change",b.hitch(this,function(){this.singleLayerRaido.checked&&(g.addClass(this.defaultLayersContainer,
"hide"),g.removeClass(this.swipeLayersContainer,"hide"),this.emit("change",{mode:"single"}))})));this.own(k(this.multipleLayerRaido,"change",b.hitch(this,function(){this.multipleLayerRaido.checked&&(g.removeClass(this.defaultLayersContainer,"hide"),g.addClass(this.swipeLayersContainer,"hide"),this.emit("change",{mode:"mult"}))})));this.inherited(arguments)},startup:function(){this.inherited(arguments)},setConfig:function(a){this.config=a;"mult"===this.config.layerMode?this.multipleLayerRaido.setChecked(!0):
this.singleLayerRaido.setChecked(!0);this._layerChooserFromMap||(this._layerChooserFromMap=new t({showTables:!1,onlyShowWebMapLayers:!0,customFilter:b.hitch(this,function(a){var c=new u,d=l.getInstanceSync().getLayerInfoArrayOfWebmap();h.some(d,function(c){if(c.id===a.id)return!0},this)?a.isRootLayer()?c.resolve(!0):this.map.getLayer(a.id)?c.resolve(!0):c.resolve(!1):c.resolve(!1);return c}),layerState:this.config.layerState}),this._layerChooserFromMap.placeAt(this.layersChooser),this._layerChooserFromMap.startup(),
h.forEach(this._layerInfosObj.getLayerInfoArray(),function(a){a&&a.layerObject&&a.layerObject.declaredClass&&("esri.layers.ArcGISDynamicMapServiceLayer"===a.layerObject.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.layerObject.declaredClass||"esri.layers.FeatureCollection"===a.layerObject.declaredClass)&&(a=this._layerChooserFromMap.getLayerAssociateDomNodesById(a.id))&&g.addClass(a.collapseIcon,"transparent")},this),this.own(k(this._layerChooserFromMap,"tree-click",b.hitch(this,function(){var a=
this._layerChooserFromMap.getState();this._setDefaultLayerByState(a);this._isLayersChooserStateEmpty()&&(this.swipeLayers.set("options",[{value:"",label:""}]),this.swipeLayers.reset(),this.defaultLayersSelector.reset())}))));a=this._getOptionsFromState(this.config.layerState);this._isSelectedLayerInOptions(a)&&this.swipeLayers.set("value",this.config.layer);this.config.defaultLayers||(this.config.defaultLayers=[]);this.defaultLayersSelector.setConfig(this.config.defaultLayers)},getConfig:function(a){a.layerMode=
this.multipleLayerRaido.checked?"mult":"single";a.layer=this.swipeLayers.get("value");a.defaultLayers=this.defaultLayersSelector.getConfig();a.layerState=this._layerChooserFromMap.getState();return this.config},setLayerInfoText:function(a){this.layerTextNode.innerHTML=a},_getLayerInfoObj:function(a){return l.getInstance(a,a.itemInfo).then(b.hitch(this,function(a){this._layerInfosObj=a;a=this._layerInfosObj.getLayerInfoArray();a=h.filter(a,b.hitch(this,function(a){if(!this._isNewAddedLayer(a))return!0}));
a=h.map(a,function(a){return{label:a.title,value:a.id}});this.swipeLayers.set("options",a);this.defaultLayersSelector.setOptions(a)}))},_isSelectedLayerInOptions:function(a){for(var c=this.config.layer||this.swipeLayers.getValue(),f=0,d=a.length;f<d;f++)if(a[f].value===c)return!0;return!1},_setDefaultLayerByState:function(a){"undefined"===typeof a||null===a?this.defaultLayersSelector.initOptions(this.swipeLayers.getOptions(),!0):(a=this._getOptionsFromState(a,!0),this.swipeLayers.set("options",b.clone(a)),
this._isSelectedLayerInOptions(a)&&0!==a.length?this.swipeLayers.setValue(this.config.layer||this.swipeLayers.getValue()):this.swipeLayers.reset(),this.defaultLayersSelector.initOptions(a,!0))},_getOptionsFromState:function(a,c){var f=[];if(!a)return f;for(var d in a)if(a.hasOwnProperty(d)){var b=a[d];if(!0===b.selected){var e=this._layerInfosObj.getLayerInfoById(d);e&&!this._isNewAddedLayer(e)&&(e=e.title)&&(e={value:d,label:e},c&&b.selected&&(e.selected=!0),f.push(e))}}return f},_isNewAddedLayer:function(a){for(var c=
this._layerInfosObj.getLayerInfoArrayOfWebmap(),b=0,d=c.length;b<d;b++)if(c[b].id===a.id)return!1;return!0},_isLayersChooserStateEmpty:function(){return 0===this._getOptionsFromState(this._layerChooserFromMap.getState()).length?!0:!1}})});