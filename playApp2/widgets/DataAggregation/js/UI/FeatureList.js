// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/DataAggregation/js/UI/templates/FeatureList.html":'\x3cdiv class\x3d"pad-left-5 no-select"\x3e\r\n  \x3ctable class\x3d"page-table" cellpading\x3d"0"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd colspan\x3d"2" class\x3d"panel-title-td"\x3e\r\n          \x3cdiv class\x3d"panel-title-text" data-dojo-attach-point\x3d"pageTitle"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"bottom-border-bold task-instruction-row"\x3e\r\n        \x3ctd colspan\x3d"2" class\x3d"panel-title-hint-td"\x3e\r\n          \x3cdiv class\x3d"instruction" data-dojo-attach-point\x3d"pageHint"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\r\n          \x3ctable class\x3d"page-table" cellpading\x3d"0"\x3e\r\n            \x3ctbody data-dojo-attach-point\x3d"featureListTable"\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./templates/FeatureList.html dojo/query dojo/Deferred dojo/on ./Feature".split(" "),function(n,e,f,d,k,p,q,r,t,u,v,h,l,w){return n([p,q,r,t],{baseClass:"cf-feature-list",declaredClass:"CriticalFacilities.FeatureList",templateString:u,label:"FeatureList",parent:null,nls:null,map:null,appConfig:null,config:null,features:[],
updateFeatures:[],hint:"",theme:"",styleColor:"",type:"",isDuplicate:!1,layer:null,_editToolbar:null,_syncFields:{},_started:!1,constructor:function(a){e.mixin(this,a)},postCreate:function(){this.inherited(arguments);this.pageHint.innerHTML=this.hint;this.pageTitle.innerHTML=this._title},onShown:function(){this.pageContainer.nextDisabled=!1;this.pageContainer.backDisabled=!1},startup:function(){this._started=!0;this._initFeatureList(this.features);this._updateAltIndexes();this.updateImageNodes();
this.own(l(this,"feature-list-updated",e.hitch(this,this._updateAltIndexes)));this.own(l(this.pageContainer,"view-index-change",e.hitch(this,this._indexChanged)))},validate:function(a,b){var c=new h;"next-view"===a?c.resolve(this._nextView()):"back-view"===a?c.resolve(this._backView()):this._homeView(b).then(function(a){c.resolve(a)});return c},_nextView:function(){return!0},_backView:function(){return!0},_homeView:function(a){var b=new h;this.pageContainer.getViewByTitle("Home").verifyClearSettings(a).then(function(a){b.resolve(a)});
return b},_indexChanged:function(a){this._updateAltIndexes();a.oldIndex===this.altNextIndex&&(this.altNextIndex=a.newIndex)},_updateAltIndexes:function(){this.pageContainer&&!this._reviewView&&(this._reviewView=this.pageContainer.getViewByTitle("Review"))&&(this.altHomeIndex=this.altBackIndex=this._reviewView.index);if(this.featureListTable&&this.featureListTable.rows){var a=this.featureListTable.rows;if(a.length&&0<a.length){var b=a[0].featureView,a=a[a.length-1].featureView;this.altNextIndex=b.index;
this.finalFeatureIndex=a.index;a.altNextIndex=this._reviewView.index;b.altBackIndex=this.index}}},_initFeatureList:function(a){var b=0;this.featureListTable.rows.length!==this.features.length&&f.forEach(a,e.hitch(this,function(a){this._initRow(a,b);b+=1}))},updateImageNodes:function(){var a=this.pageContainer.isDarkTheme,b=a?"next-arrow-img":"next-arrow-img-white",c=a?"next-arrow-img-white":"next-arrow-img",a=v("."+b,this.domNode);f.forEach(a,function(a){k.remove(a,b);k.add(a,c)})},setStyleColor:function(a){this.styleColor=
a},_initFeatureView:function(a,b){a=new w({nls:this.nls,map:this.map,parent:this.parent,config:this.config,appConfig:this.appConfig,label:b,altBackIndex:this.index,isDuplicate:this.isDuplicate,feature:a,theme:this.theme,layer:this.layer,_editToolbar:this._editToolbar,csvStore:this.csvStore,_parentFeatureList:this,pageContainer:this.pageContainer,pageHint:this.nls.review.reviewFeatureHint,pageTitle:a.label});this.pageContainer.addView(a);return this.pageContainer.getViewByTitle(b)},_initRow:function(a,
b){var c=d.create("tr",{className:"bottom-border feature-list-row",onclick:e.hitch(this,function(a){this.pageContainer.selectView(a.currentTarget.featureView.index)})},this.featureListTable);c.featureView=this._initFeatureView(a,this.label+"_"+b);c.fieldInfo=a.fieldInfo;for(b=0;b<a.fieldInfo.length;b++){var m=a.fieldInfo[b];if(m.name===this.layer.objectIdField){c._featureOID=m.value;break}}b=d.create("td",{className:"pad-10"},c);c.featureView.featureListLabel=d.create("div",{className:"main-text float-left text-left",
innerHTML:a.label},b);a=d.create("td",{className:"width-15"},c);d.create("div",{className:"next-arrow float-right next-arrow-img"},a)},removeFeature:function(a,b){for(var c=new h,d=this.featureListTable.rows,g=0;g<d.length;g++){var f=d[g];if(f._featureOID===b){this.pageContainer._backLabelClone=e.clone(this.pageContainer._backLabels);this.pageContainer.removeView(f.featureView);this.featureListTable.deleteRow(g);a=this.features.indexOf(a);-1<a&&this.features.splice(a,1);this.emit("feature-list-updated",
this.features.length);g===this.features.length&&this.pageContainer.selectView(this.altBackIndex);break}}c.resolve("feature-removed");return c},resetFeatureList:function(){if(0<this.featureListTable.rows.length){for(var a=this.featureListTable.rows.length;0<a;a--)this.pageContainer.removeView(this.featureListTable.rows[a-1].featureView),this.featureListTable.deleteRow(a-1);this.altNextIndex=void 0;this._initFeatureList(this.features);this._updateAltIndexes();this.pageContainer._backLabels=this.pageContainer._backLabelClone;
this.updateImageNodes()}},addFeature:function(a){this.features.push(a);this.emit("feature-list-updated",this.features.length)}})});