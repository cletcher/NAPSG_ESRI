// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/LayerList/LayerListView":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom-construct dojo/on dojo/keys dijit/focus dojo/query jimu/dijit/CheckBox jimu/dijit/DropMenu jimu/dijit/LoadingShelter jimu/utils ./PopupMenu dijit/_TemplatedMixin dojo/text!./LayerListView.html dojo/dom-class dojo/dom-style ./NlsStrings".split(" "),function(r,q,f,k,n,a,e,h,g,d,v,t,p,B,A,x,C,y,z,c){return q([r,x],{templateString:C,_currentSelectedLayerRowNode:null,
operationsDropMenu:null,_layerNodeHandles:null,_layerDomNodeStorage:null,_firstLayerNode:!1,_lastLayerNode:null,_eventHandlers:null,_layerIndexs:null,postMixInProperties:function(){this.inherited(arguments);this.nls=c.value;this._layerDomNodeStorage={};this._eventHandlers=[];this._initLayerIndexs()},postCreate:function(){this.refresh();this._initOperations()},_initLayerIndexs:function(){var b=2;this._layerIndexs={};this.operLayerInfos.traversalAll(f.hitch(this,function(m){this._layerIndexs[m.id]=
b++}))},refresh:function(){this._removeLayerNodes();k.forEach(this.operLayerInfos.getLayerInfoArray(),function(b){this.drawListNode(b,0,this.layerListTable)},this);this.config.showBasemap&&k.forEach(this.operLayerInfos.getBasemapLayerInfoArray(),function(b){this.drawListNode(b,0,this.layerListTable)},this);k.forEach(this.operLayerInfos.getTableInfoArray(),function(b){this.drawListNode(b,0,this.tableListTable)},this);k.forEach(this._eventHandlers,function(b){b.remove&&b.remove()});this._supports508Accessibility()},
drawListNode:function(b,m,w,c){var l;!this.isLayerHiddenInWidget(b)&&this.layerFilter.isValidLayerInfo(b)&&(l=this._layerDomNodeStorage[b.getObjectId()],(b.isRootLayer()||b.isTable)&&l?(a.place(l.layerTrNode,w,c),a.place(l.layerContentTrNode,w,c)):0===b.newSubLayers.length?(l=this.addLayerNode(b,m,w,c),this.config.showLegend?this.addLegendNode(b,m,l.subNode):(b=d(".showLegend-div",l.layerTrNode)[0])&&y.add(b,"hidden")):(l=this.addLayerNode(b,m,w,c),k.forEach(b.newSubLayers,f.hitch(this,function(b,
m){this.drawListNode(m,b+1,l.subNode)},m))))},addLayerNode:function(b,m,c,d){var l=this._layerIndexs[b.id],u,w,p,g,t,h,k=b.getRootLayerInfo();this._layerDomNodeStorage[b.getObjectId()]={layerTrNode:null,layerContentTrNode:null,layerNodeEventHandles:[],layerNodeReferredDijits:[],layerInfo:b};u=a.create("tr",{"class":"jimu-widget-row layer-row layer-tr-node-"+b.id+"",tabindex:0,"aria-label":(b.isTable?window.jimuNls.common.table:window.jimuNls.common.layer)+" "+b.title,layerTrNodeId:b.id});a.place(u,
c,d);this._firstLayerNode||(this._firstLayerNode=u);this._lastLayerNode=u;this._lastLayerInfo=b;w=a.create("td",{"class":"col col1"},u);for(p=0;p<m;p++)a.create("div",{"class":"begin-blank-div jimu-float-leading",innerHTML:""},w);h=a.create("div",{"class":"showLegend-div jimu-float-leading ",tabindex:l,role:"button","aria-label":this.nls.expandLayer,"aria-expanded":"false",imageShowLegendDivId:b.id},w);p=a.create("div",{"class":"div-select jimu-float-leading"},w);g=new v({checked:b.isVisible(),"class":"visible-checkbox-"+
b.id});a.place(g.domNode,p);n.setAttr(g.domNode,"tabindex",l);t=a.create("div",{"class":"noLegend-div jimu-float-leading"},w);var D;D=b.isTable?"images/table.png":b.isBasemap()?"images/basemap.png":"images/noLegend.png";a.create("img",{"class":"noLegend-image",src:this.layerListWidget.folderUrl+D,alt:"l"},t);if(b.isTiled||b.isTable)z.set(h,"display","none"),z.set(p,"display","none"),z.set(t,"display","block");b.isBasemap()&&(z.set(h,"display","block"),z.set(p,"display","none"),z.set(t,"display","block"),
z.set(t,"width","auto"),z.set(t,"margin-left","2px"));z.set(w,"width",12*m+40+"px");m=a.create("td",{"class":"col col2"},u);w="";try{b.isInScale()||(w="grayed-title")}catch(E){console.warn(E.message)}a.create("div",{innerHTML:b.title,"class":"layer-title-div-"+b.id+" div-content jimu-float-leading "+w},m);w=a.create("td",{"class":"col col3"},u);t=this.hasContentMenu()?"display: block":"display: none";l=a.create("div",{"class":"layers-list-popupMenu-div ",tabindex:l,role:"button","aria-haspopup":"true",
"aria-expanded":"false","aria-label":this.nls.tipLayerOperation,style:t},w);w=a.create("tr",{"class":"",layerContentTrNodeId:b.id});a.place(w,c,d);c=a.create("td",{"class":"",colspan:"3"},w);c=a.create("table",{"class":"layer-sub-node",subNodeId:b.id},c);d=this.own(e(m,"click",f.hitch(this,this._onRowTrClick,b,h,u,c)));this._storeLayerNodeEventHandle(k,d[0]);d=this.own(e(h,"click",f.hitch(this,this._onRowTrClick,b,h,u,c)));this._storeLayerNodeEventHandle(k,d[0]);d=this.own(e(g.domNode,"click",f.hitch(this,
this._onCkSelectNodeClick,b,g)));this._storeLayerNodeEventHandle(k,d[0]);d=this.own(e(l,"click",f.hitch(this,this._onPopupMenuClick,b,l,u)));this._storeLayerNodeEventHandle(k,d[0]);d=this.own(e(u,"keydown",f.hitch(this,this._onLayerNodeKey,h,l)));this._storeLayerNodeEventHandle(k,d[0]);d=this.own(e(h,"keydown",f.hitch(this,this._onImageShowLegendKey,b,h,u,c,l)));this._storeLayerNodeEventHandle(k,d[0]);d=this.own(e(p,"keydown",f.hitch(this,this._onCkSelectDivKey,b,g,u)));this._storeLayerNodeEventHandle(k,
d[0]);d=this.own(e(l,"keydown",f.hitch(this,this._onPopupMenuNodeKey,b,l,u,h)));this._storeLayerNodeEventHandle(k,d[0]);this._layerDomNodeStorage[b.getObjectId()].layerTrNode=u;this._layerDomNodeStorage[b.getObjectId()].layerContentTrNode=w;this.layerFilter.isExpanded(b)&&this._foldOrUnfoldLayer(b,!1,h,c);return{layerTrNode:u,subNode:c}},hasContentMenu:function(){var b=!1,m;if(this.config.contextMenu)for(m in this.config.contextMenu)this.config.contextMenu.hasOwnProperty(m)&&"function"!==typeof this.config.contextMenu[m]&&
(b=b||this.config.contextMenu[m]);else b=!0;return b},addLegendNode:function(b,m,c){c=a.create("tr",{"class":"legend-node-tr",tabindex:0},c);a.create("td",{"aria-label":window.jimuNls.common.layer+" "+window.jimuNls.statisticsChart.legend},c);c=a.create("td",{"class":"legend-node-td"},c);try{var w=b.createLegendsNode();z.set(w,"font-size",12*(m+1)+"px");a.place(w,c)}catch(l){console.error(l)}},redrawLegends:function(b){var m=d("div[legendsDivId\x3d'"+b.id+"']",this.layerListTable)[0];m&&(m._legendDijit&&
m._legendDijit.destroy&&m._legendDijit.destroy(),b.drawLegends(m,this.layerListWidget.appConfig.portalUrl))},_storeLayerNodeEventHandle:function(b,m){(b=this._layerDomNodeStorage[b.getObjectId()])&&b.layerNodeEventHandles.push(m)},_storeLayerNodeDijit:function(b,m){(b=this._layerDomNodeStorage[b.getObjectId()])&&b.layerNodeReferredDijits.push(m)},_clearLayerDomNodeStorage:function(){var b,m=[];this.operLayerInfos.traversalAll(function(b){m.push(b)});for(var c in this._layerDomNodeStorage)this._layerDomNodeStorage.hasOwnProperty(c)&&
"function"!==typeof this._layerDomNodeStorage[c]&&(b=k.some(m,function(b){if(b.getObjectId().toString()===c)return!0},this),b||(k.forEach(this._layerDomNodeStorage[c].layerNodeEventHandles,function(b){b.remove()},this),k.forEach(this._layerDomNodeStorage[c].layerNodeReferredDijits,function(b){b.destroy()},this),a.destroy(this._layerDomNodeStorage[c].layerTrNode),a.destroy(this._layerDomNodeStorage[c].layerContentTrNode),delete this._layerDomNodeStorage[c]))},_removeLayerNodes:function(){var b,m;this._clearLayerDomNodeStorage();
for(var c in this._layerDomNodeStorage)this._layerDomNodeStorage.hasOwnProperty(c)&&"function"!==typeof this._layerDomNodeStorage[c]&&(b=this._layerDomNodeStorage[c])&&b.layerInfo&&b.layerInfo.isRootLayer()&&b.layerContentTrNode&&b.layerTrNode&&((m=b.layerTrNode.parentNode)&&m.removeChild(b.layerTrNode),(m=b.layerContentTrNode.parentNode)&&m.removeChild(b.layerContentTrNode))},_foldSwitch:function(b,m,c){return"none"===z.get(c,"display")?this._foldOrUnfoldLayer(b,!1,m,c):this._foldOrUnfoldLayer(b,
!0,m,c)},_foldOrUnfoldLayer:function(b,m,c,a){var l=l?c:d("div[imageShowLegendDivId\x3d'"+b.id+"']",this.layerListTable)[0],u=u?a:d("table[subNodeId\x3d'"+b.id+"']",this.layerListTable)[0];c=null;l&&u&&(m?(z.set(u,"display","none"),y.remove(l,"unfold"),c=!0,n.setAttr(l,"aria-label",this.nls.expandLayer),n.setAttr(l,"aria-expanded","false")):(z.set(u,"display","table"),y.add(l,"unfold"),c=!1,n.setAttr(l,"aria-label",this.nls.collapseLayer),n.setAttr(l,"aria-expanded","true"),b.isLeaf()&&(m=d(".legends-div",
u)[0],l=d(".legends-loading-img",m)[0],m&&l&&b.drawLegends(m,this.layerListWidget.appConfig.portalUrl))));return c},_foldOrUnfoldLayers:function(b,m){k.forEach(b,function(b){this._foldOrUnfoldLayer(b,m)},this)},_onCkSelectNodeClick:function(b,m,c){c.ctrlKey||c.metaKey?b.isRootLayer()?this.turnAllRootLayers(m.checked):this.turnAllSameLevelLayers(b,m.checked):(this.layerListWidget._denyLayerInfosIsVisibleChangedResponseOneTime=!0,b.setTopLayerVisible(m.checked));c.stopPropagation()},_onPopupMenuClick:function(b,
m,c,a){var l=b.getRootLayerInfo(),u=m.popupMenu;if(!u){u=(new A({_layerInfo:b,box:this.layerListWidget.domNode.parentNode,popupMenuNode:m,layerListWidget:this.layerListWidget,_config:this.config})).placeAt(m);m.popupMenu=u;this._storeLayerNodeDijit(l,u);var d=this.own(e(u,"onMenuClick",f.hitch(this,this._onPopupMenuItemClick,b,u)));this._storeLayerNodeEventHandle(l,d[0]);d=this.own(m.popupMenu.on("onOpenMenu",f.hitch(this,this._onPopupMenuOpen,b,m,l)));this._storeLayerNodeEventHandle(l,d[0])}this._changeSelectedLayerRow(c);
u&&"opened"===u.state?u.closeDropMenu():(this._hideCurrentPopupMenu(),u&&(this.currentPopupMenu=u,u.openDropMenu()));this.operationsDropMenu&&"opened"===this.operationsDropMenu.state&&this.operationsDropMenu.closeDropMenu();a.stopPropagation()},_hideCurrentPopupMenu:function(){this.currentPopupMenu&&"opened"===this.currentPopupMenu.state&&this.currentPopupMenu.closeDropMenu()},_onLayerListWidgetPaneClick:function(){this.operationsDropMenu&&this.operationsDropMenu.closeDropMenu()},_onRowTrClick:function(b,
m,c,a,l){this._changeSelectedLayerRow(c);m=this._foldSwitch(b,m,a);c._expanded=!m;if(l.ctrlKey||l.metaKey)b.isRootLayer()?this.foldOrUnfoldAllRootLayers(m):this.foldOrUnfoldSameLevelLayers(b,m)},_changeSelectedLayerRow:function(b){this._currentSelectedLayerRowNode&&this._currentSelectedLayerRowNode===b||(this._currentSelectedLayerRowNode&&y.remove(this._currentSelectedLayerRowNode,"jimu-widget-row-selected"),y.add(b,"jimu-widget-row-selected"),this._currentSelectedLayerRowNode=b)},_onPopupMenuItemClick:function(b,
m,c,a){a={itemKey:c.key,extraData:a,layerListWidget:this.layerListWidget,layerListView:this};"transparency"===c.key?"none"===z.get(m.transparencyDiv,"display")?m.showTransNode(b.getOpacity(),c):m.hideTransNode():"setVisibilityRange"===c.key?"none"===z.get(m.setVisibilityRangeNode,"display")?m.showSetVisibilityRangeNode(b,c):m.hideSetVisibilityRangeNode():(b=m.popupMenuInfo.onPopupMenuClick(a),b.closeMenu&&m.closeDropMenu())},_exchangeLayerTrNode:function(b,c){b=d("tr[layerTrNodeId\x3d'"+b.id+"']",
this.layerListTable)[0];var m=d("tr[layerTrNodeId\x3d'"+c.id+"']",this.layerListTable)[0];c=d("tr[layerContentTrNodeId\x3d'"+c.id+"']",this.layerListTable)[0];b&&m&&c&&(this.layerListTable.removeChild(m),this.layerListTable.insertBefore(m,b),this.layerListTable.removeChild(c),this.layerListTable.insertBefore(c,b))},_getMovedSteps:function(b,c){var m=1,a,l=this.operLayerInfos.getLayerInfoArray();k.forEach(l,function(l,c){b.id===l.id&&(a=c)},this);if("moveup"===c)for(;!l[a].isFirst&&!(a--,!this.isLayerHiddenInWidget(l[a])&&
this.layerFilter.isValidLayerInfo(l[a])||l[a].isFirst);)m++;else for(;!l[a].isLast&&!(a++,!this.isLayerHiddenInWidget(l[a])&&this.layerFilter.isValidLayerInfo(l[a])||l[a].isLast);)m++;return m},moveUpLayer:function(b){var c=this._getMovedSteps(b,"moveup");this.layerListWidget._denyLayerInfosReorderResponseOneTime=!0;(c=this.operLayerInfos.moveUpLayer(b,c))&&this._exchangeLayerTrNode(c,b)},moveDownLayer:function(b){var c=this._getMovedSteps(b,"movedown");this.layerListWidget._denyLayerInfosReorderResponseOneTime=
!0;(c=this.operLayerInfos.moveDownLayer(b,c))&&this._exchangeLayerTrNode(b,c)},isLayerHiddenInWidget:function(b){var c=!1,a=b;if(b&&this.config.layerOptions&&void 0!==this.config.layerOptions[b.id])for(;a&&!(c=c||!this.config.layerOptions[a.id].display);)a=a.parentLayerInfo;else c=!1;return c},isFirstDisplayedLayerInfo:function(b){var c,a;b.isFirst||!b.isRootLayer()||b.isBasemap()?c=!0:(c=this._getMovedSteps(b,"moveup"),a=this.operLayerInfos.getLayerInfoArray(),b=this.operLayerInfos._getTopLayerInfoIndexById(b.id),
c=this.isLayerHiddenInWidget(a[b-c])||!this.layerFilter.isValidLayerInfo(a[b-c])?!0:!1);return c},isLastDisplayedLayerInfo:function(b){var c,a;b.isLast||!b.isRootLayer()||b.isBasemap()?c=!0:(c=this._getMovedSteps(b,"movedown"),a=this.operLayerInfos.getLayerInfoArray(),b=this.operLayerInfos._getTopLayerInfoIndexById(b.id),c=this.isLayerHiddenInWidget(a[b+c])||!this.layerFilter.isValidLayerInfo(a[b+c])?!0:!1);return c},_initOperations:function(){this.operationsDropMenu=(new t({items:[{key:"turnAllLayersOn",
label:this.nls.turnAllLayersOn},{key:"turnAllLayersOff",label:this.nls.turnAllLayersOff},{key:"separator"},{key:"expandAllLayers",label:this.nls.expandAllLayers},{key:"collapseAlllayers",label:this.nls.collapseAlllayers}],box:this.layerListWidget.domNode.parentNode})).placeAt(this.layerListOperations);var b=d("div.jimu-dropmenu \x3e div:first-child",this.layerListOperations)[0];b&&(y.remove(b,["jimu-icon-btn","popup-menu-button"]),y.add(b,["feature-action","icon-operation"]));this.operationsDropMenu.btnNode&&
this.own(e(this.operationsDropMenu.btnNode,"click",f.hitch(this,this._onLayerListOperationsClick)));this.own(e(this.operationsDropMenu,"onMenuClick",f.hitch(this,this._onOperationsMenuItemClick)));this.operationsDropMenuLoading=(new p({hidden:!0})).placeAt(this.operationsDropMenu.domNode);this.own(e(this.layerListOperations,"keydown",f.hitch(this,this._onLayerListOperationsKey)));this.own(e(this.operationsDropMenu,"onOpenMenu",f.hitch(this,this._onOperationsDropMenuOpen)))},_onLayerListOperationsClick:function(){this._hideCurrentPopupMenu()},
_onOperationsMenuItemClick:function(b){switch(b.key){case "turnAllLayersOn":this.turnAllRootLayers(!0);break;case "turnAllLayersOff":this.turnAllRootLayers(!1);break;case "expandAllLayers":this.foldOrUnfoldAllLayers(!1);break;case "collapseAlllayers":this.foldOrUnfoldAllLayers(!0)}},turnAllRootLayers:function(b){var c=this.operLayerInfos.getLayerInfoArray();k.forEach(c,function(c){this.isLayerHiddenInWidget(c)||c.setTopLayerVisible(b)},this)},turnAllSameLevelLayers:function(b,c){var a={},m=b.getRootLayerInfo();
m.traversal(f.hitch(this,function(l){l.parentLayerInfo&&l.parentLayerInfo.id===b.parentLayerInfo.id&&!this.isLayerHiddenInWidget(l)?a[l.id]={visible:c}:a[l.id]={visible:l.isVisible()}}));m.resetLayerObjectVisibility(a)},foldOrUnfoldAllRootLayers:function(b){var c=k.filter(this.operLayerInfos.getLayerInfoArray(),function(b){return!this.isLayerHiddenInWidget(b)},this);this._foldOrUnfoldLayers(c,b)},foldOrUnfoldSameLevelLayers:function(b,c){b.parentLayerInfo&&(b=k.filter(b.parentLayerInfo.getSubLayers(),
function(b){return!this.isLayerHiddenInWidget(b)},this),this._foldOrUnfoldLayers(b,c))},foldOrUnfoldAllLayers:function(b){var c=[],a=[];this.operationsDropMenuLoading.show();this.operLayerInfos.traversal(f.hitch(this,function(b){this.isLayerHiddenInWidget(b)||(b.isRootLayer()?a.push(b):c.push(b))}));var c=a.concat(c),d=0,l=c.length;setTimeout(f.hitch(this,function(){if(d<l){var a=c.slice(d,d+50);this._foldOrUnfoldLayers(a,b);d+=50;setTimeout(f.hitch(this,arguments.callee),60)}else this.operationsDropMenuLoading.hide()}),
60)},_supports508Accessibility:function(){var b;this._lastLayerNode?(b=e(this.layerListWidget.layerFilter.searchButton,"keydown",f.hitch(this,"_onSearchButtonKey")),this._eventHandlers.push(b),b=e(this.supports508Node,"focus",f.hitch(this,"_onLastNodeFocus")),this._eventHandlers.push(b),B.initLastFocusNode(this.layerListWidget.domNode,this.supports508Node)):(B.initLastFocusNode(this.layerListWidget.domNode,this.layerListOperations),b=e(this.supports508Node,"focus",f.hitch(this,"_onLastNodeFocus")),
this._eventHandlers.push(b))},_onSearchButtonKey:function(b){b.keyCode===h.TAB&&b.shiftKey&&(b.stopPropagation(),b.preventDefault(),this._backToLastNodeFlag=!0)},_getLastExpandedLayerNode:function(){for(var b=this._lastLayerNode,c=null,a=this._lastLayerInfo;a;){var d=a.parentLayerInfo;if(d){if((c=this._layerDomNodeStorage[d.getObjectId()].layerTrNode)&&c._expanded){b=this._layerDomNodeStorage[a.getObjectId()].layerTrNode;break}}else{b=this._layerDomNodeStorage[a.getObjectId()].layerTrNode;break}a=
d}return b},_onLastNodeFocus:function(){if(this._backToLastNodeFlag){var b=this._getLastExpandedLayerNode();b&&g.focus(b);this._backToLastNodeFlag=!1}else g.focus(this.layerListWidget.layerFilter.searchButton)},_onLastLayerNodeKey:function(b){b.keyCode!==h.TAB||b.shiftKey||(b.stopPropagation(),b.preventDefault(),g.focus(this.layerListWidget.layerFilter.searchButton))},_onLayerNodeKey:function(b,c,a){a.keyCode===h.ENTER&&(a.stopPropagation(),a.preventDefault(),"none"===n.getStyle(b,"display")?g.focus(c):
g.focus(b))},_onImageShowLegendKey:function(b,c,a,d,l,u){u.keyCode===h.TAB&&u.stopPropagation();u.keyCode===h.TAB&&u.shiftKey?(u.stopPropagation(),u.preventDefault(),g.focus(l)):u.keyCode===h.ESCAPE?(u.stopPropagation(),u.preventDefault(),g.focus(a)):u.keyCode===h.ENTER&&(u.stopPropagation(),u.preventDefault(),this._onRowTrClick(b,c,a,d,u))},_onCkSelectDivKey:function(b,c,a,d){d.keyCode===h.TAB&&d.stopPropagation();if(d.keyCode===h.ESCAPE)d.stopPropagation(),d.preventDefault(),g.focus(a);else if(d.keyCode===
h.SPACE||d.keyCode===h.ENTER)d.stopPropagation(),d.preventDefault(),c.checked?c.uncheck(!0):c.check(!0),this._onCkSelectNodeClick(b,c,d)},_onPopupMenuNodeKey:function(b,c,a,d,l){l.keyCode===h.TAB&&l.stopPropagation();if(l.keyCode===h.TAB&&!l.shiftKey)l.stopPropagation(),l.preventDefault(),g.focus(d);else if(l.keyCode===h.ESCAPE)l.stopPropagation(),l.preventDefault(),g.focus(a);else if(l.keyCode===h.ENTER||l.keyCode===h.DOWN_ARROW||l.keyCode===h.UP_ARROW)l.stopPropagation(),l.preventDefault(),this._onPopupMenuClick(b,
c,a,l)},_onPopupMenuOpen:function(b,c,a){var m=d(".menu-item",c.popupMenu.dropMenuNode),m=m.filter(function(b){return n.hasClass(b,"menu-item-hidden")?!1:!0}),l=m[0],u=m[m.length-1];m.forEach(function(b,d){var p=!1,t=!1,h=m[d-1],v=m[d+1];0===d?(g.focus(b),p=!0):d===m.length-1&&(t=!0);b.hasBeenOpened||(d=this.own(e(b,"keydown",f.hitch(this,this._onPopupMenuItemKey,c,h,v,l,u,p,t))),this._storeLayerNodeEventHandle(a,d[0]),b.hasBeenOpened=!0)},this)},_onPopupMenuItemKey:function(b,c,a,d,l,u,p,e){if(e.keyCode===
h.DOWN_ARROW)e.stopPropagation(),e.preventDefault(),a&&g.focus(a);else if(e.keyCode===h.UP_ARROW)e.stopPropagation(),e.preventDefault(),c&&g.focus(c);else if(e.keyCode===h.HOME)e.stopPropagation(),e.preventDefault(),d&&g.focus(d);else if(e.keyCode===h.END)e.stopPropagation(),e.preventDefault(),l&&g.focus(l);else if(e.keyCode===h.ESCAPE||e.keyCode===h.TAB)e.stopPropagation(),e.preventDefault(),g.focus(b),b.popupMenu.closeDropMenu()},_enableNavMode:function(b){b.keyCode!==h.TAB||B.isInNavMode()||n.addClass(document.body,
"jimu-nav-mode")},_onLayerListOperationsKey:function(b){b.keyCode===h.ENTER&&this.operationsDropMenu._onBtnClick(b)},_onOperationsDropMenuOpen:function(){var b=d(".menu-item",this.operationsDropMenu.domNode),b=b.filter(function(b){return n.hasClass(b,"menu-item-hidden")?!1:!0}),c=b[0],a=b[b.length-1];b.forEach(function(d,l){var u=!1,m=!1,p=b[l-1],t=b[l+1];0===l?(g.focus(d),u=!0):l===b.length-1&&(m=!0);d.hasBeenOpened||(this.own(e(d,"keydown",f.hitch(this,this._onLayerListOperationsMenuItemKey,p,t,
c,a,u,m))),d.hasBeenOpened=!0)},this)},_onLayerListOperationsMenuItemKey:function(b,c,a,d,l,u,e){if(e.keyCode===h.DOWN_ARROW)e.stopPropagation(),e.preventDefault(),c&&g.focus(c);else if(e.keyCode===h.UP_ARROW)e.stopPropagation(),e.preventDefault(),b&&g.focus(b);else if(e.keyCode===h.HOME)e.stopPropagation(),e.preventDefault(),a&&g.focus(a);else if(e.keyCode===h.END)e.stopPropagation(),e.preventDefault(),d&&g.focus(d);else if(e.keyCode===h.ESCAPE||e.keyCode===h.TAB)e.stopPropagation(),e.preventDefault(),
g.focus(this.layerListOperations),this.operationsDropMenu.closeDropMenu()}})})},"jimu/dijit/DropMenu":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on dijit/focus dojo/keys dojo/Evented ../utils".split(" "),function(r,q,f,k,n,a,e,h,g,d,v){return r([q,d],{baseClass:"jimu-dropmenu",declaredClass:"jimu.dijit.DropMenu",focusNodeWhenLeave:null,constructor:function(){this.state="closed"},postCreate:function(){this.btnNode=n.create("div",
{"class":"popup-menu-button"},this.domNode);this.own(e(this.btnNode,"click",f.hitch(this,this._onBtnClick)));this.box||(this.box=this.domNode.parentNode);this.own(e(this.box,"click",f.hitch(this,function(){this.dropMenuNode&&this.closeDropMenu()})))},_onBtnClick:function(a){a.stopPropagation();this.dropMenuNode||this._createDropMenuNode();"closed"===this.state?this.openDropMenu():this.closeDropMenu()},_createDropMenuNode:function(){this.dropMenuNode=n.create("div",{"class":"drop-menu",style:{display:"none"}},
this.domNode);this.items||(this.items=[]);k.forEach(this.items,function(d){var p;d.key&&"separator"===d.key?n.create("hr",{"class":"menu-item-identification menu-item-line",itemId:d.key},this.dropMenuNode):d.key&&(p=n.create("div",{"class":"menu-item-identification menu-item",tabindex:"0",itemId:d.key,role:"button",innerHTML:d.label},this.dropMenuNode),this.own(e(p,"click",f.hitch(this,function(a){this.selectItem(d,a)}))),this.own(e(p,"keydown",f.hitch(this,function(e){if(e.keyCode===g.ENTER){e.stopPropagation();
e.preventDefault();var f=a("a",p)[0];f?(e=document.createEvent("MouseEvents"),e.initEvent("click",!0,!0),f.dispatchEvent(e)):this.selectItem(d,e)}}))))},this);this.focusNodeWhenLeave||(this.focusNodeWhenLeave=this.domNode.parentNode)},_getDropMenuPosition:function(){var a=n.getContentBox(this.box),d=n.getMarginBox(this.domNode),e=n.getMarginBox(this.btnNode),f=n.getMarginBox(this.dropMenuNode),g={},h,v;g.l=d.l;g.t=d.t+e.h;g.t+f.h>a.h&&(v=d.t,h=a.h-d.t-e.h,h=Math.max(v,h),h===v&&(g.t=0-f.h));g.l+f.w>
a.w&&(f=d.l,a=a.w-d.l-e.w,h=Math.max(f,a),h===f&&(g.l="",g.r=0));g.left=g.l;g.top=g.t;g.right=g.r;return g},getMenuItemNodeByItemKey:function(d){var e;a(".menu-item",this.dropMenuNode).some(function(a){return n.getAttr(a,"itemId")===d?(e=a,!0):!1},this);return e},selectItem:function(a){this.closeDropMenu();this.emit("onMenuClick",a)},openDropMenu:function(){this.state="opened";n.setStyle(this.dropMenuNode,"display","");n.setStyle(this.dropMenuNode,v.getPositionStyle(this._getDropMenuPosition()));
this.emit("onOpenMenu")},closeDropMenu:function(){"opened"===this.state&&h.focus(this.focusNodeWhenLeave);this.state="closed";n.setStyle(this.dropMenuNode,"display","none");this.emit("onCloseMenu")}})})},"widgets/LayerList/PopupMenu":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/_base/lang dojo/query dojo/on dojo/keys dijit/focus dojo/Deferred jimu/dijit/DropMenu jimu/utils dijit/_TemplatedMixin dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dojo/text!./PopupMenu.html dojo/dom-style esri/dijit/VisibleScaleRangeSlider ./NlsStrings ./PopupMenuInfo".split(" "),
function(r,q,f,k,n,a,e,h,g,d,v,t,p,B,A,x,C,y,z){return r([d,t],{templateString:A,popupMenuInfo:null,loading:null,_deniedItems:null,_deniedItemsFromConfig:null,_layerInfo:null,constructor:function(){this.nls=y.value},postCreate:function(){this.inherited(arguments);this._initDeniedItems();this.loading=f.create("div",{"class":"popup-menu-loading"},this.popupMenuNode)},_initDeniedItems:function(){var c=[],b={ZoomTo:"zoomto",Transparency:"transparency",SetVisibilityRange:"setVisibilityRange",EnableOrDisablePopup:"controlPopup",
ControlLabels:"controlLabels",MoveupOrMovedown:"moveup movedown",OpenAttributeTable:"table",DescriptionOrShowItemDetailsOrDownload:"url"};this._deniedItems=[];this._deniedItemsFromConfig=[];for(var a in this._config.contextMenu)this._config.contextMenu.hasOwnProperty(a)&&"function"!==typeof this._config.contextMenu[a]&&!1===this._config.contextMenu[a]&&(c=c.concat(b[a].split(" ")));q.forEach(c,k.hitch(this,function(b){this._deniedItemsFromConfig.push({key:b,denyType:"hidden"})}))},_getDropMenuPosition:function(){return{top:"40px",
right:"0px",zIndex:1}},_getTransNodePosition:function(){return{top:"28px",right:"2px"}},_onBtnClick:function(){},_refresh:function(){this._denyItems();this._changeItemsUI()},_denyItems:function(){var c=n("[class~\x3d'menu-item-identification']",this.dropMenuNode);c.forEach(function(b){f.removeClass(b,"menu-item-dissable");f.removeClass(b,"menu-item-hidden")},this);f.removeClass(this.dropMenuNode,"no-border");q.forEach(this._deniedItems,function(b){var c=n("div[itemId\x3d'"+b.key+"']",this.dropMenuNode)[0];
c&&("disable"===b.denyType?(f.addClass(c,"menu-item-dissable"),"url"===b.key&&n(".menu-item-description",c).forEach(function(b){f.setAttr(b,"href","#");f.removeAttr(b,"target")})):f.addClass(c,"menu-item-hidden"))},this);for(var b=-1,a=0;a<c.length;a++)f.hasClass(c[a],"menu-item-line")&&(-1===b||f.hasClass(c[b],"menu-item-line"))&&f.addClass(c[a],"menu-item-hidden"),f.hasClass(c[a],"menu-item-hidden")||(b=a);c=q.filter(c,function(b){return!f.hasClass(b,"menu-item-hidden")});0===c.length?f.addClass(this.dropMenuNode,
"no-border"):(f.removeClass(this.dropMenuNode,"no-border"),f.hasClass(c[c.length-1],"menu-item-line")&&f.addClass(c[c.length-1],"menu-item-hidden"))},_changeItemsUI:function(){var c=n("[itemid\x3dcontrolPopup]",this.dropMenuNode)[0];c&&(this._layerInfo.isPopupNestedEnabled()?f.setAttr(c,"innerHTML",this.nls.removePopup):f.setAttr(c,"innerHTML",this.nls.enablePopup));(c=n("[itemid\x3dcontrolLabels]",this.dropMenuNode)[0])&&this._layerInfo.canShowLabel()&&(this._layerInfo.isShowLabels()?f.setAttr(c,
"innerHTML",this.nls.hideLables):f.setAttr(c,"innerHTML",this.nls.showLabels))},_switchLoadingState:function(c){c?f.setStyle(this.loading,"display","block"):f.setStyle(this.loading,"display","none")},selectItem:function(c,b){for(var a=!1,d=0;d<this._deniedItems.length;d++)if(this._deniedItems[d].key===c.key){a=!0;break}a||this.emit("onMenuClick",c);b.stopPropagation(b)},openDropMenu:function(){var c=k.hitch(this,this.inherited,arguments),b=new g;this._switchLoadingState(!0);this.dropMenuNode?b.resolve(this.popupMenuInfo):
z.create(this._layerInfo,this.layerListWidget).then(k.hitch(this,function(c){this.items=c.getDisplayItems();this.popupMenuInfo=c;this._createDropMenuNode();b.resolve(this.popupMenuInfo)}));b.then(k.hitch(this,function(){this.popupMenuInfo.getDeniedItems().then(k.hitch(this,function(b){this._deniedItems=this._deniedItemsFromConfig.concat(b);this._refresh();c(arguments);this._switchLoadingState(!1)}),k.hitch(this,function(){this._switchLoadingState(!1)}))}),k.hitch(this,function(){this._switchLoadingState(!1)}))},
closeDropMenu:function(){this.inherited(arguments);this.hideTransNode();this.hideSetVisibilityRangeNode()},_onTransparencyDivClick:function(c){c.stopPropagation()},showTransNode:function(c,b){this.hideSetVisibilityRangeNode();this.transHorizSlider||(this._createTransparencyWidget(b),this.transHorizSlider.set("value",1-c));x.set(this.transparencyDiv,"top",this._getTransNodePosition().top);isRTL?x.set(this.transparencyDiv,"left",this._getTransNodePosition().right):x.set(this.transparencyDiv,"right",
this._getTransNodePosition().right);x.set(this.transparencyDiv,"display","block");this.transHorizSlider.focus()},hideTransNode:function(){x.set(this.transparencyDiv,"display","none")},_createTransparencyWidget:function(c){this.transHorizSlider=new p({minimum:0,maximum:1,intermediateChanges:!0},this.transparencyBody);this.own(this.transHorizSlider.on("change",k.hitch(this,function(b){this.emit("onMenuClick",{key:"transparencyChanged"},{newTransValue:b})})));this.own(a(this.transHorizSlider.domNode,
"keydown",k.hitch(this,function(b){b.keyCode===e.ESCAPE?(b.stopPropagation(),b.preventDefault(),this.hideTransNode(),(b=this.getMenuItemNodeByItemKey(c.key))&&h.focus(b)):b.keyCode===e.TAB&&(b.stopPropagation(),b.preventDefault(),this._enableNavMode(b))})));new B({container:"bottomDecoration"},this.transparencyRule)},_onSetVisibilityRangeNode:function(c){c.stopPropagation()},showSetVisibilityRangeNode:function(c,b){this.hideTransNode();if(!this.visibleScaleRangeSlider){var a=c.getScaleRange();this.visibleScaleRangeSlider=
(new C({map:c.map,minScale:a.minScale,maxScale:a.maxScale})).placeAt(this.setVisibilityRangeNode);this.visibleScaleRangeSlider.startup();this._supportsVisibilityRange508Accessibility(b)}this.own(this.visibleScaleRangeSlider.on("scale-range-change",k.hitch(this,function(b){c.setScaleRange(b.minScale,b.maxScale)})));x.set(this.setVisibilityRangeNode,"top",this._getTransNodePosition().top);isRTL?x.set(this.setVisibilityRangeNode,"left",this._getTransNodePosition().right):x.set(this.setVisibilityRangeNode,
"right",this._getTransNodePosition().right);x.set(this.setVisibilityRangeNode,"display","block");this.visibleScaleRangeSlider._slider.focus();this.visibleScaleRangeSlider._slider.focus()},hideSetVisibilityRangeNode:function(){x.set(this.setVisibilityRangeNode,"display","none")},hide:function(){x.set(this.domNode,"display","none")},show:function(){x.set(this.domNode,"display","block")},_enableNavMode:function(c){c.keyCode!==e.TAB||v.isInNavMode()||f.addClass(document.body,"jimu-nav-mode")},_supportsVisibilityRange508Accessibility:function(c){var b=
n(".dijitSliderImageHandle",this.setVisibilityRangeNode)[0],d=n(".dijitDownArrowButton",this.setVisibilityRangeNode),g=d[1],f=d[0],l=d[1];this.own(a(b,"keydown",k.hitch(this,function(b){b.keyCode===e.TAB&&b.shiftKey&&(b.stopPropagation(),b.preventDefault())})));this.own(a(g,"keydown",k.hitch(this,function(b){b.keyCode!==e.TAB||b.shiftKey?b.keyCode===e.ENTER&&(b.stopPropagation(),b.preventDefault(),setTimeout(k.hitch(this,function(){this._bindEsriScaleMenuPopupKey(l)}),200)):(b.stopPropagation(),b.preventDefault())})));
this.own(a(f,"keydown",k.hitch(this,function(b){b.keyCode===e.ENTER&&(b.stopPropagation(),b.preventDefault(),setTimeout(k.hitch(this,function(){this._bindEsriScaleMenuPopupKey(f)}),200))})));this.own(a(f,"click",k.hitch(this,function(b){b.stopPropagation();b.preventDefault();setTimeout(k.hitch(this,function(){this._bindEsriScaleMenuPopupKey(f)}),200)})));this.own(a(l,"click",k.hitch(this,function(b){b.stopPropagation();b.preventDefault();setTimeout(k.hitch(this,function(){this._bindEsriScaleMenuPopupKey(l)}),
200)})));this.own(a(this.setVisibilityRangeNode,"keydown",k.hitch(this,function(b){b.keyCode===e.ESCAPE?(b.stopPropagation(),b.preventDefault(),this.hideSetVisibilityRangeNode(),(b=this.getMenuItemNodeByItemKey(c.key))&&h.focus(b)):b.keyCode===e.TAB?(b.stopPropagation(),this._enableNavMode(b)):b.keyCode===e.ENTER&&b.stopPropagation()})))},_bindEsriScaleMenuPopupKey:function(c){var b=this._getEsriScaleMenuPopup(),d,g,p;b&&(d=n(".dijitInputInner",b)[0],f.setAttr(d,"tabindex","0"),g=n(".esriHeader",
b),p=n(".esriCurrent",b)[0],g[0]&&p&&f.setAttr(d,"aria-label",g[0].innerText+" "+p.innerText),h.focus(d));if(b&&!b._hasBeenBoundKey){var l=n(".esriContent",b)[1];f.setAttr(l,"tabindex","0");g[1]&&f.setAttr(l,"aria-label",g[1].innerText+" ");g=n("li.esriItem",b);q.forEach(g,function(d){f.setAttr(d,"tabindex","0");this.own(a(d,"keydown",k.hitch(this,function(a){var g=this._getMenuItemInfo(b,d);a.keyCode===e.TAB?(a.stopPropagation(),a.preventDefault(),l&&h.focus(l)):a.keyCode===e.DOWN_ARROW?(a.stopPropagation(),
a.preventDefault(),g.nextMenuItem&&h.focus(g.nextMenuItem)):a.keyCode===e.UP_ARROW?(a.stopPropagation(),a.preventDefault(),g.previousMenuItem&&h.focus(g.previousMenuItem)):a.keyCode===e.ESCAPE?(a.stopPropagation(),a.preventDefault(),l&&h.focus(l)):a.keyCode===e.ENTER&&(a.stopPropagation(),a.preventDefault(),a=document.createEvent("MouseEvents"),a.initEvent("click",!0,!0),d.dispatchEvent(a),c&&h.focus(c))})))},this);this.own(a(d,"keydown",k.hitch(this,function(b){b.keyCode===e.TAB?(b.stopPropagation(),
b.preventDefault(),this._enableNavMode(b),h.focus(l)):b.keyCode===e.ESCAPE?c&&h.focus(c):b.keyCode===e.ENTER&&c&&h.focus(c)})));l&&this.own(a(l,"keydown",k.hitch(this,function(a){var l=this._getMenuItemInfo(b);a.keyCode===e.TAB?(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a),h.focus(d)):a.keyCode===e.ENTER?(a.stopPropagation(),a.preventDefault(),l.firstMenuItem&&h.focus(l.firstMenuItem)):a.keyCode===e.ESCAPE&&c&&h.focus(c)})));b._hasBeenBoundKey=!0}},_getMenuItemInfo:function(c,b){var a=
{firstMenuItem:null,lastMenuItem:null,previousMenuItem:null,nextMenuItem:null},d=n("li.esriItem",c),d=q.filter(d,k.hitch(this,function(b){return f.hasClass(b,"esriHidden")?!1:!0}));b&&q.some(d,function(c,l){return c===b?(a.previousMenuItem=d[l-1],a.nextMenuItem=d[l+1],!0):!1},this);a.firstMenuItem=d[0];a.lastMenuItem=d[d.length-1];return a},_getEsriScaleMenuPopup:function(){var c=null;n(".esriScaleMenuPopup",document.body).some(function(b){return"block"===f.getStyle(b,"display")?(c=b,!0):!1});return c}})})},
"esri/dijit/VisibleScaleRangeSlider":function(){define("../kernel ./_EventedWidget ./_Tooltip ./VisibleScaleRangeSlider/_RecommendedScaleRangeBounds ./VisibleScaleRangeSlider/_SlideEvent ./VisibleScaleRangeSlider/ScaleMenu ./VisibleScaleRangeSlider/ScalePreview ./VisibleScaleRangeSlider/ScaleRanges dijit/form/DropDownButton dijit/popup dojo/_base/array dojo/_base/lang dojo/aspect dojo/debounce dojo/Deferred dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/on dojo/string dojox/form/HorizontalRangeSlider dojo/i18n!../nls/jsapi".split(" "),
function(r,q,f,k,n,a,e,h,g,d,v,t,p,B,A,x,C,y,z,c,b,m,w,D){q=q.createSubclass([f],{declaredClass:"esri.dijit.VisibleScaleRangeSlider",baseClass:"esriVisibleScaleRangeSlider",css:{currentScaleIndicator:"esriCurrentScaleIndicator",currentScaleIndicatorContainer:"esriCurrentScaleIndicatorContainer",scaleIndicator:"esriScaleIndicator",scaleIndicatorContainer:"esriScaleIndicatorContainer"},disabled:!1,map:null,layer:null,region:"en-US",minScale:0,maxScale:0,intermediateChanges:!1,labels:D.widgets.visibleScaleRangeSlider,
_slider:null,_currentScaleIndicator:null,_scalePreview:null,_maxScaleButton:null,_minScaleButton:null,_mapUpdateHandler:null,_scaleRanges:null,_scheduleScaleRangeChangeEmit:null,_getSliderIndexRange:function(b){b=Math.floor(b);return{min:b,max:b+.99999}},_setDisabledAttr:function(b){this._slider.set("disabled",b);this._maxScaleButton.set("disabled",b);this._minScaleButton.set("disabled",b);this._set("disabled",b)},_setMapAttr:function(b){this._set("map",b);this._mapUpdateHandler&&this._mapUpdateHandler.remove();
this._slider.set("disabled",!0);this._ensureMap().then(this._updateFromMap)},_setConstraintsAttr:function(b){this._set("constraints",b);this._setUpSlider({minScale:b.minScale,maxScale:b.maxScale})},_updateFromMap:function(b){var c=b.getMinScale(),a=b.getMaxScale();this._setUpSlider({minScale:c,maxScale:a});this._updateCurrentScaleIndicator();b=b.on("zoom-end",t.hitch(this,this._updateCurrentScaleIndicator));this.own(b);this._mapUpdateHandler=b},_setUpSlider:function(b){var c=b.maxScale;b=b.minScale;
var a;this._slider.set("disabled",this.get("disabled"));this._scaleRanges.set("scaleRangeBounds",{minScale:b,maxScale:c});a=this._getSliderIndexRange(this._scaleRanges.length-1);this._slider.set("maximum",a.max);this._silentSliderUpdate({maxScale:c,minScale:b})},_ensureMap:function(){return this._untilLoaded(this.map)},_untilLoaded:function(b){var c=new A;if(b)if(b.loaded)c.resolve(b);else b.on("load",function(){c.resolve(b)});else c.reject(Error("could not load resource"));return c.promise},_updateCurrentScaleIndicator:function(){var b=
this._scaleRanges.clampScale(this.map.getScale()),b=this._mapScaleToSlider(b)/this._slider.maximum;this.isLeftToRight()||(b=1-b);z.set(this._currentScaleIndicator,{left:100*b+"%"})},_setLayerAttr:function(b){this._set("layer",b);this._ensureScaleRangeProvider().then(this._ensureLayer).then(this._updateMinMaxScaleFromLayer)},_ensureLayer:function(){return this._untilLoaded(this.layer)},_updateMinMaxScaleFromLayer:function(b){this.set({minScale:b.minScale,maxScale:b.maxScale})},_mapSliderToScale:function(b){var c=
this._getSliderIndexRange(b),a=this._scaleRanges.findScaleRangeByIndex(b);return this._mapToRange(b,c.min,c.max,a.minScale,a.maxScale)},_mapToRange:function(b,c,a,d,e){return d+(b-c)*(e-d)/(a-c)},_setRegionAttr:function(b){this._set("region",b);this._scalePreview.set("source",h.getScalePreviewSource(b))},_getMinimumAttr:function(){return this._mapSliderToScale(this._slider.minimum)},_getMaximumAttr:function(){return this._mapSliderToScale(this._slider.maximum)},_getActualMaxScaleAttr:function(){return this._scaleRanges.clampMaxScale(this.maxScale)},
_setMaxScaleAttr:function(b){this._set("maxScale",b);this._ensureScaleRangeProvider().then(t.hitch(this,function(){b=this._scaleRanges.clampMaxScale(b);this._set("maxScale",this._layerConstrainedMaxScale(b));this._silentSliderUpdate({maxScale:b});this._scheduleScaleRangeChangeEmit()}))},_silentSliderUpdate:function(b){var c=b.minScale,a=b.maxScale,d=this._scaleRanges;b=this._slider;void 0!==c&&(c=this._mapScaleToSlider(d.clampMinScale(c)),b.set("value",c,!1,!1));void 0!==a&&(c=this._mapScaleToSlider(d.clampMaxScale(a)),
b.set("value",c,!1,!0))},_mapScaleToSlider:function(b){var c=this._scaleRanges.scaleToRangeIndex(b),a=this._getSliderIndexRange(c),c=this._scaleRanges.findScaleRangeByIndex(c);return this._mapToRange(b,c.minScale,c.maxScale,a.min,a.max)},_getActualMinScaleAttr:function(){return this._scaleRanges.clampMinScale(this.minScale)},_setMinScaleAttr:function(b){this._set("minScale",b);this._ensureScaleRangeProvider().then(t.hitch(this,function(){b=this._scaleRanges.clampMinScale(b);this._set("minScale",this._layerConstrainedMinScale(b));
this._silentSliderUpdate({minScale:b});this._scheduleScaleRangeChangeEmit()}))},_ensureScaleRangeProvider:function(){if(this.map)return this._ensureMap();var b=new A;this.constraints&&b.resolve();return b.promise},_emitScaleRangeChange:function(){this.emit("scale-range-change",{minScale:this.minScale,maxScale:this.maxScale})},_layerConstrainedMinScale:function(b){var c=t.getObject("tileInfo.lods",!1,this.layer)||[],a;return 0<c.length?(c=c[0].scale,a=this._scaleRanges.get("firstRange"),(a=.85<this._mapToRange(b,
a.maxScale,a.minScale,0,1))?c:b>c?c:b):this._scaleRanges.beyondMinScale(b)?0:b},_layerConstrainedMaxScale:function(b){var c=t.getObject("tileInfo.lods",!1,this.layer)||[];return 0<c.length?(c=c[c.length-1].scale,b<c?c:b):this._scaleRanges.beyondMaxScale(b)?0:b},constructor:function(){this._scaleRanges=new (h.createSubclass([k]));this._scheduleScaleRangeChangeEmit=B(t.hitch(this,this._emitScaleRangeChange),0);this._ensureMap=t.hitch(this,this._ensureMap);this._ensureScaleRangeProvider=t.hitch(this,
this._ensureScaleRangeProvider);this._ensureLayer=t.hitch(this,this._ensureLayer);this._updateMinMaxScaleFromLayer=t.hitch(this,this._updateMinMaxScaleFromLayer);this._updateFromMap=t.hitch(this,this._updateFromMap)},buildRendering:function(){this.inherited(arguments);this._initSlider();this._initScalePreview();this._initCurrentScaleIndicator();this._initScaleMenus()},_initSlider:function(){var b=new (w.createSubclass([n]))({baseClass:"esriHorizontalSlider",showButtons:!1,intermediateChanges:this.intermediateChanges,
disabled:!0});this._slider=b;b.placeAt(this.domNode);b.startup();this.own(b.on("slide-onmousemove, slidemax-onmousemove",t.hitch(this,function(b){this._updateScalePreview(b.movable.handle)})),b.on("slide-onmovestop, slidemax-onmovestop",t.hitch(this,function(b){x.contains(b.movable.handle,"dijitSliderThumbHover")||this._closeScalePreview()})),b.on("change",t.hitch(this,function(){var b=Math.round(this._mapSliderToScale(this._getSliderMin())),c=Math.round(this._mapSliderToScale(this._getSliderMax()));
this.set({minScale:b,maxScale:c})})),p.after(b,"_setValueAttr",t.hitch(this,this._updateLabelMenus)))},_getSliderMin:function(){return this._slider.get("value")[0]},_getSliderMax:function(){return this._slider.get("value")[1]},_updateLabelMenus:function(){var b=this._maxScaleButton;this._minScaleButton.set("label",this._scaleRanges.getScaleRangeLabel(this._getSliderMin()));b.set("label",this._scaleRanges.getScaleRangeLabel(this._getSliderMax()))},_initScalePreview:function(){var b=new e;b.startup();
d.moveOffScreen(b);v.forEach([this._slider._movable.handle,this._slider._movableMax.handle],function(b){b.onmouseenter=t.hitch(this,this._updateScalePreview,b);b.onmouseleave=t.hitch(this,this._closeScalePreview)},this);this.own(b);this._scalePreview=b},_closeScalePreview:function(){d.close(this._scalePreview)},_updateScalePreview:function(b){if(!this.disabled){var c=this._scalePreview;d.moveOffScreen(c);var a=this._slider,e=b===a.sliderHandle?this._getSliderMin():this._getSliderMax(),g=y.position(b),
f=y.position(c.domNode),a=y.position(a.sliderBarContainer),p=this.isLeftToRight(),e=this._scaleRanges.getScalePreviewSpriteBackgroundPosition(e);c.set("backgroundPosition",e);g=g.x-a.x;f=.5*f.w;d.open({parent:this,popup:c,around:b,orient:g<f?p?["above","below"]:["above-alt","below-alt"]:g<a.w-f?["above-centered","below-centered"]:p?["above-alt","below-alt"]:["above","below"]})}},_initCurrentScaleIndicator:function(){if(this.map){var c=C.create("div",{className:this.css.scaleIndicatorContainer+" "+
this.css.currentScaleIndicatorContainer},this._slider.sliderBarContainer),a=C.create("div",{className:this.css.scaleIndicator+" "+this.css.currentScaleIndicator},c);this._currentScaleIndicator=a;this.createTooltip(a);c=b(a,"mouseover",t.hitch(this,function(){var b=m.substitute(this.labels.currentScaleTooltip,{scaleLabel:this._scaleRanges.getScaleRangeLabel(this._mapScaleToSlider(this.map.getScale()))});this.findTooltip(a).set("label",b)}));this.own(c)}},_initScaleMenus:function(){var b=new a,c=new a,
d,e;this.own(b.on("scale-selected",t.hitch(this,function(b){d.closeDropDown();this.set("minScale",b.scale)})));this.own(c.on("scale-selected",t.hitch(this,function(b){e.closeDropDown();this.set("maxScale",b.scale)})));d=new g({baseClass:"esriScaleMenuButton esriMinScaleMenuButton",dropDown:b,dropDownPosition:["below","above"]});d.toggleDropDown();d.toggleDropDown();e=new g({baseClass:"esriScaleMenuButton esriMaxScaleMenuButton",dropDown:c,dropDownPosition:["below","above"]});e.toggleDropDown();e.toggleDropDown();
this.own(p.before(d,"openDropDown",t.hitch(this,function(){var c=this._scaleRanges.findScaleRange(this.get("actualMaxScale")).minScale;b.set("options",{label:d.label,scale:{current:this.get("actualMinScale"),map:this._getMapScale(),min:this.get("minimum"),max:c}})})));this.own(p.before(e,"openDropDown",t.hitch(this,function(){var b=this._scaleRanges.findScaleRange(this.get("actualMinScale")).maxScale;c.set("options",{label:e.label,scale:{current:this.get("actualMaxScale"),map:this._getMapScale(),
min:b,max:this.get("maximum")}})})));d.placeAt(this.domNode);e.placeAt(this.domNode);b.startup();c.startup();d.startup();e.startup();this._minScaleButton=d;this._maxScaleButton=e},_getMapScale:function(){return this.map?this.map.getScale():-1},startup:function(){this.inherited(arguments);this.watch("intermediateChanges",function(b,c,a){this._slider.set(b,a)})}});c("extend-esri")&&t.setObject("dijit.VisibleScaleRangeSlider",q,r);return q})},"esri/dijit/_Tooltip":function(){define(["dijit/Tooltip",
"dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom"],function(r,q,f,k,n){return f(null,{declaredClass:"esri.dijit._Tooltip",_tooltips:null,constructor:function(){this._tooltips=[]},startup:function(){this.inherited(arguments);this._started||q.forEach(this._tooltips,function(a){a.startup()})},destroy:function(){this.inherited(arguments);q.forEach(this._tooltips,function(a){a.destroy()});this._tooltips=null},createTooltips:function(a){q.forEach(a,function(a){this.createTooltip(a.node,
a.label)},this)},createTooltip:function(a,e){if(a=this._getConnectId(a))e="object"===typeof e?k.mixin({},e,{connectId:a}):{connectId:a,label:e},e=new r(e),this._started&&e.startup(),this._tooltips.push(e)},_getConnectId:function(a){var e,f;if(a){if(k.isArray(a)){if(e=[],q.forEach(a,function(a){(f=this._getNode(a))&&e.push(f)}),0===e.length)return}else if(e=this._getNode(a),!e)return;return e}},_getNode:function(a){return n.byId(a.domNode||a)},findTooltip:function(a){var e=this._getNode(a),f,g,d;if(a){a=
this._tooltips;f=a.length;for(var v=0;v<f;v++)if(g=a[v],d=k.isArray(g.connectId)?-1<q.indexOf(g.connectId,e):g.connectId===e)return g}}})})},"esri/dijit/VisibleScaleRangeSlider/_RecommendedScaleRangeBounds":function(){define(["./recommendedScales","dojo/_base/declare"],function(r,q){return q(null,{declaredClass:"esri.dijit.VisibleScaleRangeSlider._RecommendedScaleRangeBounds",beyondMinScale:function(f){var k=this.get("firstRange"),n=k.minScale,k=r.getRecommendedScale(k.id)||k.maxScale;return f<=n&&
f>k},beyondMaxScale:function(f){var k=this.get("lastRange"),n=k.maxScale,k=r.getRecommendedScale(k.id)||k.minScale;return f<k&&f>=n}})})},"esri/dijit/VisibleScaleRangeSlider/recommendedScales":function(){define(["dojo/_base/lang"],function(r){var q={_recommendedScales:{world:1E8,continent:5E7,countriesBig:25E6,countriesSmall:12E6,statesProvinces:6E6,stateProvince:3E6,counties:15E5,county:75E4,metropolitanArea:32E4,cities:16E4,city:8E4,town:4E4,neighborhood:2E4,streets:1E4,street:5E3,buildings:2500,
building:1250,smallBuilding:800,rooms:400,room:100},getRecommendedScale:function(f){return q._recommendedScales[f]},all:function(){return r.clone(q._recommendedScales)}};return q})},"esri/dijit/VisibleScaleRangeSlider/_SlideEvent":function(){define(["dojo/_base/array","dojo/_base/declare"],function(r,q){return q(null,{declaredClass:"esri.dijit.VisibleScaleRangeSlider._SlideEvent",_events:["onMouseMove","onFirstMove",{name:"onMoveStop",hookTo:"destroy"}],postCreate:function(){this.inherited(arguments);
this._extendMover(this._movable);this._extendMover(this._movableBar,"rangebar");this._extendMover(this._movableMax,"max")},_extendMover:function(f,k){if(f){var n=f.mover,a={};r.forEach(this._events,function(e){var h,g,d,v,t,p;"object"===typeof e?(g=e.name,h=e.hookTo):g=e;d=n.prototype[g]||function(){};v="slide"+(k||"")+"-"+g.toLowerCase();t=function(){d.apply(this,arguments);this.widget.emit(v,{movable:f})};h&&(p=n.prototype[h],a[h]=function(){p.apply(this,arguments);t.apply(this,arguments)});a[g]=
t});n.extend(a)}}})})},"esri/dijit/VisibleScaleRangeSlider/ScaleMenu":function(){define("../../kernel ../_EventedWidget ../_Tooltip ./recommendedScales ./ScaleRanges dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-prop dojo/dom-style dojo/has dojo/keys dojo/number dojo/on dojo/query dojo/string dojox/html/entities dojox/lang/functional/object dojo/i18n!../../nls/jsapi dojo/text!./templates/ScaleMenu.html dijit/form/TextBox".split(" "),
function(r,q,f,k,n,a,e,h,g,d,v,t,p,B,A,x,C,y,z,c,b,m,w,D){q=h([q,a,e,f],{declaredClass:"esri.dijit.VisibleScaleRangeSlider.ScaleMenu",templateString:D,baseClass:"esriScaleMenu",labels:w.widgets.visibleScaleRangeSlider,css:{header:"esriHeader",section:"esriSection",content:"esriContent",current:"esriCurrent",input:"esriInput",list:"esriList",item:"esriItem",inline:"esriInline",selectable:"esriSelectable",hidden:"esriHidden"},_elementValueMap:null,_elements:null,_scaleRangeCategories:null,_scaleRanges:null,
_rangeToScaleAndNodeLookup:null,constructor:function(){this._scaleRanges=new n},buildRendering:function(){this.inherited(arguments);this._rangeToScaleAndNodeLookup={map:{scale:null,node:this.dap_mapScaleItem}};var b=this.labels,a=b.featuredScaleLabels,d=k.all(),e=this.css.item+" "+this.css.selectable,f;g.forEach(m.keys(d),function(b){f=a[b];var g=d[b],p=c.substitute(f,{scaleLabel:this._formatScale(g)}),p=t.create("li",{innerHTML:p,className:e},this.dap_recommendedScales);this._rangeToScaleAndNodeLookup[b]=
{scale:g,node:p}},this);var h=t.create("span",{innerHTML:b.setTo,className:this.css.inline}),v=t.create("span",{innerHTML:b.selectOne,className:this.css.inline});p.set(this.dap_scaleListHeader,"innerHTML",c.substitute(b.setToSelectOne,{setTo:h.outerHTML,selectOne:v.outerHTML}))},_formatScale:function(b){return"1:"+C.format(b)},postCreate:function(){this.inherited(arguments);this.own(y(this.domNode,y.selector("."+this.css.item+"."+this.css.selectable,"click"),d.hitch(this,function(b){b=b.target===
this.dap_mapScaleItem?this.options.scale.map:this._parseScale(b.target.innerHTML);this._emitScaleSelected(b)})));this.dap_scaleInput.on("keyDown",d.hitch(this,function(b){b.keyCode===x.ENTER&&this._handleCustomScaleInput()}));this.createTooltip(this.dap_scaleInput,this.labels.customScaleInputTooltip)},_emitScaleSelected:function(b){this.emit("scale-selected",{scale:b})},_handleCustomScaleInput:function(){var b=this._parseScale(this.dap_scaleInput.get("value"));isNaN(b)||this._emitScaleSelected(this._scaleRanges.clampScale(b))},
_parseScale:function(c){c=b.decode(c).replace(/.*\(/,"").replace(/\).*$/,"").replace(/.*1:/,"").replace(/[^0-9.\s]/g,"");return C.parse(c)},_setOptionsAttr:function(b){var a=b.scale,d=this._formatScale(a.current);p.set(this.dap_currentScaleLabel,"innerHTML",b.label);this.dap_scaleInput.set("value",d,!1);d=c.substitute(this.labels.featuredScaleLabels.current,{scaleLabel:this._formatScale(a.map)});this._rangeToScaleAndNodeLookup.map.scale=a.map;p.set(this.dap_mapScaleItem,"innerHTML",d);v.toggle(this.dap_mapScaleItem,
this.css.hidden,-1===a.map);this._scaleRanges.set("scaleRangeBounds",{minScale:a.min,maxScale:a.max});this._hideOutOfScaleRanges();this._set("options",b)},_hideOutOfScaleRanges:function(){var b=z("."+this.css.item+"."+this.css.selectable,this.dap_recommendedScales),c=this._scaleRanges;g.forEach(m.keys(this._rangeToScaleAndNodeLookup),function(b){b=this._rangeToScaleAndNodeLookup[b];v.toggle(b.node,this.css.hidden,!c.contains(b.scale))},this);b=b.every(function(b){return"none"===B.get(b,"display")});
v.toggle(this.dap_recommendedScaleSection,this.css.hidden,b)}});A("extend-esri")&&d.setObject("dijit.ScaleMenu",q,r);return q})},"esri/dijit/VisibleScaleRangeSlider/ScaleRanges":function(){define(["./scalePreviewUtil","dojo/_base/array","dojo/_base/declare","dojo/Stateful","dojo/i18n!../../nls/jsapi"],function(r,q,f,k,n){f=f(k,{_scaleRangeStops:[{id:"room",minScale:100},{id:"rooms",minScale:400},{id:"smallBuilding",minScale:800},{id:"building",minScale:1999},{id:"buildings",minScale:3999},{id:"street",
minScale:7499},{id:"streets",minScale:14999},{id:"neighborhood",minScale:29999},{id:"town",minScale:59999},{id:"city",minScale:119999},{id:"cities",minScale:249999},{id:"metropolitanArea",minScale:499999},{id:"county",minScale:999999},{id:"counties",minScale:1999999},{id:"state",minScale:3999999},{id:"states",minScale:6999999},{id:"country",minScale:14999999},{id:"countries",minScale:34999999},{id:"continent",minScale:99999999},{id:"world",minScale:147914382}],_allRanges:null,_ranges:null,length:0,
constructor:function(){this._allRanges=this.getScaleRanges()},_scaleRangeBoundsSetter:function(a){this._ranges=a=this.getScaleRanges(a.maxScale,a.minScale);this.length=a.length},getScaleRanges:function(a,e){var f=this._scaleRangeStops,g=f.length,d,v,t;a=0<=a?a:0;e=0<e?e:f[g-1].minScale;d=a;v=[];for(var p=0;p<g;p++){var k=Math.min(f[p].minScale,e);t=Math.min(k,e);a<=k&&d<e&&v.push({id:f[p].id,maxScale:Math.max(d,a),minScale:t});d=t+1}v.reverse();return this._ensureValidBoundaryRanges(v)},_ensureValidBoundaryRanges:function(a){var e=
a[0];e.minScale===e.maxScale&&(a.shift(),a[0].minScale+=1);e=a[a.length-1];e.minScale===e.maxScale&&(a.pop(),--a[a.length-1].maxScale);return a},getScalePreviewSpriteBackgroundPosition:function(a){a=this._toFullRangeIndex(a);return r.getScalePreviewSpriteBackgroundPosition(a)},_toFullRangeIndex:function(a){a=this.findScaleRangeByIndex(Math.floor(a));for(var e=this._allRanges,f=e.length,g=0,d=0;d<f;d++)if(e[d].id===a.id){g=d;break}return g},getScaleRangeLabel:function(a){a=this._ranges[this._clampScaleRangeIndex(a)];
return n.widgets.visibleScaleRangeSlider.scaleRangeLabels[a.id]},findScaleRange:function(a){var e=this._ranges,f,g;if(a>=e[0].maxScale)return e[0];if(a<=e[e.length-1].minScale)return e[e.length-1];for(var d=0;d<e.length;d++)if(g=e[d],a>=g.maxScale&&a<=g.minScale){f=g;break}return f},findScaleRangeByIndex:function(a){a=this._clampScaleRangeIndex(a);return this._ranges[a]},clampScale:function(a){return Math.min(this.get("minScale"),Math.max(this.get("maxScale"),a))},_minScaleGetter:function(){return this.get("firstRange").minScale},
_maxScaleGetter:function(){return this.get("lastRange").maxScale},_firstRangeGetter:function(){return this._ranges[0]},_lastRangeGetter:function(){var a=this._ranges;return a[a.length-1]},clampMinScale:function(a){return 0===a?this.get("minScale"):this.clampScale(a)},clampMaxScale:function(a){return this.clampScale(a)},_clampScaleRangeIndex:function(a){if(0>=a)return 0;var e=this._ranges.length-1;return a>e?e:Math.floor(a)},scaleToRangeIndex:function(a){return q.indexOf(this._ranges,this.findScaleRange(a))},
contains:function(a){for(var e=this._ranges,f=!1,g,d=0;d<e.length;d++)if(g=e[d],a>=g.maxScale&&a<=g.minScale){f=!0;break}return f}});f.getScalePreviewSource=function(a){return r.getScalePreviewSource(a)};return f})},"esri/dijit/VisibleScaleRangeSlider/scalePreviewUtil":function(){define(["dojo/_base/array","require"],function(r,q){var f={_supportedRegions:"ar-iq ar-kw bg-bg cs-cz da-dk da-gl da-gl de-at de-ch de-de de-li el-gr en-ae en-au en-ca en-ca en-eg en-gb en-hk en-id en-ie en-ie en-il en-in en-iq en-ke en-lu en-mo en-my en-nz en-rw en-sg en-us en-us en-vi en-vi en-wo en-za es-ar es-ar es-bo es-bo es-cl es-cl es-co es-co es-cr es-cr es-es es-gt es-gt es-mx es-mx es-ni es-ni es-pe es-pe es-pr es-pr es-sv es-sv es-ve et-ee fi-fi fi-fi fr-ci fr-fr fr-ma fr-mg fr-ml fr-tn is-is is-is it-it ja-jp ja-jp ko-kr lt-lt lv-lv nl-be nl-nl nl-sr nl-sr nn-no nn-no pl-pl pt-br pt-br pt-pt ro-ro ru-ru sk-sk sv-se sv-se th-th zh-cn zh-tw".split(" "),
_defaultRegion:"en-us",_getSupportedRegion:function(k){k=k?k.toLowerCase():"";return-1<r.indexOf(f._supportedRegions,k)?k:f._defaultRegion},getScalePreviewSource:function(k){k="./images/scalePreview/"+f._getSupportedRegion(k)+".jpg";return"url("+q.toUrl(k)+")"},getScalePreviewSpriteBackgroundPosition:function(f){return"-"+f%5*128+"px -"+128*Math.floor(f/5)+"px"}};return f})},"dojox/lang/functional/object":function(){define(["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(r,q,f){var k={};
q.mixin(f,{keys:function(f){var a=[],e;for(e in f)e in k||a.push(e);return a},values:function(f){var a=[],e;for(e in f)e in k||a.push(f[e]);return a},filterIn:function(n,a,e){e=e||r.global;a=f.lambda(a);var h={},g,d;for(d in n)d in k||(g=n[d],a.call(e,g,d,n)&&(h[d]=g));return h},forIn:function(n,a,e){e=e||r.global;a=f.lambda(a);for(var h in n)h in k||a.call(e,n[h],h,n);return e},mapIn:function(n,a,e){e=e||r.global;a=f.lambda(a);var h={},g;for(g in n)g in k||(h[g]=a.call(e,n[g],g,n));return h}});return f})},
"dojox/lang/functional/lambda":function(){define(["../..","dojo/_base/lang","dojo/_base/array"],function(r,q,f){var k=q.getObject("lang.functional",!0,r),n={},a=1<"ab".split(/a*/).length?String.prototype.split:function(a){var d=this.split.call(this,a);(a=a.exec(this))&&0==a.index&&d.unshift("");return d},e=function(e){var d=[],g=a.call(e,/\s*->\s*/m);if(1<g.length)for(;g.length;)e=g.pop(),d=g.pop().split(/\s*,\s*|\s+/m),g.length&&g.push("(function("+d.join(", ")+"){ return ("+e+"); })");else if(e.match(/\b_\b/))d=
["_"];else{var g=e.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),h=e.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(g||h)g&&(d.push("$1"),e="$1"+e),h&&(d.push("$2"),e+="$2");else{var g=e.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,
"").match(/([a-z_$][a-z_$\d]*)/gi)||[],p={};f.forEach(g,function(a){p.hasOwnProperty(a)||(d.push(a),p[a]=1)})}}return{args:d,body:e}},h=function(a){return a.length?function(){var d=a.length-1,e=k.lambda(a[d]).apply(this,arguments);for(--d;0<=d;--d)e=k.lambda(a[d]).call(this,e);return e}:function(a){return a}};q.mixin(k,{rawLambda:function(a){return e(a)},buildLambda:function(a){a=e(a);return"function("+a.args.join(",")+"){return ("+a.body+");}"},lambda:function(a){if("function"==typeof a)return a;
if(a instanceof Array)return h(a);if(n.hasOwnProperty(a))return n[a];var d=e(a);return n[a]=new Function(d.args,"return ("+d.body+");")},clearLambdaCache:function(){n={}}});return k})},"esri/dijit/VisibleScaleRangeSlider/ScalePreview":function(){define("../../kernel dijit/_TemplatedMixin dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has dojo/i18n!../../nls/jsapi dojo/text!./templates/ScalePreview.html".split(" "),function(r,q,f,k,n,a,e,h,g){q=k([f,q],{declaredClass:"esri.dijit.VisibleScaleRangeSlider.ScalePreview",
baseClass:"esriScalePreview",templateString:g,labels:h.widgets.visibleScaleRangeSlider,css:{header:"esriHeader",thumbnail:"esriThumbnail"},source:null,_setSourceAttr:function(d){this.source!==d&&(this._set("source",d),a.set(this.dap_scalePreviewThumbnail,"backgroundImage",d))},backgroundPosition:null,_setBackgroundPositionAttr:function(d){this.backgroundPosition!==d&&(this._set("backgroundPosition",d),a.set(this.dap_scalePreviewThumbnail,"backgroundPosition",d))}});e("extend-esri")&&n.setObject("dijit.ScalePreview",
q,r);return q})},"dojox/form/HorizontalRangeSlider":function(){define(["dojo/_base/declare","dojox/form/_RangeSliderMixin","dojo/text!./resources/HorizontalRangeSlider.html","dijit/form/HorizontalSlider"],function(r,q,f,k){return r("dojox.form.HorizontalRangeSlider",[k,q],{templateString:f})})},"dojox/form/_RangeSliderMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/fx dojo/_base/event dojo/_base/sniff dojo/dom-style dojo/dom-geometry dojo/keys dijit dojo/dnd/Mover dojo/dnd/Moveable dijit/form/_FormValueWidget dijit/focus dojo/fx dojox/fx".split(" "),
function(r,q,f,k,n,a,e,h,g,d,v,t,p,B,A){var x=function(a,c){return a-c};d=r("dojox.form._RangeSliderMixin",null,{_setTabIndexAttr:["sliderHandle","sliderHandleMax"],value:[0,100],postMixInProperties:function(){this.inherited(arguments);this.value=f.map(this.value,function(a){return parseInt(a,10)})},postCreate:function(){this.inherited(arguments);this.value.sort(x);var a=this,c=r(C,{constructor:function(){this.widget=a}});this._movableMax=new t(this.sliderHandleMax,{mover:c});this.sliderHandle.setAttribute("aria-valuemin",
this.minimum);this.sliderHandle.setAttribute("aria-valuemax",this.maximum);this.sliderHandleMax.setAttribute("aria-valuemin",this.minimum);this.sliderHandleMax.setAttribute("aria-valuemax",this.maximum);c=r(y,{constructor:function(){this.widget=a}});this._movableBar=new t(this.progressBar,{mover:c});this.focusNode.removeAttribute("aria-valuemin");this.focusNode.removeAttribute("aria-valuemax");this.focusNode.removeAttribute("aria-valuenow")},destroy:function(){this.inherited(arguments);this._movableMax.destroy();
this._movableBar.destroy()},_onKeyPress:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey)){var c=a.target===this.sliderHandleMax,b=a.target===this.progressBar,d=q.delegate(g,this.isLeftToRight()?{PREV_ARROW:g.LEFT_ARROW,NEXT_ARROW:g.RIGHT_ARROW}:{PREV_ARROW:g.RIGHT_ARROW,NEXT_ARROW:g.LEFT_ARROW}),e=0,f=!1;switch(a.keyCode){case d.HOME:this._setValueAttr(this.minimum,!0,c);n.stop(a);return;case d.END:this._setValueAttr(this.maximum,!0,c);n.stop(a);return;case d.PREV_ARROW:case d.DOWN_ARROW:f=
!0;case d.NEXT_ARROW:case d.UP_ARROW:e=1;break;case d.PAGE_DOWN:f=!0;case d.PAGE_UP:e=this.pageIncrement;break;default:this.inherited(arguments);return}f&&(e=-e);e&&(b?this._bumpValue([{change:e,useMaxValue:!1},{change:e,useMaxValue:!0}]):this._bumpValue(e,c),n.stop(a))}},_onHandleClickMax:function(d){this.disabled||this.readOnly||(a("ie")||B.focus(this.sliderHandleMax),n.stop(d))},_onClkIncBumper:function(){this._setValueAttr(!1===this._descending?this.minimum:this.maximum,!0,!0)},_bumpValue:function(a,
c){a=q.isArray(a)?[this._getBumpValue(a[0].change,a[0].useMaxValue),this._getBumpValue(a[1].change,a[1].useMaxValue)]:this._getBumpValue(a,c);this._setValueAttr(a,!0,c)},_getBumpValue:function(a,c){var b=c?1:0;c=e.getComputedStyle(this.sliderBarContainer);var d=h.getContentBox(this.sliderBarContainer,c);c=this.discreteValues;b=this.value[b];if(1>=c||Infinity==c)c=d[this._pixelCount];c--;a=this.maximum>this.minimum?(b-this.minimum)*c/(this.maximum-this.minimum)+a:0;0>a&&(a=0);a>c&&(a=c);return a*(this.maximum-
this.minimum)/c+this.minimum},_onBarClick:function(d){this.disabled||this.readOnly||(a("ie")||B.focus(this.progressBar),n.stop(d))},_onRemainingBarClick:function(d){if(!this.disabled&&!this.readOnly){a("ie")||B.focus(this.progressBar);var c=h.position(this.sliderBarContainer,!0),b=h.position(this.progressBar,!0),e=d[this._mousePixelCoord],f=b[this._startingPixelCoord],b=f+b[this._pixelCount],f=this._isReversed()?e<=f:e>=b,e=this._isReversed()?c[this._pixelCount]-e+c[this._startingPixelCoord]:e-c[this._startingPixelCoord];
this._setPixelValue(e,c[this._pixelCount],!0,f);n.stop(d)}},_setPixelValue:function(a,c,b,d){this.disabled||this.readOnly||(a=this._getValueByPixelValue(a,c),this._setValueAttr(a,b,d))},_getValueByPixelValue:function(a,c){var b=this.discreteValues;if(1>=b||Infinity==b)b=c;b--;return(this.maximum-this.minimum)*Math.round((0>a?0:c<a?c:a)/(c/b))/b+this.minimum},_setValueAttr:function(a,c,b){var d=q.clone(this.value);q.isArray(a)?d=a:d[b?1:0]=a;this._lastValueReported="";this.valueNode.value=a=d;d.sort(x);
this.sliderHandle.setAttribute("aria-valuenow",d[0]);this.sliderHandleMax.setAttribute("aria-valuenow",d[1]);p.prototype._setValueAttr.apply(this,arguments);this._printSliderBar(c,b)},_printSliderBar:function(a,c){c=this.maximum>this.minimum?(this.value[0]-this.minimum)/(this.maximum-this.minimum):0;var b=this.maximum>this.minimum?(this.value[1]-this.minimum)/(this.maximum-this.minimum):0,d=c;c>b&&(c=b,b=d);var e=this._isReversed()?100*(1-c):100*c,f=this._isReversed()?100*(1-b):100*b,p=this._isReversed()?
100*(1-b):100*c;if(a&&0<this.slideDuration&&this.progressBar.style[this._progressPixelSize]){if(parseFloat(this.progressBar.style[this._handleOffsetCoord]),a=this.slideDuration/10,0!==a){0>a&&(a=0-a);var g={},h={},d={};g[this._handleOffsetCoord]={start:this.sliderHandle.parentNode.style[this._handleOffsetCoord],end:e,units:"%"};h[this._handleOffsetCoord]={start:this.sliderHandleMax.parentNode.style[this._handleOffsetCoord],end:f,units:"%"};d[this._handleOffsetCoord]={start:this.progressBar.style[this._handleOffsetCoord],
end:p,units:"%"};d[this._progressPixelSize]={start:this.progressBar.style[this._progressPixelSize],end:100*(b-c),units:"%"};c=k.animateProperty({node:this.sliderHandle.parentNode,duration:a,properties:g});b=k.animateProperty({node:this.sliderHandleMax.parentNode,duration:a,properties:h});a=k.animateProperty({node:this.progressBar,duration:a,properties:d});A.combine([c,b,a]).play()}}else this.sliderHandle.parentNode.style[this._handleOffsetCoord]=e+"%",this.sliderHandleMax.parentNode.style[this._handleOffsetCoord]=
f+"%",this.progressBar.style[this._handleOffsetCoord]=p+"%",this.progressBar.style[this._progressPixelSize]=100*(b-c)+"%"}});var C=r("dijit.form._SliderMoverMax",v,{onMouseMove:function(a){var c=this.widget,b=c._abspos;b||(b=c._abspos=h.position(c.sliderBarContainer,!0),c._setPixelValue_=q.hitch(c,"_setPixelValue"),c._isReversed_=c._isReversed());a=a[c._mousePixelCoord]-b[c._startingPixelCoord];c._setPixelValue_(c._isReversed_?b[c._pixelCount]-a:a,b[c._pixelCount],!1,!0)},destroy:function(a){v.prototype.destroy.apply(this,
arguments);var c=this.widget;c._abspos=null;c._setValueAttr(c.value,!0)}}),y=r("dijit.form._SliderBarMover",v,{onMouseMove:function(a){var c=this.widget;if(!c.disabled&&!c.readOnly){var b=c._abspos,d=c._bar,e=c._mouseOffset;b||(b=c._abspos=h.position(c.sliderBarContainer,!0),c._setPixelValue_=q.hitch(c,"_setPixelValue"),c._getValueByPixelValue_=q.hitch(c,"_getValueByPixelValue"),c._isReversed_=c._isReversed());d||(d=c._bar=h.position(c.progressBar,!0));e||(e=c._mouseOffset=a[c._mousePixelCoord]-d[c._startingPixelCoord]);
a=a[c._mousePixelCoord]-b[c._startingPixelCoord]-e;pixelValues=[a,a+d[c._pixelCount]];pixelValues.sort(x);0>=pixelValues[0]&&(pixelValues[0]=0,pixelValues[1]=d[c._pixelCount]);pixelValues[1]>=b[c._pixelCount]&&(pixelValues[1]=b[c._pixelCount],pixelValues[0]=b[c._pixelCount]-d[c._pixelCount]);b=[c._getValueByPixelValue(c._isReversed_?b[c._pixelCount]-pixelValues[0]:pixelValues[0],b[c._pixelCount]),c._getValueByPixelValue(c._isReversed_?b[c._pixelCount]-pixelValues[1]:pixelValues[1],b[c._pixelCount])];
c._setValueAttr(b,!1,!1)}},destroy:function(){v.prototype.destroy.apply(this,arguments);var a=this.widget;a._abspos=null;a._bar=null;a._mouseOffset=null;a._setValueAttr(a.value,!0)}});return d})},"dojox/fx":function(){define(["./fx/_base"],function(r){return r})},"dojox/fx/_base":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/fx dojo/fx dojo/dom dojo/dom-style dojo/dom-geometry dojo/_base/connect dojo/_base/html".split(" "),function(r,q,f,k,n,a,e,h,g){r=q.getObject("dojox.fx",!0);
q.mixin(r,{anim:f.anim,animateProperty:f.animateProperty,fadeTo:f._fade,fadeIn:f.fadeIn,fadeOut:f.fadeOut,combine:k.combine,chain:k.chain,slideTo:k.slideTo,wipeIn:k.wipeIn,wipeOut:k.wipeOut});r.sizeTo=function(d){var e=d.node=n.byId(d.node),g=d.method||"chain";d.duration||(d.duration=500);"chain"==g&&(d.duration=Math.floor(d.duration/2));var p,h,A,x,r,y=null,z=function(c){return function(){var b=a.getComputedStyle(c),e=b.position,f=b.width,g=b.height;p="absolute"==e?c.offsetTop:parseInt(b.top)||0;
A="absolute"==e?c.offsetLeft:parseInt(b.left)||0;r="auto"==f?0:parseInt(f);y="auto"==g?0:parseInt(g);x=A-Math.floor((d.width-r)/2);h=p-Math.floor((d.height-y)/2);"absolute"!=e&&"relative"!=e&&(b=a.coords(c,!0),p=b.y,A=b.x,c.style.position="absolute",c.style.top=p+"px",c.style.left=A+"px")}}(e),e=f.animateProperty(q.mixin({properties:{height:function(){z();return{end:d.height||0,start:y}},top:function(){return{start:p,end:h}}}},d)),g=f.animateProperty(q.mixin({properties:{width:function(){return{start:r,
end:d.width||0}},left:function(){return{start:A,end:x}}}},d));return k["combine"==d.method?"combine":"chain"]([e,g])};r.slideBy=function(d){var g,k,p=function(d){return function(){var f=a.getComputedStyle(d),p=f.position;g="absolute"==p?d.offsetTop:parseInt(f.top)||0;k="absolute"==p?d.offsetLeft:parseInt(f.left)||0;"absolute"!=p&&"relative"!=p&&(f=e.coords(d,!0),g=f.y,k=f.x,d.style.position="absolute",d.style.top=g+"px",d.style.left=k+"px")}}(d.node=n.byId(d.node));p();d=f.animateProperty(q.mixin({properties:{top:g+
(d.top||0),left:k+(d.left||0)}},d));h.connect(d,"beforeBegin",d,p);return d};r.crossFade=function(a){var d=a.nodes[0]=n.byId(a.nodes[0]),e=g.style(d,"opacity"),p=a.nodes[1]=n.byId(a.nodes[1]);g.style(p,"opacity");return k.combine([f[0==e?"fadeIn":"fadeOut"](q.mixin({node:d},a)),f[0==e?"fadeOut":"fadeIn"](q.mixin({node:p},a))])};r.highlight=function(a){var d=a.node=n.byId(a.node);a.duration=a.duration||400;var e=a.color||"#ffff99",p=g.style(d,"backgroundColor");"rgba(0, 0, 0, 0)"==p&&(p="transparent");
a=f.animateProperty(q.mixin({properties:{backgroundColor:{start:e,end:p}}},a));"transparent"==p&&h.connect(a,"onEnd",a,function(){d.style.backgroundColor=p});return a};r.wipeTo=function(a){a.node=n.byId(a.node);var d=a.node,e=d.style,p=a.width?"width":"height",h={};h[p]={start:function(){e.overflow="hidden";if("hidden"==e.visibility||"none"==e.display)return e[p]="1px",e.display="",e.visibility="",1;var a=g.style(d,p);return Math.max(a,1)},end:a[p]};return f.animateProperty(q.mixin({properties:h},
a))};return r})},"widgets/LayerList/NlsStrings":function(){define([],function(){return{value:null}})},"widgets/LayerList/PopupMenuInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all jimu/WidgetManager jimu/portalUrlUtils esri/lang ./NlsStrings".split(" "),function(r,q,f,k,n,a,e,h,g){var d=r([],{_candidateMenuItems:null,_displayItems:null,_layerInfo:null,_layerType:null,_appConfig:null,constructor:function(a,d,e,f){this.nls=g.value;this._layerInfo=
a;this._layerType=e;this.layerListWidget=f;this._initCandidateMenuItems();this._initDisplayItems(d)},_getATagLabel:function(){var a,d;a=this._layerInfo.getUrl();(d=this._layerInfo.isItemLayer())?(a=this._getItemDetailsPageUrl(d)||a,d=this.nls.itemShowItemDetails):!a||"CSVLayer"!==this._layerType&&"KMLLayer"!==this._layerType?(a=a&&"WMSLayer"===this._layerType?a+(-1<a.indexOf("?")?"\x26":"?")+"SERVICE\x3dWMS\x26REQUEST\x3dGetCapabilities":a&&"WFSLayer"===this._layerType?a+(-1<a.indexOf("?")?"\x26":
"?")+"SERVICE\x3dWFS\x26REQUEST\x3dGetCapabilities":a?a:"",d=this.nls.itemDesc):d=this.nls.itemDownload;this._ATagLabelUrl=a;return'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d"'+a+'"\x3e'+d+"\x3c/a\x3e"},_getItemDetailsPageUrl:function(a){var d="";return d=e.getItemDetailsPageUrl(a.portalUrl,a.itemId)},_initCandidateMenuItems:function(){this._candidateMenuItems=[{key:"separator",label:""},{key:"empty",label:this.nls.empty},{key:"zoomto",label:this.nls.itemZoomTo},{key:"transparency",
label:this.nls.itemTransparency},{key:"setVisibilityRange",label:this.nls.itemSetVisibilityRange},{key:"moveup",label:this.nls.itemMoveUp},{key:"movedown",label:this.nls.itemMoveDown},{key:"table",label:this.nls.itemToAttributeTable},{key:"controlPopup",label:this.nls.removePopup},{key:"controlLabels",label:this.nls.showLabels},{key:"url",label:this._getATagLabel()}]},_initDisplayItems:function(a){this._displayItems=[];q.forEach(a,function(a){q.forEach(this._candidateMenuItems,function(d){a.key===
d.key&&(this._displayItems.push(f.clone(d)),a.onClick&&(this._displayItem.onClick=a.onClick))},this)},this)},_getSupportTableInfoForAllSublayers:function(a){var d=[];a.traversal(function(a){var e=new k;a.getSupportTableInfo().then(function(d){d.layerInfo=a;e.resolve(d)});d.push(e)});return n(d)},_isSupportedByAT:function(a,d){return q.some(d,function(a){return a.isSupportedLayer?!0:!1})},getDeniedItems:function(){var a=new k,d=[];this.layerListWidget.layerListView.isFirstDisplayedLayerInfo(this._layerInfo)&&
d.push({key:"moveup",denyType:"disable"});this.layerListWidget.layerListView.isLastDisplayedLayerInfo(this._layerInfo)&&d.push({key:"movedown",denyType:"disable"});this._ATagLabelUrl||d.push({key:"url",denyType:"disable"});this._layerInfo.canShowLabel()||d.push({key:"controlLabels",denyType:"hidden"});this._layerInfo.originOperLayer.featureCollection?d.push({key:"setVisibilityRange",denyType:"hidden"}):this._layerInfo.isRootLayer()||"esri.layers.ArcGISTiledMapServiceLayer"!==this._layerInfo.getRootLayerInfo().layerObject.declaredClass?
this._layerInfo.isRootLayer()||"esri.layers.ArcGISDynamicMapServiceLayer"!==this._layerInfo.getRootLayerInfo().layerObject.declaredClass||this._layerInfo.getRootLayerInfo().layerObject.supportsDynamicLayers||d.push({key:"setVisibilityRange",denyType:"disable"}):d.push({key:"setVisibilityRange",denyType:"hidden"});var e=this._layerInfo.isSupportPopupNested(),g=this._getSupportTableInfoForAllSublayers(this._layerInfo);n({isPopupSupported:e,supportTableInfo:g}).then(f.hitch(this,function(e){e.isPopupSupported||
d.push({key:"controlPopup",denyType:"hidden"});e=e.supportTableInfo;var f=this.layerListWidget.appConfig.getConfigElementsByName("AttributeTable")[0];f&&f.visible?this._isSupportedByAT(f,e)||d.push({key:"table",denyType:"disable"}):d.push({key:"table",denyType:"hidden"});a.resolve(d)}),function(){a.resolve(d)});return a},getDisplayItems:function(){return this._displayItems},onPopupMenuClick:function(a){var d={closeMenu:!0};switch(a.itemKey){case "zoomto":this._onItemZoomToClick(a);break;case "moveup":this._onMoveUpItemClick(a);
break;case "movedown":this._onMoveDownItemClick(a);break;case "table":this._onTableItemClick(a);break;case "transparencyChanged":this._onTransparencyChanged(a);d.closeMenu=!1;break;case "controlPopup":this._onControlPopup();break;case "controlLabels":this._onControlLabels()}return d},_onItemZoomToClick:function(a){this._layerInfo.zoomTo()},_isValidExtent:function(a){var d=!1;h.isDefined(a)&&h.isDefined(a.xmin)&&isFinite(a.xmin)&&h.isDefined(a.ymin)&&isFinite(a.ymin)&&h.isDefined(a.xmax)&&isFinite(a.xmax)&&
h.isDefined(a.ymax)&&isFinite(a.ymax)&&(d=!0);return d},_onMoveUpItemClick:function(a){this._layerInfo.isFirst||a.layerListView.moveUpLayer(this._layerInfo)},_onMoveDownItemClick:function(a){this._layerInfo.isLast||a.layerListView.moveDownLayer(this._layerInfo)},_onTableItemClick:function(d){this._getSupportTableInfoForAllSublayers(this._layerInfo).then(f.hitch(this,function(e){var g,h=this.layerListWidget.appConfig.getConfigElementsByName("AttributeTable")[0];this._isSupportedByAT(h,e)&&(g=a.getInstance(),
q.forEach(e,function(a){a.isSupportedLayer&&g.triggerWidgetOpen(h.id).then(f.hitch(this,function(e){e&&g.activateWidget(e);d.layerListWidget.publishData({target:"AttributeTable",layer:a.layerInfo})}))},this))}))},_onTransparencyChanged:function(a){this._layerInfo.setOpacity(1-a.extraData.newTransValue)},_onControlPopup:function(a){this._layerInfo.isPopupNestedEnabled()?this._layerInfo.disablePopupNested():this._layerInfo.enablePopupNested();this._layerInfo.map.infoWindow.hide()},_onControlLabels:function(a){this._layerInfo.canShowLabel()&&
(this._layerInfo.isShowLabels()?this._layerInfo.hideLabels():this._layerInfo.showLabels())}});d.create=function(a,e){var g=new k,h=a.isRootLayer(),n={RootLayer:[{key:"zoomto"},{key:"transparency"},{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"moveup"},{key:"movedown"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],RootLayerAndFeatureLayer:[{key:"zoomto"},{key:"transparency"},{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},
{key:"separator"},{key:"controlLabels"},{key:"separator"},{key:"moveup"},{key:"movedown"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],FeatureLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],SublayerOfDynamicMapserviceLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"url"}],GroupLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"table"},{key:"separator"},
{key:"url"}],Table:[{key:"table"},{key:"separator"},{key:"url"}],BasemapLayer:[{key:"zoomto"},{key:"transparency"},{key:"separator"},{key:"url"}],"default":[{key:"controlPopup"},{key:"separator"},{key:"url",onClick:null}]};a.getLayerType().then(f.hitch(this,function(f){var p="",p=a.isBasemap()&&a.isRootLayer()?"BasemapLayer":a.isBasemap()?"default":!h||"FeatureLayer"!==f&&"CSVLayer"!==f&&"ArcGISImageServiceLayer"!==f&&"StreamLayer"!==f&&"ArcGISImageServiceVectorLayer"!==f?h?"RootLayer":"FeatureLayer"===
f||"CSVLayer"===f?"FeatureLayer":a.isLeaf()&&a.getRootLayerInfo()&&a.getRootLayerInfo().layerObject&&"esri.layers.ArcGISDynamicMapServiceLayer"===a.getRootLayerInfo().layerObject.declaredClass?"SublayerOfDynamicMapserviceLayer":"GroupLayer"===f?"GroupLayer":"Table"===f?"Table":"default":"RootLayerAndFeatureLayer";g.resolve(new d(a,n[p],f,e))}),f.hitch(this,function(){g.resolve(new d(a,[{key:"empty"}]))}));return g};return d})},"widgets/LayerList/LayerFilter":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dijit/_TemplatedMixin dojo/text!./LayerFilter.html dojo/dom dojo/on dojo/keys dojo/dom-class dijit/focus jimu/utils jimu/dijit/Search".split(" "),
function(r,q,f,k,n,a,e,h,g,d,v,t){return q([r,k],{templateString:n,baseClass:"layer-filter",layerFilterInput:null,isValid:!1,layerListWidget:null,layerInfoIsValidStatus:null,layerInfoIsExpandStatus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=f.mixin(f.clone(this.layerListWidget.nls),window.jimuNls.common)},constructor:function(){this.layerInfoIsValidStatus={};this.layerInfoIsExpandStatus={}},startup:function(){this.layerFilterInput=(new t({placeholder:this.nls.typeAKeywork,
onSearch:f.hitch(this,this._onFilter),searchWhenInput:!0})).placeAt(this.searchInputNode);a.setSelectable(this.cancelButton,!1);this.own(e(this.searchButton,"keydown",f.hitch(this,"_onSearchButtonKey")));this.own(e(this.layerFilterInput.inputSearch,"keydown",f.hitch(this,"_onLayerFilterInputKey")));this.own(e(this.clearInputButton,"keydown",f.hitch(this,"_onClearInputButtonKey")));this.own(e(this.cancelButton,"keydown",f.hitch(this,"_onCancelButtonKey")))},_updateLayerInfoStatus:function(a){this.layerInfoIsValidStatus=
{};this.layerInfoIsExpandStatus={};this.layerListWidget.operLayerInfos.traversalAll(f.hitch(this,function(d){if(a){var e;if(0<=d.title.toLowerCase().indexOf(a.toLowerCase()))for(e=d;e;)this.layerInfoIsValidStatus[e.id]=!0,(e=e.parentLayerInfo)&&(this.layerInfoIsExpandStatus[e.id]=!0);else for(e=d.parentLayerInfo;e;){if(0<=e.title.toLowerCase().indexOf(a.toLowerCase())){this.layerInfoIsValidStatus[d.id]=!0;break}e=e.parentLayerInfo}}else this.layerInfoIsValidStatus[d.id]=!0}))},isValidLayerInfo:function(a){return!this.isValid||
this.layerInfoIsValidStatus[a.id]},isExpanded:function(a){return this.isValid&&this.layerInfoIsExpandStatus[a.id]},cancelFilter:function(){this.isValid=!1;this.layerFilterInput.inputSearch.value&&(this.layerFilterInput.inputSearch.value="",this.layerListWidget._refresh());g.remove(this.searchButton,"invalid");g.add(this.searchInputNode,"invalid");g.add(this.cancelButton,"invalid");d.focus(this.searchButton)},_onFilter:function(a){a?g.remove(this.clearInputButton,"disable"):g.add(this.clearInputButton,
"disable");this._updateLayerInfoStatus(a);this.layerListWidget._refresh()},_onSearchBtnClick:function(){this.isValid=!0;g.add(this.searchButton,"invalid");g.remove(this.searchInputNode,"invalid");g.remove(this.cancelButton,"invalid");this.layerFilterInput.inputSearch.focus()},_onCancelBtnClick:function(){this.cancelFilter()},_onClearInputButton:function(){this.layerFilterInput.inputSearch.value&&(g.add(this.clearInputButton,"disable"),this.layerFilterInput.inputSearch.focus(),this.layerFilterInput.inputSearch.value=
"",this._updateLayerInfoStatus(""),this.layerListWidget._refresh())},_onSearchButtonKey:function(a){a.keyCode===h.ENTER&&this._onSearchBtnClick()},_onLayerFilterInputKey:function(a){a.keyCode===h.TAB&&a.shiftKey?(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a)):a.keyCode!==h.TAB||a.shiftKey?a.keyCode===h.ESCAPE&&(a.stopPropagation(),a.preventDefault(),this._onCancelBtnClick()):(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a),g.contains(this.clearInputButton,"disable")?
d.focus(this.cancelButton):d.focus(this.clearInputButton))},_onClearInputButtonKey:function(a){a.keyCode===h.TAB&&a.shiftKey?(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a),d.focus(this.layerFilterInput.inputSearch)):a.keyCode!==h.TAB||a.shiftKey?a.keyCode===h.ENTER?(a.stopPropagation(),a.preventDefault(),this._onClearInputButton()):a.keyCode===h.ESCAPE&&(a.stopPropagation(),a.preventDefault(),this._onCancelBtnClick()):(a.stopPropagation(),a.preventDefault(),d.focus(this.cancelButton))},
_onCancelButtonKey:function(a){a.keyCode===h.TAB&&a.shiftKey?(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a),d.focus(this.layerFilterInput.inputSearch)):a.keyCode!==h.TAB||a.shiftKey?a.keyCode===h.ENTER?(a.stopPropagation(),a.preventDefault(),this._onCancelBtnClick()):a.keyCode===h.ESCAPE&&(a.stopPropagation(),a.preventDefault(),this._onCancelBtnClick()):(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a))},_enableNavMode:function(a){a.keyCode!==h.TAB||v.isInNavMode()||g.add(document.body,
"jimu-nav-mode")}})})},"widgets/LayerList/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/LayerList/PopupMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"popup-menu-transparency-body" data-dojo-attach-point\x3d"transparencyDiv" data-dojo-attach-event\x3d"onclick:_onTransparencyDivClick" \x3e\r\n    \x3cdiv class\x3d"label"\x3e\r\n      \x3cdiv class\x3d"label-left jimu-float-leading"\x3e${nls.itemOpaque}\x3c/div\x3e\r\n      \x3cdiv class\x3d"label-right jimu-float-trailing"\x3e${nls.itemTransparent}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"transparencyBody"\x3e \r\n      \x3col data-dojo-attach-point\x3d"transparencyRule" class\x3d"transparency-rule"\x3e \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"popup-menu-visible-scale-range-body" data-dojo-attach-point\x3d"setVisibilityRangeNode" data-dojo-attach-event\x3d"onclick:_onSetVisibilityRangeNode"\x3e \r\n  \x3c/div\x3e\r\n\x3cdiv\x3e\r\n',
"url:esri/dijit/VisibleScaleRangeSlider/templates/ScaleMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.section}"\x3e\r\n    \x3cdiv class\x3d"${css.header}"\x3e${labels.current}\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.content}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_currentScaleLabel" class\x3d"${css.item} ${css.current}"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_scaleInput" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"${css.input}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_recommendedScaleSection"\x3e\r\n    \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_scaleListHeader"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.content}"\x3e\r\n      \x3col data-dojo-attach-point\x3d"dap_recommendedScales" class\x3d"${css.list}"\x3e\r\n        \x3cli data-dojo-attach-point\x3d"dap_mapScaleItem" class\x3d"${css.item} ${css.selectable}"\x3e\x3c/li\x3e\r\n        \x3c!--additional list items added dynamically--\x3e\r\n      \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/VisibleScaleRangeSlider/templates/ScalePreview.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.header}"\x3e${labels.preview}\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dap_scalePreviewThumbnail" class\x3d"${css.thumbnail}"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:dojox/form/resources/HorizontalRangeSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH dojoxRangeSlider" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onkeyup:_onKeyUp" role\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" dojoAttachEvent\x3d"onmousedown:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput dojoAttachPoint\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv role\x3d"presentation" class\x3d"dojoxRangeSliderBarContainer" dojoAttachPoint\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandle,focusNode" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" dojoAttachEvent\x3d"onmousedown:_onBarClick"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandleMax" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClickMax" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" dojoAttachEvent\x3d"onmousedown:_onRemainingBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" dojoAttachEvent\x3d"onmousedown:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:widgets/LayerList/LayerListView.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layer-list-operations" role\x3d\'button\' aria-haspopup\x3d\'true\' aria-label\x3d"${nls.tipLayerListOperation}" aria-expanded\x3d"false" tabindex\x3d"0" data-dojo-attach-point\x3d"layerListOperations"\x3e\r\n    \x3c!--div class\x3d"setting-image jimu-icon jimu-icon-setting jimu-state-disabled"\x3e\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3ctable class\x3d"layer-list-table"\x3e\r\n    \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"layerListTable"\x3e\x3c/tbody\x3e\r\n    \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"tableListTable"\x3e\x3c/tbody\x3e       \r\n  \x3c/table\x3e\r\n  \x3cdiv class\x3d"supports-508-node" tabindex\x3d"0" data-dojo-attach-point\x3d"supports508Node"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/LayerList/LayerFilter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"search-input-node invalid" data-dojo-attach-point\x3d"searchInputNode"\x3e\r\n    \x3cdiv class\x3d"clear-input-button disable" tabindex\x3d"0" role\x3d"button" aria-label\x3d\'${nls.tipClearText}\' data-dojo-attach-point\x3d"clearInputButton" data-dojo-attach-event\x3d"click:_onClearInputButton"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-button" data-dojo-attach-point\x3d"searchButton" role\x3d"button" tabindex\x3d"0" data-dojo-attach-event\x3d"click:_onSearchBtnClick"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"cancel-button invalid" data-dojo-attach-point\x3d"cancelButton" role\x3d"button" tabindex\x3d"0" data-dojo-attach-event\x3d"click:_onCancelBtnClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/LayerList/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layers-section" data-dojo-attach-point\x3d"layersSection"\x3e\r\n    \x3cdiv class\x3d"layer-list-title" data-dojo-attach-point\x3d"layerListTitle"\x3e${nls.layers}\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-filter-node" data-dojo-attach-point\x3d"layerFilterNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-list-body" data-dojo-attach-point\x3d"layerListBody"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/LayerList/css/style.css":'.jimu-widget-layerList{position: relative;}.jimu-widget-layerList .jimu-hr{margin-top: 15px;}.jimu-widget-layerList .layers-section{margin-top: 0px; z-index: 0; position: relative;}.jimu-widget-layerList .layers-section .layers-list{width: 100%;}.jimu-widget-layerList .layers-section .layer-list-title{height: 16px; font-size: 14px; margin-bottom: 14px; font-family: "Avenir Heavy"; margin-left: 8px; margin-right: 8px;}.jimu-widget-layerList .layers-section .layer-list-title.disable{margin-bottom: 2px;}.jimu-widget-layerList .layer-list-body {}.jimu-widget-layerList .layer-list-table{width: 100%; border-spacing: 0px;}.jimu-widget-layerList .layers-list-body{border: 0px solid #999;}.jimu-widget-layerList .jimu-widget-row{}.jimu-widget-layerList .layer-row{height: 40px;}.jimu-nav-mode .jimu-widget-layerList .layer-row:focus{outline: none !important;}.jimu-nav-mode .jimu-widget-layerList .layer-row:focus .col1{border-left: 2px solid #24b5cc; border-top: 2px solid #24b5cc; border-bottom: 2px solid #24b5cc;}.jimu-nav-mode .jimu-widget-layerList .layer-row:focus .col2{border-top: 2px solid #24b5cc; border-bottom: 2px solid #24b5cc;}.jimu-nav-mode .jimu-widget-layerList .layer-row:focus .col3{border-right: 2px solid #24b5cc; border-top: 2px solid #24b5cc; border-bottom: 2px solid #24b5cc;}.jimu-widget-layerList .layer-row:hover{background-color: #e3ecf2;}.jimu-widget-layerList .layer-row-mouseover{background-color: #e3ecf2;}.jimu-widget-layerList .jimu-widget-row-selected{background-color: #d9dde0;}.jimu-widget-layerList .jimu-widget-row-active{background-color: #009cff;}.jimu-widget-layerList .jimu-widget-row-selected .col-layer-label{color: #333;}.jimu-widget-layerList .jimu-widget-row-active .col-layer-label{color: #fff;}.jimu-widget-layerList .col{border: 0px solid; border-bottom: 0px solid #ffffff;}.jimu-widget-layerList .col1{}.jimu-widget-layerList .col2{width: auto; word-break: break-word; cursor: pointer;}.jimu-widget-layerList .col3{width: 24px;}.jimu-widget-layerList .begin-blank-div{width: 12px; height: 2px;}.jimu-widget-layerList .col-showLegend{width: 17px; text-align: center;}.jimu-widget-layerList .showLegend-div{width: 12px; height: 12px; cursor: pointer; margin-left: 3px; margin-top: 2px; background-image: url("../images/v_right.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .jimu-widget-layerList .showLegend-div{background-image: url("../images/v_left.png"); margin-left: 0; margin-right: 3px;} .jimu-widget-layerList .showLegend-div.unfold{background-image: url("../images/v.png");}.jimu-widget-layerList .showLegend-div.hidden{background-image: none; cursor: auto;}.jimu-widget-layerList .layers-list-imageShowLegend-down{-moz-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -webkit-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -o-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -ms-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);}.jimu-widget-layerList .layers-list-imageShowLegend-down-div{background-color: #d9dde0;}.jimu-widget-layerList .noLegend-div{width: 33px; text-align: right; display: none;}.jimu-widget-layerList .noLegend-image{display: block; margin: 0 auto;}.jimu-widget-layerList .col-blank{width:17px;}.jimu-widget-layerList .col-select{width: 17px;}.jimu-widget-layerList .col-reserve-blank{width: 25px;}.jimu-widget-layerList .col-content{color: #686868; font-size: 12px;}.jimu-widget-layerList .div-select{position: relative; font-size: 2px;}.jimu-widget-layerList .div-select .checkbox{cursor: auto;}.jimu-widget-layerList .image-group-div {width: 14px; height: 14px; background-image: url("../images/group_layer.svg"); background-repeat: no-repeat; background-position: center center; background-size: 14px; margin: 1px 0 0 2px; cursor: auto;}.jimu-rtl .jimu-widget-layerList .image-group-div {margin-left: 4px; margin-right: auto;}.jimu-widget-layerList .image-group-div.disable{display: none;}.jimu-widget-layerList .div-content{position: relative; font-size: 12px; border: 0px solid;}.jimu-widget-layerList .div-content.grayed-title{opacity: 0.3;}.jimu-widget-layerList .col-popupMenu{width: 17px; text-align: center;}.jimu-widget-layerList .col-select .jimu-selection-box{margin-top: 5px;}.jimu-widget-layerList .layers-list-body .col-layer-label{color: #686868;}.jimu-widget-layerList .layer-sub-node{display: none; width:100%; border-spacing: 0px;}.jimu-widget-layerList .legend-node-td{}.jimu-widget-layerList .legend-div{overflow: hidden; font-size: 11px;}.jimu-widget-layerList .legend-symbol{}.jimu-widget-layerList .legend-label{margin-top: 17px; color: #686868; font-size: 11px;}.jimu-widget-layerList .esriLegendService {padding-bottom: 0;}.jimu-widget-layerList .esriLegendLayerLabel {padding-top: 0; height: 0; display: none;}.jimu-widget-layerList .esriLegendServiceLabel {display: none;}.jimu-widget-layerList .esriLegendLayer{font-size: 12px;}.jimu-widget-layerList .esriLegendMsg{display: none;}.jimu-widget-layerList .layers-list-popupMenu-div{position: relative; width: 22px; height: 40px; cursor: pointer; border-radius: 2px; float: right; background-image: url("../images/more_normal.svg"); background-repeat: no-repeat; background-position: center 19px;}.jimu-widget-layerList .layers-list-popupMenu-div:hover{background-image: url("../images/more_hover.svg");}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-button{background: none;}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-button:hover{background: none;}.jimu-widget-layerList .layers-list-popupMenu-div .loading-section {width: 17px; height: 17px; top: 14px; left: 2px; z-index: 1; margin: 0;} .jimu-rtl .jimu-widget-layerList .layers-list-popupMenu-div .loading-section {left: auto; right: 2px;}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-loading{width: 17px; height: 17px; margin: -9px 0 0 2px; border-radius: 25px; background-image: url("../images/loading.gif"); background-repeat: no-repeat; background-position: center center; background-size: contain;}.jimu-rtl .jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-loading{}.jimu-widget-layerList .layers-list-popupMenu-div-selected{width: 13px; height: 13px; background-color: #ffffff; border-radius: 2px;}.jimu-widget-layerList .layers-list-popupMenu-image{position: absolute; top: 5px; left: 3px;}.jimu-widget-layerList .popup-menu-transparency-body {position: absolute; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-width:1px; width: 290px; height:50px; padding-left: 5px; padding-right: 5px; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderImageHandleH{background: url(./images/slider-handle.png); width: 10px; border: none; height: 14px;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderBar {background: #ddd none; border-color: #999;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderBar {background: #ddd none; border-color: #999;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderDecrementIconH, .jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderIncrementIconH {background-color: #ddd; border: solid 1px #b5bcc7;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderDecrementIconH,.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderIncrementIconH {background-color: #ddd; border: solid 1px #b5bcc7;}.jimu-widget-layerList .popup-menu-transparency-body .transparency-rule{}.jimu-widget-layerList .popup-menu-transparency-body .label {overflow: hidden; margin-top: 2px; margin-bottom: 1px;}.jimu-widget-layerList .popup-menu-visible-scale-range-body {position: absolute; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-width:1px; width: 290px; height:50px; padding-left: 5px; padding-right: 5px; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-visible-scale-range-body .esriVisibleScaleRangeSlider{margin-top: 15px;}.jimu-widget-layerList .jimu-dropmenu .popup-menu-button{width: 22px; height: 22px;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn{width: 22px; height: 22px; min-width: 13px; background-image: url("../images/more_normal.svg"); background-color: rgba(255, 255, 255, 0); border: 0 solid;}.jimu-widget-layerList .layers-list-popupMenu-div:hover .jimu-icon-btn{background-image: url("../images/more_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn-selected{background-image: url("../images/more_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .jimu-dropmenu .drop-menu{min-width: 180px; max-width: 330px; outline-color:#ffffff; outline-style:solid; outline-width:1px; overflow:auto; font-size: 12px; z-index: 2; right: 0px; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-style: none;}.jimu-widget-layerList .jimu-dropmenu .drop-menu hr{border-bottom: 1px solid #d7dbde !important;}.jimu-widget-layerList .jimu-dropmenu .drop-menu.no-border{outline-style: none; border: none; box-shadow: none;}.jimu-rtl .jimu-widget-layerList .jimu-dropmenu .drop-menu{left: 0px;}.jimu-widget-layerList .jimu-dropmenu .menu-item{position: relative; height: 40px; line-height: 40px; white-space: nowrap; padding: 0px 24px; margin: 0 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin: 2px 2px 2px 2px;}.jimu-widget-layerList .jimu-dropmenu .menu-item:focus{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .jimu-dropmenu .menu-item:hover{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .jimu-dropmenu .menu-item-dissable{opacity: 0.4;}.jimu-widget-layerList .jimu-dropmenu .menu-item-hidden{display: none;}.jimu-widget-layerList .jimu-dropmenu .menu-item a{width: 100%;}.jimu-rtl .jimu-widget-layerList .jimu-dropmenu .menu-item a{right: auto; left: 0;}.jimu-widget-layerList .legends-loading-img{width: 45px;}.jimu-widget-layerList .jimu-dropmenu .menu-item .menu-item-description{text-decoration: none; color: inherit; display: block;}.jimu-widget-layerList .layer-list-operations{position: absolute; right: 0; top: 0;}.jimu-rtl .jimu-widget-layerList .layer-list-operations{right: auto; left: 0;}.jimu-widget-layerList .layer-list-operations .setting-image{position: relative; right: 11px; top: -1px;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .setting-image{right: auto; left: 11px;}.jimu-widget-layerList .layer-list-operations .jimu-icon-btn{background-image: url("../images/operation_normal.svg"); background-color: rgba(255, 255, 255, 0);}.jimu-rtl .jimu-widget-layerList .layer-list-operations .jimu-icon-btn{left: auto; right: -8px;}.jimu-widget-layerList .layer-list-operations:hover .jimu-icon-btn{background-image: url("../images/operation_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .layer-list-operations .drop-menu{min-width:147px !important; top: 21px !important; right: 0 !important; left: auto !important; z-index: 1 !important; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-style: none !important;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .drop-menu{right: auto !important; left: 0 !important;}.jimu-widget-layerList .layer-list-operations .drop-menu hr{border-bottom: 1px solid #d7dbde !important;}.jimu-widget-layerList .layer-list-operations .drop-menu .menu-item{margin: 0; padding: 0 7px; font-size: 12px; padding: 0 20px; margin: 2px 2px 2px 2px;}.jimu-widget-layerList .layer-list-operations .drop-menu .menu-item:hover{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .layer-list-operations .jimu-loading{font-size: 5px; top: 45px; left: 20px;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .jimu-loading{left: auto; right: 20px;}.jimu-widget-layerList .layer-filter-node{position: absolute; width: 100%; top: 0;}.jimu-widget-layerList .layer-filter{position: relative;}.jimu-widget-layerList .layer-filter .search-input-node{position: absolute; top: -10px; left: 0; right: 74px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node{left: 70px; right: 0;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input-wrapper{border: 1px solid #cccccc; background-color: #ffffff;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input{border: none; padding-left: 32px; padding-right: 30px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input{padding-left: 30px; padding-right: 32px;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input:focus{box-shadow: none;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn{left: 10px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn{right: 10px; left: auto;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn:hover{cursor: auto; background-position: 0 -291px;}.jimu-widget-layerList .layer-filter .search-input-node.invalid{display: none;}.jimu-widget-layerList .layer-filter .search-button{width: 20px; height: 20px; position: absolute; top: -2px; right: 23px; background-image: url("../images/search_normal.svg"); background-repeat: no-repeat; background-position: center; cursor: pointer;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-button{left: 23px; right: auto;}.jimu-widget-layerList .layer-filter .search-button:focus{}.jimu-widget-layerList .layer-filter .search-button:hover{background-image: url("../images/search_hover.svg");}.jimu-widget-layerList .layer-filter .search-button.invalid{display: none;}.jimu-widget-layerList .layer-filter .cancel-button{width: 69px; height: 30px; line-height: 30px; border: 1px solid #cccccc; position: absolute; top: -5px; right: 0; z-index: 1; background-color: #ffffff; text-align: center; cursor: pointer; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding: 0 2px 0 2px;}.jimu-widget-layerList .layer-filter .cancel-button:hover{border: 1px solid #000; font-family: "Avenir Medium";}.jimu-rtl .jimu-widget-layerList .layer-filter .cancel-button{left: 0; right: auto;}.jimu-widget-layerList .layer-filter .cancel-button.invalid{display: none;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button{width: 15px; height: 25px; position: absolute; top: 7px; right: 10px; z-index: 1; background-image: url("../images/clear.svg"); background-repeat: no-repeat; background-position: center; background-size: 10px 10px;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button.disable{display: none;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button:hover{background-image: url("../images/clear_hover.svg");}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .clear-input-button{left: 10px; right: auto;}',
"*now":function(r){r(['dojo/i18n!*preload*widgets/LayerList/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("jimu/BaseWidget dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom dojo/on dojo/query dijit/registry ./LayerListView ./LayerFilter ./NlsStrings jimu/LayerInfos/LayerInfos".split(" "),function(r,q,f,k,n,a,e,h,g,d,v,t,p){return q([r],{baseClass:"jimu-widget-layerList",name:"layerList",layerFilter:null,_denyLayerInfosReorderResponseOneTime:null,_denyLayerInfosIsVisibleChangedResponseOneTime:null,layerListView:null,operLayerInfos:null,postCreate:function(){!1===this.config.showTitle&&
(this.layerListTitle.innerHTML="",n.addClass(this.layerListTitle,"disable"))},startup:function(){this.inherited(arguments);this._createLayerFilter();t.value=this.nls;this._denyLayerInfosIsVisibleChangedResponseOneTime=this._denyLayerInfosReorderResponseOneTime=!1;if(this.map.itemId)p.getInstance(this.map,this.map.itemInfo).then(f.hitch(this,function(d){this.operLayerInfos=d;this.showLayers();this.bindEvents();a.setSelectable(this.layerListBody,!1);a.setSelectable(this.layerListTitle,!1)}));else{var d=
this._obtainMapLayers();p.getInstance(this.map,d).then(f.hitch(this,function(d){this.operLayerInfos=d;this.showLayers();this.bindEvents();a.setSelectable(this.layerListBody,!1);a.setSelectable(this.layerListTitle,!1)}))}},_createLayerFilter:function(){this.layerFilter=(new v({layerListWidget:this})).placeAt(this.layerFilterNode);n.setAttr(this.layerFilter.searchButton,"tabindex",0);n.setAttr(this.layerFilter.searchButton,"aria-label",this.nls.layers+" "+window.jimuNls.common.search);n.addClass(this.layerFilter.searchButton,
"firstFocusNode")},destroy:function(){this._clearLayers();this.inherited(arguments)},_obtainMapLayers:function(){var a=[],d=[],e={itemData:{baseMap:{baseMapLayers:[]},operationalLayers:[]}};k.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);a.isOperationalLayer&&d.push({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" "})},this);k.forEach(this.map.layerIds,function(e){e=this.map.getLayer(e);e.isOperationalLayer?d.push({layerObject:e,title:e.label||e.title||e.name||
e.id||" ",id:e.id||" "}):a.push({layerObject:e,id:e.id||" "})},this);e.itemData.baseMap.baseMapLayers=a;e.itemData.operationalLayers=d;return e},showLayers:function(){this.layerListView=(new d({operLayerInfos:this.operLayerInfos,layerListWidget:this,layerFilter:this.layerFilter,config:this.config})).placeAt(this.layerListBody);this.config.expandAllLayersByDefault&&this.layerListView.foldOrUnfoldAllLayers(!1)},_clearLayers:function(){this.layerListView&&this.layerListView.destroyRecursive&&this.layerListView.destroyRecursive()},
_refresh:function(){this._clearLayers();this.showLayers()},bindEvents:function(){this.own(e(this.operLayerInfos,"layerInfosChanged",f.hitch(this,this._onLayerInfosChanged)));this.config.showBasemap&&this.own(e(this.operLayerInfos,"basemapLayerInfosChanged",f.hitch(this,this._onLayerInfosChanged)));this.own(e(this.operLayerInfos,"tableInfosChanged",f.hitch(this,this._onTableInfosChanged)));this.own(this.operLayerInfos.on("layerInfosIsVisibleChanged",f.hitch(this,this._onLayerInfosIsVisibleChanged)));
this.own(e(this.operLayerInfos,"layerInfosReorder",f.hitch(this,this._onLayerInfosReorder)));this.own(e(this.map,"zoom-end",f.hitch(this,this._onZoomEnd)));this.own(e(this.operLayerInfos,"layerInfosRendererChanged",f.hitch(this,this._onLayerInfosRendererChanged)));this.own(e(this.operLayerInfos,"layerInfosOpacityChanged",f.hitch(this,this._onLayerInfosOpacityChanged)));this.own(e(this.operLayerInfos,"layerInfosScaleRangeChanged",f.hitch(this,this._onLayerInfosScaleRangeChanged)))},_onLayerInfosChanged:function(){this.layerFilter.cancelFilter();
this.layerListView.refresh()},_onTableInfosChanged:function(){this.layerFilter.cancelFilter();this.layerListView.refresh()},_onLayerInfosIsVisibleChanged:function(a){this._denyLayerInfosIsVisibleChangedResponseOneTime?this._denyLayerInfosIsVisibleChangedResponseOneTime=!1:k.forEach(a,function(a){h("[class~\x3d'visible-checkbox-"+a.id+"']",this.domNode).forEach(function(d){d=g.byNode(d);a.isVisible()?d.check():d.uncheck()},this)},this)},_onZoomEnd:function(){var a=[];this.operLayerInfos.traversal(f.hitch(this,
function(d){a.push(d)}));var d=this;setTimeout(function(){var e=a.shift();h("[class~\x3d'layer-title-div-"+e.id+"']",this.domNode).forEach(function(a){try{e.isInScale()?n.removeClass(a,"grayed-title"):n.addClass(a,"grayed-title")}catch(y){console.warn(y.message)}},d);0<a.length&&setTimeout(arguments.callee,30)},30)},_onLayerInfosReorder:function(){this._denyLayerInfosReorderResponseOneTime?this._denyLayerInfosReorderResponseOneTime=!1:this._refresh()},_onLayerInfosRendererChanged:function(a){try{k.forEach(a,
function(a){this.layerListView.redrawLegends(a)},this)}catch(A){this._refresh()}},_onLayerInfosOpacityChanged:function(a){k.forEach(a,function(a){var d=void 0===a.layerObject.opacity?1:a.layerObject.opacity;a=h("[layercontenttrnodeid\x3d'"+a.id+"']",this.domNode)[0];h(".legends-div.jimu-legends-div-flag img",a).style("opacity",d)},this)},_onLayerInfosScaleRangeChanged:function(a){k.forEach(a,function(a){var d=[];a.traversal(f.hitch(this,function(a){d.push(a)}));var e=this,g=0;setTimeout(function(){var a=
d.slice(g,g+10);g+=10;k.forEach(a,function(a){h("[class~\x3d'layer-title-div-"+a.id+"']",this.domNode).forEach(function(b){try{a.isInScale()?n.removeClass(b,"grayed-title"):n.addClass(b,"grayed-title")}catch(m){console.warn(m.message)}},e)});d.length>g&&setTimeout(arguments.callee,30)},30)},this)},onAppConfigChanged:function(a,d,e){this.appConfig=a}})});