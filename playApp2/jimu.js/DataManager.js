// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define(["dojo/_base/declare","dojo/_base/lang","dojo/topic"],function(g,c,b){var f=null,e;e=g(null,{constructor:function(a){b.subscribe("publishData",c.hitch(this,this.onDataPublished));b.subscribe("fetchData",c.hitch(this,this.onFetchData));b.subscribe("clearAllData",c.hitch(this,this.onClearAllData));b.subscribe("removeData",c.hitch(this,this.onRemoveData));b.subscribe("clearDataHistory",c.hitch(this,this.onClearDataHistory));this.widgetManager=a},_dataStore:{},onDataPublished:function(a,b,d,c){"undefined"===
typeof c&&(c=!1);this._dataStore[b]?(this._dataStore[b].current=d,c&&(this._dataStore[b].history?this._dataStore[b].history.push(d):this._dataStore[b].history=[d])):(this._dataStore[b]={current:d},c&&(this._dataStore[b].history=[d]))},onFetchData:function(a){var c;if(a)"framework"===a?this._dataStore[a]?b.publish("dataFetched","framework","framework",this._dataStore[a].current,this._dataStore[a].history):b.publish("noData","framework","framework"):(c=this.widgetManager.getWidgetById(a))?this._dataStore[a]?
b.publish("dataFetched",c.name,a,this._dataStore[a].current,this._dataStore[a].history):b.publish("noData",c.name,a):b.publish("noData",void 0,a);else{for(var d in this._dataStore)(c=this.widgetManager.getWidgetById(d))&&b.publish("dataFetched",c.name,d,this._dataStore[d].current,this._dataStore[d].history);c||b.publish("noData",void 0,void 0)}},onClearAllData:function(){this._dataStore={};b.publish("allDataCleared")},onRemoveData:function(a){delete this._dataStore[a];b.publish("dataRemoved",a)},
onClearDataHistory:function(a){this._dataStore[a]&&(this._dataStore[a].history=[]);b.publish("dataHistoryCleared",a)}});e.getInstance=function(a){null===f&&(f=new e(a));return f};return e});